"use strict";
(self["webpackChunktelegram_t"] = self["webpackChunktelegram_t"] || []).push([["BundleExtra"],{

/***/ "./src/bundles/extra.ts":
/*!******************************!*\
  !*** ./src/bundles/extra.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AboutAdsModal: () => (/* reexport safe */ _components_modals_aboutAds_AboutAdsModal__WEBPACK_IMPORTED_MODULE_26__["default"]),
/* harmony export */   AboutMonetizationModal: () => (/* reexport safe */ _components_common_AboutMonetizationModal__WEBPACK_IMPORTED_MODULE_27__["default"]),
/* harmony export */   ArchivedChats: () => (/* reexport safe */ _components_left_ArchivedChats__WEBPACK_IMPORTED_MODULE_49__["default"]),
/* harmony export */   AttachBotInstallModal: () => (/* reexport safe */ _components_modals_attachBotInstall_AttachBotInstallModal__WEBPACK_IMPORTED_MODULE_15__["default"]),
/* harmony export */   AttachBotRecipientPicker: () => (/* reexport safe */ _components_main_AttachBotRecipientPicker__WEBPACK_IMPORTED_MODULE_4__["default"]),
/* harmony export */   AttachmentModal: () => (/* reexport safe */ _components_middle_composer_AttachmentModal__WEBPACK_IMPORTED_MODULE_59__["default"]),
/* harmony export */   BoostModal: () => (/* reexport safe */ _components_modals_boost_BoostModal__WEBPACK_IMPORTED_MODULE_22__["default"]),
/* harmony export */   BotCommandMenu: () => (/* reexport safe */ _components_middle_composer_BotCommandMenu__WEBPACK_IMPORTED_MODULE_63__["default"]),
/* harmony export */   BotTrustModal: () => (/* reexport safe */ _components_main_BotTrustModal__WEBPACK_IMPORTED_MODULE_14__["default"]),
/* harmony export */   CalendarModal: () => (/* reexport safe */ _components_common_CalendarModal__WEBPACK_IMPORTED_MODULE_33__["default"]),
/* harmony export */   ChatCommandTooltip: () => (/* reexport safe */ _components_middle_composer_ChatCommandTooltip__WEBPACK_IMPORTED_MODULE_62__["default"]),
/* harmony export */   ChatFolderModal: () => (/* reexport safe */ _components_left_ChatFolderModal__WEBPACK_IMPORTED_MODULE_50__["default"]),
/* harmony export */   ChatInviteModal: () => (/* reexport safe */ _components_modals_chatInvite_ChatInviteModal__WEBPACK_IMPORTED_MODULE_25__["default"]),
/* harmony export */   ChatLanguageModal: () => (/* reexport safe */ _components_middle_ChatLanguageModal__WEBPACK_IMPORTED_MODULE_43__["default"]),
/* harmony export */   ChatlistModal: () => (/* reexport safe */ _components_modals_chatlist_ChatlistModal__WEBPACK_IMPORTED_MODULE_24__["default"]),
/* harmony export */   CollectibleInfoModal: () => (/* reexport safe */ _components_modals_collectible_CollectibleInfoModal__WEBPACK_IMPORTED_MODULE_44__["default"]),
/* harmony export */   ContactList: () => (/* reexport safe */ _components_left_main_ContactList__WEBPACK_IMPORTED_MODULE_47__["default"]),
/* harmony export */   ContextMenuContainer: () => (/* reexport safe */ _components_middle_message_ContextMenuContainer__WEBPACK_IMPORTED_MODULE_52__["default"]),
/* harmony export */   CountryPickerModal: () => (/* reexport safe */ _components_common_CountryPickerModal__WEBPACK_IMPORTED_MODULE_40__["default"]),
/* harmony export */   CreateTopic: () => (/* reexport safe */ _components_right_CreateTopic__WEBPACK_IMPORTED_MODULE_79__["default"]),
/* harmony export */   CustomEmojiSetsModal: () => (/* reexport safe */ _components_common_CustomEmojiSetsModal__WEBPACK_IMPORTED_MODULE_55__["default"]),
/* harmony export */   CustomEmojiTooltip: () => (/* reexport safe */ _components_middle_composer_CustomEmojiTooltip__WEBPACK_IMPORTED_MODULE_66__["default"]),
/* harmony export */   CustomSendMenu: () => (/* reexport safe */ _components_middle_composer_CustomSendMenu__WEBPACK_IMPORTED_MODULE_67__["default"]),
/* harmony export */   DeleteFolderDialog: () => (/* reexport safe */ _components_main_DeleteFolderDialog__WEBPACK_IMPORTED_MODULE_16__["default"]),
/* harmony export */   DeleteMessageModal: () => (/* reexport safe */ _components_common_DeleteMessageModal__WEBPACK_IMPORTED_MODULE_34__["default"]),
/* harmony export */   Dialogs: () => (/* reexport safe */ _components_main_Dialogs__WEBPACK_IMPORTED_MODULE_5__["default"]),
/* harmony export */   DraftRecipientPicker: () => (/* reexport safe */ _components_main_DraftRecipientPicker__WEBPACK_IMPORTED_MODULE_3__["default"]),
/* harmony export */   DropArea: () => (/* reexport safe */ _components_middle_composer_DropArea__WEBPACK_IMPORTED_MODULE_68__["default"]),
/* harmony export */   EditTopic: () => (/* reexport safe */ _components_right_EditTopic__WEBPACK_IMPORTED_MODULE_80__["default"]),
/* harmony export */   EmojiInteractionAnimation: () => (/* reexport safe */ _components_middle_EmojiInteractionAnimation__WEBPACK_IMPORTED_MODULE_42__["default"]),
/* harmony export */   EmojiStatusAccessModal: () => (/* reexport safe */ _components_modals_emojiStatusAccess_EmojiStatusAccessModal__WEBPACK_IMPORTED_MODULE_29__["default"]),
/* harmony export */   EmojiTooltip: () => (/* reexport safe */ _components_middle_composer_EmojiTooltip__WEBPACK_IMPORTED_MODULE_70__["default"]),
/* harmony export */   ForwardRecipientPicker: () => (/* reexport safe */ _components_main_ForwardRecipientPicker__WEBPACK_IMPORTED_MODULE_2__["default"]),
/* harmony export */   GifSearch: () => (/* reexport safe */ _components_right_GifSearch__WEBPACK_IMPORTED_MODULE_74__["default"]),
/* harmony export */   GiftCodeModal: () => (/* reexport safe */ _components_modals_giftcode_GiftCodeModal__WEBPACK_IMPORTED_MODULE_23__["default"]),
/* harmony export */   GiveawayModal: () => (/* reexport safe */ _components_main_premium_GiveawayModal__WEBPACK_IMPORTED_MODULE_18__["default"]),
/* harmony export */   HeaderMenuContainer: () => (/* reexport safe */ _components_middle_HeaderMenuContainer__WEBPACK_IMPORTED_MODULE_56__["default"]),
/* harmony export */   HistoryCalendar: () => (/* reexport safe */ _components_main_HistoryCalendar__WEBPACK_IMPORTED_MODULE_10__["default"]),
/* harmony export */   InlineBotTooltip: () => (/* reexport safe */ _components_middle_composer_InlineBotTooltip__WEBPACK_IMPORTED_MODULE_71__["default"]),
/* harmony export */   InviteViaLinkModal: () => (/* reexport safe */ _components_modals_inviteViaLink_InviteViaLinkModal__WEBPACK_IMPORTED_MODULE_84__["default"]),
/* harmony export */   LeftSearch: () => (/* reexport safe */ _components_left_search_LeftSearch__WEBPACK_IMPORTED_MODULE_45__["default"]),
/* harmony export */   LocationAccessModal: () => (/* reexport safe */ _components_modals_locationAccess_LocationAccessModal__WEBPACK_IMPORTED_MODULE_30__["default"]),
/* harmony export */   Management: () => (/* reexport safe */ _components_right_management_Management__WEBPACK_IMPORTED_MODULE_81__["default"]),
/* harmony export */   MapModal: () => (/* reexport safe */ _components_modals_map_MapModal__WEBPACK_IMPORTED_MODULE_8__["default"]),
/* harmony export */   MediaViewer: () => (/* reexport safe */ _components_mediaViewer_MediaViewer__WEBPACK_IMPORTED_MODULE_0__["default"]),
/* harmony export */   MentionTooltip: () => (/* reexport safe */ _components_middle_composer_MentionTooltip__WEBPACK_IMPORTED_MODULE_64__["default"]),
/* harmony export */   MessageSelectToolbar: () => (/* reexport safe */ _components_middle_MessageSelectToolbar__WEBPACK_IMPORTED_MODULE_37__["default"]),
/* harmony export */   MessageStatistics: () => (/* reexport safe */ _components_right_statistics_MessageStatistics__WEBPACK_IMPORTED_MODULE_76__["default"]),
/* harmony export */   MiddleSearch: () => (/* reexport safe */ _components_middle_search_MiddleSearch__WEBPACK_IMPORTED_MODULE_57__["default"]),
/* harmony export */   MinimizedWebAppModal: () => (/* reexport safe */ _components_modals_webApp_MinimizedWebAppModal__WEBPACK_IMPORTED_MODULE_13__["default"]),
/* harmony export */   MuteChatModal: () => (/* reexport safe */ _components_left_MuteChatModal__WEBPACK_IMPORTED_MODULE_51__["default"]),
/* harmony export */   NewChat: () => (/* reexport safe */ _components_left_newChat_NewChat__WEBPACK_IMPORTED_MODULE_48__["default"]),
/* harmony export */   NewContactModal: () => (/* reexport safe */ _components_main_NewContactModal__WEBPACK_IMPORTED_MODULE_11__["default"]),
/* harmony export */   Notifications: () => (/* reexport safe */ _components_main_Notifications__WEBPACK_IMPORTED_MODULE_6__["default"]),
/* harmony export */   OneTimeMediaModal: () => (/* reexport safe */ _components_modals_oneTimeMedia_OneTimeMediaModal__WEBPACK_IMPORTED_MODULE_85__["default"]),
/* harmony export */   PaymentModal: () => (/* reexport safe */ _components_payment_PaymentModal__WEBPACK_IMPORTED_MODULE_82__["default"]),
/* harmony export */   PinMessageModal: () => (/* reexport safe */ _components_common_PinMessageModal__WEBPACK_IMPORTED_MODULE_35__["default"]),
/* harmony export */   PollModal: () => (/* reexport safe */ _components_middle_composer_PollModal__WEBPACK_IMPORTED_MODULE_60__["default"]),
/* harmony export */   PollResults: () => (/* reexport safe */ _components_right_PollResults__WEBPACK_IMPORTED_MODULE_78__["default"]),
/* harmony export */   PremiumLimitReachedModal: () => (/* reexport safe */ _components_main_premium_common_PremiumLimitReachedModal__WEBPACK_IMPORTED_MODULE_19__["default"]),
/* harmony export */   PremiumMainModal: () => (/* reexport safe */ _components_main_premium_PremiumMainModal__WEBPACK_IMPORTED_MODULE_17__["default"]),
/* harmony export */   PrivacySettingsNoticeModal: () => (/* reexport safe */ _components_common_PrivacySettingsNoticeModal__WEBPACK_IMPORTED_MODULE_39__["default"]),
/* harmony export */   ReactionPicker: () => (/* reexport safe */ _components_middle_message_reactions_ReactionPicker__WEBPACK_IMPORTED_MODULE_58__["default"]),
/* harmony export */   ReactorListModal: () => (/* reexport safe */ _components_middle_ReactorListModal__WEBPACK_IMPORTED_MODULE_41__["default"]),
/* harmony export */   ReceiptModal: () => (/* reexport safe */ _components_payment_ReceiptModal__WEBPACK_IMPORTED_MODULE_83__["default"]),
/* harmony export */   ReportAdModal: () => (/* reexport safe */ _components_modals_reportAd_ReportAdModal__WEBPACK_IMPORTED_MODULE_31__["default"]),
/* harmony export */   ReportModal: () => (/* reexport safe */ _components_modals_reportModal_ReportModal__WEBPACK_IMPORTED_MODULE_32__["default"]),
/* harmony export */   SafeLinkModal: () => (/* reexport safe */ _components_main_SafeLinkModal__WEBPACK_IMPORTED_MODULE_7__["default"]),
/* harmony export */   SeenByModal: () => (/* reexport safe */ _components_common_SeenByModal__WEBPACK_IMPORTED_MODULE_38__["default"]),
/* harmony export */   SendAsMenu: () => (/* reexport safe */ _components_middle_composer_SendAsMenu__WEBPACK_IMPORTED_MODULE_72__["default"]),
/* harmony export */   Settings: () => (/* reexport safe */ _components_left_settings_Settings__WEBPACK_IMPORTED_MODULE_46__["default"]),
/* harmony export */   SponsoredMessageContextMenuContainer: () => (/* reexport safe */ _components_middle_message_SponsoredMessageContextMenuContainer__WEBPACK_IMPORTED_MODULE_53__["default"]),
/* harmony export */   Statistics: () => (/* reexport safe */ _components_right_statistics_Statistics__WEBPACK_IMPORTED_MODULE_75__["default"]),
/* harmony export */   StatusPickerMenu: () => (/* reexport safe */ _components_left_main_StatusPickerMenu__WEBPACK_IMPORTED_MODULE_20__["default"]),
/* harmony export */   StickerSearch: () => (/* reexport safe */ _components_right_StickerSearch__WEBPACK_IMPORTED_MODULE_73__["default"]),
/* harmony export */   StickerSetModal: () => (/* reexport safe */ _components_common_StickerSetModal__WEBPACK_IMPORTED_MODULE_54__["default"]),
/* harmony export */   StickerTooltip: () => (/* reexport safe */ _components_middle_composer_StickerTooltip__WEBPACK_IMPORTED_MODULE_65__["default"]),
/* harmony export */   StoryStatistics: () => (/* reexport safe */ _components_right_statistics_StoryStatistics__WEBPACK_IMPORTED_MODULE_77__["default"]),
/* harmony export */   StoryViewer: () => (/* reexport safe */ _components_story_StoryViewer__WEBPACK_IMPORTED_MODULE_1__["default"]),
/* harmony export */   SuggestedStatusModal: () => (/* reexport safe */ _components_modals_suggestedStatus_SuggestedStatusModal__WEBPACK_IMPORTED_MODULE_21__["default"]),
/* harmony export */   SymbolMenu: () => (/* reexport safe */ _components_middle_composer_SymbolMenu__WEBPACK_IMPORTED_MODULE_61__["default"]),
/* harmony export */   TextFormatter: () => (/* reexport safe */ _components_middle_composer_TextFormatter__WEBPACK_IMPORTED_MODULE_69__["default"]),
/* harmony export */   UnpinAllMessagesModal: () => (/* reexport safe */ _components_common_UnpinAllMessagesModal__WEBPACK_IMPORTED_MODULE_36__["default"]),
/* harmony export */   UrlAuthModal: () => (/* reexport safe */ _components_modals_urlAuth_UrlAuthModal__WEBPACK_IMPORTED_MODULE_9__["default"]),
/* harmony export */   VerificationMonetizationModal: () => (/* reexport safe */ _components_common_VerificationMonetizationModal__WEBPACK_IMPORTED_MODULE_28__["default"]),
/* harmony export */   WebAppModal: () => (/* reexport safe */ _components_modals_webApp_WebAppModal__WEBPACK_IMPORTED_MODULE_12__["default"]),
/* harmony export */   WebAppsCloseConfirmationModal: () => (/* reexport safe */ _components_main_WebAppsCloseConfirmationModal__WEBPACK_IMPORTED_MODULE_86__["default"])
/* harmony export */ });
/* harmony import */ var _components_mediaViewer_MediaViewer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/mediaViewer/MediaViewer */ "./src/components/mediaViewer/MediaViewer.tsx");
/* harmony import */ var _components_story_StoryViewer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/story/StoryViewer */ "./src/components/story/StoryViewer.tsx");
/* harmony import */ var _components_main_ForwardRecipientPicker__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/main/ForwardRecipientPicker */ "./src/components/main/ForwardRecipientPicker.tsx");
/* harmony import */ var _components_main_DraftRecipientPicker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/main/DraftRecipientPicker */ "./src/components/main/DraftRecipientPicker.tsx");
/* harmony import */ var _components_main_AttachBotRecipientPicker__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/main/AttachBotRecipientPicker */ "./src/components/main/AttachBotRecipientPicker.tsx");
/* harmony import */ var _components_main_Dialogs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/main/Dialogs */ "./src/components/main/Dialogs.tsx");
/* harmony import */ var _components_main_Notifications__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../components/main/Notifications */ "./src/components/main/Notifications.tsx");
/* harmony import */ var _components_main_SafeLinkModal__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../components/main/SafeLinkModal */ "./src/components/main/SafeLinkModal.tsx");
/* harmony import */ var _components_modals_map_MapModal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../components/modals/map/MapModal */ "./src/components/modals/map/MapModal.tsx");
/* harmony import */ var _components_modals_urlAuth_UrlAuthModal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../components/modals/urlAuth/UrlAuthModal */ "./src/components/modals/urlAuth/UrlAuthModal.tsx");
/* harmony import */ var _components_main_HistoryCalendar__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../components/main/HistoryCalendar */ "./src/components/main/HistoryCalendar.tsx");
/* harmony import */ var _components_main_NewContactModal__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../components/main/NewContactModal */ "./src/components/main/NewContactModal.tsx");
/* harmony import */ var _components_modals_webApp_WebAppModal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../components/modals/webApp/WebAppModal */ "./src/components/modals/webApp/WebAppModal.tsx");
/* harmony import */ var _components_modals_webApp_MinimizedWebAppModal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../components/modals/webApp/MinimizedWebAppModal */ "./src/components/modals/webApp/MinimizedWebAppModal.tsx");
/* harmony import */ var _components_main_BotTrustModal__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../components/main/BotTrustModal */ "./src/components/main/BotTrustModal.tsx");
/* harmony import */ var _components_modals_attachBotInstall_AttachBotInstallModal__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../components/modals/attachBotInstall/AttachBotInstallModal */ "./src/components/modals/attachBotInstall/AttachBotInstallModal.tsx");
/* harmony import */ var _components_main_DeleteFolderDialog__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../components/main/DeleteFolderDialog */ "./src/components/main/DeleteFolderDialog.tsx");
/* harmony import */ var _components_main_premium_PremiumMainModal__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../components/main/premium/PremiumMainModal */ "./src/components/main/premium/PremiumMainModal.tsx");
/* harmony import */ var _components_main_premium_GiveawayModal__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../components/main/premium/GiveawayModal */ "./src/components/main/premium/GiveawayModal.tsx");
/* harmony import */ var _components_main_premium_common_PremiumLimitReachedModal__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../components/main/premium/common/PremiumLimitReachedModal */ "./src/components/main/premium/common/PremiumLimitReachedModal.tsx");
/* harmony import */ var _components_left_main_StatusPickerMenu__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../components/left/main/StatusPickerMenu */ "./src/components/left/main/StatusPickerMenu.tsx");
/* harmony import */ var _components_modals_suggestedStatus_SuggestedStatusModal__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../components/modals/suggestedStatus/SuggestedStatusModal */ "./src/components/modals/suggestedStatus/SuggestedStatusModal.tsx");
/* harmony import */ var _components_modals_boost_BoostModal__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../components/modals/boost/BoostModal */ "./src/components/modals/boost/BoostModal.tsx");
/* harmony import */ var _components_modals_giftcode_GiftCodeModal__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../components/modals/giftcode/GiftCodeModal */ "./src/components/modals/giftcode/GiftCodeModal.tsx");
/* harmony import */ var _components_modals_chatlist_ChatlistModal__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../components/modals/chatlist/ChatlistModal */ "./src/components/modals/chatlist/ChatlistModal.tsx");
/* harmony import */ var _components_modals_chatInvite_ChatInviteModal__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../components/modals/chatInvite/ChatInviteModal */ "./src/components/modals/chatInvite/ChatInviteModal.tsx");
/* harmony import */ var _components_modals_aboutAds_AboutAdsModal__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../components/modals/aboutAds/AboutAdsModal */ "./src/components/modals/aboutAds/AboutAdsModal.tsx");
/* harmony import */ var _components_common_AboutMonetizationModal__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../components/common/AboutMonetizationModal */ "./src/components/common/AboutMonetizationModal.tsx");
/* harmony import */ var _components_common_VerificationMonetizationModal__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../components/common/VerificationMonetizationModal */ "./src/components/common/VerificationMonetizationModal.tsx");
/* harmony import */ var _components_modals_emojiStatusAccess_EmojiStatusAccessModal__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../components/modals/emojiStatusAccess/EmojiStatusAccessModal */ "./src/components/modals/emojiStatusAccess/EmojiStatusAccessModal.tsx");
/* harmony import */ var _components_modals_locationAccess_LocationAccessModal__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../components/modals/locationAccess/LocationAccessModal */ "./src/components/modals/locationAccess/LocationAccessModal.tsx");
/* harmony import */ var _components_modals_reportAd_ReportAdModal__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../components/modals/reportAd/ReportAdModal */ "./src/components/modals/reportAd/ReportAdModal.tsx");
/* harmony import */ var _components_modals_reportModal_ReportModal__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../components/modals/reportModal/ReportModal */ "./src/components/modals/reportModal/ReportModal.tsx");
/* harmony import */ var _components_common_CalendarModal__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../components/common/CalendarModal */ "./src/components/common/CalendarModal.tsx");
/* harmony import */ var _components_common_DeleteMessageModal__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../components/common/DeleteMessageModal */ "./src/components/common/DeleteMessageModal.tsx");
/* harmony import */ var _components_common_PinMessageModal__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../components/common/PinMessageModal */ "./src/components/common/PinMessageModal.tsx");
/* harmony import */ var _components_common_UnpinAllMessagesModal__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../components/common/UnpinAllMessagesModal */ "./src/components/common/UnpinAllMessagesModal.tsx");
/* harmony import */ var _components_middle_MessageSelectToolbar__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../components/middle/MessageSelectToolbar */ "./src/components/middle/MessageSelectToolbar.tsx");
/* harmony import */ var _components_common_SeenByModal__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../components/common/SeenByModal */ "./src/components/common/SeenByModal.tsx");
/* harmony import */ var _components_common_PrivacySettingsNoticeModal__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../components/common/PrivacySettingsNoticeModal */ "./src/components/common/PrivacySettingsNoticeModal.tsx");
/* harmony import */ var _components_common_CountryPickerModal__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ../components/common/CountryPickerModal */ "./src/components/common/CountryPickerModal.tsx");
/* harmony import */ var _components_middle_ReactorListModal__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ../components/middle/ReactorListModal */ "./src/components/middle/ReactorListModal.tsx");
/* harmony import */ var _components_middle_EmojiInteractionAnimation__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ../components/middle/EmojiInteractionAnimation */ "./src/components/middle/EmojiInteractionAnimation.tsx");
/* harmony import */ var _components_middle_ChatLanguageModal__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ../components/middle/ChatLanguageModal */ "./src/components/middle/ChatLanguageModal.tsx");
/* harmony import */ var _components_modals_collectible_CollectibleInfoModal__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ../components/modals/collectible/CollectibleInfoModal */ "./src/components/modals/collectible/CollectibleInfoModal.tsx");
/* harmony import */ var _components_left_search_LeftSearch__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ../components/left/search/LeftSearch */ "./src/components/left/search/LeftSearch.tsx");
/* harmony import */ var _components_left_settings_Settings__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ../components/left/settings/Settings */ "./src/components/left/settings/Settings.tsx");
/* harmony import */ var _components_left_main_ContactList__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ../components/left/main/ContactList */ "./src/components/left/main/ContactList.tsx");
/* harmony import */ var _components_left_newChat_NewChat__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ../components/left/newChat/NewChat */ "./src/components/left/newChat/NewChat.tsx");
/* harmony import */ var _components_left_ArchivedChats__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ../components/left/ArchivedChats */ "./src/components/left/ArchivedChats.tsx");
/* harmony import */ var _components_left_ChatFolderModal__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ../components/left/ChatFolderModal */ "./src/components/left/ChatFolderModal.tsx");
/* harmony import */ var _components_left_MuteChatModal__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ../components/left/MuteChatModal */ "./src/components/left/MuteChatModal.tsx");
/* harmony import */ var _components_middle_message_ContextMenuContainer__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ../components/middle/message/ContextMenuContainer */ "./src/components/middle/message/ContextMenuContainer.tsx");
/* harmony import */ var _components_middle_message_SponsoredMessageContextMenuContainer__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ../components/middle/message/SponsoredMessageContextMenuContainer */ "./src/components/middle/message/SponsoredMessageContextMenuContainer.tsx");
/* harmony import */ var _components_common_StickerSetModal__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ../components/common/StickerSetModal */ "./src/components/common/StickerSetModal.tsx");
/* harmony import */ var _components_common_CustomEmojiSetsModal__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! ../components/common/CustomEmojiSetsModal */ "./src/components/common/CustomEmojiSetsModal.tsx");
/* harmony import */ var _components_middle_HeaderMenuContainer__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! ../components/middle/HeaderMenuContainer */ "./src/components/middle/HeaderMenuContainer.tsx");
/* harmony import */ var _components_middle_search_MiddleSearch__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! ../components/middle/search/MiddleSearch */ "./src/components/middle/search/MiddleSearch.tsx");
/* harmony import */ var _components_middle_message_reactions_ReactionPicker__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(/*! ../components/middle/message/reactions/ReactionPicker */ "./src/components/middle/message/reactions/ReactionPicker.tsx");
/* harmony import */ var _components_middle_composer_AttachmentModal__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(/*! ../components/middle/composer/AttachmentModal */ "./src/components/middle/composer/AttachmentModal.tsx");
/* harmony import */ var _components_middle_composer_PollModal__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(/*! ../components/middle/composer/PollModal */ "./src/components/middle/composer/PollModal.tsx");
/* harmony import */ var _components_middle_composer_SymbolMenu__WEBPACK_IMPORTED_MODULE_61__ = __webpack_require__(/*! ../components/middle/composer/SymbolMenu */ "./src/components/middle/composer/SymbolMenu.tsx");
/* harmony import */ var _components_middle_composer_ChatCommandTooltip__WEBPACK_IMPORTED_MODULE_62__ = __webpack_require__(/*! ../components/middle/composer/ChatCommandTooltip */ "./src/components/middle/composer/ChatCommandTooltip.tsx");
/* harmony import */ var _components_middle_composer_BotCommandMenu__WEBPACK_IMPORTED_MODULE_63__ = __webpack_require__(/*! ../components/middle/composer/BotCommandMenu */ "./src/components/middle/composer/BotCommandMenu.tsx");
/* harmony import */ var _components_middle_composer_MentionTooltip__WEBPACK_IMPORTED_MODULE_64__ = __webpack_require__(/*! ../components/middle/composer/MentionTooltip */ "./src/components/middle/composer/MentionTooltip.tsx");
/* harmony import */ var _components_middle_composer_StickerTooltip__WEBPACK_IMPORTED_MODULE_65__ = __webpack_require__(/*! ../components/middle/composer/StickerTooltip */ "./src/components/middle/composer/StickerTooltip.tsx");
/* harmony import */ var _components_middle_composer_CustomEmojiTooltip__WEBPACK_IMPORTED_MODULE_66__ = __webpack_require__(/*! ../components/middle/composer/CustomEmojiTooltip */ "./src/components/middle/composer/CustomEmojiTooltip.tsx");
/* harmony import */ var _components_middle_composer_CustomSendMenu__WEBPACK_IMPORTED_MODULE_67__ = __webpack_require__(/*! ../components/middle/composer/CustomSendMenu */ "./src/components/middle/composer/CustomSendMenu.tsx");
/* harmony import */ var _components_middle_composer_DropArea__WEBPACK_IMPORTED_MODULE_68__ = __webpack_require__(/*! ../components/middle/composer/DropArea */ "./src/components/middle/composer/DropArea.tsx");
/* harmony import */ var _components_middle_composer_TextFormatter__WEBPACK_IMPORTED_MODULE_69__ = __webpack_require__(/*! ../components/middle/composer/TextFormatter */ "./src/components/middle/composer/TextFormatter.tsx");
/* harmony import */ var _components_middle_composer_EmojiTooltip__WEBPACK_IMPORTED_MODULE_70__ = __webpack_require__(/*! ../components/middle/composer/EmojiTooltip */ "./src/components/middle/composer/EmojiTooltip.tsx");
/* harmony import */ var _components_middle_composer_InlineBotTooltip__WEBPACK_IMPORTED_MODULE_71__ = __webpack_require__(/*! ../components/middle/composer/InlineBotTooltip */ "./src/components/middle/composer/InlineBotTooltip.tsx");
/* harmony import */ var _components_middle_composer_SendAsMenu__WEBPACK_IMPORTED_MODULE_72__ = __webpack_require__(/*! ../components/middle/composer/SendAsMenu */ "./src/components/middle/composer/SendAsMenu.tsx");
/* harmony import */ var _components_right_StickerSearch__WEBPACK_IMPORTED_MODULE_73__ = __webpack_require__(/*! ../components/right/StickerSearch */ "./src/components/right/StickerSearch.tsx");
/* harmony import */ var _components_right_GifSearch__WEBPACK_IMPORTED_MODULE_74__ = __webpack_require__(/*! ../components/right/GifSearch */ "./src/components/right/GifSearch.tsx");
/* harmony import */ var _components_right_statistics_Statistics__WEBPACK_IMPORTED_MODULE_75__ = __webpack_require__(/*! ../components/right/statistics/Statistics */ "./src/components/right/statistics/Statistics.tsx");
/* harmony import */ var _components_right_statistics_MessageStatistics__WEBPACK_IMPORTED_MODULE_76__ = __webpack_require__(/*! ../components/right/statistics/MessageStatistics */ "./src/components/right/statistics/MessageStatistics.tsx");
/* harmony import */ var _components_right_statistics_StoryStatistics__WEBPACK_IMPORTED_MODULE_77__ = __webpack_require__(/*! ../components/right/statistics/StoryStatistics */ "./src/components/right/statistics/StoryStatistics.tsx");
/* harmony import */ var _components_right_PollResults__WEBPACK_IMPORTED_MODULE_78__ = __webpack_require__(/*! ../components/right/PollResults */ "./src/components/right/PollResults.tsx");
/* harmony import */ var _components_right_CreateTopic__WEBPACK_IMPORTED_MODULE_79__ = __webpack_require__(/*! ../components/right/CreateTopic */ "./src/components/right/CreateTopic.tsx");
/* harmony import */ var _components_right_EditTopic__WEBPACK_IMPORTED_MODULE_80__ = __webpack_require__(/*! ../components/right/EditTopic */ "./src/components/right/EditTopic.tsx");
/* harmony import */ var _components_right_management_Management__WEBPACK_IMPORTED_MODULE_81__ = __webpack_require__(/*! ../components/right/management/Management */ "./src/components/right/management/Management.tsx");
/* harmony import */ var _components_payment_PaymentModal__WEBPACK_IMPORTED_MODULE_82__ = __webpack_require__(/*! ../components/payment/PaymentModal */ "./src/components/payment/PaymentModal.tsx");
/* harmony import */ var _components_payment_ReceiptModal__WEBPACK_IMPORTED_MODULE_83__ = __webpack_require__(/*! ../components/payment/ReceiptModal */ "./src/components/payment/ReceiptModal.tsx");
/* harmony import */ var _components_modals_inviteViaLink_InviteViaLinkModal__WEBPACK_IMPORTED_MODULE_84__ = __webpack_require__(/*! ../components/modals/inviteViaLink/InviteViaLinkModal */ "./src/components/modals/inviteViaLink/InviteViaLinkModal.tsx");
/* harmony import */ var _components_modals_oneTimeMedia_OneTimeMediaModal__WEBPACK_IMPORTED_MODULE_85__ = __webpack_require__(/*! ../components/modals/oneTimeMedia/OneTimeMediaModal */ "./src/components/modals/oneTimeMedia/OneTimeMediaModal.tsx");
/* harmony import */ var _components_main_WebAppsCloseConfirmationModal__WEBPACK_IMPORTED_MODULE_86__ = __webpack_require__(/*! ../components/main/WebAppsCloseConfirmationModal */ "./src/components/main/WebAppsCloseConfirmationModal.tsx");
























































































/***/ }),

/***/ "./src/components/common/AboutMonetizationModal.tsx":
/*!**********************************************************!*\
  !*** ./src/components/common/AboutMonetizationModal.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _helpers_renderText__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _modals_common_TableAboutModal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../modals/common/TableAboutModal */ "./src/components/modals/common/TableAboutModal.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _SafeLink__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SafeLink */ "./src/components/common/SafeLink.tsx");
/* harmony import */ var _AboutMonetizationModal_module_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./AboutMonetizationModal.module.scss */ "./src/components/common/AboutMonetizationModal.module.scss");








const AboutMonetizationModal = ({
  isOpen,
  onClose
}) => {
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const blockchainText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const linkText = oldLang('LearnMore');
    return lang('ChannelEarnLearnCoinAbout', {
      link: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SafeLink__WEBPACK_IMPORTED_MODULE_6__["default"], {
        url: oldLang('MonetizationInfoTONLink'),
        text: linkText
      }, linkText, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_5__["default"], {
        name: "next"
      }))
    }, {
      withNodes: true
    });
  }, [lang, oldLang]);
  const monetizationTitle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return lang('MonetizationInfoTONTitle', undefined, {
      withNodes: true,
      specialReplacement: {
        '💎': /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_5__["default"], {
          className: _AboutMonetizationModal_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].toncoin,
          name: "toncoin"
        })
      }
    });
  }, [lang]);
  const modalData = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!isOpen) return undefined;
    const header = /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: _AboutMonetizationModal_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].title
    }, oldLang('lng_channel_earn_learn_title'));
    const listItemData = [['channel', oldLang('lng_channel_earn_learn_in_subtitle'), (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_1__["default"])(oldLang('lng_channel_earn_learn_in_about'), ['simple_markdown'])], ['revenue-split', oldLang('lng_channel_earn_learn_split_subtitle'), (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_1__["default"])(oldLang('Monetization.Intro.Split.Text'), ['simple_markdown'])], ['cash-circle', oldLang('lng_channel_earn_learn_out_subtitle'), (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_1__["default"])(oldLang('lng_channel_earn_learn_out_about'), ['simple_markdown'])]];
    const footer = /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: _AboutMonetizationModal_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].title
    }, monetizationTitle), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: _AboutMonetizationModal_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].description
    }, blockchainText));
    return {
      header,
      listItemData,
      footer
    };
  }, [isOpen, oldLang, monetizationTitle, blockchainText]);
  if (!modalData) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_modals_common_TableAboutModal__WEBPACK_IMPORTED_MODULE_4__["default"], {
    isOpen: isOpen,
    listItemData: modalData.listItemData,
    headerIconName: "cash-circle",
    withSeparator: true,
    header: modalData.header,
    footer: modalData.footer,
    buttonText: oldLang('RevenueSharingAdsUnderstood'),
    onClose: onClose
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(AboutMonetizationModal));

/***/ }),

/***/ "./src/components/common/CalendarModal.tsx":
/*!*************************************************!*\
  !*** ./src/components/common/CalendarModal.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _CalendarModal_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./CalendarModal.scss */ "./src/components/common/CalendarModal.scss");











const MAX_SAFE_DATE = _config__WEBPACK_IMPORTED_MODULE_1__.MAX_INT_32 * 1000;
const MIN_SAFE_DATE = 0;
const WEEKDAY_LETTERS = ['lng_weekday1', 'lng_weekday2', 'lng_weekday3', 'lng_weekday4', 'lng_weekday5', 'lng_weekday6', 'lng_weekday7'];
const CalendarModal = ({
  selectedAt,
  minAt,
  maxAt,
  isFutureMode,
  isPastMode,
  isOpen,
  withTimePicker,
  submitButtonLabel,
  secondButtonLabel,
  onClose,
  onSubmit,
  onSecondButtonClick
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const now = new Date();
  const minDate = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (isFutureMode && !minAt) return new Date();
    return new Date(Math.max(minAt || MIN_SAFE_DATE, MIN_SAFE_DATE));
  }, [isFutureMode, minAt]);
  const maxDate = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (isPastMode && !maxAt) return new Date();
    return new Date(Math.min(maxAt || MAX_SAFE_DATE, MAX_SAFE_DATE));
  }, [isPastMode, maxAt]);
  const passedSelectedDate = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => selectedAt ? new Date(selectedAt) : new Date(), [selectedAt]);
  const prevIsOpen = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__["default"])(isOpen);
  const [isTimeInputFocused, markTimeInputAsFocused] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])(false);
  const [selectedDate, setSelectedDate] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(passedSelectedDate);
  const [currentMonthAndYear, setCurrentMonthAndYear] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(new Date(selectedDate.getFullYear(), selectedDate.getMonth(), 1));
  const [selectedHours, setSelectedHours] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(formatInputTime(passedSelectedDate.getHours()));
  const [selectedMinutes, setSelectedMinutes] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(formatInputTime(passedSelectedDate.getMinutes()));
  const selectedDay = formatDay(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate());
  const currentYear = currentMonthAndYear.getFullYear();
  const currentMonth = currentMonthAndYear.getMonth();
  const isDisabled = isFutureMode && selectedDate.getTime() < minDate.getTime() || isPastMode && selectedDate.getTime() > maxDate.getTime();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!prevIsOpen && isOpen) {
      setSelectedDate(passedSelectedDate);
      setCurrentMonthAndYear(new Date(passedSelectedDate.getFullYear(), passedSelectedDate.getMonth(), 1));
      if (withTimePicker) {
        setSelectedHours(formatInputTime(passedSelectedDate.getHours()));
        setSelectedMinutes(formatInputTime(passedSelectedDate.getMinutes()));
      }
    }
  }, [passedSelectedDate, isOpen, prevIsOpen, withTimePicker]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isFutureMode && !isTimeInputFocused && selectedDate.getTime() < minDate.getTime()) {
      setSelectedDate(minDate);
      setSelectedHours(formatInputTime(minDate.getHours()));
      setSelectedMinutes(formatInputTime(minDate.getMinutes()));
    }
  }, [isFutureMode, isTimeInputFocused, minDate, selectedDate]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isPastMode && !isTimeInputFocused && selectedDate.getTime() > maxDate.getTime()) {
      setSelectedDate(maxDate);
      setSelectedHours(formatInputTime(maxDate.getHours()));
      setSelectedMinutes(formatInputTime(maxDate.getMinutes()));
    }
  }, [isFutureMode, isPastMode, isTimeInputFocused, maxDate, minDate, selectedDate]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (selectedAt) {
      const newSelectedDate = new Date(selectedAt);
      setSelectedDate(newSelectedDate);
      setSelectedHours(formatInputTime(newSelectedDate.getHours()));
      setSelectedMinutes(formatInputTime(newSelectedDate.getMinutes()));
    }
  }, [selectedAt]);
  const shouldDisableNextMonth = isPastMode && currentYear >= now.getFullYear() && currentMonth >= now.getMonth() || maxDate && currentYear >= maxDate.getFullYear() && currentMonth >= maxDate.getMonth();
  const shouldDisablePrevMonth = isFutureMode && currentYear <= now.getFullYear() && currentMonth <= now.getMonth();
  const {
    prevMonthGrid,
    currentMonthGrid,
    nextMonthGrid
  } = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => buildCalendarGrid(currentYear, currentMonth), [currentMonth, currentYear]);
  const submitLabel = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return submitButtonLabel || formatSubmitLabel(lang, selectedDate);
  }, [lang, selectedDate, submitButtonLabel]);
  function handlePrevMonth() {
    setCurrentMonthAndYear(d => {
      const dateCopy = new Date(d);
      dateCopy.setMonth(dateCopy.getMonth() - 1);
      return dateCopy;
    });
  }
  function handleNextMonth() {
    setCurrentMonthAndYear(d => {
      const dateCopy = new Date(d);
      dateCopy.setMonth(dateCopy.getMonth() + 1);
      return dateCopy;
    });
  }
  function handleDateSelect(date) {
    setSelectedDate(d => {
      const dateCopy = new Date(d);
      dateCopy.setDate(date);
      dateCopy.setMonth(currentMonth);
      dateCopy.setFullYear(currentYear);
      return dateCopy;
    });
  }
  const handleSubmit = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (isFutureMode && selectedDate < minDate) {
      onSubmit(minDate);
    } else if (isPastMode && selectedDate > maxDate) {
      onSubmit(maxDate);
    } else {
      onSubmit(selectedDate);
    }
  }, [isFutureMode, isPastMode, minDate, maxDate, onSubmit, selectedDate]);
  const handleChangeHours = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const value = e.target.value.replace(/[^\d]+/g, '');
    if (!value.length) {
      setSelectedHours('');
      e.target.value = '';
      return;
    }
    const hours = Math.max(0, Math.min(Number(value), 23));
    const date = new Date(selectedDate.getTime());
    date.setHours(hours);
    setSelectedDate(date);
    const hoursStr = formatInputTime(hours);
    setSelectedHours(hoursStr);
    e.target.value = hoursStr;
  }, [selectedDate]);
  const handleChangeMinutes = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const value = e.target.value.replace(/[^\d]+/g, '');
    if (!value.length) {
      setSelectedMinutes('');
      e.target.value = '';
      return;
    }
    const minutes = Math.max(0, Math.min(Number(value), 59));
    const date = new Date(selectedDate.getTime());
    date.setMinutes(minutes);
    setSelectedDate(date);
    const minutesStr = formatInputTime(minutes);
    setSelectedMinutes(minutesStr);
    e.target.value = minutesStr;
  }, [selectedDate]);
  function renderTimePicker() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "timepicker"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
      type: "text",
      className: "form-control",
      inputMode: "decimal",
      value: selectedHours,
      onChange: handleChangeHours,
      onFocus: markTimeInputAsFocused
    }), ":", /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
      type: "text",
      className: "form-control",
      inputMode: "decimal",
      value: selectedMinutes,
      onChange: handleChangeMinutes,
      onFocus: markTimeInputAsFocused
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_8__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    className: "CalendarModal",
    onEnter: handleSubmit
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "container"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "month-selector"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
    round: true,
    size: "smaller",
    color: "translucent",
    onClick: onClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", null, lang(`lng_month${currentMonth + 1}`), ' ', currentYear), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
    round: true,
    size: "smaller",
    color: "translucent",
    disabled: shouldDisablePrevMonth,
    onClick: !shouldDisablePrevMonth ? handlePrevMonth : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    name: "previous"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
    round: true,
    size: "smaller",
    color: "translucent",
    disabled: shouldDisableNextMonth,
    onClick: !shouldDisableNextMonth ? handleNextMonth : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    name: "next"
  })))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "calendar-wrapper"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "calendar-grid"
  }, WEEKDAY_LETTERS.map(day => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "day-button faded weekday"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, lang(day)))), prevMonthGrid.map(gridDate => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "day-button disabled"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, gridDate))), currentMonthGrid.map(gridDate => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    role: "button",
    tabIndex: 0,
    onClick: () => handleDateSelect(gridDate),
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('day-button', 'div-button', isDisabledDay(currentYear, currentMonth, gridDate, minDate, maxDate) ? 'disabled' : `${gridDate ? 'clickable' : ''}`, selectedDay === formatDay(currentYear, currentMonth, gridDate) && 'selected')
  }, Boolean(gridDate) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, gridDate))), nextMonthGrid.map(gridDate => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "day-button disabled"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, gridDate))))), withTimePicker && renderTimePicker(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "footer"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "footer"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
    onClick: handleSubmit,
    disabled: isDisabled
  }, submitLabel), secondButtonLabel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
    onClick: onSecondButtonClick,
    isText: true
  }, secondButtonLabel))));
};
function buildCalendarGrid(year, month) {
  const prevMonthGrid = [];
  const currentMonthGrid = [];
  const nextMonthGrid = [];
  const date = new Date();
  date.setDate(1);
  date.setMonth(month);
  date.setFullYear(year);
  const firstDay = date.getDay() || 7;
  const totalDaysInPrevMonth = new Date(year, month, 0).getDate();
  for (let i = 1; i < firstDay; i++) {
    prevMonthGrid.push(totalDaysInPrevMonth - firstDay + i + 1);
  }
  while (date.getMonth() === month) {
    const gridDate = date.getDate();
    currentMonthGrid.push(gridDate);
    date.setDate(gridDate + 1);
  }
  const lastRowDaysCount = (currentMonthGrid.length + prevMonthGrid.length) % 7;
  if (lastRowDaysCount > 0) {
    for (let i = 1; i <= 7 - lastRowDaysCount; i++) {
      nextMonthGrid.push(i);
    }
  }
  return {
    prevMonthGrid,
    currentMonthGrid,
    nextMonthGrid
  };
}
function isDisabledDay(year, month, day, minDate, maxDate) {
  const selectedDay = new Date(year, month, day);
  const fixedMinDate = minDate && (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.getDayStart)(minDate);
  const fixedMaxDate = maxDate && (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.getDayStart)(maxDate);
  if (fixedMaxDate && selectedDay > fixedMaxDate) {
    return true;
  } else if (fixedMinDate && selectedDay < fixedMinDate) {
    return true;
  }
  return false;
}
function formatInputTime(value) {
  return String(value).padStart(2, '0');
}
function formatDay(year, month, day) {
  return `${year}-${month + 1}-${day}`;
}
function formatSubmitLabel(lang, date) {
  const day = (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.formatDateToString)(date, lang.code);
  const today = (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.formatDateToString)(new Date(), lang.code);
  if (day === today) {
    return lang('Conversation.ScheduleMessage.SendToday', (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.formatTime)(lang, date));
  }
  return lang('Conversation.ScheduleMessage.SendOn', [day, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.formatTime)(lang, date)]);
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(CalendarModal));

/***/ }),

/***/ "./src/components/common/CountryPickerModal.tsx":
/*!******************************************************!*\
  !*** ./src/components/common/CountryPickerModal.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _pickers_ItemPicker__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./pickers/ItemPicker */ "./src/components/common/pickers/ItemPicker.tsx");
/* harmony import */ var _CountryPickerModal_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./CountryPickerModal.module.scss */ "./src/components/common/CountryPickerModal.module.scss");











const CountryPickerModal = ({
  isOpen,
  onClose,
  onSubmit,
  countryList,
  selectionLimit
}) => {
  const {
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const [selectedCountryIds, setSelectedCountryIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const prevSelectedCountryIds = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_5__["default"])(selectedCountryIds);
  const noPickerScrollRestore = prevSelectedCountryIds === selectedCountryIds;
  const displayedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!countryList) {
      return [];
    }
    return countryList.filter(country => !country.isHidden && country.iso2 !== 'FT').map(({
      iso2,
      defaultName
    }) => ({
      value: iso2,
      label: defaultName
    }));
  }, [countryList]);
  const handleSelectedIdsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__["default"])(newSelectedIds => {
    if (selectionLimit && newSelectedIds.length > selectionLimit) {
      showNotification({
        message: lang('BoostingSelectUpToWarningCountries', selectionLimit)
      });
      return;
    }
    setSelectedCountryIds(newSelectedIds);
  });
  const handleSubmit = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__["default"])(() => {
    onSubmit(selectedCountryIds);
    onClose();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_7__["default"], {
    className: _CountryPickerModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].root,
    isOpen: isOpen,
    onClose: onClose,
    onEnter: handleSubmit
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _CountryPickerModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].container
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _CountryPickerModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].pickerSelector
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    round: true,
    size: "smaller",
    color: "translucent",
    onClick: onClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: _CountryPickerModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].pickerTitle
  }, lang('BoostingSelectCountry')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_CountryPickerModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].main, 'custom-scroll')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_pickers_ItemPicker__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: _CountryPickerModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].picker,
    items: displayedIds,
    selectedValues: selectedCountryIds,
    onSelectedValuesChange: handleSelectedIdsChange,
    noScrollRestore: noPickerScrollRestore,
    allowMultiple: true,
    itemInputType: "checkbox"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _CountryPickerModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].footer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    size: "smaller",
    onClick: handleSubmit
  }, lang('SelectCountries.OK'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(CountryPickerModal));

/***/ }),

/***/ "./src/components/common/CustomEmojiPicker.tsx":
/*!*****************************************************!*\
  !*** ./src/components/common/CustomEmojiPicker.tsx ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/animateHorizontalScroll */ "./src/util/animateHorizontalScroll.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/useHorizontalScroll */ "./src/hooks/useHorizontalScroll.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePrevDuringAnimation__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../hooks/usePrevDuringAnimation */ "./src/hooks/usePrevDuringAnimation.ts");
/* harmony import */ var _hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../hooks/useScrolledState */ "./src/hooks/useScrolledState.ts");
/* harmony import */ var _right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../right/hooks/useAsyncRendering */ "./src/components/right/hooks/useAsyncRendering.ts");
/* harmony import */ var _hooks_useStickerPickerObservers__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./hooks/useStickerPickerObservers */ "./src/components/common/hooks/useStickerPickerObservers.ts");
/* harmony import */ var _middle_composer_StickerSetCover__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../middle/composer/StickerSetCover */ "./src/components/middle/composer/StickerSetCover.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _StickerButton__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./StickerButton */ "./src/components/common/StickerButton.tsx");
/* harmony import */ var _StickerSet__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./StickerSet */ "./src/components/common/StickerSet.tsx");
/* harmony import */ var _middle_composer_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../middle/composer/StickerPicker.module.scss */ "./src/components/middle/composer/StickerPicker.module.scss");
/* harmony import */ var _CustomEmojiPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./CustomEmojiPicker.module.scss */ "./src/components/common/CustomEmojiPicker.module.scss");


























const HEADER_BUTTON_WIDTH = 2.5 * _helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_9__.REM; // px (including margin)

const DEFAULT_ID_PREFIX = 'custom-emoji-set';
const TOP_REACTIONS_COUNT = 16;
const RECENT_REACTIONS_COUNT = 32;
const RECENT_DEFAULT_STATUS_COUNT = 7;
const FADED_BUTTON_SET_IDS = new Set([_config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID, _config__WEBPACK_IMPORTED_MODULE_2__.FAVORITE_SYMBOL_SET_ID, _config__WEBPACK_IMPORTED_MODULE_2__.POPULAR_SYMBOL_SET_ID]);
const STICKER_SET_IDS_WITH_COVER = new Set([_config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID, _config__WEBPACK_IMPORTED_MODULE_2__.FAVORITE_SYMBOL_SET_ID, _config__WEBPACK_IMPORTED_MODULE_2__.POPULAR_SYMBOL_SET_ID]);
const CustomEmojiPicker = ({
  className,
  pickerListClassName,
  isHidden,
  loadAndPlay,
  addedCustomEmojiIds,
  customEmojisById,
  recentCustomEmojiIds,
  selectedReactionIds,
  recentStatusEmojis,
  stickerSetsById,
  chatEmojiSetId,
  topReactions,
  recentReactions,
  availableReactions,
  idPrefix = DEFAULT_ID_PREFIX,
  customEmojiFeaturedIds,
  canAnimate,
  isReactionPicker,
  isStatusPicker,
  isTranslucent,
  isSavedMessages,
  isCurrentUserPremium,
  withDefaultTopicIcons,
  defaultTopicIconsId,
  defaultStatusIconsId,
  defaultTagReactions,
  isWithPaidReaction,
  onCustomEmojiSelect,
  onReactionSelect,
  onReactionContext,
  onContextMenuOpen,
  onContextMenuClose,
  onContextMenuClick
}) => {
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const headerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const sharedCanvasRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const sharedCanvasHqRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const {
    handleScroll: handleContentScroll,
    isAtBeginning: shouldHideTopBorder
  } = (0,_hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_15__["default"])();
  const recentCustomEmojis = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return isStatusPicker ? recentStatusEmojis : Object.values((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_7__.pickTruthy)(customEmojisById, recentCustomEmojiIds));
  }, [customEmojisById, isStatusPicker, recentCustomEmojiIds, recentStatusEmojis]);
  const prefix = `${idPrefix}-custom-emoji`;
  const {
    activeSetIndex,
    observeIntersectionForSet,
    observeIntersectionForPlayingItems,
    observeIntersectionForShowingItems,
    observeIntersectionForCovers,
    selectStickerSet
  } = (0,_hooks_useStickerPickerObservers__WEBPACK_IMPORTED_MODULE_17__.useStickerPickerObservers)(containerRef, headerRef, prefix, isHidden);
  const canLoadAndPlay = (0,_hooks_usePrevDuringAnimation__WEBPACK_IMPORTED_MODULE_14__["default"])(loadAndPlay || undefined, _config__WEBPACK_IMPORTED_MODULE_2__.SLIDE_TRANSITION_DURATION);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__["default"])();
  const areAddedLoaded = Boolean(addedCustomEmojiIds);
  const allSets = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const defaultSets = [];
    if (isReactionPicker && isSavedMessages) {
      if (defaultTagReactions?.length) {
        defaultSets.push({
          id: _config__WEBPACK_IMPORTED_MODULE_2__.TOP_SYMBOL_SET_ID,
          accessHash: '',
          title: lang('PremiumPreviewTags'),
          reactions: defaultTagReactions,
          count: defaultTagReactions.length,
          isEmoji: true
        });
      }
    }
    if (isReactionPicker && !isSavedMessages) {
      const topReactionsSlice = topReactions?.slice(0, TOP_REACTIONS_COUNT) || [];
      if (isWithPaidReaction) {
        topReactionsSlice.unshift({
          type: 'paid'
        });
      }
      if (topReactionsSlice?.length) {
        defaultSets.push({
          id: _config__WEBPACK_IMPORTED_MODULE_2__.TOP_SYMBOL_SET_ID,
          accessHash: '',
          title: lang('Reactions'),
          reactions: topReactionsSlice,
          count: topReactionsSlice.length,
          isEmoji: true
        });
      }
      const cleanRecentReactions = (recentReactions || []).filter(reaction => !topReactionsSlice.some(topReaction => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(topReaction, reaction))).slice(0, RECENT_REACTIONS_COUNT);
      const cleanAvailableReactions = (availableReactions || []).filter(({
        isInactive
      }) => !isInactive).map(({
        reaction
      }) => reaction).filter(reaction => {
        return !topReactionsSlice.some(topReaction => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(topReaction, reaction)) && !cleanRecentReactions.some(topReaction => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(topReaction, reaction));
      });
      if (cleanAvailableReactions?.length || cleanRecentReactions?.length) {
        const isPopular = !cleanRecentReactions?.length;
        const allRecentReactions = cleanRecentReactions.concat(cleanAvailableReactions);
        defaultSets.push({
          id: isPopular ? _config__WEBPACK_IMPORTED_MODULE_2__.POPULAR_SYMBOL_SET_ID : _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID,
          accessHash: '',
          title: lang(isPopular ? 'PopularReactions' : 'RecentStickers'),
          reactions: allRecentReactions,
          count: allRecentReactions.length,
          isEmoji: true
        });
      }
    } else if (isStatusPicker) {
      const defaultStatusIconsPack = stickerSetsById[defaultStatusIconsId];
      if (defaultStatusIconsPack?.stickers?.length) {
        const stickers = defaultStatusIconsPack.stickers.slice(0, RECENT_DEFAULT_STATUS_COUNT).concat(recentCustomEmojis || []);
        defaultSets.push({
          ...defaultStatusIconsPack,
          stickers,
          count: stickers.length,
          id: _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID,
          title: lang('RecentStickers')
        });
      }
    } else if (withDefaultTopicIcons) {
      const defaultTopicIconsPack = stickerSetsById[defaultTopicIconsId];
      if (defaultTopicIconsPack.stickers?.length) {
        defaultSets.push({
          ...defaultTopicIconsPack,
          id: _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID,
          title: lang('RecentStickers')
        });
      }
    } else if (recentCustomEmojis?.length) {
      defaultSets.push({
        id: _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID,
        accessHash: '0',
        title: lang('RecentStickers'),
        stickers: recentCustomEmojis,
        count: recentCustomEmojis.length,
        isEmoji: true
      });
    }
    const userSetIds = [...(addedCustomEmojiIds || [])];
    if (chatEmojiSetId) {
      userSetIds.unshift(chatEmojiSetId);
    }
    const setIdsToDisplay = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_7__.unique)(userSetIds.concat(customEmojiFeaturedIds || []));
    const setsToDisplay = Object.values((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_7__.pickTruthy)(stickerSetsById, setIdsToDisplay));
    return [...defaultSets, ...setsToDisplay];
  }, [addedCustomEmojiIds, isReactionPicker, isStatusPicker, withDefaultTopicIcons, recentCustomEmojis, customEmojiFeaturedIds, stickerSetsById, topReactions, availableReactions, lang, recentReactions, defaultStatusIconsId, defaultTopicIconsId, isSavedMessages, defaultTagReactions, chatEmojiSetId, isWithPaidReaction]);
  const noPopulatedSets = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => areAddedLoaded && allSets.filter(set => set.stickers?.length).length === 0, [allSets, areAddedLoaded]);
  const canRenderContent = (0,_right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_16__["default"])([], _config__WEBPACK_IMPORTED_MODULE_2__.SLIDE_TRANSITION_DURATION);
  const shouldRenderContent = areAddedLoaded && canRenderContent && !noPopulatedSets;
  (0,_hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_11__["default"])(headerRef, isMobile || !shouldRenderContent);

  // Scroll container and header when active set changes
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!areAddedLoaded) {
      return;
    }
    const header = headerRef.current;
    if (!header) {
      return;
    }
    const newLeft = activeSetIndex * HEADER_BUTTON_WIDTH - (header.offsetWidth / 2 - HEADER_BUTTON_WIDTH / 2);
    (0,_util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_5__["default"])(header, newLeft);
  }, [areAddedLoaded, activeSetIndex]);
  const handleEmojiSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__["default"])(emoji => {
    onCustomEmojiSelect(emoji);
  });
  function renderCover(stickerSet, index) {
    const firstSticker = stickerSet.stickers?.[0];
    const buttonClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_middle_composer_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_24__["default"].stickerCover, index === activeSetIndex && _CustomEmojiPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].activated);
    const withSharedCanvas = index < _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_PICKER_MAX_SHARED_COVERS;
    const isHq = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsAlwaysHighPriorityEmoji)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), stickerSet);
    if (stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.TOP_SYMBOL_SET_ID) {
      return undefined;
    }
    if (STICKER_SET_IDS_WITH_COVER.has(stickerSet.id) || stickerSet.hasThumbnail || !firstSticker) {
      const isRecent = stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID || stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.POPULAR_SYMBOL_SET_ID;
      const isFaded = FADED_BUTTON_SET_IDS.has(stickerSet.id);
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_19__["default"], {
        key: stickerSet.id,
        className: buttonClassName,
        ariaLabel: stickerSet.title,
        round: true,
        faded: isFaded,
        color: "translucent"
        // eslint-disable-next-line react/jsx-no-bind
        ,
        onClick: () => selectStickerSet(isRecent ? 0 : index)
      }, isRecent ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_21__["default"], {
        name: "recent"
      }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_middle_composer_StickerSetCover__WEBPACK_IMPORTED_MODULE_18__["default"], {
        stickerSet: stickerSet,
        noPlay: !canAnimate || !canLoadAndPlay,
        forcePlayback: true,
        observeIntersection: observeIntersectionForCovers,
        sharedCanvasRef: withSharedCanvas ? isHq ? sharedCanvasHqRef : sharedCanvasRef : undefined
      }));
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerButton__WEBPACK_IMPORTED_MODULE_22__["default"], {
      key: stickerSet.id,
      sticker: firstSticker,
      size: _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_PICKER_HEADER,
      title: stickerSet.title,
      className: buttonClassName,
      noPlay: !canAnimate || !canLoadAndPlay,
      observeIntersection: observeIntersectionForCovers,
      noContextMenu: true,
      isCurrentUserPremium: true,
      sharedCanvasRef: withSharedCanvas ? isHq ? sharedCanvasHqRef : sharedCanvasRef : undefined,
      withTranslucentThumb: isTranslucent,
      onClick: selectStickerSet,
      clickArg: index,
      forcePlayback: true
    });
  }
  const fullClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])('StickerPicker', _CustomEmojiPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].root, className);
  if (!shouldRenderContent) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: fullClassName
    }, noPopulatedSets ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _middle_composer_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_24__["default"].pickerDisabled
    }, lang('NoStickers')) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_20__["default"], null));
  }
  const headerClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_middle_composer_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_24__["default"].header, 'no-scrollbar', !shouldHideTopBorder && _middle_composer_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_24__["default"].headerWithBorder);
  const listClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_middle_composer_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_24__["default"].main, _middle_composer_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_24__["default"].main_customEmoji, _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_8__.IS_TOUCH_ENV ? 'no-scrollbar' : 'custom-scroll', pickerListClassName, _middle_composer_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_24__["default"].hasHeader);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: fullClassName
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: headerRef,
    className: headerClassName
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "shared-canvas-container"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: sharedCanvasRef,
    className: "shared-canvas"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: sharedCanvasHqRef,
    className: "shared-canvas"
  }), allSets.map(renderCover))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    onScroll: handleContentScroll,
    className: listClassName
  }, allSets.map((stickerSet, i) => {
    const shouldHideHeader = stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.TOP_SYMBOL_SET_ID || stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID && (withDefaultTopicIcons || isStatusPicker);
    const isChatEmojiSet = stickerSet.id === chatEmojiSetId;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerSet__WEBPACK_IMPORTED_MODULE_23__["default"], {
      key: stickerSet.id,
      stickerSet: stickerSet,
      loadAndPlay: Boolean(canAnimate && canLoadAndPlay),
      index: i,
      idPrefix: prefix,
      observeIntersection: observeIntersectionForSet,
      observeIntersectionForPlayingItems: observeIntersectionForPlayingItems,
      observeIntersectionForShowingItems: observeIntersectionForShowingItems,
      isNearActive: activeSetIndex >= i - 1 && activeSetIndex <= i + 1,
      isSavedMessages: isSavedMessages,
      isStatusPicker: isStatusPicker,
      isReactionPicker: isReactionPicker,
      shouldHideHeader: shouldHideHeader,
      withDefaultTopicIcon: withDefaultTopicIcons && stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID,
      withDefaultStatusIcon: isStatusPicker && stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID,
      isChatEmojiSet: isChatEmojiSet,
      isCurrentUserPremium: isCurrentUserPremium,
      selectedReactionIds: selectedReactionIds,
      availableReactions: availableReactions,
      isTranslucent: isTranslucent,
      onReactionSelect: onReactionSelect,
      onReactionContext: onReactionContext,
      onStickerSelect: handleEmojiSelect,
      onContextMenuOpen: onContextMenuOpen,
      onContextMenuClose: onContextMenuClose,
      onContextMenuClick: onContextMenuClick,
      forcePlayback: true
    });
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId,
  isStatusPicker,
  isReactionPicker
}) => {
  const {
    stickers: {
      setsById: stickerSetsById
    },
    customEmojis: {
      byId: customEmojisById,
      featuredIds: customEmojiFeaturedIds,
      statusRecent: {
        emojis: recentStatusEmojis
      }
    },
    recentCustomEmojis: recentCustomEmojiIds,
    reactions: {
      availableReactions,
      recentReactions,
      topReactions,
      defaultTags
    }
  } = global;
  const isSavedMessages = Boolean(chatId && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsChatWithSelf)(global, chatId));
  const chatFullInfo = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId) : undefined;
  return {
    customEmojisById: !isStatusPicker ? customEmojisById : undefined,
    recentCustomEmojiIds: !isStatusPicker ? recentCustomEmojiIds : undefined,
    recentStatusEmojis: isStatusPicker ? recentStatusEmojis : undefined,
    stickerSetsById,
    addedCustomEmojiIds: global.customEmojis.added.setIds,
    canAnimate: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCanPlayAnimatedEmojis)(global),
    isSavedMessages,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsCurrentUserPremium)(global),
    customEmojiFeaturedIds,
    defaultTopicIconsId: global.defaultTopicIconsId,
    defaultStatusIconsId: global.defaultStatusIconsId,
    topReactions: isReactionPicker ? topReactions : undefined,
    recentReactions: isReactionPicker ? recentReactions : undefined,
    chatEmojiSetId: chatFullInfo?.emojiSet?.id,
    isWithPaidReaction: isReactionPicker && chatFullInfo?.isPaidReactionAvailable,
    availableReactions: isReactionPicker ? availableReactions : undefined,
    defaultTagReactions: isReactionPicker ? defaultTags : undefined
  };
})(CustomEmojiPicker)));

/***/ }),

/***/ "./src/components/common/CustomEmojiSetsModal.tsx":
/*!********************************************************!*\
  !*** ./src/components/common/CustomEmojiSetsModal.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _StickerSetCard__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./StickerSetCard */ "./src/components/common/StickerSetCard.tsx");
/* harmony import */ var _CustomEmojiSetsModal_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./CustomEmojiSetsModal.module.scss */ "./src/components/common/CustomEmojiSetsModal.module.scss");











const CustomEmojiSetsModal = ({
  customEmojiSetIds,
  canPlayAnimatedEmojis,
  onClose
}) => {
  const {
    openStickerSet
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const customEmojiSets = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return customEmojiSetIds?.map(id => (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().stickers.setsById[id]);
  }, [customEmojiSetIds]);

  // eslint-disable-next-line no-null/no-null
  const customEmojiModalRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    observe: observeIntersectionForCovers
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_4__.useIntersectionObserver)({
    rootRef: customEmojiModalRef,
    isDisabled: !customEmojiSets
  });
  const prevCustomEmojiSets = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_7__["default"])(customEmojiSets);
  const renderingCustomEmojiSets = customEmojiSets || prevCustomEmojiSets;
  const handleSetClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(sticker => {
    openStickerSet({
      stickerSetInfo: sticker.stickerSetInfo
    });
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_8__["default"], {
    isOpen: Boolean(customEmojiSets),
    className: _CustomEmojiSetsModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].root,
    onClose: onClose,
    hasCloseButton: true,
    title: lang('lng_custom_emoji_used_sets')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_CustomEmojiSetsModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].sets, 'custom-scroll'),
    ref: customEmojiModalRef,
    teactFastList: true
  }, renderingCustomEmojiSets?.map(customEmojiSet => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerSetCard__WEBPACK_IMPORTED_MODULE_9__["default"], {
      key: customEmojiSet.id,
      className: _CustomEmojiSetsModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].setCard,
      stickerSet: customEmojiSet,
      onClick: handleSetClick,
      observeIntersection: observeIntersectionForCovers,
      noPlay: !canPlayAnimatedEmojis
    });
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    canPlayAnimatedEmojis: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCanPlayAnimatedEmojis)(global)
  };
})(CustomEmojiSetsModal)));

/***/ }),

/***/ "./src/components/common/DeleteMessageModal.tsx":
/*!******************************************************!*\
  !*** ./src/components/common/DeleteMessageModal.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _right_hooks_useManagePermissions__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../right/hooks/useManagePermissions */ "./src/components/right/hooks/useManagePermissions.ts");
/* harmony import */ var _main_PermissionCheckboxList__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../main/PermissionCheckboxList */ "./src/components/main/PermissionCheckboxList.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/CheckboxGroup */ "./src/components/ui/CheckboxGroup.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _Avatar__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./DeleteMessageModal.module.scss */ "./src/components/common/DeleteMessageModal.module.scss");



















const DeleteMessageModal = ({
  isOpen,
  chat,
  isGroup,
  isSuperGroup,
  sender,
  currentUserId,
  messageIdList,
  isSchedule,
  message,
  album,
  canDeleteForAll,
  contactName,
  willDeleteForCurrentUserOnly,
  willDeleteForAll,
  onConfirm,
  adminMembersById,
  chatBot,
  isOwn,
  canBanUsers
}) => {
  const {
    deleteMessages,
    deleteScheduledMessages,
    reportChannelSpam,
    deleteChatMember,
    updateChatMemberBannedRights,
    closeDeleteMessageModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const prevIsOpen = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_9__["default"])(isOpen);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const {
    permissions,
    havePermissionChanged,
    handlePermissionChange,
    resetPermissions
  } = (0,_right_hooks_useManagePermissions__WEBPACK_IMPORTED_MODULE_10__["default"])(chat?.defaultBannedRights);
  const [chosenDeleteOption, setChosenDeleteOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [chosenBanOption, setChosenBanOptions] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [chosenSpanOption, setChosenSpanOptions] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [isMediaDropdownOpen, setIsMediaDropdownOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isAdditionalOptionsVisible, setIsAdditionalOptionsVisible] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const isSenderOwner = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return sender && adminMembersById && adminMembersById[sender.id] && adminMembersById[sender.id].isOwner;
  }, [sender, adminMembersById]);
  const user = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    if (!sender || isSchedule) return undefined;
    return usersById[sender.id];
  }, [isSchedule, sender]);
  const shouldShowAdditionalOptions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return user && user.id !== currentUserId;
  }, [user, currentUserId]);
  const shouldShowOptions = shouldShowAdditionalOptions && !canDeleteForAll && !isSchedule && (isGroup || isSuperGroup);
  const userName = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    if (!sender || isSchedule) return '';
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(usersById[sender.id]);
  }, [isSchedule, sender]);
  const ACTION_SPAM_OPTION = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!user) {
      return [];
    }
    return [{
      value: user.id,
      label: lang('ReportSpamTitle')
    }];
  }, [lang, user]);
  const ACTION_DELETE_OPTION = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!user) {
      return [];
    }
    return [{
      value: user.id,
      label: lang('DeleteAllFrom', userName)
    }];
  }, [lang, user, userName]);
  const ACTION_BAN_OPTION = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!user) {
      return [];
    }
    return [{
      value: user.id,
      label: message && isAdditionalOptionsVisible ? lang('KickFromSupergroup') : lang('DeleteBan', userName)
    }];
  }, [isAdditionalOptionsVisible, lang, message, user, userName]);
  const toggleAdditionalOptions = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    setIsAdditionalOptionsVisible(!isAdditionalOptionsVisible);
  });
  const filterMessageIdByUserId = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])((userIds, selectedMessageIdList) => {
    if (!chat) return _util_memo__WEBPACK_IMPORTED_MODULE_5__.MEMO_EMPTY_ARRAY;
    return selectedMessageIdList.filter(msgId => {
      const senderPeer = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSenderFromMessage)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), chat.id, msgId);
      return senderPeer && userIds.includes(senderPeer.id);
    });
  });
  const handleDeleteMessages = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(filteredMessageIdList => {
    if (filteredMessageIdList?.length) {
      deleteMessages({
        messageIds: filteredMessageIdList,
        shouldDeleteForAll: true
      });
    }
  });
  const handleDeleteMember = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(filteredUserIdList => {
    filteredUserIdList.forEach(userId => {
      deleteChatMember({
        chatId: chat.id,
        userId
      });
    });
  });
  const handleUpdateChatMemberBannedRights = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(filteredUserIdList => {
    filteredUserIdList.forEach(userId => {
      updateChatMemberBannedRights({
        chatId: chat.id,
        userId,
        bannedRights: permissions
      });
    });
  });
  const handleDeleteMessageForAll = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    onConfirm?.();
    const messageIds = album?.messages ? album.messages.map(({
      id
    }) => id) : [message.id];
    deleteMessages({
      messageIds,
      shouldDeleteForAll: true
    });
    closeDeleteMessageModal();
  });
  const handleDeleteMessageForSelf = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!chat) return;
    onConfirm?.();
    const messageIds = album?.messages ? album.messages.map(({
      id
    }) => id) : [message.id];
    if (isSchedule) {
      deleteScheduledMessages({
        messageIds
      });
    } else if (!isOwn && (chosenSpanOption || chosenDeleteOption || chosenBanOption) && (isGroup || isSuperGroup)) {
      if (chosenSpanOption && sender) {
        const filteredMessageIdList = filterMessageIdByUserId(chosenSpanOption, messageIdList);
        if (filteredMessageIdList && filteredMessageIdList.length) {
          reportChannelSpam({
            participantId: sender.id,
            chatId: chat.id,
            messageIds: filteredMessageIdList
          });
        }
      }
      if (chosenDeleteOption) {
        const filteredMessageIdList = filterMessageIdByUserId(chosenDeleteOption, messageIdList);
        handleDeleteMessages(filteredMessageIdList);
      }
      if (chosenBanOption && !havePermissionChanged && message) {
        const filteredUserIdList = chosenBanOption.filter(userId => messageIds?.some(msgId => {
          const senderPeer = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSenderFromMessage)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), chat.id, msgId);
          return senderPeer && senderPeer.id === userId;
        }));
        handleDeleteMember(filteredUserIdList);
        deleteMessages({
          messageIds: [message.id],
          shouldDeleteForAll: false
        });
      }
      if (chosenBanOption && havePermissionChanged) {
        const filteredUserIdList = chosenBanOption.filter(userId => messageIds?.some(msgId => {
          const senderPeer = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSenderFromMessage)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), chat.id, msgId);
          return senderPeer && senderPeer.id === userId;
        }));
        handleUpdateChatMemberBannedRights(filteredUserIdList);
      }
    } else {
      deleteMessages({
        messageIds,
        shouldDeleteForAll: false
      });
    }
    closeDeleteMessageModal();
  });
  const handleDeleteOptionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(options => {
    setChosenDeleteOption(options);
  });
  const handleBanOptionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(options => {
    setChosenBanOptions(options);
  });
  const handleSpanOptionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(options => {
    setChosenSpanOptions(options);
  });
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    closeDeleteMessageModal();
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen && prevIsOpen) {
      setChosenSpanOptions(undefined);
      setChosenDeleteOption(undefined);
      setChosenBanOptions(undefined);
      setIsMediaDropdownOpen(false);
      setIsAdditionalOptionsVisible(false);
      resetPermissions();
    }
  }, [isOpen, prevIsOpen, resetPermissions]);
  function renderHeader() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: shouldShowOptions && _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].container,
      dir: lang.isRtl ? 'rtl' : undefined
    }, shouldShowOptions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Avatar__WEBPACK_IMPORTED_MODULE_16__["default"], {
      size: "small",
      peer: user
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: shouldShowOptions ? _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].title : _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].singleTitle
    }, lang('DeleteSingleMessagesTitle')));
  }
  function renderAdditionalActionOptions() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].options
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_13__["default"], {
      options: ACTION_SPAM_OPTION,
      onChange: handleSpanOptionChange,
      selected: chosenSpanOption
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_13__["default"], {
      options: ACTION_DELETE_OPTION,
      onChange: handleDeleteOptionChange,
      selected: chosenDeleteOption
    }), !isSenderOwner && canBanUsers && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_13__["default"], {
      options: ACTION_BAN_OPTION,
      onChange: handleBanOptionChange,
      selected: chosenBanOption
    }));
  }
  function renderPartiallyRestrictedUser() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].restrictionContainer, isAdditionalOptionsVisible && _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].restrictionContainerOpen)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].actionTitle, _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].restrictionTitle)
    }, lang('UserRestrictionsCanDoUsers', 1)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_main_PermissionCheckboxList__WEBPACK_IMPORTED_MODULE_11__["default"], {
      withCheckbox: true,
      permissionGroup: true,
      chatId: chat?.id,
      isMediaDropdownOpen: isMediaDropdownOpen,
      setIsMediaDropdownOpen: setIsMediaDropdownOpen,
      handlePermissionChange: handlePermissionChange,
      permissions: permissions,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].dropdownList, isMediaDropdownOpen && _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].dropdownListOpen)
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_15__["default"], {
    isOpen: isOpen,
    onClose: handleClose,
    onEnter: canDeleteForAll ? undefined : handleDeleteMessageForSelf,
    className: "delete"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].mainContainer, 'custom-scroll')
  }, renderHeader(), shouldShowOptions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].actionTitle
  }, lang('DeleteAdditionalActions')), renderAdditionalActionOptions(), renderPartiallyRestrictedUser(), chosenBanOption && canBanUsers && chosenBanOption?.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    narrow: true,
    className: _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].listItemButton,
    buttonClassName: _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].button,
    onClick: toggleAdditionalOptions
  }, lang(isAdditionalOptionsVisible ? 'DeleteToggleBanUsers' : 'DeleteToggleRestrictUsers'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_17__["default"], {
    name: isAdditionalOptionsVisible ? 'up' : 'down',
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].button, 'ml-2')
  })) : setIsAdditionalOptionsVisible(false)), (chatBot || !shouldShowAdditionalOptions) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, lang('AreYouSureDeleteSingleMessage')), willDeleteForCurrentUserOnly && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, lang('lng_delete_for_me_chat_hint', 1, 'i')), willDeleteForAll && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, lang('lng_delete_for_everyone_hint', 1, 'i'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: canDeleteForAll ? 'dialog-buttons-column' : (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('dialog-buttons', isAdditionalOptionsVisible && _DeleteMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].dialogButtons)
  }, canDeleteForAll && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    color: "danger",
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleDeleteMessageForAll
  }, contactName && (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang('Conversation.DeleteMessagesFor', contactName)), !contactName && lang('Conversation.DeleteMessagesForEveryone')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    color: "danger",
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleDeleteMessageForSelf
  }, lang(canDeleteForAll ? 'ChatList.DeleteForCurrentUser' : 'Delete')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleClose
  }, lang('Cancel')))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    deleteMessageModal
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global);
  const chatId = deleteMessageModal && deleteMessageModal.message?.chatId;
  const chat = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId) : undefined;
  const chatFullInfo = chat && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chat.id);
  const {
    threadId,
    type
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentMessageList)(global) || {};
  const {
    canDeleteForAll
  } = deleteMessageModal && deleteMessageModal.message && threadId && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectAllowedMessageActionsSlow)(global, deleteMessageModal.message, threadId) || {};
  const adminMembersById = chatFullInfo && chatFullInfo?.adminMembersById;
  const messageIdList = chat && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentMessageIds)(global, chat.id, threadId, type);
  const isGroup = Boolean(chat) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatBasicGroup)(chat);
  const isSuperGroup = Boolean(chat) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatSuperGroup)(chat);
  const sender = deleteMessageModal?.message && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSender)(global, deleteMessageModal.message);
  const contactName = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(chat.id) ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFirstOrLastName)((0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getPrivateChatUserId)(chat))) : undefined;
  const isChatWithBot = Boolean(deleteMessageModal && deleteMessageModal.message && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectBot)(global, deleteMessageModal.message.chatId));
  const chatBot = Boolean(chat && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isSystemBot)(chat.id) && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectBot)(global, chat.id));
  const canBanUsers = chat && (chat.isCreator || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getHasAdminRight)(chat, 'banUsers'));
  const isOwn = deleteMessageModal && deleteMessageModal.message && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isOwnMessage)(deleteMessageModal.message);
  const willDeleteForCurrentUserOnly = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatBasicGroup)(chat) && !canDeleteForAll || isChatWithBot;
  const willDeleteForAll = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatSuperGroup)(chat);
  return {
    chat,
    isGroup,
    isSuperGroup,
    currentUserId: global.currentUserId,
    sender,
    messageIdList,
    canDeleteForAll: deleteMessageModal && !deleteMessageModal.isSchedule && canDeleteForAll,
    contactName,
    willDeleteForCurrentUserOnly,
    willDeleteForAll,
    adminMembersById,
    chatBot,
    isSchedule: deleteMessageModal && deleteMessageModal.isSchedule,
    message: deleteMessageModal && deleteMessageModal.message,
    album: deleteMessageModal && deleteMessageModal.album,
    onConfirm: deleteMessageModal && deleteMessageModal.onConfirm,
    isOwn,
    canBanUsers
  };
})(DeleteMessageModal)));

/***/ }),

/***/ "./src/components/common/DeleteProfilePhotoModal.tsx":
/*!***********************************************************!*\
  !*** ./src/components/common/DeleteProfilePhotoModal.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");






const DeleteProfilePhotoModal = ({
  isOpen,
  photo,
  profileId,
  onClose,
  onConfirm
}) => {
  const {
    deleteProfilePhoto,
    deleteChatPhoto
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const handleDeletePhoto = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onConfirm?.();
    if ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(profileId)) {
      deleteProfilePhoto({
        photo
      });
    } else {
      deleteChatPhoto({
        photo,
        chatId: profileId
      });
    }
    onClose();
  }, [onConfirm, profileId, onClose, deleteProfilePhoto, photo, deleteChatPhoto]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_5__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    onEnter: handleDeletePhoto,
    className: "delete dialog-buttons-column",
    title: lang('AreYouSure')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons mt-2"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_4__["default"], {
    color: "danger",
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleDeletePhoto
  }, lang('Preview.DeletePhoto')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_4__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onClose
  }, lang('Cancel'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(DeleteProfilePhotoModal));

/***/ }),

/***/ "./src/components/common/GifButton.tsx":
/*!*********************************************!*\
  !*** ./src/components/common/GifButton.tsx ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _middle_helpers_preventMessageInputBlur__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../middle/helpers/preventMessageInputBlur */ "./src/components/middle/helpers/preventMessageInputBlur.ts");
/* harmony import */ var _hooks_useBuffering__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useBuffering */ "./src/hooks/useBuffering.ts");
/* harmony import */ var _hooks_useCanvasBlur__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useCanvasBlur */ "./src/hooks/useCanvasBlur.ts");
/* harmony import */ var _hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useContextMenuHandlers */ "./src/hooks/useContextMenuHandlers.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_OptimizedVideo__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/OptimizedVideo */ "./src/components/ui/OptimizedVideo.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _GifButton_scss__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./GifButton.scss */ "./src/components/common/GifButton.scss");
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }



















const GifButton = ({
  gif,
  isDisabled,
  className,
  observeIntersection,
  onClick,
  onUnsaveClick,
  isSavedMessages
}) => {
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const isIntersecting = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_8__.useIsIntersecting)(ref, observeIntersection);
  const loadAndPlay = isIntersecting && !isDisabled;
  const previewHash = !gif.hasVideoPreview && gif.thumbnail && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getVideoMediaHash)(gif, 'pictogram');
  const previewBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_10__["default"])(previewHash, !loadAndPlay);
  const [withThumb] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(gif.thumbnail?.dataUri && !previewBlobUrl);
  const thumbRef = (0,_hooks_useCanvasBlur__WEBPACK_IMPORTED_MODULE_6__["default"])(gif.thumbnail?.dataUri, !withThumb);
  const videoHash = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getVideoPreviewMediaHash)(gif) || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getVideoMediaHash)(gif, 'full');
  const videoData = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_10__["default"])(videoHash, !loadAndPlay);
  const shouldRenderVideo = Boolean(loadAndPlay && videoData);
  const {
    isBuffered,
    bufferingHandlers
  } = (0,_hooks_useBuffering__WEBPACK_IMPORTED_MODULE_5__["default"])(true);
  const shouldRenderSpinner = loadAndPlay && !isBuffered;
  const isVideoReady = loadAndPlay && isBuffered;
  const {
    isContextMenuOpen,
    contextMenuAnchor,
    handleBeforeContextMenu,
    handleContextMenu,
    handleContextMenuClose,
    handleContextMenuHide
  } = (0,_hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_7__["default"])(ref);
  const getTriggerElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => ref.current);
  const getRootElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => ref.current.closest('.custom-scroll, .no-scrollbar'));
  const getMenuElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => ref.current.querySelector('.gif-context-menu .bubble'));
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    if (isContextMenuOpen || !onClick) return;
    onClick({
      ...gif,
      blobUrl: videoData
    });
  });
  const handleUnsaveClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(e => {
    e.stopPropagation();
    e.preventDefault();
    onUnsaveClick(gif);
  });
  const handleContextDelete = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onUnsaveClick?.(gif);
  });
  const handleSendQuiet = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onClick({
      ...gif,
      blobUrl: videoData
    }, true);
  });
  const handleSendScheduled = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onClick({
      ...gif,
      blobUrl: videoData
    }, undefined, true);
  });
  const handleMouseDown = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(e => {
    (0,_middle_helpers_preventMessageInputBlur__WEBPACK_IMPORTED_MODULE_4__.preventMessageInputBlurWithBubbling)(e);
    handleBeforeContextMenu(e);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isDisabled) handleContextMenuClose();
  }, [handleContextMenuClose, isDisabled]);
  const fullClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('GifButton', gif.width && gif.height && gif.width < gif.height ? 'vertical' : 'horizontal', onClick && 'interactive', className);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: ref,
    className: fullClassName,
    onMouseDown: handleMouseDown,
    onClick: handleClick,
    onContextMenu: handleContextMenu
  }, !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__.IS_TOUCH_ENV && onUnsaveClick && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: "gif-unsave-button",
    color: "dark",
    pill: true,
    noFastClick: true,
    onClick: handleUnsaveClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_17__["default"], {
    name: "close",
    className: "gif-unsave-button-icon"
  })), withThumb && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: thumbRef,
    className: "thumbnail"
  }), previewBlobUrl && !isVideoReady && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: previewBlobUrl,
    alt: "",
    className: "preview",
    draggable: false
  }), shouldRenderVideo && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_OptimizedVideo__WEBPACK_IMPORTED_MODULE_15__["default"], _extends({
    canPlay: true,
    src: videoData,
    autoPlay: true,
    loop: true,
    muted: true,
    disablePictureInPicture: true,
    playsInline: true,
    preload: "none"
    // eslint-disable-next-line react/jsx-props-no-spreading
  }, bufferingHandlers)), shouldRenderSpinner && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_16__["default"], {
    color: previewBlobUrl || withThumb ? 'white' : 'black'
  }), onClick && contextMenuAnchor !== undefined && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isContextMenuOpen,
    anchor: contextMenuAnchor,
    getTriggerElement: getTriggerElement,
    getRootElement: getRootElement,
    getMenuElement: getMenuElement,
    className: "gif-context-menu",
    autoClose: true,
    onClose: handleContextMenuClose,
    onCloseAnimationEnd: handleContextMenuHide
  }, !isSavedMessages && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    onClick: handleSendQuiet,
    icon: "mute"
  }, lang('SendWithoutSound')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    onClick: handleSendScheduled,
    icon: "calendar"
  }, lang(isSavedMessages ? 'SetReminder' : 'ScheduleMessage')), onUnsaveClick && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    destructive: true,
    icon: "delete",
    onClick: handleContextDelete
  }, lang('Delete'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(GifButton));

/***/ }),

/***/ "./src/components/common/ManageUsernames.tsx":
/*!***************************************************!*\
  !*** ./src/components/common/ManageUsernames.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_clipboard__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/clipboard */ "./src/util/clipboard.ts");
/* harmony import */ var _util_math__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/math */ "./src/util/math.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_Draggable__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Draggable */ "./src/components/ui/Draggable.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ManageUsernames_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./ManageUsernames.module.scss */ "./src/components/common/ManageUsernames.module.scss");











const USERNAME_HEIGHT_PX = 60;
const ManageUsernames = ({
  chatId,
  usernames,
  onEditUsername
}) => {
  const {
    showNotification,
    toggleUsername,
    toggleChatUsername,
    sortUsernames,
    sortChatUsernames
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const [usernameForConfirm, setUsernameForConfirm] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const usernameList = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => usernames.map(({
    username
  }) => username), [usernames]);
  const prevUsernameList = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__["default"])(usernameList);
  const [state, setState] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)({
    orderedUsernames: usernameList,
    dragOrderUsernames: usernameList,
    draggedIndex: undefined
  });

  // Sync folders state after changing folders in other clients
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (prevUsernameList !== usernameList) {
      setState({
        orderedUsernames: usernameList,
        dragOrderUsernames: usernameList,
        draggedIndex: undefined
      });
    }
  }, [prevUsernameList, usernameList]);
  const handleCopyUsername = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    (0,_util_clipboard__WEBPACK_IMPORTED_MODULE_3__.copyTextToClipboard)(`@${value}`);
    showNotification({
      message: lang('UsernameCopied')
    });
  }, [lang, showNotification]);
  const handleUsernameClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(data => {
    if (data.isEditable) {
      onEditUsername(data.username);
    } else {
      setUsernameForConfirm(data);
    }
  }, [onEditUsername]);
  const closeConfirmUsernameDialog = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setUsernameForConfirm(undefined);
  }, []);
  const handleUsernameToggle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!usernameForConfirm) {
      return;
    }
    if (chatId) {
      toggleChatUsername({
        chatId,
        username: usernameForConfirm.username,
        isActive: !usernameForConfirm.isActive
      });
    } else {
      toggleUsername({
        username: usernameForConfirm.username,
        isActive: !usernameForConfirm.isActive
      });
    }
    closeConfirmUsernameDialog();
  }, [chatId, closeConfirmUsernameDialog, toggleChatUsername, toggleUsername, usernameForConfirm]);
  const handleDrag = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((translation, id) => {
    const delta = Math.round(translation.y / USERNAME_HEIGHT_PX);
    const index = state.orderedUsernames?.indexOf(id) || 0;
    const dragOrderUsernames = state.orderedUsernames?.filter(username => username !== id);
    if (!dragOrderUsernames || !(0,_util_math__WEBPACK_IMPORTED_MODULE_4__.isBetween)(index + delta, 0, usernameList.length)) {
      return;
    }
    dragOrderUsernames.splice(index + delta, 0, id);
    setState(current => ({
      ...current,
      draggedIndex: index,
      dragOrderUsernames
    }));
  }, [state.orderedUsernames, usernameList.length]);
  const handleDragEnd = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setState(current => {
      if (chatId) {
        sortChatUsernames({
          chatId,
          usernames: current.dragOrderUsernames
        });
      } else {
        sortUsernames({
          usernames: current.dragOrderUsernames
        });
      }
      return {
        ...current,
        orderedUsernames: current.dragOrderUsernames,
        draggedIndex: undefined
      };
    });
  }, [chatId, sortChatUsernames, sortUsernames]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ManageUsernames_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].container
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: _ManageUsernames_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].header,
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('lng_usernames_subtitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ManageUsernames_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].sortableContainer,
    style: `height: ${usernames.length * USERNAME_HEIGHT_PX}px`
  }, usernames.map((usernameData, i) => {
    const isDragged = state.draggedIndex === i;
    const draggedTop = (state.orderedUsernames?.indexOf(usernameData.username) ?? 0) * USERNAME_HEIGHT_PX;
    const top = (state.dragOrderUsernames?.indexOf(usernameData.username) ?? 0) * USERNAME_HEIGHT_PX;
    const subtitle = usernameData.isEditable ? 'lng_usernames_edit' : usernameData.isActive ? 'lng_usernames_active' : 'lng_usernames_non_active';
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Draggable__WEBPACK_IMPORTED_MODULE_8__["default"], {
      key: usernameData.username,
      id: usernameData.username,
      onDrag: handleDrag,
      onDragEnd: handleDragEnd,
      style: `top: ${isDragged ? draggedTop : top}px;`,
      knobStyle: `${lang.isRtl ? 'left' : 'right'}: 3rem;`,
      isDisabled: !usernameData.isActive
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
      key: usernameData.username,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('drag-item mb-2 no-icon', _ManageUsernames_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].item),
      narrow: true,
      secondaryIcon: "more",
      icon: usernameData.isActive ? 'link' : 'link-broken',
      multiline: true,
      contextActions: [{
        handler: () => {
          handleCopyUsername(usernameData.username);
        },
        title: lang('Copy'),
        icon: 'copy'
      }]
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => {
        handleUsernameClick(usernameData);
      }
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "title"
    }, "@", usernameData.username), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "subtitle"
    }, lang(subtitle))));
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _ManageUsernames_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].description,
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('lng_usernames_description'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_7__["default"], {
    isOpen: Boolean(usernameForConfirm),
    onClose: closeConfirmUsernameDialog,
    title: lang(usernameForConfirm?.isActive ? 'Username.DeactivateAlertTitle' : 'Username.ActivateAlertTitle'),
    text: lang(usernameForConfirm?.isActive ? 'Username.DeactivateAlertText' : 'Username.ActivateAlertText'),
    confirmLabel: lang(usernameForConfirm?.isActive ? 'Username.DeactivateAlertHide' : 'Username.ActivateAlertShow'),
    confirmHandler: handleUsernameToggle,
    confirmIsDestructive: !usernameForConfirm?.isActive
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ManageUsernames));

/***/ }),

/***/ "./src/components/common/PasswordMonkey.tsx":
/*!**************************************************!*\
  !*** ./src/components/common/PasswordMonkey.tsx ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_schedulers_useTimeout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/schedulers/useTimeout */ "./src/hooks/schedulers/useTimeout.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _AnimatedSticker__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./AnimatedSticker */ "./src/components/common/AnimatedSticker.tsx");
/* harmony import */ var _PasswordMonkey_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./PasswordMonkey.scss */ "./src/components/common/PasswordMonkey.scss");








const PEEK_MONKEY_SHOW_DELAY = 2000;
const SEGMENT_COVER_EYES = [0, 50];
const SEGMENT_UNCOVER_EYE = [0, 20];
const SEGMENT_COVER_EYE = [20, 0];
const PasswordMonkey = ({
  isPasswordVisible,
  isBig
}) => {
  const [isFirstMonkeyLoaded, markFirstMonkeyLoaded] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])(false);
  const [isPeekShown, markPeekShown] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])(false);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const stikerSize = isMobile ? _config__WEBPACK_IMPORTED_MODULE_1__.STICKER_SIZE_AUTH_MOBILE : _config__WEBPACK_IMPORTED_MODULE_1__.STICKER_SIZE_AUTH;
  (0,_hooks_schedulers_useTimeout__WEBPACK_IMPORTED_MODULE_3__["default"])(markPeekShown, PEEK_MONKEY_SHOW_DELAY);
  const handleFirstMonkeyLoad = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(markFirstMonkeyLoaded, [markFirstMonkeyLoaded]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    id: "monkey",
    className: isBig ? 'big' : ''
  }, !isFirstMonkeyLoaded && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "monkey-preview"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_AnimatedSticker__WEBPACK_IMPORTED_MODULE_6__["default"], {
    size: isBig ? _config__WEBPACK_IMPORTED_MODULE_1__.STICKER_SIZE_TWO_FA : stikerSize,
    className: isPeekShown ? 'hidden' : 'shown',
    tgsUrl: _helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__.LOCAL_TGS_URLS.MonkeyClose,
    playSegment: SEGMENT_COVER_EYES,
    noLoop: true,
    onLoad: handleFirstMonkeyLoad
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_AnimatedSticker__WEBPACK_IMPORTED_MODULE_6__["default"], {
    size: isBig ? _config__WEBPACK_IMPORTED_MODULE_1__.STICKER_SIZE_TWO_FA : stikerSize,
    className: isPeekShown ? 'shown' : 'hidden',
    tgsUrl: _helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__.LOCAL_TGS_URLS.MonkeyPeek,
    playSegment: isPasswordVisible ? SEGMENT_UNCOVER_EYE : SEGMENT_COVER_EYE,
    noLoop: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PasswordMonkey));

/***/ }),

/***/ "./src/components/common/PinMessageModal.async.tsx":
/*!*********************************************************!*\
  !*** ./src/components/common/PinMessageModal.async.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_moduleLoader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/moduleLoader */ "./src/util/moduleLoader.ts");
/* harmony import */ var _hooks_useModuleLoader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useModuleLoader */ "./src/hooks/useModuleLoader.ts");



const PinMessageModalAsync = props => {
  const {
    isOpen
  } = props;
  const PinMessageModal = (0,_hooks_useModuleLoader__WEBPACK_IMPORTED_MODULE_2__["default"])(_util_moduleLoader__WEBPACK_IMPORTED_MODULE_1__.Bundles.Extra, 'PinMessageModal', !isOpen);

  // eslint-disable-next-line react/jsx-props-no-spreading
  return PinMessageModal ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(PinMessageModal, props) : undefined;
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (PinMessageModalAsync);

/***/ }),

/***/ "./src/components/common/PinMessageModal.tsx":
/*!***************************************************!*\
  !*** ./src/components/common/PinMessageModal.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _helpers_renderText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");








const PinMessageModal = ({
  isOpen,
  chatId,
  messageId,
  isChannel,
  isGroup,
  isSuperGroup,
  canPinForAll,
  contactName,
  onClose
}) => {
  const {
    pinMessage
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const handlePinMessageForAll = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    pinMessage({
      chatId,
      messageId,
      isUnpin: false
    });
    onClose();
  }, [chatId, messageId, onClose]);
  const handlePinMessage = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    pinMessage({
      chatId,
      messageId,
      isUnpin: false,
      isOneSide: true,
      isSilent: true
    });
    onClose();
  }, [chatId, messageId, onClose]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  function renderMessage() {
    if (isChannel) {
      return lang('PinMessageAlertChannel');
    }
    if (isGroup || isSuperGroup) {
      return lang('PinMessageAlert');
    }
    return lang('PinMessageAlertChat');
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_7__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    className: "pin",
    title: lang('PinMessageAlertTitle')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, renderMessage()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons-column"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: handlePinMessage
  }, lang('DialogPin')), canPinForAll && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: handlePinMessageForAll
  }, contactName ? (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(lang('Conversation.PinMessagesFor', contactName)) : lang('Conversation.PinMessageAlert.PinAndNotifyMembers')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onClose
  }, lang('Cancel'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const isPrivateChat = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(chatId);
  const isChatWithSelf = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsChatWithSelf)(global, chatId);
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId);
  const isChannel = Boolean(chat) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatChannel)(chat);
  const isGroup = Boolean(chat) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatBasicGroup)(chat);
  const isSuperGroup = Boolean(chat) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatSuperGroup)(chat);
  const canPinForAll = isPrivateChat && !isChatWithSelf || isSuperGroup || isGroup;
  const contactName = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(chat.id) ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFirstOrLastName)((0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getPrivateChatUserId)(chat))) : undefined;
  return {
    isPrivateChat,
    isChatWithSelf,
    isChannel,
    isGroup,
    isSuperGroup,
    canPinForAll,
    contactName
  };
})(PinMessageModal)));

/***/ }),

/***/ "./src/components/common/PrivacySettingsNoticeModal.tsx":
/*!**************************************************************!*\
  !*** ./src/components/common/PrivacySettingsNoticeModal.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Separator__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/Separator */ "./src/components/ui/Separator.tsx");
/* harmony import */ var _AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./AnimatedIconWithPreview */ "./src/components/common/AnimatedIconWithPreview.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./PrivacySettingsNoticeModal.module.scss */ "./src/components/common/PrivacySettingsNoticeModal.module.scss");















const CLOSE_ANIMATION_DURATION = _ui_Modal__WEBPACK_IMPORTED_MODULE_10__.ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_END_DELAY;
const PrivacySettingsNoticeModal = ({
  isOpen,
  isReadDate,
  user
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const {
    updateGlobalPrivacySettings,
    openPremiumModal,
    closePrivacySettingsNoticeModal,
    showNotification,
    setPrivacyVisibility,
    loadUser
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const userName = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFirstOrLastName)(user);
  const handleShowReadTime = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    updateGlobalPrivacySettings({
      shouldHideReadMarks: false
    });
    closePrivacySettingsNoticeModal();
    setTimeout(() => {
      showNotification({
        message: lang('PremiumReadSet')
      });
    }, CLOSE_ANIMATION_DURATION);
  });
  const handleShowLastSeen = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    setPrivacyVisibility({
      privacyKey: 'lastSeen',
      visibility: 'everybody',
      onSuccess: () => loadUser({
        userId: user.id
      })
    });
    closePrivacySettingsNoticeModal();
    setTimeout(() => {
      showNotification({
        message: lang('PremiumLastSeenSet')
      });
    }, CLOSE_ANIMATION_DURATION);
  });
  const handleOpenPremium = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    closePrivacySettingsNoticeModal();
    setTimeout(() => {
      openPremiumModal({
        initialSection: 'last_seen'
      });
    }, CLOSE_ANIMATION_DURATION);
  });
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    closePrivacySettingsNoticeModal();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isSlim: true,
    isOpen: isOpen,
    onClose: handleClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].container,
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].closeButton,
    color: "translucent",
    round: true,
    size: "smaller",
    onClick: handleClose,
    ariaLabel: "Close"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_13__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_12__["default"], {
    tgsUrl: isReadDate ? _helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_5__.LOCAL_TGS_URLS.ReadTime : _helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_5__.LOCAL_TGS_URLS.LastSeen,
    size: 84,
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].icon,
    nonInteractive: true,
    noLoop: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].header
  }, lang(isReadDate ? 'PremiumReadHeader1' : 'PremiumLastSeenHeader1')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].desc
  }, (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang(isReadDate ? 'PremiumReadText1' : 'PremiumLastSeenText1Locked', userName), ['simple_markdown'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
    size: "smaller",
    onClick: isReadDate ? handleShowReadTime : handleShowLastSeen,
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].button
  }, lang(isReadDate ? 'PremiumReadButton1' : 'PremiumLastSeenButton1')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Separator__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].separator
  }, lang('PremiumOr')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].header
  }, lang('PremiumReadHeader2')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].desc
  }, (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang(isReadDate ? 'PremiumReadText2' : 'PremiumLastSeenText2', userName), ['simple_markdown'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
    withPremiumGradient: true,
    size: "smaller",
    onClick: handleOpenPremium,
    className: _PrivacySettingsNoticeModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].button
  }, lang('PremiumLastSeenButton2'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    chatId,
    isReadDate
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global).privacySettingsNoticeModal || {};
  const user = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectUser)(global, chatId) : undefined;
  return {
    user,
    isReadDate
  };
})(PrivacySettingsNoticeModal)));

/***/ }),

/***/ "./src/components/common/RecipientPicker.tsx":
/*!***************************************************!*\
  !*** ./src/components/common/RecipientPicker.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./helpers/sortChatIds */ "./src/components/common/helpers/sortChatIds.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _pickers_ChatOrUserPicker__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./pickers/ChatOrUserPicker */ "./src/components/common/pickers/ChatOrUserPicker.tsx");










const RecipientPicker = ({
  isOpen,
  currentUserId,
  activeListIds,
  archivedListIds,
  pinnedIds,
  contactIds,
  filter = _config__WEBPACK_IMPORTED_MODULE_2__.API_CHAT_TYPES,
  className,
  searchPlaceholder,
  loadMore,
  onSelectRecipient,
  onClose,
  onCloseAnimationEnd
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [search, setSearch] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const ids = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!isOpen) return undefined;
    let priorityIds = pinnedIds || [];
    if (currentUserId) {
      priorityIds = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_5__.unique)([currentUserId, ...priorityIds]);
    }

    // No need for expensive global updates on users, so we avoid them
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    const usersById = global.users.byId;
    const chatsById = global.chats.byId;
    const chatFullInfoById = global.chats.fullInfoById;
    const chatIds = [...(activeListIds || []), ...(search && archivedListIds || [])].filter(id => {
      const chat = chatsById[id];
      const user = usersById[id];
      if (user && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isDeletedUser)(user)) return false;
      return chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getCanPostInChat)(chat, undefined, undefined, chatFullInfoById[id]);
    });
    const sorted = (0,_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_6__["default"])((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_5__.unique)([...(currentUserId ? [currentUserId] : []), ...(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.filterChatsByName)(lang, chatIds, chatsById, search, currentUserId), ...(contactIds && filter.includes('users') ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.filterUsersByName)(contactIds, usersById, search) : [])]), undefined, priorityIds, currentUserId);
    return (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.filterChatIdsByType)(global, sorted, filter);
  }, [pinnedIds, currentUserId, activeListIds, search, archivedListIds, lang, contactIds, filter, isOpen]);
  const renderingIds = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_7__["default"])(ids, true);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_pickers_ChatOrUserPicker__WEBPACK_IMPORTED_MODULE_9__["default"], {
    isOpen: isOpen,
    className: className,
    chatOrUserIds: renderingIds,
    currentUserId: currentUserId,
    searchPlaceholder: searchPlaceholder,
    search: search,
    onSearchChange: setSearch,
    loadMore: loadMore,
    onSelectChatOrUser: onSelectRecipient,
    onClose: onClose,
    onCloseAnimationEnd: onCloseAnimationEnd
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    chats: {
      listIds,
      orderedPinnedIds
    },
    currentUserId
  } = global;
  return {
    activeListIds: listIds.active,
    archivedListIds: listIds.archived,
    pinnedIds: orderedPinnedIds.active,
    contactIds: global.contactList?.userIds,
    currentUserId
  };
})(RecipientPicker)));

/***/ }),

/***/ "./src/components/common/ReportAvatarModal.tsx":
/*!*****************************************************!*\
  !*** ./src/components/common/ReportAvatarModal.tsx ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");








const ReportAvatarModal = ({
  isOpen,
  peerId,
  photo,
  onClose,
  onCloseAnimationEnd
}) => {
  const {
    reportProfilePhoto
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [selectedReason, setSelectedReason] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('spam');
  const [description, setDescription] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const handleReport = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__["default"])(() => {
    reportProfilePhoto({
      chatId: peerId,
      photo,
      reason: selectedReason,
      description
    });
    onClose();
  });
  const handleSelectReason = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__["default"])(value => {
    setSelectedReason(value);
  });
  const handleDescriptionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__["default"])(e => {
    setDescription(e.target.value);
  });
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const REPORT_OPTIONS = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => [{
    value: 'spam',
    label: lang('lng_report_reason_spam')
  }, {
    value: 'violence',
    label: lang('lng_report_reason_violence')
  }, {
    value: 'pornography',
    label: lang('lng_report_reason_pornography')
  }, {
    value: 'childAbuse',
    label: lang('lng_report_reason_child_abuse')
  }, {
    value: 'copyright',
    label: lang('ReportPeer.ReasonCopyright')
  }, {
    value: 'illegalDrugs',
    label: 'Illegal Drugs'
  }, {
    value: 'personalDetails',
    label: 'Personal Details'
  }, {
    value: 'other',
    label: lang('lng_report_reason_other')
  }], [lang]);
  if (!peerId || !photo) {
    return undefined;
  }
  const title = lang('ReportPeer.Report');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    onEnter: isOpen ? handleReport : undefined,
    onCloseAnimationEnd: onCloseAnimationEnd,
    className: "narrow",
    title: title
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_7__["default"], {
    name: "report-message",
    options: REPORT_OPTIONS,
    onChange: handleSelectReason,
    selected: selectedReason
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    label: lang('lng_report_reason_description'),
    value: description,
    onChange: handleDescriptionChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_4__["default"], {
    color: "danger",
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleReport
  }, lang('lng_report_button')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_4__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onClose
  }, lang('Cancel'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ReportAvatarModal));

/***/ }),

/***/ "./src/components/common/SeenByModal.tsx":
/*!***********************************************!*\
  !*** ./src/components/common/SeenByModal.tsx ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _PrivateChatInfo__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _SeenByModal_module_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./SeenByModal.module.scss */ "./src/components/common/SeenByModal.module.scss");













const CLOSE_ANIMATION_DURATION = 100;
function SeenByModal({
  isOpen,
  seenByDates
}) {
  const {
    openChat,
    closeSeenByModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const renderingSeenByDates = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_5__["default"])(seenByDates, true);
  const memberIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!renderingSeenByDates) {
      return undefined;
    }
    const result = Object.keys(renderingSeenByDates);
    result.sort((leftId, rightId) => renderingSeenByDates[rightId] - renderingSeenByDates[leftId]);
    return result;
  }, [renderingSeenByDates]);
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(userId => {
    closeSeenByModal();
    setTimeout(() => {
      openChat({
        id: userId
      });
    }, CLOSE_ANIMATION_DURATION);
  });
  const handleCloseSeenByModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    closeSeenByModal();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isOpen: isOpen,
    onClose: closeSeenByModal,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_SeenByModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].modal, 'narrow'),
    title: `Seen by ${memberIds?.length} users`
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    dir: lang.isRtl ? 'rtl' : undefined
  }, memberIds && memberIds.map(userId => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    key: userId,
    className: "chat-item-clickable scroll-item small-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleClick(userId)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_11__["default"], {
    userId: userId,
    noStatusOrTyping: true,
    status: (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.formatDateAtTime)(lang, renderingSeenByDates[userId] * 1000),
    statusIcon: "message-read"
  })))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons mt-2"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleCloseSeenByModal
  }, lang('Close'))));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    chatId,
    messageId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global).seenByModal || {};
  if (!chatId || !messageId) {
    return {};
  }
  return {
    seenByDates: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectChatMessage)(global, chatId, messageId)?.seenByDates
  };
})(SeenByModal)));

/***/ }),

/***/ "./src/components/common/SliderDots.tsx":
/*!**********************************************!*\
  !*** ./src/components/common/SliderDots.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./SliderDots.module.scss */ "./src/components/common/SliderDots.module.scss");






const SliderDots = ({
  length,
  active,
  onSelectSlide
}) => {
  const startFrom = Math.max(0, Math.min(length - 8, active - 4));
  const isPreLastBatch = startFrom === length - 8 - 1;
  const isLastBatch = startFrom === length - 8;
  const isFirstBatch = startFrom === 0;
  const isPreFirstBatch = startFrom === 1;
  const shownDotsCount = Math.min(length, 8);
  const handleGoForward = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onSelectSlide(active + 1);
  }, [active, onSelectSlide]);
  const handleGoBack = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onSelectSlide(active - 1);
  }, [active, onSelectSlide]);
  const count = Math.min(8, length);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_TOUCH_ENV && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_3__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].arrow, active === 0 && _SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].arrowHidden),
    color: "translucent",
    disabled: active === 0,
    round: true,
    onClick: handleGoBack
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_4__["default"], {
    name: "previous"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].root,
    style: `--start-from: ${startFrom}; --length: ${length}; --count: ${count};`
  }, Array(length).fill(undefined).map((_, i) => {
    const index = i;
    const isLast = i === startFrom + shownDotsCount - 1 && !isLastBatch && !isPreLastBatch;
    const isPreLast = i === startFrom + shownDotsCount - 2 && !isPreLastBatch && !isLastBatch || i === startFrom + shownDotsCount - 1 && isPreLastBatch;
    const isFirst = i === startFrom && !isFirstBatch && !isPreFirstBatch;
    const isPreFirst = i === startFrom + 1 && !isFirstBatch && !isPreFirstBatch || i === startFrom && isPreFirstBatch;
    const isInvisible = i < startFrom || i >= startFrom + shownDotsCount;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      onClick: () => onSelectSlide(i),
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].dot, index === active && _SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].active, (isPreLast || isPreFirst) && _SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].medium, (isLast || isFirst || isInvisible) && _SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].small, isInvisible && _SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].invisible)
    });
  })), !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_TOUCH_ENV && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_3__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].arrow, active === length - 1 && _SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].arrowHidden, _SliderDots_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].right),
    color: "translucent",
    round: true,
    disabled: active === length - 1,
    onClick: handleGoForward
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_4__["default"], {
    name: "next"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SliderDots));

/***/ }),

/***/ "./src/components/common/StickerButton.tsx":
/*!*************************************************!*\
  !*** ./src/components/common/StickerButton.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _middle_helpers_preventMessageInputBlur__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../middle/helpers/preventMessageInputBlur */ "./src/components/middle/helpers/preventMessageInputBlur.ts");
/* harmony import */ var _hooks_stickers_useDynamicColorListener__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/stickers/useDynamicColorListener */ "./src/hooks/stickers/useDynamicColorListener.ts");
/* harmony import */ var _hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useContextMenuHandlers */ "./src/hooks/useContextMenuHandlers.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _StickerView__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./StickerView */ "./src/components/common/StickerView.tsx");
/* harmony import */ var _StickerButton_scss__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./StickerButton.scss */ "./src/components/common/StickerButton.scss");

















const contentForStatusMenuContext = [{
  title: 'SetTimeoutFor.Hours',
  value: 1,
  arg: 3600
}, {
  title: 'SetTimeoutFor.Hours',
  value: 2,
  arg: 7200
}, {
  title: 'SetTimeoutFor.Hours',
  value: 8,
  arg: 28800
}, {
  title: 'SetTimeoutFor.Days',
  value: 1,
  arg: 86400
}, {
  title: 'SetTimeoutFor.Days',
  value: 2,
  arg: 172800
}];
const StickerButton = ({
  sticker,
  size,
  noPlay,
  title,
  className,
  noContextMenu,
  isSavedMessages,
  isStatusPicker,
  canViewSet,
  observeIntersection,
  observeIntersectionForShowing,
  isSelected,
  isCurrentUserPremium,
  shouldIgnorePremium,
  noShowPremium,
  sharedCanvasRef,
  withTranslucentThumb,
  forcePlayback,
  onClick,
  clickArg,
  onFaveClick,
  onUnfaveClick,
  onRemoveRecentClick,
  onContextMenuOpen,
  onContextMenuClose,
  onContextMenuClick,
  isEffectEmoji
}) => {
  const {
    openStickerSet,
    openPremiumModal,
    setEmojiStatus
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const menuRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const hasCustomColor = sticker.shouldUseTextColor;
  const customColor = (0,_hooks_stickers_useDynamicColorListener__WEBPACK_IMPORTED_MODULE_6__["default"])(ref, !hasCustomColor);
  const {
    id,
    stickerSetInfo
  } = sticker;
  const isPremium = !sticker.isFree && isEffectEmoji || sticker.hasEffect;
  const isCustomEmoji = sticker.isCustomEmoji || isEffectEmoji;
  const isLocked = !isCurrentUserPremium && isPremium && !shouldIgnorePremium;
  const isIntersecting = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_8__.useIsIntersecting)(ref, observeIntersection);
  const shouldLoad = isIntersecting;
  const shouldPlay = isIntersecting && !noPlay;
  const isIntesectingForShowing = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_8__.useIsIntersecting)(ref, observeIntersectionForShowing);
  const {
    isContextMenuOpen,
    contextMenuAnchor,
    handleBeforeContextMenu,
    handleContextMenu,
    handleContextMenuClose,
    handleContextMenuHide
  } = (0,_hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_7__["default"])(ref);
  const shouldRenderContextMenu = Boolean(!noContextMenu && contextMenuAnchor);
  const getTriggerElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => ref.current);
  const getRootElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => ref.current.closest('.custom-scroll, .no-scrollbar'));
  const getMenuElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    return isStatusPicker ? menuRef.current : ref.current.querySelector('.sticker-context-menu .bubble');
  });
  const getLayout = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => ({
    withPortal: isStatusPicker,
    shouldAvoidNegativePosition: true
  }));
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isContextMenuOpen) {
      onContextMenuOpen?.();
    } else {
      onContextMenuClose?.();
    }
  }, [isContextMenuOpen, onContextMenuClose, onContextMenuOpen]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isIntersecting) handleContextMenuClose();
  }, [handleContextMenuClose, isIntersecting]);
  const handleClick = () => {
    if (isContextMenuOpen) return;
    if (isLocked) {
      if (isEffectEmoji) {
        openPremiumModal({
          initialSection: 'effects'
        });
      } else {
        openPremiumModal({
          initialSection: 'premium_stickers'
        });
      }
      return;
    }
    onClick?.(clickArg);
  };
  const handleMouseDown = e => {
    (0,_middle_helpers_preventMessageInputBlur__WEBPACK_IMPORTED_MODULE_5__.preventMessageInputBlurWithBubbling)(e);
    handleBeforeContextMenu(e);
  };
  const handleRemoveClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(e => {
    e.stopPropagation();
    e.preventDefault();
    onRemoveRecentClick(sticker);
  });
  const handleContextRemoveRecent = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onRemoveRecentClick(sticker);
  });
  const handleContextUnfave = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onUnfaveClick(sticker);
  });
  const handleContextFave = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onFaveClick(sticker);
  });
  const handleSendQuiet = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onClick?.(clickArg, true);
  });
  const handleSendScheduled = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onClick?.(clickArg, undefined, true);
  });
  const handleOpenSet = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    openStickerSet({
      stickerSetInfo
    });
  });
  const handleEmojiStatusExpiresClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])((e, duration = 0) => {
    e.preventDefault();
    e.stopPropagation();
    handleContextMenuClose();
    onContextMenuClick?.();
    setEmojiStatus({
      emojiStatusId: sticker.id,
      expires: (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_3__.getServerTime)() + duration
    });
  });
  const shouldShowCloseButton = !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_TOUCH_ENV && onRemoveRecentClick;
  const fullClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('StickerButton', onClick && 'interactive', isSelected && 'selected', isCustomEmoji && 'custom-emoji', isEffectEmoji && 'effect-emoji', className);
  const contextMenuItems = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!shouldRenderContextMenu || noContextMenu || isCustomEmoji && !isStatusPicker) return [];
    const items = [];
    if (isCustomEmoji) {
      contentForStatusMenuContext.forEach(item => {
        items.push( /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
          onClick: handleEmojiStatusExpiresClick,
          clickArg: item.arg
        }, lang(item.title, item.value, 'i')));
      });
      return items;
    }
    if (onUnfaveClick) {
      items.push( /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
        icon: "favorite",
        onClick: handleContextUnfave
      }, lang('Stickers.RemoveFromFavorites')));
    }
    if (onFaveClick) {
      items.push( /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
        icon: "favorite",
        onClick: handleContextFave
      }, lang('Stickers.AddToFavorites')));
    }
    if (!isLocked && onClick) {
      if (!isSavedMessages) {
        items.push( /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
          onClick: handleSendQuiet,
          icon: "muted"
        }, lang('SendWithoutSound')));
      }
      items.push( /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
        onClick: handleSendScheduled,
        icon: "calendar"
      }, lang(isSavedMessages ? 'SetReminder' : 'ScheduleMessage')));
    }
    if (canViewSet) {
      items.push( /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
        onClick: handleOpenSet,
        icon: "stickers"
      }, lang('ViewPackPreview')));
    }
    if (onRemoveRecentClick) {
      items.push( /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
        icon: "delete",
        onClick: handleContextRemoveRecent
      }, lang('DeleteFromRecent')));
    }
    return items;
  }, [shouldRenderContextMenu, noContextMenu, isCustomEmoji, isStatusPicker, onUnfaveClick, onFaveClick, isLocked, onClick, canViewSet, onRemoveRecentClick, handleEmojiStatusExpiresClick, lang, handleContextUnfave, handleContextFave, isSavedMessages, handleSendScheduled, handleSendQuiet, handleOpenSet, handleContextRemoveRecent]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: ref,
    className: fullClassName,
    title: title || sticker?.emoji,
    "data-sticker-id": id,
    onMouseDown: handleMouseDown,
    onClick: handleClick,
    onContextMenu: handleContextMenu
  }, isIntesectingForShowing && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerView__WEBPACK_IMPORTED_MODULE_15__["default"], {
    containerRef: ref,
    sticker: sticker,
    isSmall: true,
    size: size,
    shouldLoop: true,
    shouldPreloadPreview: true,
    noLoad: !shouldLoad,
    noPlay: !shouldPlay,
    noVideoOnMobile: true,
    withSharedAnimation: true,
    sharedCanvasRef: sharedCanvasRef,
    withTranslucentThumb: withTranslucentThumb,
    customColor: customColor,
    forceAlways: forcePlayback
  }), !noShowPremium && isLocked && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "sticker-locked"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "lock-badge"
  })), !noShowPremium && isPremium && !isLocked && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "sticker-premium"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "star"
  })), shouldShowCloseButton && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: "sticker-remove-button",
    color: "dark",
    round: true,
    noFastClick: true,
    onClick: handleRemoveClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "close"
  })), Boolean(contextMenuItems.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_12__["default"], {
    ref: menuRef,
    isOpen: isContextMenuOpen,
    anchor: contextMenuAnchor,
    getTriggerElement: getTriggerElement,
    getRootElement: getRootElement,
    getMenuElement: getMenuElement,
    getLayout: getLayout,
    className: "sticker-context-menu",
    autoClose: true,
    withPortal: isStatusPicker,
    onClose: handleContextMenuClose,
    onCloseAnimationEnd: handleContextMenuHide
  }, contextMenuItems));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StickerButton));

/***/ }),

/***/ "./src/components/common/StickerSet.tsx":
/*!**********************************************!*\
  !*** ./src/components/common/StickerSet.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useMediaTransitionDeprecated */ "./src/hooks/useMediaTransitionDeprecated.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useResizeObserver__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../hooks/useResizeObserver */ "./src/hooks/useResizeObserver.ts");
/* harmony import */ var _hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../hooks/window/useWindowSize */ "./src/hooks/window/useWindowSize.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _reactions_ReactionEmoji__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./reactions/ReactionEmoji */ "./src/components/common/reactions/ReactionEmoji.tsx");
/* harmony import */ var _StickerButton__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./StickerButton */ "./src/components/common/StickerButton.tsx");
/* harmony import */ var _assets_icons_forumTopic_grey_svg__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../assets/icons/forumTopic/grey.svg */ "./src/assets/icons/forumTopic/grey.svg");




















const ITEMS_PER_ROW_FALLBACK = 8;
const ITEMS_MOBILE_PER_ROW_FALLBACK = 7;
const ITEMS_MINI_MOBILE_PER_ROW_FALLBACK = 6;
const MOBILE_WIDTH_THRESHOLD_PX = 440;
const MINI_MOBILE_WIDTH_THRESHOLD_PX = 362;
const StickerSet = ({
  stickerSet,
  loadAndPlay,
  index,
  idPrefix,
  isNearActive,
  favoriteStickers,
  availableReactions,
  isSavedMessages,
  isStatusPicker,
  isReactionPicker,
  isCurrentUserPremium,
  shouldHideHeader,
  withDefaultTopicIcon,
  selectedReactionIds,
  withDefaultStatusIcon,
  isChatEmojiSet,
  isChatStickerSet,
  isTranslucent,
  noContextMenus,
  forcePlayback,
  observeIntersection,
  observeIntersectionForPlayingItems,
  observeIntersectionForShowingItems,
  onReactionSelect,
  onReactionContext,
  onStickerSelect,
  onStickerUnfave,
  onStickerFave,
  onStickerRemoveRecent,
  onContextMenuOpen,
  onContextMenuClose,
  onContextMenuClick
}) => {
  const {
    clearRecentStickers,
    clearRecentCustomEmoji,
    clearRecentReactions,
    openPremiumModal,
    toggleStickerSet,
    loadStickers
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);

  // eslint-disable-next-line no-null/no-null
  const sharedCanvasRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const sharedCanvasHqRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const {
    width: windowWidth
  } = (0,_hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_13__["default"])();
  const [isConfirmModalOpen, openConfirmModal, closeConfirmModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [itemsPerRow, setItemsPerRow] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(getItemsPerRowFallback(windowWidth));
  const isIntersecting = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_8__.useIsIntersecting)(ref, observeIntersection ?? observeIntersectionForShowingItems);
  const transitionClassNames = (0,_hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(isIntersecting);

  // `isNearActive` is set in advance during animation, but it is not reliable for short sets
  const shouldRender = isNearActive || isIntersecting;
  const stickerMarginPx = isMobile ? 8 : 4;
  const emojiMarginPx = isMobile ? 8 : 10;
  const emojiVerticalMarginPx = isMobile ? 8 : 4;
  const isRecent = stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID;
  const isFavorite = stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.FAVORITE_SYMBOL_SET_ID;
  const isPopular = stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.POPULAR_SYMBOL_SET_ID;
  const isEmoji = stickerSet.isEmoji;
  const isPremiumSet = !isRecent && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsSetPremium)(stickerSet);
  const handleClearRecent = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    if (isReactionPicker) {
      clearRecentReactions();
    } else if (isEmoji) {
      clearRecentCustomEmoji();
    } else {
      clearRecentStickers();
    }
    closeConfirmModal();
  });
  const handleAddClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    if (isPremiumSet && !isCurrentUserPremium) {
      openPremiumModal({
        initialSection: 'animated_emoji'
      });
    } else {
      toggleStickerSet({
        stickerSetId: stickerSet.id
      });
    }
  });
  const handleDefaultTopicIconClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onStickerSelect?.({
      mediaType: 'sticker',
      id: _config__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_TOPIC_ICON_STICKER_ID,
      isLottie: false,
      isVideo: false,
      stickerSetInfo: {
        shortName: 'dummy'
      }
    });
  });
  const handleDefaultStatusIconClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onStickerSelect?.({
      mediaType: 'sticker',
      id: _config__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_STATUS_ICON_ID,
      isLottie: false,
      isVideo: false,
      stickerSetInfo: {
        shortName: 'dummy'
      }
    });
  });
  const itemSize = isEmoji ? _config__WEBPACK_IMPORTED_MODULE_2__.EMOJI_SIZE_PICKER : _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_PICKER;
  const margin = isEmoji ? emojiMarginPx : stickerMarginPx;
  const verticalMargin = isEmoji ? emojiVerticalMarginPx : stickerMarginPx;
  const calculateItemsPerRow = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(width => {
    if (!width) {
      return getItemsPerRowFallback(windowWidth);
    }
    return Math.floor((width + margin) / (itemSize + margin));
  });
  const handleResize = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(entry => {
    setItemsPerRow(calculateItemsPerRow(entry.contentRect.width));
  });
  (0,_hooks_useResizeObserver__WEBPACK_IMPORTED_MODULE_12__["default"])(ref, handleResize);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!ref.current) return;
    setItemsPerRow(calculateItemsPerRow(ref.current.clientWidth));
  }, [calculateItemsPerRow]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (shouldRender && !stickerSet.stickers?.length && !stickerSet.reactions?.length && stickerSet.accessHash) {
      loadStickers({
        stickerSetInfo: {
          id: stickerSet.id,
          accessHash: stickerSet.accessHash
        }
      });
    }
  }, [shouldRender, loadStickers, stickerSet]);
  const isLocked = !isSavedMessages && !isCurrentUserPremium && isPremiumSet && !isChatEmojiSet;
  const isInstalled = stickerSet.installedDate && !stickerSet.isArchived;
  const canCut = !isInstalled && stickerSet.id !== _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID && stickerSet.id !== _config__WEBPACK_IMPORTED_MODULE_2__.POPULAR_SYMBOL_SET_ID && stickerSet.id !== _config__WEBPACK_IMPORTED_MODULE_2__.EFFECT_EMOJIS_SET_ID && stickerSet.id !== _config__WEBPACK_IMPORTED_MODULE_2__.EFFECT_STICKERS_SET_ID && !isChatEmojiSet && !isChatStickerSet;
  const [isCut,, expand] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])(canCut);
  const itemsBeforeCutout = itemsPerRow * 3 - 1;
  const totalItemsCount = withDefaultTopicIcon || withDefaultStatusIcon ? stickerSet.count + 1 : stickerSet.count;
  const itemHeight = itemSize + verticalMargin;
  const heightWhenCut = Math.ceil(Math.min(itemsBeforeCutout, totalItemsCount) / itemsPerRow) * itemHeight - verticalMargin;
  const height = isCut ? heightWhenCut : Math.ceil(totalItemsCount / itemsPerRow) * itemHeight - verticalMargin;
  const favoriteStickerIdsSet = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => favoriteStickers ? new Set(favoriteStickers.map(({
    id
  }) => id)) : undefined, [favoriteStickers]);
  const withAddSetButton = !shouldHideHeader && !isRecent && isEmoji && !isPopular && !isChatEmojiSet && (!isInstalled || !isCurrentUserPremium && !isSavedMessages);
  const addSetButtonText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (isLocked) {
      if (isInstalled) return lang('lng_emoji_premium_restore');
      return lang('Unlock');
    }
    return lang('Add');
  }, [isLocked, lang, isInstalled]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: ref,
    key: stickerSet.id,
    id: `${idPrefix}-${index}`,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('symbol-set', isLocked && 'symbol-set-locked')
  }, !shouldHideHeader && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "symbol-set-header"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('symbol-set-title', withAddSetButton && 'symbol-set-title-external')
  }, isLocked && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_16__["default"], {
    name: "lock-badge",
    className: "symbol-set-locked-icon"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "symbol-set-name"
  }, stickerSet.title), (isChatEmojiSet || isChatStickerSet) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "symbol-set-chat"
  }, lang(isChatEmojiSet ? 'GroupEmoji' : 'GroupStickers')), withAddSetButton && Boolean(stickerSet.stickers) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "symbol-set-amount"
  }, lang(isEmoji ? 'EmojiCount' : 'Stickers', stickerSet.stickers.length, 'i'))), isRecent && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_16__["default"], {
    className: "symbol-set-remove",
    name: "close",
    onClick: openConfirmModal
  }), withAddSetButton && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: "symbol-set-add-button",
    withPremiumGradient: isPremiumSet && !isCurrentUserPremium,
    onClick: handleAddClick,
    pill: true,
    size: "tiny",
    fluid: true
  }, addSetButtonText)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('symbol-set-container shared-canvas-container', transitionClassNames, stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.EFFECT_EMOJIS_SET_ID && 'effect-emojis'),
    style: `height: ${height}px;`
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: sharedCanvasRef,
    className: "shared-canvas",
    style: canCut ? `height: ${heightWhenCut}px;` : undefined
  }), (isRecent || isFavorite || canCut) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: sharedCanvasHqRef,
    className: "shared-canvas"
  }), withDefaultTopicIcon && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: "StickerButton custom-emoji",
    color: "translucent",
    onClick: handleDefaultTopicIconClick,
    key: "default-topic-icon"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: _assets_icons_forumTopic_grey_svg__WEBPACK_IMPORTED_MODULE_19__,
    alt: "Reset",
    className: "sticker-media",
    draggable: false
  })), withDefaultStatusIcon && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: "StickerButton custom-emoji status-default",
    color: "translucent",
    onClick: handleDefaultStatusIconClick,
    key: "default-status-icon"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_16__["default"], {
    name: "star"
  })), shouldRender && stickerSet.reactions?.map(reaction => {
    const reactionId = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getReactionKey)(reaction);
    const isSelected = reactionId ? selectedReactionIds?.includes(reactionId) : undefined;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_reactions_ReactionEmoji__WEBPACK_IMPORTED_MODULE_17__["default"], {
      key: `${stickerSet.id}_${reactionId}`,
      reaction: reaction,
      isSelected: isSelected,
      loadAndPlay: loadAndPlay,
      availableReactions: availableReactions,
      observeIntersection: observeIntersectionForPlayingItems,
      onClick: onReactionSelect,
      onContextMenu: onReactionContext,
      sharedCanvasRef: sharedCanvasRef,
      sharedCanvasHqRef: sharedCanvasHqRef,
      forcePlayback: forcePlayback
    });
  }), shouldRender && stickerSet.stickers?.slice(0, isCut ? itemsBeforeCutout : stickerSet.stickers.length).map((sticker, i) => {
    const isHqEmoji = (isRecent || isFavorite) && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsAlwaysHighPriorityEmoji)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), sticker.stickerSetInfo);
    const canvasRef = canCut && i >= itemsBeforeCutout || isHqEmoji ? sharedCanvasHqRef : sharedCanvasRef;
    const reactionId = sticker.isCustomEmoji ? sticker.id : sticker.emoji;
    const isSelected = reactionId ? selectedReactionIds?.includes(reactionId) : undefined;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerButton__WEBPACK_IMPORTED_MODULE_18__["default"], {
      key: sticker.id,
      sticker: sticker,
      size: itemSize,
      observeIntersection: observeIntersectionForPlayingItems,
      observeIntersectionForShowing: observeIntersectionForShowingItems,
      noPlay: !loadAndPlay,
      isSavedMessages: isSavedMessages,
      isStatusPicker: isStatusPicker,
      canViewSet: true,
      noContextMenu: noContextMenus,
      isCurrentUserPremium: isCurrentUserPremium,
      shouldIgnorePremium: isChatEmojiSet,
      sharedCanvasRef: canvasRef,
      withTranslucentThumb: isTranslucent,
      onClick: onStickerSelect,
      clickArg: sticker,
      isSelected: isSelected,
      onUnfaveClick: isFavorite && favoriteStickerIdsSet?.has(sticker.id) ? onStickerUnfave : undefined,
      onFaveClick: !favoriteStickerIdsSet?.has(sticker.id) ? onStickerFave : undefined,
      onRemoveRecentClick: isRecent ? onStickerRemoveRecent : undefined,
      onContextMenuOpen: onContextMenuOpen,
      onContextMenuClose: onContextMenuClose,
      onContextMenuClick: onContextMenuClick,
      forcePlayback: forcePlayback,
      isEffectEmoji: stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.EFFECT_EMOJIS_SET_ID,
      noShowPremium: isCurrentUserPremium && (stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.EFFECT_STICKERS_SET_ID || stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.EFFECT_EMOJIS_SET_ID)
    });
  }), isCut && totalItemsCount > itemsBeforeCutout && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: "StickerButton custom-emoji set-expand",
    round: true,
    color: "translucent",
    onClick: expand,
    key: "more"
  }, "+", totalItemsCount - itemsBeforeCutout)), isRecent && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_15__["default"], {
    text: lang(isReactionPicker ? 'ClearRecentReactionsAlertMessage' : 'ClearRecentStickersAlertMessage'),
    isOpen: isConfirmModalOpen,
    onClose: closeConfirmModal,
    confirmHandler: handleClearRecent,
    confirmIsDestructive: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StickerSet));
function getItemsPerRowFallback(windowWidth) {
  return windowWidth > MOBILE_WIDTH_THRESHOLD_PX ? ITEMS_PER_ROW_FALLBACK : windowWidth < MINI_MOBILE_WIDTH_THRESHOLD_PX ? ITEMS_MINI_MOBILE_PER_ROW_FALLBACK : ITEMS_MOBILE_PER_ROW_FALLBACK;
}

/***/ }),

/***/ "./src/components/common/StickerSetCard.tsx":
/*!**************************************************!*\
  !*** ./src/components/common/StickerSetCard.tsx ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _middle_composer_StickerSetCover__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../middle/composer/StickerSetCover */ "./src/components/middle/composer/StickerSetCover.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _StickerButton__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./StickerButton */ "./src/components/common/StickerButton.tsx");
/* harmony import */ var _StickerSetCard_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./StickerSetCard.scss */ "./src/components/common/StickerSetCard.scss");










const StickerSetCard = ({
  stickerSet,
  noPlay,
  className,
  observeIntersection,
  onClick
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const firstSticker = stickerSet?.stickers?.[0];
  const handleCardClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__["default"])(() => {
    if (firstSticker) onClick(firstSticker);
  });
  if (!stickerSet?.stickers) {
    return undefined;
  }
  function renderPreview() {
    if (!stickerSet) return undefined;
    if (stickerSet.hasThumbnail || !firstSticker) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
        ariaLabel: stickerSet.title,
        color: "translucent",
        isRtl: lang.isRtl
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_middle_composer_StickerSetCover__WEBPACK_IMPORTED_MODULE_5__["default"], {
        stickerSet: stickerSet,
        size: _config__WEBPACK_IMPORTED_MODULE_1__.STICKER_SIZE_GENERAL_SETTINGS,
        noPlay: noPlay,
        observeIntersection: observeIntersection
      }));
    } else {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerButton__WEBPACK_IMPORTED_MODULE_8__["default"], {
        sticker: firstSticker,
        size: _config__WEBPACK_IMPORTED_MODULE_1__.STICKER_SIZE_GENERAL_SETTINGS,
        title: stickerSet.title,
        noPlay: noPlay,
        observeIntersection: observeIntersection,
        noContextMenu: true,
        isCurrentUserPremium: true,
        clickArg: undefined
      });
    }
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_7__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('StickerSetCard', 'chat-item-clickable small-icon', className),
    style: `height: ${_config__WEBPACK_IMPORTED_MODULE_1__.CHAT_HEIGHT_PX}px;`,
    inactive: !firstSticker,
    onClick: handleCardClick
  }, renderPreview(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "title"
  }, stickerSet.title), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "subtitle"
  }, lang('StickerPack.StickerCount', stickerSet.count, 'i'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StickerSetCard));

/***/ }),

/***/ "./src/components/common/StickerSetModal.tsx":
/*!***************************************************!*\
  !*** ./src/components/common/StickerSetModal.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_clipboard__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/clipboard */ "./src/util/clipboard.ts");
/* harmony import */ var _helpers_renderText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_useSchedule__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../hooks/useSchedule */ "./src/hooks/useSchedule.tsx");
/* harmony import */ var _hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../hooks/useScrolledState */ "./src/hooks/useScrolledState.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/DropdownMenu */ "./src/components/ui/DropdownMenu.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _StickerButton__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./StickerButton */ "./src/components/common/StickerButton.tsx");
/* harmony import */ var _StickerSetModal_scss__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./StickerSetModal.scss */ "./src/components/common/StickerSetModal.scss");






















const INTERSECTION_THROTTLE = 200;
const StickerSetModal = ({
  isOpen,
  fromSticker,
  stickerSetShortName,
  stickerSet,
  canSendStickers,
  canScheduleUntilOnline,
  shouldSchedule,
  isSavedMessages,
  isCurrentUserPremium,
  shouldUpdateStickerSetOrder,
  currentMessageList,
  onClose
}) => {
  const {
    loadStickers,
    toggleStickerSet,
    sendMessage,
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const sharedCanvasRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const prevStickerSet = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_11__["default"])(stickerSet);
  const renderingStickerSet = stickerSet || prevStickerSet;
  const isAdded = Boolean(!renderingStickerSet?.isArchived && renderingStickerSet?.installedDate);
  const isEmoji = renderingStickerSet?.isEmoji;
  const [requestCalendar, calendar] = (0,_hooks_useSchedule__WEBPACK_IMPORTED_MODULE_12__["default"])(canScheduleUntilOnline);
  const {
    handleScroll: handleContentScroll,
    isAtBeginning: shouldHideTopBorder
  } = (0,_hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_13__["default"])();
  const {
    observe: observeIntersection
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_9__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: INTERSECTION_THROTTLE,
    isDisabled: !isOpen
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && !renderingStickerSet?.stickers) {
      loadStickers({
        stickerSetInfo: fromSticker ? fromSticker.stickerSetInfo : {
          shortName: stickerSetShortName
        }
      });
    }
  }, [isOpen, fromSticker, loadStickers, stickerSetShortName, renderingStickerSet]);
  const handleSelect = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((sticker, isSilent, isScheduleRequested) => {
    if (!currentMessageList) {
      return;
    }
    sticker = {
      ...sticker,
      isPreloadedGlobally: true
    };
    if (shouldSchedule || isScheduleRequested) {
      requestCalendar(scheduledAt => {
        sendMessage({
          messageList: currentMessageList,
          sticker,
          isSilent,
          scheduledAt
        });
        onClose();
      });
    } else {
      sendMessage({
        messageList: currentMessageList,
        sticker,
        isSilent,
        shouldUpdateStickerSetOrder: shouldUpdateStickerSetOrder && isAdded
      });
      onClose();
    }
  }, [currentMessageList, shouldSchedule, requestCalendar, onClose, shouldUpdateStickerSetOrder, isAdded]);
  const handleButtonClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (renderingStickerSet) {
      toggleStickerSet({
        stickerSetId: renderingStickerSet.id
      });
      onClose();
    }
  }, [onClose, renderingStickerSet, toggleStickerSet]);
  const handleCopyLink = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!renderingStickerSet) return;
    const {
      shortName
    } = renderingStickerSet;
    const suffix = isEmoji ? 'addemoji' : 'addstickers';
    const url = `${_config__WEBPACK_IMPORTED_MODULE_2__.TME_LINK_PREFIX}${suffix}/${shortName}`;
    (0,_util_clipboard__WEBPACK_IMPORTED_MODULE_6__.copyTextToClipboard)(url);
    showNotification({
      message: lang('LinkCopied')
    });
  }, [isEmoji, lang, renderingStickerSet, showNotification]);
  const renderButtonText = () => {
    if (!renderingStickerSet) return lang('Loading');
    const suffix = isEmoji ? 'Emoji' : 'Sticker';
    return lang(isAdded ? `StickerPack.Remove${suffix}Count` : `StickerPack.Add${suffix}Count`, renderingStickerSet.count, 'i');
  };
  const MoreMenuButton = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return ({
      onTrigger,
      isOpen: isMenuOpen
    }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
      round: true,
      ripple: !isMobile,
      size: "smaller",
      color: "translucent",
      className: isMenuOpen ? 'active' : '',
      onClick: onTrigger,
      ariaLabel: "More actions"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
      name: "more"
    }));
  }, [isMobile]);
  function renderHeader() {
    const fullClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('modal-header', !shouldHideTopBorder && 'with-top-border');
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: fullClassName,
      dir: lang.isRtl ? 'rtl' : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: lang('Close'),
      onClick: onClose
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
      name: "close"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-title"
    }, renderingStickerSet ? (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__["default"])(renderingStickerSet.title, ['emoji', 'links']) : lang('AccDescrStickerSet')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_15__["default"], {
      className: "stickers-more-menu with-menu-transitions",
      trigger: MoreMenuButton,
      positionX: "right"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
      icon: "copy",
      onClick: handleCopyLink
    }, lang('StickersCopy'))));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_18__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('StickerSetModal', isEmoji && 'custom-emoji'),
    isOpen: isOpen,
    onClose: onClose,
    header: renderHeader()
  }, renderingStickerSet?.stickers ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: "stickers custom-scroll",
    onScroll: handleContentScroll
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "shared-canvas-container stickers-grid"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: sharedCanvasRef,
    className: "shared-canvas"
  }), renderingStickerSet.stickers.map(sticker => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerButton__WEBPACK_IMPORTED_MODULE_20__["default"], {
    sticker: sticker,
    size: isEmoji ? _config__WEBPACK_IMPORTED_MODULE_2__.EMOJI_SIZE_MODAL : _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_MODAL,
    observeIntersection: observeIntersection,
    onClick: canSendStickers && !isEmoji ? handleSelect : undefined,
    clickArg: sticker,
    isSavedMessages: isSavedMessages,
    isCurrentUserPremium: isCurrentUserPremium,
    sharedCanvasRef: sharedCanvasRef
  })))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "button-wrapper"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    size: "smaller",
    fluid: true,
    color: isAdded ? 'danger' : 'primary',
    onClick: handleButtonClick
  }, renderButtonText()))) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_16__["default"], null), calendar);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  fromSticker,
  stickerSetShortName
}) => {
  const currentMessageList = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCurrentMessageList)(global);
  const {
    chatId,
    threadId
  } = currentMessageList || {};
  const chat = chatId && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  const chatFullInfo = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId) : undefined;
  const sendOptions = chat ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getAllowedAttachmentOptions)(chat, chatFullInfo) : undefined;
  const threadInfo = chatId && threadId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectThreadInfo)(global, chatId, threadId) : undefined;
  const isMessageThread = Boolean(!threadInfo?.isCommentsInfo && threadInfo?.fromChannelId);
  const topic = chatId && threadId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTopic)(global, chatId, threadId) : undefined;
  const canSendStickers = Boolean(chat && threadId && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getCanPostInChat)(chat, topic, isMessageThread, chatFullInfo) && sendOptions?.canSendStickers);
  const isSavedMessages = Boolean(chatId) && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsChatWithSelf)(global, chatId);
  const stickerSetInfo = fromSticker ? fromSticker.stickerSetInfo : stickerSetShortName ? {
    shortName: stickerSetShortName
  } : undefined;
  const stickerSet = stickerSetInfo ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectStickerSet)(global, stickerSetInfo) : undefined;
  return {
    canScheduleUntilOnline: Boolean(chatId) && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCanScheduleUntilOnline)(global, chatId),
    canSendStickers,
    isSavedMessages,
    shouldSchedule: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectShouldSchedule)(global),
    stickerSet,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsCurrentUserPremium)(global),
    shouldUpdateStickerSetOrder: global.settings.byKey.shouldUpdateStickerSetOrder,
    currentMessageList
  };
})(StickerSetModal)));

/***/ }),

/***/ "./src/components/common/UnpinAllMessagesModal.tsx":
/*!*********************************************************!*\
  !*** ./src/components/common/UnpinAllMessagesModal.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");




const UnpinAllMessagesModal = ({
  isOpen,
  pinnedMessagesCount = 0,
  onClose,
  onUnpin
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_1__["default"])();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_3__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    className: "unpin-all",
    title: lang('Chat.PanelUnpinAllMessages')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, lang('Chat.UnpinAllMessagesConfirmation', pinnedMessagesCount, 'i')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons mt-2"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_2__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onUnpin
  }, lang('DialogUnpin')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_2__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onClose
  }, lang('Cancel'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(UnpinAllMessagesModal));

/***/ }),

/***/ "./src/components/common/UsernameInput.tsx":
/*!*************************************************!*\
  !*** ./src/components/common/UsernameInput.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _util_username__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/username */ "./src/util/username.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");








const LINK_PREFIX_REGEX = /https:\/\/t\.me\/?/i;
const runDebouncedForCheckUsername = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_3__.debounce)(cb => cb(), 250, false);
const UsernameInput = ({
  currentUsername,
  asLink,
  isLoading,
  isUsernameAvailable,
  checkedUsername,
  onChange
}) => {
  const {
    checkUsername,
    checkPublicLink
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [username, setUsername] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentUsername || '');
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const langPrefix = asLink ? 'SetUrl' : 'Username';
  const label = asLink ? lang('SetUrlPlaceholder') : lang('Username');
  const previousIsUsernameAvailable = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__["default"])(isUsernameAvailable);
  const renderingIsUsernameAvailable = currentUsername !== username ? isUsernameAvailable ?? previousIsUsernameAvailable : undefined;
  const isChecking = username && currentUsername !== username && checkedUsername !== username;
  const [usernameSuccess, usernameError] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!username.length) {
      return [];
    }
    if (username.length < _util_username__WEBPACK_IMPORTED_MODULE_4__.MIN_UPDATE_USERNAME_LENGTH) {
      return [undefined, lang(`${langPrefix}InvalidShort`)];
    }
    if (username.length > _util_username__WEBPACK_IMPORTED_MODULE_4__.MAX_USERNAME_LENGTH) {
      return [undefined, lang(`${langPrefix}InvalidLong`)];
    }
    if (!_util_username__WEBPACK_IMPORTED_MODULE_4__.USERNAME_REGEX.test(username)) {
      return [undefined, lang(`${langPrefix}Invalid`)];
    }
    if (renderingIsUsernameAvailable === undefined || isChecking) {
      return [];
    }

    // Variable `isUsernameAvailable` is initialized with `undefined`, so a strict false check is required
    return [renderingIsUsernameAvailable ? lang(`${langPrefix}Available`, label) : undefined, renderingIsUsernameAvailable === false ? lang(`${langPrefix}InUse`) : undefined];
  }, [username, renderingIsUsernameAvailable, isChecking, lang, langPrefix, label]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setUsername(currentUsername || '');
  }, [asLink, currentUsername]);
  const handleUsernameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const value = e.target.value.trim();
    // Prevent prefix editing
    if (asLink && !value.match(LINK_PREFIX_REGEX)) {
      if (!value.length) {
        setUsername('');
        onChange?.('');
      }
      return;
    }
    const newUsername = value.replace(LINK_PREFIX_REGEX, '');
    setUsername(newUsername);
    const isValid = newUsername === '' ? true : (0,_util_username__WEBPACK_IMPORTED_MODULE_4__.isUsernameValid)(newUsername, true);
    if (!isValid) return;
    onChange?.(newUsername);
    runDebouncedForCheckUsername(() => {
      if (newUsername !== currentUsername) {
        const check = asLink ? checkPublicLink : checkUsername;
        check({
          username: newUsername
        });
      }
    });
  }, [asLink, checkPublicLink, checkUsername, currentUsername, onChange]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_7__["default"], {
    value: `${asLink ? _config__WEBPACK_IMPORTED_MODULE_2__.TME_LINK_PREFIX : ''}${username}`,
    onChange: handleUsernameChange,
    label: isChecking ? lang('Checking') : label,
    error: usernameError,
    success: usernameSuccess,
    readOnly: isLoading,
    teactExperimentControlled: true
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(UsernameInput));

/***/ }),

/***/ "./src/components/common/VerificationMonetizationModal.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/common/VerificationMonetizationModal.tsx ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _PasswordForm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./PasswordForm */ "./src/components/common/PasswordForm.tsx");
/* harmony import */ var _VerificationMonetizationModal_module_scss__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./VerificationMonetizationModal.module.scss */ "./src/components/common/VerificationMonetizationModal.module.scss");









const VerificationMonetizationModal = ({
  modal,
  passwordHint
}) => {
  const {
    closeMonetizationVerificationModal,
    clearMonetizationVerificationError,
    processMonetizationRevenueWithdrawalUrl
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const isOpen = Boolean(modal);
  const renderingModal = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_3__["default"])(modal);
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const [shouldShowPassword, setShouldShowPassword] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const handleSubmit = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(password => {
    if (!renderingModal) return;
    processMonetizationRevenueWithdrawalUrl({
      peerId: renderingModal.chatId,
      currentPassword: password
    });
  });
  const handleClearError = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    clearMonetizationVerificationError();
  });
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    closeMonetizationVerificationModal();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isOpen: isOpen,
    hasCloseButton: true,
    title: lang('CheckPasswordTitle'),
    className: _VerificationMonetizationModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].root,
    contentClassName: _VerificationMonetizationModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].content,
    onClose: handleClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_VerificationMonetizationModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].content, 'settings-content password-form custom-scroll')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PasswordForm__WEBPACK_IMPORTED_MODULE_7__["default"], {
    shouldShowSubmit: true,
    placeholder: lang('CheckPasswordPlaceholder'),
    error: renderingModal?.errorKey && lang.withRegular(renderingModal.errorKey),
    description: lang('CheckPasswordDescription'),
    clearError: handleClearError,
    isLoading: renderingModal?.isLoading,
    hint: passwordHint,
    isPasswordVisible: shouldShowPassword,
    shouldResetValue: isOpen,
    onChangePasswordVisibility: setShouldShowPassword,
    onSubmit: handleSubmit
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    twoFaSettings: {
      hint: passwordHint
    }
  } = global;
  return {
    passwordHint
  };
})(VerificationMonetizationModal)));

/***/ }),

/***/ "./src/components/common/embedded/EmbeddedStoryForward.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/common/embedded/EmbeddedStoryForward.tsx ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _helpers_peerColor__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../helpers/peerColor */ "./src/components/common/helpers/peerColor.ts");
/* harmony import */ var _helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../helpers/renderTextWithEntities */ "./src/components/common/helpers/renderTextWithEntities.tsx");
/* harmony import */ var _hooks_useFastClick__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useFastClick */ "./src/hooks/useFastClick.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _EmojiIconBackground__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./EmojiIconBackground */ "./src/components/common/embedded/EmojiIconBackground.tsx");
/* harmony import */ var _EmbeddedMessage_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./EmbeddedMessage.scss */ "./src/components/common/embedded/EmbeddedMessage.scss");














const EmbeddedStoryForward = ({
  className,
  forwardInfo,
  sender,
  story
}) => {
  const {
    openStoryViewer,
    loadPeerStoriesByIds,
    openChat
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!story && forwardInfo.fromPeerId && forwardInfo.storyId) {
      loadPeerStoriesByIds({
        peerId: forwardInfo.fromPeerId,
        storyIds: [forwardInfo.storyId]
      });
    }
  }, [forwardInfo, story]);
  const senderTitle = sender ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getPeerTitle)(lang, sender) : forwardInfo.fromName;
  const openOriginalStory = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    const {
      fromPeerId,
      storyId
    } = forwardInfo;
    if (!fromPeerId) return;
    const isStoryReady = story && !('isDeleted' in story && story.isDeleted);
    if (isStoryReady) {
      openStoryViewer({
        peerId: fromPeerId,
        storyId,
        isSingleStory: true
      });
    } else {
      openChat({
        id: fromPeerId
      });
    }
  });
  const {
    handleClick,
    handleMouseDown
  } = (0,_hooks_useFastClick__WEBPACK_IMPORTED_MODULE_8__.useFastClick)(openOriginalStory);
  function renderTextContent() {
    if (story && 'content' in story && story.content.text) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
        className: "embedded-text-wrapper"
      }, (0,_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_7__.renderTextWithEntities)(story.content.text));
    }
    return undefined;
  }
  function renderSender() {
    if (!sender || !senderTitle) {
      return undefined;
    }
    const icon = !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(sender.id) ? 'channel-filled' : 'user-filled';
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, icon && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
      name: icon,
      className: "embedded-chat-icon"
    }), senderTitle && (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(senderTitle));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: ref,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('EmbeddedMessage', className, (0,_helpers_peerColor__WEBPACK_IMPORTED_MODULE_5__.getPeerColorClass)(sender, true, true)),
    dir: lang.isRtl ? 'rtl' : undefined,
    onClick: handleClick,
    onMouseDown: handleMouseDown
  }, sender?.color?.backgroundEmojiId && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_EmojiIconBackground__WEBPACK_IMPORTED_MODULE_12__["default"], {
    emojiDocumentId: sender.color.backgroundEmojiId,
    className: "EmbeddedMessage--background-icons"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "message-text"
  }, renderTextContent(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "message-title"
  }, renderSender())));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  forwardInfo
}) => {
  const sender = forwardInfo.fromPeerId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectPeer)(global, forwardInfo.fromPeerId) : undefined;
  const story = forwardInfo.storyId && forwardInfo.fromPeerId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectPeerStory)(global, forwardInfo.fromPeerId, forwardInfo.storyId) : undefined;
  return {
    sender,
    story
  };
})(EmbeddedStoryForward)));

/***/ }),

/***/ "./src/components/common/helpers/detectCardType.ts":
/*!*********************************************************!*\
  !*** ./src/components/common/helpers/detectCardType.ts ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CardType: () => (/* binding */ CardType),
/* harmony export */   detectCardType: () => (/* binding */ detectCardType),
/* harmony export */   detectCardTypeText: () => (/* binding */ detectCardTypeText)
/* harmony export */ });
const VISA = /^4\d/;
const MASTERCARD1 = /^5[1-5]/;
const MASTERCARD2 = /^2[2-7]\d{2}/;
const MIR = /^220[0-4]/;
let CardType = /*#__PURE__*/function (CardType) {
  CardType[CardType["Default"] = 0] = "Default";
  CardType[CardType["Visa"] = 1] = "Visa";
  CardType[CardType["Mastercard"] = 2] = "Mastercard";
  CardType[CardType["Mir"] = 3] = "Mir";
  return CardType;
}({});
const cards = {
  [CardType.Default]: '',
  [CardType.Visa]: 'visa',
  [CardType.Mastercard]: 'mastercard',
  [CardType.Mir]: 'mir'
};
function detectCardType(cardNumber) {
  cardNumber = cardNumber.replace(/\s/g, '');
  if (VISA.test(cardNumber)) {
    return CardType.Visa;
  }
  if (MIR.test(cardNumber)) {
    return CardType.Mir;
  }
  if (MASTERCARD1.test(cardNumber) || MASTERCARD2.test(cardNumber)) {
    return CardType.Mastercard;
  }
  return CardType.Default;
}
function detectCardTypeText(cardNumber) {
  const cardType = detectCardType(cardNumber);
  return cards[cardType] || '';
}

/***/ }),

/***/ "./src/components/common/hooks/useStickerPickerObservers.ts":
/*!******************************************************************!*\
  !*** ./src/components/common/hooks/useStickerPickerObservers.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   useStickerPickerObservers: () => (/* binding */ useStickerPickerObservers)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_animateScroll__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/animateScroll */ "./src/util/animateScroll.ts");
/* harmony import */ var _helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useSyncEffect */ "./src/hooks/useSyncEffect.ts");







const STICKER_INTERSECTION_THROTTLE = 200;
const STICKER_INTERSECTION_MARGIN = 100;
const SLIDE_TRANSITION_DURATION = 350 + _config__WEBPACK_IMPORTED_MODULE_1__.ANIMATION_END_DELAY;
const SCROLL_MAX_DISTANCE_WHEN_CLOSE = 200;
const SCROLL_MAX_DISTANCE_WHEN_FAR = 80;
const FOCUS_MARGIN = 0.5 * _helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_3__.REM;
function useStickerPickerObservers(containerRef, headerRef, idPrefix, isHidden) {
  const stickerSetIntersectionsRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)([]);
  const [activeSetIndex, setActiveSetIndex] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  const {
    observe: observeIntersectionForSet,
    freeze: freezeForSet,
    unfreeze: unfreezeForSet
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_4__.useIntersectionObserver)({
    rootRef: containerRef
  }, entries => {
    const stickerSetIntersections = stickerSetIntersectionsRef.current;
    entries.forEach(entry => {
      const index = Number(entry.target.id.replace(`${idPrefix}-`, ''));
      stickerSetIntersections[index] = entry.isIntersecting;
    });
    const minIntersectingIndex = stickerSetIntersections.reduce((lowestIndex, isIntersecting, index) => {
      return isIntersecting && index < lowestIndex ? index : lowestIndex;
    }, Infinity);
    if (minIntersectingIndex === Infinity) {
      return;
    }
    setActiveSetIndex(minIntersectingIndex);
  });
  const {
    observe: observeIntersectionForShowingItems,
    freeze: freezeForShowingItems,
    unfreeze: unfreezeForShowingItems
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_4__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: STICKER_INTERSECTION_THROTTLE,
    margin: STICKER_INTERSECTION_MARGIN
  });
  const {
    observe: observeIntersectionForPlayingItems
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_4__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: STICKER_INTERSECTION_THROTTLE,
    margin: STICKER_INTERSECTION_MARGIN
  });
  const {
    observe: observeIntersectionForCovers
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_4__.useIntersectionObserver)({
    rootRef: headerRef
  });
  (0,_hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    if (isHidden) {
      freezeForSet();
      freezeForShowingItems();
    } else {
      setTimeout(() => {
        unfreezeForShowingItems();
        unfreezeForSet();
      }, SLIDE_TRANSITION_DURATION);
    }
  }, [freezeForSet, freezeForShowingItems, isHidden, unfreezeForSet, unfreezeForShowingItems]);
  const selectStickerSet = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(index => {
    setActiveSetIndex(currentIndex => {
      const stickerSetEl = document.getElementById(`${idPrefix}-${index}`);
      const isClose = Math.abs(currentIndex - index) === 1;
      (0,_util_animateScroll__WEBPACK_IMPORTED_MODULE_2__["default"])({
        container: containerRef.current,
        element: stickerSetEl,
        position: 'start',
        margin: FOCUS_MARGIN,
        maxDistance: isClose ? SCROLL_MAX_DISTANCE_WHEN_CLOSE : SCROLL_MAX_DISTANCE_WHEN_FAR
      });
      return index;
    });
  });
  return {
    activeSetIndex,
    observeIntersectionForSet,
    observeIntersectionForShowingItems,
    observeIntersectionForPlayingItems,
    observeIntersectionForCovers,
    selectStickerSet
  };
}

/***/ }),

/***/ "./src/components/common/pickers/ChatOrUserPicker.tsx":
/*!************************************************************!*\
  !*** ./src/components/common/pickers/ChatOrUserPicker.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_helpers_peers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers/peers */ "./src/global/helpers/peers.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _helpers_renderText__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_data_useSelector__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/data/useSelector */ "./src/hooks/data/useSelector.ts");
/* harmony import */ var _hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useInfiniteScroll */ "./src/hooks/useInfiniteScroll.ts");
/* harmony import */ var _hooks_useInputFocusOnOpen__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useInputFocusOnOpen */ "./src/hooks/useInputFocusOnOpen.ts");
/* harmony import */ var _hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useKeyboardListNavigation */ "./src/hooks/useKeyboardListNavigation.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _Avatar__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _FullNameTitle__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../FullNameTitle */ "./src/components/common/FullNameTitle.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _TopicIcon__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../TopicIcon */ "./src/components/common/TopicIcon.tsx");
/* harmony import */ var _PickerItem__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./PickerItem */ "./src/components/common/pickers/PickerItem.tsx");
/* harmony import */ var _ChatOrUserPicker_scss__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./ChatOrUserPicker.scss */ "./src/components/common/pickers/ChatOrUserPicker.scss");



























const CHAT_LIST_SLIDE = 0;
const TOPIC_LIST_SLIDE = 1;
const TOPIC_ICON_SIZE = 2.75 * _helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_7__.REM;
const ITEM_CLASS_NAME = 'ChatOrUserPicker-item';
const TOPIC_ITEM_HEIGHT_PX = 56;
const ChatOrUserPicker = ({
  isOpen,
  currentUserId,
  chatOrUserIds,
  search,
  searchPlaceholder,
  className,
  loadMore,
  onSearchChange,
  onSelectChatOrUser,
  onClose,
  onCloseAnimationEnd
}) => {
  const {
    loadTopics
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_14__["default"])();
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const topicContainerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const searchRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const topicSearchRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [viewportIds, getMore] = (0,_hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_10__["default"])(loadMore, chatOrUserIds, Boolean(search));
  const [forumId, setForumId] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [topicSearch, setTopicSearch] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const activeKey = forumId ? TOPIC_LIST_SLIDE : CHAT_LIST_SLIDE;
  const viewportOffset = chatOrUserIds.indexOf(viewportIds[0]);
  const resetSearch = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_13__["default"])(() => {
    onSearchChange('');
  });
  (0,_hooks_useInputFocusOnOpen__WEBPACK_IMPORTED_MODULE_11__["default"])(searchRef, isOpen && activeKey === CHAT_LIST_SLIDE, resetSearch);
  (0,_hooks_useInputFocusOnOpen__WEBPACK_IMPORTED_MODULE_11__["default"])(topicSearchRef, isOpen && activeKey === TOPIC_LIST_SLIDE);
  const selectTopicsById = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_13__["default"])(global => {
    if (!forumId) {
      return undefined;
    }
    return (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTopics)(global, forumId);
  });
  const forumTopicsById = (0,_hooks_data_useSelector__WEBPACK_IMPORTED_MODULE_9__["default"])(selectTopicsById);
  const [topicIds, topics] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    const chatsById = global.chats.byId;
    const chatFullInfoById = global.chats.fullInfoById;
    const chat = chatsById[forumId];
    if (!chat || !forumTopicsById) {
      return [undefined, undefined];
    }
    const searchTitle = topicSearch.toLowerCase();
    const result = forumTopicsById ? Object.values(forumTopicsById).reduce((acc, topic) => {
      if ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getCanPostInChat)(chat, topic, undefined, chatFullInfoById[forumId]) && (!searchTitle || topic.title.toLowerCase().includes(searchTitle))) {
        acc[topic.id] = topic;
      }
      return acc;
    }, {}) : forumTopicsById;
    return [Object.keys(result).map(Number), result];
  }, [forumId, topicSearch, forumTopicsById]);
  const handleHeaderBackClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_13__["default"])(() => {
    setForumId(undefined);
    setTopicSearch('');
  });
  const handleSearchChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_13__["default"])(e => {
    onSearchChange(e.currentTarget.value);
  });
  const handleTopicSearchChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_13__["default"])(e => {
    setTopicSearch(e.currentTarget.value);
  });
  const handleKeyDown = (0,_hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_12__["default"])(containerRef, isOpen, index => {
    if (viewportIds && viewportIds.length > 0) {
      const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
      const chatId = viewportIds[index === -1 ? 0 : index];
      const chat = chatsById[chatId];
      if (chat?.isForum) {
        if (!forumTopicsById) loadTopics({
          chatId
        });
        setForumId(chatId);
      } else {
        onSelectChatOrUser(chatId);
      }
    }
  }, `.${ITEM_CLASS_NAME}`, true);
  const handleTopicKeyDown = (0,_hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_12__["default"])(topicContainerRef, isOpen, index => {
    if (topicIds?.length) {
      onSelectChatOrUser(forumId, topicIds[index === -1 ? 0 : index]);
    }
  }, `.${ITEM_CLASS_NAME}`, true);
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_13__["default"])(chatId => {
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    const chat = chatsById?.[chatId];
    if (chat?.isForum) {
      if (!forumTopicsById) loadTopics({
        chatId
      });
      setForumId(chatId);
      resetSearch();
    } else {
      onSelectChatOrUser(chatId);
    }
  });
  const renderChatItem = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((id, index) => {
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    const peer = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectPeer)(global, id);
    if (!peer) {
      return undefined;
    }
    const isSelf = peer && !(0,_global_helpers_peers__WEBPACK_IMPORTED_MODULE_4__.isApiPeerChat)(peer) ? peer.isSelf : undefined;
    function getSubtitle() {
      if (!peer) return undefined;
      if (peer.id === currentUserId) return [lang('SavedMessagesInfo')];
      if ((0,_global_helpers_peers__WEBPACK_IMPORTED_MODULE_4__.isApiPeerChat)(peer)) {
        return [(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getGroupStatus)(lang, peer)];
      }
      const userStatus = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUserStatus)(global, peer.id);
      return [(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserStatus)(lang, peer, userStatus), (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserOnline)(peer, userStatus, true) && 'online')];
    }
    const [subtitle, subtitleClassName] = getSubtitle() || [];
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PickerItem__WEBPACK_IMPORTED_MODULE_25__["default"], {
      key: id,
      className: ITEM_CLASS_NAME,
      title: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_FullNameTitle__WEBPACK_IMPORTED_MODULE_22__["default"], {
        peer: peer,
        isSavedMessages: isSelf
      }),
      avatarElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Avatar__WEBPACK_IMPORTED_MODULE_21__["default"], {
        peer: peer,
        isSavedMessages: isSelf,
        size: "medium"
      }),
      subtitle: subtitle,
      subtitleClassName: subtitleClassName,
      ripple: true,
      style: `top: ${(viewportOffset + index) * _config__WEBPACK_IMPORTED_MODULE_2__.PEER_PICKER_ITEM_HEIGHT_PX}px;`
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => handleClick(id)
    });
  }, [currentUserId, lang, viewportOffset]);
  function renderTopicList() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header",
      dir: lang.isRtl ? 'rtl' : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: lang('Back'),
      onClick: handleHeaderBackClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_23__["default"], {
      name: "arrow-left"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_17__["default"], {
      ref: topicSearchRef,
      value: topicSearch,
      onChange: handleTopicSearchChange,
      onKeyDown: handleTopicKeyDown,
      placeholder: searchPlaceholder
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_16__["default"], {
      ref: topicContainerRef,
      className: "picker-list custom-scroll",
      items: topicIds,
      withAbsolutePositioning: true,
      maxHeight: (topicIds?.length || 0) * TOPIC_ITEM_HEIGHT_PX,
      onKeyDown: handleTopicKeyDown
    }, !topicIds && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_18__["default"], null), topicIds?.map((topicId, i) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PickerItem__WEBPACK_IMPORTED_MODULE_25__["default"], {
      key: `${forumId}_${topicId}`,
      className: ITEM_CLASS_NAME
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => onSelectChatOrUser(forumId, topicId),
      style: `top: ${(viewportOffset + i) * TOPIC_ITEM_HEIGHT_PX}px;`,
      avatarElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_TopicIcon__WEBPACK_IMPORTED_MODULE_24__["default"], {
        size: TOPIC_ICON_SIZE,
        topic: topics[topicId],
        className: "topic-icon",
        letterClassName: "topic-icon-letter"
      }),
      title: (0,_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(topics[topicId].title)
    }))));
  }
  function renderChatList() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header",
      dir: lang.isRtl ? 'rtl' : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: lang('Close'),
      onClick: onClose
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_23__["default"], {
      name: "close"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_17__["default"], {
      ref: searchRef,
      value: search,
      onChange: handleSearchChange,
      onKeyDown: handleKeyDown,
      placeholder: searchPlaceholder
    })), viewportIds?.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_16__["default"], {
      ref: containerRef,
      className: "picker-list custom-scroll",
      items: viewportIds,
      itemSelector: `.${ITEM_CLASS_NAME}`,
      onLoadMore: getMore,
      withAbsolutePositioning: true,
      maxHeight: chatOrUserIds.length * _config__WEBPACK_IMPORTED_MODULE_2__.PEER_PICKER_ITEM_HEIGHT_PX,
      onKeyDown: handleKeyDown
    }, viewportIds.map(renderChatItem)) : viewportIds && !viewportIds.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "no-results"
    }, lang('lng_blocked_list_not_found')) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_18__["default"], null));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_19__["default"], {
    isOpen: isOpen,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])('ChatOrUserPicker', className),
    onClose: onClose,
    onCloseAnimationEnd: onCloseAnimationEnd
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_20__["default"], {
    activeKey: activeKey,
    name: "slideFade",
    slideClassName: "ChatOrUserPicker_slide"
  }, () => {
    return activeKey === TOPIC_LIST_SLIDE ? renderTopicList() : renderChatList();
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ChatOrUserPicker));

/***/ }),

/***/ "./src/components/common/pickers/ItemPicker.tsx":
/*!******************************************************!*\
  !*** ./src/components/common/pickers/ItemPicker.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useInfiniteScroll */ "./src/hooks/useInfiniteScroll.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_Radio__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Radio */ "./src/components/ui/Radio.tsx");
/* harmony import */ var _icons_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _PickerItem__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./PickerItem */ "./src/components/common/pickers/PickerItem.tsx");
/* harmony import */ var _PickerStyles_module_scss__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./PickerStyles.module.scss */ "./src/components/common/pickers/PickerStyles.module.scss");















// Focus slows down animation, also it breaks transition layout in Chrome
const FOCUS_DELAY_MS = 500;
const ITEM_CLASS_NAME = 'ItemPickerItem';
const ItemPicker = ({
  className,
  isSearchable,
  searchInputId,
  items,
  filterValue,
  notFoundText,
  isLoading,
  noScrollRestore,
  filterPlaceholder,
  isViewOnly,
  itemInputType,
  itemClassName,
  withDefaultPadding,
  forceRenderAllItems,
  onFilterChange,
  onDisabledClick,
  onLoadMore,
  ...optionalProps
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const allowMultiple = optionalProps.allowMultiple;
  const lockedSelectedValues = allowMultiple ? optionalProps.lockedSelectedValues : undefined;
  const lockedUnselectedValues = allowMultiple ? optionalProps.lockedUnselectedValues : undefined;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isSearchable) return undefined;
    const timeoutId = window.setTimeout(() => {
      (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_1__.requestMeasure)(() => {
        inputRef.current?.focus();
      });
    }, FOCUS_DELAY_MS);
    return () => {
      window.clearTimeout(timeoutId);
    };
  }, [isSearchable]);
  const selectedValues = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (allowMultiple) {
      return optionalProps.selectedValues;
    }
    return optionalProps.selectedValue ? [optionalProps.selectedValue] : _util_memo__WEBPACK_IMPORTED_MODULE_3__.MEMO_EMPTY_ARRAY;
  }, [allowMultiple, optionalProps.selectedValue, optionalProps.selectedValues]);
  const lockedSelectedValuesSet = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => new Set(lockedSelectedValues), [lockedSelectedValues]);
  const lockedUnselectedValuesSet = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => new Set(lockedUnselectedValues), [lockedUnselectedValues]);
  const sortedItemValuesList = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (filterValue) {
      return items.map(item => item.value);
    }
    const lockedSelectedBucket = [];
    const unlockedBucket = [];
    const lockedUnselectableBucket = [];
    items.forEach(item => {
      if (lockedSelectedValuesSet.has(item.value)) {
        lockedSelectedBucket.push(item);
      } else if (lockedUnselectedValuesSet.has(item.value)) {
        lockedUnselectableBucket.push(item);
      } else {
        unlockedBucket.push(item);
      }
    });
    return lockedSelectedBucket.concat(unlockedBucket, lockedUnselectableBucket).map(item => item.value);
  }, [filterValue, items, lockedSelectedValuesSet, lockedUnselectedValuesSet]);
  const handleItemClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(value => {
    if (allowMultiple) {
      const newSelectedValues = selectedValues.slice();
      const index = newSelectedValues.indexOf(value);
      if (index >= 0) {
        newSelectedValues.splice(index, 1);
      } else {
        newSelectedValues.push(value);
      }
      optionalProps.onSelectedValuesChange?.(newSelectedValues);
      return;
    }
    optionalProps.onSelectedValueChange?.(value);
  });
  const [viewportValuesList, getMore] = (0,_hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_4__["default"])(onLoadMore, sortedItemValuesList, Boolean(forceRenderAllItems || filterValue));
  const handleFilterChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(e => {
    const {
      value
    } = e.currentTarget;
    onFilterChange?.(value);
  });
  const renderItem = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    const item = items.find(itemOption => itemOption.value === value);
    if (!item) return undefined;
    const {
      label,
      subLabel,
      isLoading: isItemLoading
    } = item;
    const isAlwaysUnselected = lockedUnselectedValuesSet.has(value);
    const isAlwaysSelected = lockedSelectedValuesSet.has(value);
    const isLocked = isAlwaysUnselected || isAlwaysSelected;
    const isChecked = selectedValues.includes(value);
    function getInputElement() {
      if (isLocked) return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
        name: "lock-badge"
      });
      if (itemInputType === 'radio') {
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Radio__WEBPACK_IMPORTED_MODULE_11__["default"], {
          checked: isChecked,
          disabled: isLocked,
          isLoading: isItemLoading,
          onlyInput: true
        });
      }
      if (itemInputType === 'checkbox') {
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_7__["default"], {
          checked: isChecked,
          disabled: isLocked,
          isLoading: isItemLoading,
          onlyInput: true
        });
      }
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PickerItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
      key: value,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(ITEM_CLASS_NAME, itemClassName),
      title: label,
      subtitle: subLabel,
      disabled: isLocked,
      inactive: isViewOnly,
      ripple: true,
      inputElement: getInputElement()
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => handleItemClick(value)
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onDisabledClick: onDisabledClick && (() => onDisabledClick(value, isAlwaysSelected))
    });
  }, [items, lockedUnselectedValuesSet, lockedSelectedValuesSet, selectedValues, isViewOnly, onDisabledClick, itemInputType, itemClassName]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_PickerStyles_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].container, className)
  }, isSearchable && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_PickerStyles_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].header, 'custom-scroll'),
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_9__["default"], {
    id: searchInputId,
    ref: inputRef,
    value: filterValue,
    onChange: handleFilterChange,
    placeholder: filterPlaceholder || lang('Search')
  })), viewportValuesList?.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_8__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_PickerStyles_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].pickerList, withDefaultPadding && _PickerStyles_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].padded, 'custom-scroll'),
    items: viewportValuesList,
    itemSelector: `.${ITEM_CLASS_NAME}`,
    onLoadMore: getMore,
    noScrollRestore: noScrollRestore
  }, viewportValuesList.map(value => renderItem(value))) : !isLoading && viewportValuesList && !viewportValuesList.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _PickerStyles_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].noResults
  }, notFoundText || lang('SearchEmptyViewTitle')) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_10__["default"], null));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ItemPicker));

/***/ }),

/***/ "./src/components/common/reactions/ReactionEmoji.tsx":
/*!***********************************************************!*\
  !*** ./src/components/common/reactions/ReactionEmoji.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useContextMenuHandlers */ "./src/hooks/useContextMenuHandlers.ts");
/* harmony import */ var _hooks_useCoordsInSharedCanvas__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useCoordsInSharedCanvas */ "./src/hooks/useCoordsInSharedCanvas.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useMediaTransitionDeprecated */ "./src/hooks/useMediaTransitionDeprecated.ts");
/* harmony import */ var _AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../AnimatedIconWithPreview */ "./src/components/common/AnimatedIconWithPreview.tsx");
/* harmony import */ var _CustomEmoji__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../CustomEmoji */ "./src/components/common/CustomEmoji.tsx");
/* harmony import */ var _ReactionEmoji_module_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./ReactionEmoji.module.scss */ "./src/components/common/reactions/ReactionEmoji.module.scss");













const ReactionEmoji = ({
  reaction,
  availableReactions,
  isSelected,
  loadAndPlay,
  observeIntersection,
  sharedCanvasRef,
  sharedCanvasHqRef,
  forcePlayback,
  onClick,
  onContextMenu
}) => {
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const isCustom = reaction.type === 'custom';
  const availableReaction = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => availableReactions?.find(available => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isSameReaction)(available.reaction, reaction)), [availableReactions, reaction]);
  const thumbDataUri = availableReaction?.staticIcon?.thumbnail?.dataUri;
  const animationId = availableReaction?.selectAnimation?.id;
  const coords = (0,_hooks_useCoordsInSharedCanvas__WEBPACK_IMPORTED_MODULE_6__["default"])(ref, sharedCanvasRef);
  const mediaData = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_8__["default"])(availableReaction?.selectAnimation ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getDocumentMediaHash)(availableReaction.selectAnimation, 'full') : undefined, !animationId);
  const {
    isContextMenuOpen,
    handleBeforeContextMenu,
    handleContextMenu,
    handleContextMenuClose,
    handleContextMenuHide
  } = (0,_hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_5__["default"])(ref, reaction.type !== 'paid', undefined, undefined, undefined, true);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isContextMenuOpen) {
      onContextMenu?.(reaction);
      handleContextMenuClose();
      handleContextMenuHide();
    }
  }, [handleContextMenuClose, onContextMenu, handleContextMenuHide, isContextMenuOpen, reaction]);
  const tgsUrl = reaction.type === 'paid' ? _helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_4__.LOCAL_TGS_URLS.StarReaction : mediaData;
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    onClick(reaction);
  });
  const transitionClassNames = (0,_hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_9__["default"])(mediaData);
  const fullClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_ReactionEmoji_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].root, isSelected && _ReactionEmoji_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].selected, !isCustom && 'sticker-reaction');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: ref,
    className: fullClassName,
    onClick: handleClick,
    title: availableReaction?.title,
    "data-sticker-id": isCustom ? reaction.documentId : undefined,
    onMouseDown: handleBeforeContextMenu,
    onContextMenu: handleContextMenu
  }, isCustom ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_CustomEmoji__WEBPACK_IMPORTED_MODULE_11__["default"], {
    ref: ref,
    documentId: reaction.documentId,
    size: _config__WEBPACK_IMPORTED_MODULE_1__.EMOJI_SIZE_PICKER,
    noPlay: !loadAndPlay,
    observeIntersectionForPlaying: observeIntersection,
    sharedCanvasRef: sharedCanvasRef,
    sharedCanvasHqRef: sharedCanvasHqRef,
    withTranslucentThumb: true,
    forceAlways: forcePlayback
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_10__["default"], {
    tgsUrl: tgsUrl,
    thumbDataUri: thumbDataUri,
    play: loadAndPlay,
    noLoop: false,
    size: _config__WEBPACK_IMPORTED_MODULE_1__.EMOJI_SIZE_PICKER,
    isLowPriority: true,
    className: transitionClassNames,
    sharedCanvas: sharedCanvasRef.current || undefined,
    sharedCanvasCoords: coords,
    forceAlways: forcePlayback
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ReactionEmoji));

/***/ }),

/***/ "./src/components/left/ArchivedChats.tsx":
/*!***********************************************!*\
  !*** ./src/components/left/ArchivedChats.tsx ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _story_helpers_ribbonAnimation__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../story/helpers/ribbonAnimation */ "./src/components/story/helpers/ribbonAnimation.ts");
/* harmony import */ var _hooks_useForumPanelRender__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useForumPanelRender */ "./src/hooks/useForumPanelRender.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _main_hooks_useLeftHeaderButtonRtlForumTransition__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./main/hooks/useLeftHeaderButtonRtlForumTransition */ "./src/components/left/main/hooks/useLeftHeaderButtonRtlForumTransition.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _story_StoryRibbon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../story/StoryRibbon */ "./src/components/story/StoryRibbon.tsx");
/* harmony import */ var _story_StoryToggler__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../story/StoryToggler */ "./src/components/story/StoryToggler.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/DropdownMenu */ "./src/components/ui/DropdownMenu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _main_ChatList__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./main/ChatList */ "./src/components/left/main/ChatList.tsx");
/* harmony import */ var _main_ForumPanel__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./main/ForumPanel */ "./src/components/left/main/ForumPanel.tsx");
/* harmony import */ var _ArchivedChats_scss__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./ArchivedChats.scss */ "./src/components/left/ArchivedChats.scss");




















const ArchivedChats = ({
  isActive,
  isForumPanelOpen,
  archiveSettings,
  isStoryRibbonShown,
  onReset,
  onTopicSearch,
  onSettingsScreenSelect,
  onLeftColumnContentChange,
  foldersDispatch
}) => {
  const {
    updateArchiveSettings
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__["default"])({
    isActive,
    onBack: onReset
  });
  const handleDisplayArchiveInChats = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    updateArchiveSettings({
      isHidden: false
    });
  });
  const {
    shouldDisableDropdownMenuTransitionRef,
    handleDropdownMenuTransitionEnd
  } = (0,_main_hooks_useLeftHeaderButtonRtlForumTransition__WEBPACK_IMPORTED_MODULE_10__["default"])(isForumPanelOpen);
  const {
    shouldRender: shouldRenderTitle,
    transitionClassNames: titleClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_9__["default"])(!isForumPanelOpen);
  const {
    shouldRenderForumPanel,
    handleForumPanelAnimationEnd,
    handleForumPanelAnimationStart,
    isAnimationStarted
  } = (0,_hooks_useForumPanelRender__WEBPACK_IMPORTED_MODULE_5__["default"])(isForumPanelOpen);
  const isForumPanelVisible = isForumPanelOpen && isAnimationStarted;
  const {
    shouldRender: shouldRenderStoryRibbon,
    transitionClassNames: storyRibbonClassNames,
    isClosing: isStoryRibbonClosing
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_9__["default"])(isStoryRibbonShown, undefined, undefined, '', false, _story_helpers_ribbonAnimation__WEBPACK_IMPORTED_MODULE_4__.ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_END_DELAY);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ArchivedChats"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('left-header', !shouldRenderStoryRibbon && 'left-header-shadow')
  }, lang.isRtl && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "DropdownMenuFiller"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    round: true,
    size: "smaller",
    color: "translucent",
    onClick: onReset,
    ariaLabel: "Return to chat list",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(lang.isRtl && 'rtl', isForumPanelVisible && lang.isRtl && 'right-aligned', shouldDisableDropdownMenuTransitionRef.current && lang.isRtl && 'disable-transition'),
    onTransitionEnd: handleDropdownMenuTransitionEnd
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
    name: "arrow-left"
  })), shouldRenderTitle && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: titleClassNames
  }, lang('ArchivedChats')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "story-toggler-wrapper"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_story_StoryToggler__WEBPACK_IMPORTED_MODULE_13__["default"], {
    canShow: true,
    isArchived: true
  })), archiveSettings.isHidden && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_15__["default"], {
    className: "archived-chats-more-menu",
    positionX: "right",
    onTransitionEnd: lang.isRtl ? handleDropdownMenuTransitionEnd : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "archive-from-main",
    onClick: handleDisplayArchiveInChats
  }, lang('lng_context_archive_to_list')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('chat-list-wrapper', shouldRenderStoryRibbon && 'with-story-ribbon', storyRibbonClassNames)
  }, shouldRenderStoryRibbon && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_story_StoryRibbon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isArchived: true,
    className: "left-header-shadow",
    isClosing: isStoryRibbonClosing
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_main_ChatList__WEBPACK_IMPORTED_MODULE_17__["default"], {
    folderType: "archived",
    isActive: isActive,
    isForumPanelOpen: isForumPanelVisible,
    onSettingsScreenSelect: onSettingsScreenSelect,
    onLeftColumnContentChange: onLeftColumnContentChange,
    foldersDispatch: foldersDispatch,
    archiveSettings: archiveSettings
  })), shouldRenderForumPanel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_main_ForumPanel__WEBPACK_IMPORTED_MODULE_18__["default"], {
    isOpen: isForumPanelOpen,
    onTopicSearch: onTopicSearch,
    onOpenAnimationStart: handleForumPanelAnimationStart,
    onCloseAnimationEnd: handleForumPanelAnimationEnd
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ArchivedChats));

/***/ }),

/***/ "./src/components/left/ChatFolderModal.tsx":
/*!*************************************************!*\
  !*** ./src/components/left/ChatFolderModal.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/helpers/renderTextWithEntities */ "./src/components/common/helpers/renderTextWithEntities.tsx");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/CheckboxGroup */ "./src/components/ui/CheckboxGroup.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ChatFolderModal_module_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ChatFolderModal.module.scss */ "./src/components/left/ChatFolderModal.module.scss");










const ChatFolderModal = ({
  isOpen,
  chatId,
  foldersById,
  folderOrderedIds,
  onClose,
  onCloseAnimationEnd
}) => {
  const {
    editChatFolders
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const initialSelectedFolderIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!foldersById) {
      return [];
    }
    return Object.keys(foldersById).reduce((result, folderId) => {
      const {
        includedChatIds,
        pinnedChatIds
      } = foldersById[Number(folderId)];
      if (includedChatIds.includes(chatId) || pinnedChatIds?.includes(chatId)) {
        result.push(folderId);
      }
      return result;
    }, []);
  }, [chatId, foldersById]);
  const [selectedFolderIds, setSelectedFolderIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(initialSelectedFolderIds);
  const folders = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return folderOrderedIds?.filter(folderId => folderId !== _config__WEBPACK_IMPORTED_MODULE_2__.ALL_FOLDER_ID).map(folderId => {
      const folder = foldersById ? foldersById[folderId] : undefined;
      const label = folder ? (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_4__.renderTextWithEntities)({
        text: folder.title.text,
        entities: folder.title.entities,
        noCustomEmojiPlayback: folder.noTitleAnimations
      }) : '';
      return {
        label,
        value: String(folderId)
      };
    }) || [];
  }, [folderOrderedIds, foldersById]);
  const handleSubmit = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const idsToRemove = initialSelectedFolderIds.filter(id => !selectedFolderIds.includes(id)).map(Number);
    const idsToAdd = selectedFolderIds.filter(id => !initialSelectedFolderIds.includes(id)).map(Number);
    editChatFolders({
      chatId,
      idsToRemove,
      idsToAdd
    });
    onClose();
  }, [chatId, editChatFolders, initialSelectedFolderIds, onClose, selectedFolderIds]);
  if (!foldersById || !folderOrderedIds) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_8__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    onCloseAnimationEnd: onCloseAnimationEnd,
    onEnter: handleSubmit,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_ChatFolderModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].root, 'delete'),
    contentClassName: _ChatFolderModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].modalContent,
    title: lang('FilterAddTo')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_ChatFolderModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].main, 'custom-scroll')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_7__["default"], {
    options: folders,
    selected: selectedFolderIds,
    onChange: setSelectedFolderIds
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatFolderModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].footer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    color: "primary",
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleSubmit
  }, lang('FilterAddTo')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onClose
  }, lang('Cancel')))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    byId: foldersById,
    orderedIds: folderOrderedIds
  } = global.chatFolders;
  return {
    foldersById,
    folderOrderedIds
  };
})(ChatFolderModal)));

/***/ }),

/***/ "./src/components/left/MuteChatModal.tsx":
/*!***********************************************!*\
  !*** ./src/components/left/MuteChatModal.tsx ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");







var MuteDuration = /*#__PURE__*/function (MuteDuration) {
  MuteDuration["OneHour"] = "3600";
  MuteDuration["FourHours"] = "14400";
  MuteDuration["EightHours"] = "28800";
  MuteDuration["OneDay"] = "86400";
  MuteDuration["ThreeDays"] = "259200";
  MuteDuration["Forever"] = "-1";
  return MuteDuration;
}(MuteDuration || {});
const MuteChatModal = ({
  isOpen,
  chatId,
  topicId,
  onClose,
  onCloseAnimationEnd
}) => {
  const [muteUntilOption, setMuteUntilOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(MuteDuration.Forever);
  const {
    updateChatMutedState,
    updateTopicMutedState
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const muteForOptions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => [{
    label: lang('MuteFor.Hours', 1),
    value: MuteDuration.OneHour
  }, {
    label: lang('MuteFor.Hours', 4),
    value: MuteDuration.FourHours
  }, {
    label: lang('MuteFor.Hours', 8),
    value: MuteDuration.EightHours
  }, {
    label: lang('MuteFor.Days', 1),
    value: MuteDuration.OneDay
  }, {
    label: lang('MuteFor.Days', 3),
    value: MuteDuration.ThreeDays
  }, {
    label: lang('MuteFor.Forever'),
    value: MuteDuration.Forever
  }], [lang]);
  const handleSubmit = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    let muteUntil;
    if (muteUntilOption === MuteDuration.Forever) {
      muteUntil = _config__WEBPACK_IMPORTED_MODULE_2__.MAX_INT_32;
    } else {
      muteUntil = Math.floor(Date.now() / 1000) + Number(muteUntilOption);
    }
    if (topicId) {
      updateTopicMutedState({
        chatId,
        topicId,
        muteUntil
      });
    } else {
      updateChatMutedState({
        chatId,
        muteUntil
      });
    }
    onClose();
  }, [chatId, muteUntilOption, onClose, topicId]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_5__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    onCloseAnimationEnd: onCloseAnimationEnd,
    onEnter: handleSubmit,
    className: "delete",
    title: lang('Notifications')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_6__["default"], {
    name: "muteFor",
    options: muteForOptions,
    selected: muteUntilOption,
    onChange: setMuteUntilOption
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_4__["default"], {
    color: "primary",
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleSubmit
  }, lang('Common.Done')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_4__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onClose
  }, lang('Cancel'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(MuteChatModal));

/***/ }),

/***/ "./src/components/left/main/ContactList.tsx":
/*!**************************************************!*\
  !*** ./src/components/left/main/ContactList.tsx ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useInfiniteScroll */ "./src/hooks/useInfiniteScroll.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");














const ContactList = ({
  isActive,
  filter,
  usersById,
  userStatusesById,
  contactIds,
  onReset
}) => {
  const {
    openChat,
    openNewContactDialog
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_4__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onReset
  });
  const handleClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(id => {
    openChat({
      id,
      shouldReplaceHistory: true
    });
  }, [openChat]);
  const listIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!contactIds) {
      return undefined;
    }
    const filteredIds = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.filterUsersByName)(contactIds, usersById, filter);
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.sortUserIds)(filteredIds, usersById, userStatusesById);
  }, [contactIds, filter, usersById, userStatusesById]);
  const [viewportIds, getMore] = (0,_hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_6__["default"])(undefined, listIds, Boolean(filter));
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_11__["default"], {
    items: viewportIds,
    onLoadMore: getMore,
    className: "chat-list custom-scroll"
  }, viewportIds?.length ? viewportIds.map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    key: id,
    className: "chat-item-clickable contact-list-item"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleClick(id)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__["default"], {
    userId: id,
    forceShowSelf: true,
    avatarSize: "large",
    withStory: true,
    storyViewerOrigin: _types__WEBPACK_IMPORTED_MODULE_2__.StoryViewerOrigin.ChatList,
    ripple: !isMobile
  }))) : viewportIds && !viewportIds.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "no-results",
    key: "no-results",
    dir: "auto"
  }, filter.length ? 'No contacts matched your search.' : 'Contact list is empty.') : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_13__["default"], {
    key: "loading"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_10__["default"], {
    key: "create-new-contact",
    isShown: true,
    onClick: openNewContactDialog,
    ariaLabel: lang('CreateNewContact')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "add-user-filled"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    userIds: contactIds
  } = global.contactList || {};
  const {
    byId: usersById,
    statusesById: userStatusesById
  } = global.users;
  return {
    usersById,
    userStatusesById,
    contactIds
  };
})(ContactList)));

/***/ }),

/***/ "./src/components/left/main/StatusPickerMenu.tsx":
/*!*******************************************************!*\
  !*** ./src/components/left/main/StatusPickerMenu.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/CustomEmojiPicker */ "./src/components/common/CustomEmojiPicker.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_Portal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/Portal */ "./src/components/ui/Portal.ts");
/* harmony import */ var _StatusPickerMenu_module_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./StatusPickerMenu.module.scss */ "./src/components/left/main/StatusPickerMenu.module.scss");








const StatusPickerMenu = ({
  isOpen,
  statusButtonRef,
  areFeaturedStickersLoaded,
  isTranslucent,
  onEmojiStatusSelect,
  onClose
}) => {
  const {
    loadFeaturedEmojiStickers
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const transformOriginX = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const [isContextMenuShown, markContextMenuShown, unmarkContextMenuShown] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_3__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    transformOriginX.current = statusButtonRef.current.getBoundingClientRect().right;
  }, [isOpen, statusButtonRef]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && !areFeaturedStickersLoaded) {
      loadFeaturedEmojiStickers();
    }
  }, [areFeaturedStickersLoaded, isOpen, loadFeaturedEmojiStickers]);
  const handleEmojiSelect = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(sticker => {
    onEmojiStatusSelect(sticker);
    onClose();
  }, [onClose, onEmojiStatusSelect]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Portal__WEBPACK_IMPORTED_MODULE_6__["default"], null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_5__["default"], {
    isOpen: isOpen,
    noCompact: true,
    positionX: "right",
    bubbleClassName: _StatusPickerMenu_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].menuContent,
    onClose: onClose,
    transformOriginX: transformOriginX.current,
    noCloseOnBackdrop: isContextMenuShown
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_4__["default"], {
    idPrefix: "status-emoji-set-",
    loadAndPlay: isOpen,
    isHidden: !isOpen,
    isStatusPicker: true,
    isTranslucent: isTranslucent,
    onContextMenuOpen: markContextMenuShown,
    onContextMenuClose: unmarkContextMenuShown,
    onCustomEmojiSelect: handleEmojiSelect,
    onContextMenuClick: onClose
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    areFeaturedStickersLoaded: Boolean(global.customEmojis.featuredIds?.length),
    isTranslucent: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectIsContextMenuTranslucent)(global)
  };
})(StatusPickerMenu)));

/***/ }),

/***/ "./src/components/left/newChat/NewChat.tsx":
/*!*************************************************!*\
  !*** ./src/components/left/newChat/NewChat.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _NewChatStep1__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./NewChatStep1 */ "./src/components/left/newChat/NewChatStep1.tsx");
/* harmony import */ var _NewChatStep2__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./NewChatStep2 */ "./src/components/left/newChat/NewChatStep2.tsx");
/* harmony import */ var _NewChat_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./NewChat.scss */ "./src/components/left/newChat/NewChat.scss");







const RENDER_COUNT = Object.keys(_types__WEBPACK_IMPORTED_MODULE_1__.LeftColumnContent).length / 2;
const NewChat = ({
  isActive,
  isChannel = false,
  content,
  onContentChange,
  onReset
}) => {
  const [newChatMemberIds, setNewChatMemberIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const handleNextStep = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onContentChange(isChannel ? _types__WEBPACK_IMPORTED_MODULE_1__.LeftColumnContent.NewChannelStep2 : _types__WEBPACK_IMPORTED_MODULE_1__.LeftColumnContent.NewGroupStep2);
  }, [isChannel, onContentChange]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_3__["default"], {
    id: "NewChat",
    name: _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.LAYERS_ANIMATION_NAME,
    renderCount: RENDER_COUNT,
    activeKey: content
  }, isStepActive => {
    switch (content) {
      case _types__WEBPACK_IMPORTED_MODULE_1__.LeftColumnContent.NewChannelStep1:
      case _types__WEBPACK_IMPORTED_MODULE_1__.LeftColumnContent.NewGroupStep1:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_NewChatStep1__WEBPACK_IMPORTED_MODULE_4__["default"], {
          isChannel: isChannel,
          isActive: isActive,
          selectedMemberIds: newChatMemberIds,
          onSelectedMemberIdsChange: setNewChatMemberIds,
          onNextStep: handleNextStep,
          onReset: onReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_1__.LeftColumnContent.NewChannelStep2:
      case _types__WEBPACK_IMPORTED_MODULE_1__.LeftColumnContent.NewGroupStep2:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_NewChatStep2__WEBPACK_IMPORTED_MODULE_5__["default"], {
          isChannel: isChannel,
          isActive: isStepActive && isActive,
          memberIds: newChatMemberIds,
          onReset: onReset
        });
      default:
        return undefined;
    }
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(NewChat));

/***/ }),

/***/ "./src/components/left/newChat/NewChatStep1.tsx":
/*!******************************************************!*\
  !*** ./src/components/left/newChat/NewChatStep1.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/helpers/sortChatIds */ "./src/components/common/helpers/sortChatIds.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");












const NewChatStep1 = ({
  isChannel,
  isActive,
  selectedMemberIds,
  localContactIds,
  searchQuery,
  isSearching,
  localPeerIds,
  globalPeerIds,
  onSelectedMemberIdsChange,
  onNextStep,
  onReset
}) => {
  const {
    setGlobalSearchQuery
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__["default"])({
    isActive,
    onBack: onReset
  });
  const handleFilterChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(query => {
    setGlobalSearchQuery({
      query
    });
  }, []);
  const displayedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    // No need for expensive global updates on users, so we avoid them
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    const foundContactIds = localContactIds ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.filterUsersByName)(localContactIds, usersById, searchQuery) : [];
    return (0,_common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_5__["default"])((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.unique)([...foundContactIds, ...(localPeerIds || []), ...(globalPeerIds || [])]).filter(contactId => {
      const user = usersById[contactId];
      return user && !user.isSelf && (user.canBeInvitedToGroup || !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserBot)(user));
    }), false, selectedMemberIds);
  }, [localContactIds, searchQuery, localPeerIds, globalPeerIds, selectedMemberIds]);
  const handleNextStep = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setGlobalSearchQuery({
      query: ''
    });
    onNextStep();
  }, [onNextStep]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "NewChat step-1"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "left-header"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    round: true,
    size: "smaller",
    color: "translucent",
    onClick: onReset,
    ariaLabel: "Return to Chat List"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "arrow-left"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, lang('GroupAddMembers'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "NewChat-inner step-1"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_9__["default"], {
    itemIds: displayedIds,
    selectedIds: selectedMemberIds,
    filterValue: searchQuery,
    filterPlaceholder: lang('SendMessageTo'),
    searchInputId: "new-group-picker-search",
    isLoading: isSearching,
    isSearchable: true,
    allowMultiple: true,
    withStatus: true,
    itemInputType: "checkbox",
    withDefaultPadding: true,
    onSelectedIdsChange: onSelectedMemberIdsChange,
    onFilterChange: handleFilterChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isShown: true,
    onClick: handleNextStep,
    ariaLabel: isChannel ? 'Continue To Channel Info' : 'Continue To Group Info'
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "arrow-right"
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    userIds: localContactIds
  } = global.contactList || {};
  const {
    query: searchQuery,
    fetchingStatus,
    globalResults,
    localResults
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).globalSearch;
  const {
    peerIds: globalPeerIds
  } = globalResults || {};
  const {
    peerIds: localPeerIds
  } = localResults || {};
  return {
    localContactIds,
    searchQuery,
    isSearching: fetchingStatus?.chats,
    globalPeerIds,
    localPeerIds
  };
})(NewChatStep1)));

/***/ }),

/***/ "./src/components/left/newChat/NewChatStep2.tsx":
/*!******************************************************!*\
  !*** ./src/components/left/newChat/NewChatStep2.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/AvatarEditable */ "./src/components/ui/AvatarEditable.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");















const MAX_MEMBERS_FOR_GENERATE_CHAT_NAME = 4;
const NewChatStep2 = ({
  isChannel,
  isActive,
  memberIds,
  maxGroupSize,
  creationProgress,
  creationError,
  onReset
}) => {
  const {
    createGroupChat,
    createChannel
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onReset
  });
  const [title, setTitle] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [about, setAbout] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [photo, setPhoto] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [error, setError] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const chatTitleEmptyError = 'Chat title can\'t be empty';
  const channelTitleEmptyError = 'Channel title can\'t be empty';
  const chatTooManyUsersError = 'Sorry, creating supergroups is not yet supported';
  const isLoading = creationProgress === _types__WEBPACK_IMPORTED_MODULE_2__.ChatCreationProgress.InProgress;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isChannel) {
      return;
    }
    if (!memberIds.length || memberIds.length > MAX_MEMBERS_FOR_GENERATE_CHAT_NAME) {
      setTitle('');
      return;
    }
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    const usersById = global.users.byId;
    const memberFirstNames = [global.currentUserId, ...memberIds].map(userId => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFirstOrLastName)(usersById[userId])).filter(Boolean);
    const generatedChatName = memberFirstNames.slice(0, -1).join(', ') + lang('CreateGroup.PeersTitleLastDelimeter') + memberFirstNames[memberFirstNames.length - 1];
    setTitle(generatedChatName);
  }, [isChannel, memberIds, lang]);
  const handleTitleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const {
      value
    } = e.currentTarget;
    const newValue = value.replace(/^\s+/, '');
    setTitle(newValue);
    if (newValue !== value) {
      e.currentTarget.value = newValue;
    }
  }, []);
  const handleDescriptionChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setAbout(e.currentTarget.value);
  }, []);
  const handleCreateGroup = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!title.length) {
      setError(chatTitleEmptyError);
      return;
    }
    if (maxGroupSize && memberIds.length >= maxGroupSize) {
      setError(chatTooManyUsersError);
      return;
    }
    createGroupChat({
      title,
      photo,
      memberIds
    });
  }, [title, memberIds, maxGroupSize, createGroupChat, photo]);
  const handleCreateChannel = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!title.length) {
      setError(channelTitleEmptyError);
      return;
    }
    createChannel({
      title,
      about,
      photo,
      memberIds
    });
  }, [title, createChannel, about, photo, memberIds, channelTitleEmptyError]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (creationProgress === _types__WEBPACK_IMPORTED_MODULE_2__.ChatCreationProgress.Complete) {
      onReset(true);
    }
  }, [creationProgress, onReset]);
  const renderedError = creationError && lang(creationError) || (error !== chatTitleEmptyError && error !== channelTitleEmptyError ? error : undefined);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "NewChat"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "left-header"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    round: true,
    size: "smaller",
    color: "translucent"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onReset(),
    ariaLabel: "Return to member selection"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
    name: "arrow-left"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, lang(isChannel ? 'NewChannel' : 'NewGroup'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "NewChat-inner step-2"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_9__["default"], {
    onChange: setPhoto,
    title: lang('AddPhoto')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_12__["default"], {
    value: title,
    onChange: handleTitleChange,
    label: lang(isChannel ? 'EnterChannelName' : 'GroupName'),
    error: error === chatTitleEmptyError || error === channelTitleEmptyError ? error : undefined
  }), isChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_12__["default"], {
    value: about,
    onChange: handleDescriptionChange,
    label: lang('DescriptionOptionalPlaceholder')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "note"
  }, lang('DescriptionInfo'))), renderedError && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "error"
  }, renderedError), memberIds.length > 0 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "chat-members-heading"
  }, lang('GroupInfo.ParticipantCount', memberIds.length, 'i')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "chat-members-list custom-scroll"
  }, memberIds.map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
    inactive: true,
    className: "chat-item-clickable"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_8__["default"], {
    userId: id
  })))))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isShown: title.length !== 0,
    onClick: isChannel ? handleCreateChannel : handleCreateGroup,
    disabled: isLoading,
    ariaLabel: isChannel ? lang('ChannelIntro.CreateChannel') : 'Create Group'
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_14__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
    name: "arrow-right"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    progress: creationProgress,
    error: creationError
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global).chatCreation || {};
  return {
    creationProgress,
    creationError,
    maxGroupSize: global.config?.maxGroupSize
  };
})(NewChatStep2)));

/***/ }),

/***/ "./src/components/left/search/AudioResults.tsx":
/*!*****************************************************!*\
  !*** ./src/components/left/search/AudioResults.tsx ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/keys/searchResultKey */ "./src/util/keys/searchResultKey.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _helpers_createMapStateToProps__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./helpers/createMapStateToProps */ "./src/components/left/search/helpers/createMapStateToProps.ts");
/* harmony import */ var _helpers_getSenderName__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./helpers/getSenderName */ "./src/components/left/search/helpers/getSenderName.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../right/hooks/useAsyncRendering */ "./src/components/right/hooks/useAsyncRendering.ts");
/* harmony import */ var _common_Audio__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/Audio */ "./src/components/common/Audio.tsx");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");

















const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_8__.throttle)(cb => cb(), 500, true);
const AudioResults = ({
  theme,
  isVoice,
  searchQuery,
  isLoading,
  chatsById,
  usersById,
  globalMessagesByChatId,
  foundIds,
  activeDownloads
}) => {
  const {
    searchMessagesGlobal,
    focusMessage,
    openAudioPlayer
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const currentType = isVoice ? 'voice' : 'audio';
  const handleLoadMore = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards) {
      runThrottled(() => {
        searchMessagesGlobal({
          type: currentType
        });
      });
    }
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps -- `searchQuery` is required to prevent infinite message loading
  }, [currentType, searchMessagesGlobal, searchQuery]);
  const foundMessages = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!foundIds || !globalMessagesByChatId) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_7__.MEMO_EMPTY_ARRAY;
    }
    return foundIds.map(id => {
      const [chatId, messageId] = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_6__.parseSearchResultKey)(id);
      return globalMessagesByChatId[chatId]?.byId[messageId];
    }).filter(Boolean);
  }, [globalMessagesByChatId, foundIds]);
  const handleMessageFocus = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(message => {
    focusMessage({
      chatId: message.chatId,
      messageId: message.id
    });
  }, [focusMessage]);
  const handlePlayAudio = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((messageId, chatId) => {
    openAudioPlayer({
      chatId,
      messageId
    });
  }, [openAudioPlayer]);
  function renderList() {
    return foundMessages.map((message, index) => {
      const isFirst = index === 0;
      const shouldDrawDateDivider = isFirst || (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.toYearMonth)(message.date) !== (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.toYearMonth)(foundMessages[index - 1].date);
      const media = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getMessageDownloadableMedia)(message);
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, shouldDrawDateDivider && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
        className: "section-heading",
        key: message.date,
        dir: lang.isRtl ? 'rtl' : undefined
      }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatMonthAndYear)(lang, new Date(message.date * 1000))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: "ListItem small-icon",
        key: message.id
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Audio__WEBPACK_IMPORTED_MODULE_13__["default"], {
        key: message.id,
        theme: theme,
        message: message,
        origin: _types__WEBPACK_IMPORTED_MODULE_2__.AudioOrigin.Search,
        senderTitle: (0,_helpers_getSenderName__WEBPACK_IMPORTED_MODULE_10__.getSenderName)(lang, message, chatsById, usersById),
        date: message.date,
        className: "scroll-item",
        onPlay: handlePlayAudio,
        onDateClick: handleMessageFocus,
        canDownload: !chatsById[message.chatId]?.isProtected && !message.isProtected,
        isDownloading: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getIsDownloading)(activeDownloads, media)
      })));
    });
  }
  const canRenderContents = (0,_right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_12__["default"])([searchQuery], _config__WEBPACK_IMPORTED_MODULE_3__.SLIDE_TRANSITION_DURATION) && !isLoading;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "LeftSearch--content"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_15__["default"], {
    className: "search-content documents-list custom-scroll",
    items: canRenderContents ? foundMessages : undefined,
    onLoadMore: handleLoadMore,
    noFastList: true
  }, !canRenderContents && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_16__["default"], null), canRenderContents && (!foundIds || foundIds.length === 0) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_14__["default"], {
    text: lang('ChatList.Search.NoResults'),
    description: lang('ChatList.Search.NoResultsDescription')
  }), canRenderContents && foundIds && foundIds.length > 0 && renderList()));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((0,_helpers_createMapStateToProps__WEBPACK_IMPORTED_MODULE_9__.createMapStateToProps)('audio'))(AudioResults)));

/***/ }),

/***/ "./src/components/left/search/BotAppResults.tsx":
/*!******************************************************!*\
  !*** ./src/components/left/search/BotAppResults.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../right/hooks/useAsyncRendering */ "./src/components/right/hooks/useAsyncRendering.ts");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_Link__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Link */ "./src/components/ui/Link.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _LeftSearchResultChat__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./LeftSearchResultChat */ "./src/components/left/search/LeftSearchResultChat.tsx");















const LESS_LIST_ITEMS_AMOUNT = 5;
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_6__.throttle)(cb => cb(), 500, true);
const BotAppResults = ({
  searchQuery,
  isLoading,
  foundIds,
  recentBotIds
}) => {
  const {
    searchPopularBotApps,
    openChatWithInfo
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [shouldShowMoreMine, setShouldShowMoreMine] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const filteredFoundIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!foundIds) return [];
    const recentSet = new Set(recentBotIds);
    const withoutRecent = foundIds.filter(id => !recentSet.has(id));
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.filterUsersByName)(withoutRecent, usersById, searchQuery);
  }, [foundIds, recentBotIds, searchQuery]);
  const handleChatClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(id => {
    openChatWithInfo({
      id,
      shouldReplaceHistory: true
    });
  });
  const handleLoadMore = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards) {
      runThrottled(() => {
        searchPopularBotApps();
      });
    }
  }, []);
  const handleToggleShowMoreMine = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    setShouldShowMoreMine(prev => !prev);
  });
  const canRenderContents = (0,_right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_9__["default"])([searchQuery], _config__WEBPACK_IMPORTED_MODULE_3__.SLIDE_TRANSITION_DURATION) && !isLoading;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: "LeftSearch--content"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: "search-content custom-scroll",
    items: canRenderContents ? filteredFoundIds : undefined,
    onLoadMore: handleLoadMore,
    noFastList: true
  }, !canRenderContents && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_13__["default"], null), canRenderContents && !filteredFoundIds?.length && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_10__["default"], {
    text: lang('ChatList.Search.NoResults'),
    description: lang('ChatList.Search.NoResultsDescription')
  }), canRenderContents && !searchQuery && Boolean(recentBotIds?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "search-section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading"
  }, recentBotIds.length > LESS_LIST_ITEMS_AMOUNT && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Link__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: "Link",
    onClick: handleToggleShowMoreMine
  }, lang(shouldShowMoreMine ? 'ChatList.Search.ShowLess' : 'ChatList.Search.ShowMore')), lang('SearchAppsMine')), recentBotIds.map((id, index) => {
    if (!shouldShowMoreMine && index >= LESS_LIST_ITEMS_AMOUNT) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_LeftSearchResultChat__WEBPACK_IMPORTED_MODULE_14__["default"], {
      chatId: id,
      onClick: handleChatClick,
      withOpenAppButton: true
    });
  })), canRenderContents && filteredFoundIds?.length && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "search-section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading"
  }, lang('SearchAppsPopular')), filteredFoundIds.map(id => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_LeftSearchResultChat__WEBPACK_IMPORTED_MODULE_14__["default"], {
      chatId: id,
      onClick: handleChatClick,
      withOpenAppButton: true
    });
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const globalSearch = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global).globalSearch;
  const foundIds = globalSearch.popularBotApps?.peerIds;
  return {
    isLoading: !foundIds && globalSearch.fetchingStatus?.botApps,
    foundIds,
    recentBotIds: global.topBotApps.userIds
  };
})(BotAppResults)));

/***/ }),

/***/ "./src/components/left/search/ChatMessage.tsx":
/*!****************************************************!*\
  !*** ./src/components/left/search/ChatMessage.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/renderMessageText */ "./src/components/common/helpers/renderMessageText.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useSelectWithEnter__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useSelectWithEnter */ "./src/hooks/useSelectWithEnter.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_FullNameTitle__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/FullNameTitle */ "./src/components/common/FullNameTitle.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Link__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/Link */ "./src/components/ui/Link.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ChatMessage_scss__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./ChatMessage.scss */ "./src/components/left/search/ChatMessage.scss");


















const ChatMessage = ({
  message,
  searchQuery,
  chatId,
  chat,
  privateChatUser
}) => {
  const {
    focusMessage
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const mediaThumbnail = !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageSticker)(message) ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageMediaThumbDataUri)(message) : undefined;
  const mediaBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_9__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageMediaHash)(message, 'micro'));
  const isRoundVideo = Boolean((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageRoundVideo)(message));
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    focusMessage({
      chatId,
      messageId: message.id,
      shouldReplaceHistory: true
    });
  });
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const buttonRef = (0,_hooks_useSelectWithEnter__WEBPACK_IMPORTED_MODULE_11__["default"])(handleClick);
  if (!chat) {
    return undefined;
  }
  const peer = privateChatUser || chat;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    className: "ChatMessage chat-item-clickable",
    ripple: !isMobile,
    onClick: handleClick,
    buttonRef: buttonRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_12__["default"], {
    peer: peer,
    isSavedMessages: privateChatUser?.isSelf
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "info"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "info-row"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_FullNameTitle__WEBPACK_IMPORTED_MODULE_13__["default"], {
    peer: peer,
    withEmojiStatus: true,
    isSavedMessages: chatId === privateChatUser?.id && privateChatUser?.isSelf
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "message-date"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Link__WEBPACK_IMPORTED_MODULE_15__["default"], {
    className: "date"
  }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatPastTimeShort)(lang, message.date * 1000)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "subtitle"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "message",
    dir: "auto"
  }, renderSummary(lang, message, mediaBlobUrl || mediaThumbnail, searchQuery, isRoundVideo)))));
};
function renderSummary(lang, message, blobUrl, searchQuery, isRoundVideo) {
  if (!blobUrl) {
    return (0,_common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_6__.renderMessageSummary)(lang, message, undefined, searchQuery);
  }
  const isSpoiler = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageIsSpoiler)(message);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "media-preview"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: blobUrl,
    alt: "",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('media-preview--image', isRoundVideo && 'round', isSpoiler && 'media-preview-spoiler'),
    draggable: false
  }), (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageVideo)(message) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "play"
  }), (0,_common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_6__.renderMessageSummary)(lang, message, true, searchQuery));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId);
  if (!chat) {
    return {};
  }
  const privateChatUserId = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getPrivateChatUserId)(chat);
  const privateChatUser = privateChatUserId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, privateChatUserId) : undefined;
  return {
    chat,
    ...(privateChatUserId && {
      privateChatUser
    })
  };
})(ChatMessage)));

/***/ }),

/***/ "./src/components/left/search/ChatMessageResults.tsx":
/*!***********************************************************!*\
  !*** ./src/components/left/search/ChatMessageResults.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/keys/searchResultKey */ "./src/util/keys/searchResultKey.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/helpers/renderMessageText */ "./src/components/common/helpers/renderMessageText.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ChatMessage__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./ChatMessage */ "./src/components/left/search/ChatMessage.tsx");
/* harmony import */ var _DateSuggest__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./DateSuggest */ "./src/components/left/search/DateSuggest.tsx");
/* harmony import */ var _LeftSearchResultTopic__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./LeftSearchResultTopic */ "./src/components/left/search/LeftSearchResultTopic.tsx");















const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_6__.throttle)(cb => cb(), 500, true);
const ChatMessageResults = ({
  searchQuery,
  dateSearchQuery,
  foundIds,
  globalMessagesByChatId,
  chatsById,
  fetchingStatus,
  foundTopicIds,
  searchChatId,
  onSearchDateSelect,
  onReset
}) => {
  const {
    searchMessagesGlobal,
    openThread
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const handleLoadMore = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards) {
      runThrottled(() => {
        searchMessagesGlobal({
          type: 'text'
        });
      });
    }
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps -- `searchQuery` is required to prevent infinite message loading
  }, [searchQuery]);
  const handleTopicClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(id => {
    if (!searchChatId) return;
    openThread({
      chatId: searchChatId,
      threadId: id,
      shouldReplaceHistory: true
    });
    if (!isMobile) {
      onReset();
    }
  }, [searchChatId, isMobile, onReset]);
  const foundMessages = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!foundIds || foundIds.length === 0) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_5__.MEMO_EMPTY_ARRAY;
    }
    return foundIds.map(id => {
      const [chatId, messageId] = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_4__.parseSearchResultKey)(id);
      return globalMessagesByChatId?.[chatId]?.byId[messageId];
    }).filter(Boolean).sort((a, b) => b.date - a.date);
  }, [foundIds, globalMessagesByChatId]);
  function renderFoundMessage(message) {
    const text = (0,_common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_7__.renderMessageSummary)(lang, message);
    const chat = chatsById[message.chatId];
    if (!text || !chat) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatMessage__WEBPACK_IMPORTED_MODULE_12__["default"], {
      chatId: message.chatId,
      message: message,
      searchQuery: searchQuery
    });
  }
  const nothingFound = fetchingStatus && !fetchingStatus.chats && !fetchingStatus.messages && !foundMessages.length && !foundTopicIds?.length;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "LeftSearch--content"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: "search-content custom-scroll chat-list",
    items: foundMessages,
    onLoadMore: handleLoadMore,
    noFastList: true
  }, dateSearchQuery && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "chat-selection no-scrollbar"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_DateSuggest__WEBPACK_IMPORTED_MODULE_13__["default"], {
    searchDate: dateSearchQuery,
    onSelect: onSearchDateSelect
  })), nothingFound && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_10__["default"], {
    text: lang('ChatList.Search.NoResults'),
    description: lang('ChatList.Search.NoResultsDescription')
  }), Boolean(foundTopicIds?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "pb-2"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading topic-search-heading",
    dir: lang.isRtl ? 'auto' : undefined
  }, lang('Topics')), foundTopicIds.map(id => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_LeftSearchResultTopic__WEBPACK_IMPORTED_MODULE_14__["default"], {
      chatId: searchChatId,
      topicId: id,
      onClick: handleTopicClick
    });
  })), Boolean(foundMessages.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "pb-2"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading topic-search-heading",
    dir: lang.isRtl ? 'auto' : undefined
  }, lang('SearchMessages')), foundMessages.map(renderFoundMessage))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    byId: chatsById
  } = global.chats;
  const {
    currentUserId,
    messages: {
      byChatId: globalMessagesByChatId
    }
  } = global;
  const {
    fetchingStatus,
    resultsByType,
    foundTopicIds,
    chatId: searchChatId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).globalSearch;
  const {
    foundIds
  } = resultsByType?.text || {};
  return {
    currentUserId,
    foundIds,
    globalMessagesByChatId,
    chatsById,
    fetchingStatus,
    foundTopicIds,
    searchChatId
  };
})(ChatMessageResults)));

/***/ }),

/***/ "./src/components/left/search/ChatResults.tsx":
/*!****************************************************!*\
  !*** ./src/components/left/search/ChatResults.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_folderManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/folderManager */ "./src/util/folderManager.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../util/keys/searchResultKey */ "./src/util/keys/searchResultKey.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/helpers/renderMessageText */ "./src/components/common/helpers/renderMessageText.ts");
/* harmony import */ var _common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/helpers/sortChatIds */ "./src/components/common/helpers/sortChatIds.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../hooks/useContextMenuHandlers */ "./src/hooks/useContextMenuHandlers.ts");
/* harmony import */ var _hooks_useEffectOnce__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../hooks/useEffectOnce */ "./src/hooks/useEffectOnce.ts");
/* harmony import */ var _hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../hooks/useHorizontalScroll */ "./src/hooks/useHorizontalScroll.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _common_PeerChip__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../common/PeerChip */ "./src/components/common/PeerChip.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_Link__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../../ui/Link */ "./src/components/ui/Link.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _ChatMessage__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./ChatMessage */ "./src/components/left/search/ChatMessage.tsx");
/* harmony import */ var _DateSuggest__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./DateSuggest */ "./src/components/left/search/DateSuggest.tsx");
/* harmony import */ var _LeftSearchResultChat__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./LeftSearchResultChat */ "./src/components/left/search/LeftSearchResultChat.tsx");
/* harmony import */ var _RecentContacts__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./RecentContacts */ "./src/components/left/search/RecentContacts.tsx");
/* harmony import */ var _ChatResults_scss__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./ChatResults.scss */ "./src/components/left/search/ChatResults.scss");



































const MIN_QUERY_LENGTH_FOR_GLOBAL_SEARCH = 4;
const LESS_LIST_ITEMS_AMOUNT = 5;
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_11__.throttle)(cb => cb(), 500, false);
const ChatResults = ({
  isChannelList,
  searchQuery,
  searchDate,
  dateSearchQuery,
  currentUserId,
  contactIds,
  accountPeerIds,
  globalPeerIds,
  foundIds,
  globalMessagesByChatId,
  fetchingStatus,
  suggestedChannelIds,
  onReset,
  onSearchDateSelect
}) => {
  const {
    openChat,
    addRecentlyFoundChatId,
    searchMessagesGlobal,
    setGlobalSearchChatId,
    loadChannelRecommendations
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const chatSelectionRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_20__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_18__["default"])();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_14__["default"])();
  const [shouldShowMoreLocal, setShouldShowMoreLocal] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [shouldShowMoreGlobal, setShouldShowMoreGlobal] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [searchContext, setSearchContext] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('all');
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_hooks_useEffectOnce__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    if (isChannelList) loadChannelRecommendations({});
  });
  const handleLoadMore = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards) {
      runThrottled(() => {
        searchMessagesGlobal({
          type: isChannelList ? 'channels' : 'text',
          context: searchContext
        });
      });
    }
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps -- `searchQuery` is required to prevent infinite message loading
  }, [searchQuery, searchContext]);
  const handleChatClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(id => {
    openChat({
      id,
      shouldReplaceHistory: true
    });
    if (id !== currentUserId) {
      addRecentlyFoundChatId({
        id
      });
    }
    if (!isMobile) {
      onReset();
    }
  }, [openChat, currentUserId, isMobile, addRecentlyFoundChatId, onReset]);
  const handlePickerItemClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(id => {
    setGlobalSearchChatId({
      id
    });
  }, [setGlobalSearchChatId]);
  function getSearchContextCaption(context) {
    if (context === 'users') return lang('PrivateChatsSearchContext');
    if (context === 'groups') return lang('GroupChatsSearchContext');
    if (context === 'channels') return lang('ChannelsSearchContext');
    return lang('AllChatsSearchContext');
  }
  const {
    isContextMenuOpen,
    contextMenuAnchor,
    handleContextMenu,
    handleContextMenuClose,
    handleContextMenuHide
  } = (0,_hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_15__["default"])(ref);
  const getRootElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_19__["default"])(() => ref.current);
  const getMenuElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_19__["default"])(() => ref.current.querySelector('.chatResultsContextMenu .bubble'));
  const getTriggerElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_19__["default"])(() => ref.current.querySelector('.menuTrigger'));
  const handleClickContext = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_19__["default"])(e => {
    handleContextMenu(e);
  });
  const itemPlaceholderClass = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])('icon', 'iconPlaceholder');
  function renderContextMenu() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_27__["default"], {
      isOpen: isContextMenuOpen,
      anchor: contextMenuAnchor,
      getTriggerElement: getTriggerElement,
      getRootElement: getRootElement,
      getMenuElement: getMenuElement,
      className: "chatResultsContextMenu",
      onClose: handleContextMenuClose,
      onCloseAnimationEnd: handleContextMenuHide,
      autoClose: true
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_28__["default"], {
      icon: searchContext === 'all' ? 'check' : undefined,
      customIcon: searchContext !== 'all' ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("i", {
        className: itemPlaceholderClass
      }) : undefined
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => setSearchContext('all')
    }, getSearchContextCaption('all')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_28__["default"], {
      icon: searchContext === 'users' ? 'check' : undefined,
      customIcon: searchContext !== 'users' ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("i", {
        className: itemPlaceholderClass
      }) : undefined
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => setSearchContext('users')
    }, getSearchContextCaption('users')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_28__["default"], {
      icon: searchContext === 'groups' ? 'check' : undefined,
      customIcon: searchContext !== 'groups' ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("i", {
        className: itemPlaceholderClass
      }) : undefined
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => setSearchContext('groups')
    }, getSearchContextCaption('groups')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_28__["default"], {
      icon: searchContext === 'channels' ? 'check' : undefined,
      customIcon: searchContext !== 'channels' ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("i", {
        className: itemPlaceholderClass
      }) : undefined
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => setSearchContext('channels')
    }, getSearchContextCaption('channels'))));
  }
  const localResults = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!isChannelList && (!searchQuery || searchQuery.startsWith('@') && searchQuery.length < 2)) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_10__.MEMO_EMPTY_ARRAY;
    }

    // No need for expensive global updates, so we avoid them
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    const orderedChatIds = (0,_util_folderManager__WEBPACK_IMPORTED_MODULE_7__.getOrderedIds)(_config__WEBPACK_IMPORTED_MODULE_3__.ALL_FOLDER_ID) ?? [];
    const filteredChatIds = orderedChatIds.filter(id => {
      if (!isChannelList) return true;
      const chat = chatsById[id];
      return chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatChannel)(chat);
    });
    const localChatIds = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.filterChatsByName)(oldLang, filteredChatIds, chatsById, searchQuery, currentUserId);
    if (isChannelList) return localChatIds;
    const contactIdsWithMe = [...(currentUserId ? [currentUserId] : []), ...(contactIds || [])];
    const localContactIds = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.filterUsersByName)(contactIdsWithMe, usersById, searchQuery, currentUserId, oldLang('SavedMessages'));
    const localPeerIds = [...localContactIds, ...localChatIds];
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_8__.unique)([...(0,_common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_13__["default"])(localPeerIds, undefined, currentUserId ? [currentUserId] : undefined), ...(0,_common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_13__["default"])(accountPeerIds || [])]);
  }, [searchQuery, oldLang, currentUserId, contactIds, accountPeerIds, isChannelList]);
  (0,_hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_17__["default"])(chatSelectionRef, !localResults.length || isChannelList, true);
  const globalResults = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!searchQuery || searchQuery.length < MIN_QUERY_LENGTH_FOR_GLOBAL_SEARCH || !globalPeerIds) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_10__.MEMO_EMPTY_ARRAY;
    }

    // No need for expensive global updates, so we avoid them
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    const filteredIds = globalPeerIds.filter(id => {
      if (!isChannelList) return true;
      const chat = chatsById[id];
      return chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatChannel)(chat);
    });
    return (0,_common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_13__["default"])(filteredIds, true);
  }, [globalPeerIds, isChannelList, searchQuery]);
  const foundMessages = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!searchQuery && !searchDate || !foundIds || foundIds.length === 0) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_10__.MEMO_EMPTY_ARRAY;
    }

    // No need for expensive global updates, so we avoid them
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    return foundIds.map(id => {
      const [chatId, messageId] = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_9__.parseSearchResultKey)(id);
      const chat = chatsById[chatId];
      if (!chat) return undefined;
      if (isChannelList && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatChannel)(chat)) return undefined;
      return globalMessagesByChatId?.[chatId]?.byId[messageId];
    }).filter(Boolean);
  }, [searchQuery, searchDate, foundIds, isChannelList, globalMessagesByChatId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!searchQuery) return;
    searchMessagesGlobal({
      type: isChannelList ? 'channels' : 'text',
      context: searchContext,
      shouldResetResultsByType: true,
      shouldCheckFetchingMessagesStatus: true
    });
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps
  }, [searchContext]);
  const handleClickShowMoreLocal = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setShouldShowMoreLocal(!shouldShowMoreLocal);
  }, [shouldShowMoreLocal]);
  const handleClickShowMoreGlobal = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setShouldShowMoreGlobal(!shouldShowMoreGlobal);
  }, [shouldShowMoreGlobal]);
  function renderFoundMessage(message) {
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    const text = (0,_common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_12__.renderMessageSummary)(oldLang, message);
    const chat = chatsById[message.chatId];
    if (!text || !chat) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatMessage__WEBPACK_IMPORTED_MODULE_30__["default"], {
      chatId: message.chatId,
      message: message,
      searchQuery: searchQuery
    });
  }
  const actualFoundIds = foundMessages;
  const nothingFound = searchContext === 'all' && fetchingStatus && !fetchingStatus.chats && !fetchingStatus.messages && !localResults.length && !globalResults.length && !actualFoundIds.length;
  const isMessagesFetching = fetchingStatus?.messages;
  if (!searchQuery && !searchDate && !isChannelList) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_RecentContacts__WEBPACK_IMPORTED_MODULE_33__["default"], {
      onReset: onReset
    });
  }
  const shouldRenderMessagesSection = searchContext === 'all' ? Boolean(actualFoundIds.length) : true;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_24__["default"], {
    className: "LeftSearch--content custom-scroll",
    items: actualFoundIds,
    onLoadMore: handleLoadMore
    // To prevent scroll jumps caused by delayed local results rendering
    ,
    noScrollRestoreOnTop: true,
    noFastList: true
  }, dateSearchQuery && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "chat-selection no-scrollbar"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_DateSuggest__WEBPACK_IMPORTED_MODULE_31__["default"], {
    searchDate: dateSearchQuery,
    onSelect: onSearchDateSelect
  })), nothingFound && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_22__["default"], {
    text: oldLang('ChatList.Search.NoResults'),
    description: oldLang('ChatList.Search.NoResultsDescription')
  }), Boolean(localResults.length) && !isChannelList && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "chat-selection no-scrollbar",
    dir: oldLang.isRtl ? 'rtl' : undefined,
    ref: chatSelectionRef
  }, localResults.map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PeerChip__WEBPACK_IMPORTED_MODULE_23__["default"], {
    peerId: id,
    className: "left-search-local-suggestion",
    onClick: handlePickerItemClick,
    clickArg: id
  }))), Boolean(localResults.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "search-section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading",
    dir: oldLang.isRtl ? 'auto' : undefined
  }, localResults.length > LESS_LIST_ITEMS_AMOUNT && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Link__WEBPACK_IMPORTED_MODULE_25__["default"], {
    className: "Link",
    onClick: handleClickShowMoreLocal
  }, oldLang(shouldShowMoreLocal ? 'ChatList.Search.ShowLess' : 'ChatList.Search.ShowMore')), oldLang(isChannelList ? 'SearchMyChannels' : 'DialogList.SearchSectionDialogs')), localResults.map((id, index) => {
    if (!shouldShowMoreLocal && index >= LESS_LIST_ITEMS_AMOUNT) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_LeftSearchResultChat__WEBPACK_IMPORTED_MODULE_32__["default"], {
      chatId: id,
      onClick: handleChatClick
    });
  })), Boolean(globalResults.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "search-section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading",
    dir: oldLang.isRtl ? 'auto' : undefined
  }, globalResults.length > LESS_LIST_ITEMS_AMOUNT && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Link__WEBPACK_IMPORTED_MODULE_25__["default"], {
    className: "Link",
    onClick: handleClickShowMoreGlobal
  }, oldLang(shouldShowMoreGlobal ? 'ChatList.Search.ShowLess' : 'ChatList.Search.ShowMore')), oldLang('DialogList.SearchSectionGlobal')), globalResults.map((id, index) => {
    if (!shouldShowMoreGlobal && index >= LESS_LIST_ITEMS_AMOUNT) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_LeftSearchResultChat__WEBPACK_IMPORTED_MODULE_32__["default"], {
      chatId: id,
      withUsername: true,
      onClick: handleChatClick
    });
  })), Boolean(suggestedChannelIds?.length) && !searchQuery && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "search-section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading",
    dir: oldLang.isRtl ? 'auto' : undefined
  }, oldLang('SearchRecommendedChannels')), suggestedChannelIds.map(id => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_LeftSearchResultChat__WEBPACK_IMPORTED_MODULE_32__["default"], {
      chatId: id,
      withUsername: true,
      onClick: handleChatClick
    });
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "menuOwner",
    ref: ref
  }, renderContextMenu(), shouldRenderMessagesSection && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "search-section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading",
    dir: oldLang.isRtl ? 'auto' : undefined
  }, !isChannelList && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Link__WEBPACK_IMPORTED_MODULE_25__["default"], {
    className: "Link menuTrigger dropDownLink",
    onClick: handleClickContext
  }, lang('SearchContextCaption', {
    type: getSearchContextCaption(searchContext)
  }, {
    withNodes: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_29__["default"], {
    name: "fade",
    shouldCleanup: true,
    activeKey: Number(isMessagesFetching),
    className: "iconContainer",
    slideClassName: "iconContainerSlide"
  }, isMessagesFetching && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_26__["default"], null), !isMessagesFetching && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_21__["default"], {
    name: "down"
  }))), oldLang('SearchMessages')), actualFoundIds.map(renderFoundMessage))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  isChannelList
}) => {
  const {
    userIds: contactIds
  } = global.contactList || {};
  const {
    currentUserId,
    messages
  } = global;
  if (!contactIds) {
    return {};
  }
  const {
    fetchingStatus,
    globalResults,
    localResults,
    resultsByType
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global).globalSearch;
  const {
    peerIds: globalPeerIds
  } = globalResults || {};
  const {
    peerIds: accountPeerIds
  } = localResults || {};
  const {
    byChatId: globalMessagesByChatId
  } = messages;
  const foundIds = resultsByType?.[isChannelList ? 'channels' : 'text']?.foundIds;
  const {
    similarChannelIds
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectSimilarChannelIds)(global, _config__WEBPACK_IMPORTED_MODULE_3__.GLOBAL_SUGGESTED_CHANNELS_ID) || {};
  return {
    currentUserId,
    contactIds,
    accountPeerIds,
    globalPeerIds,
    foundIds,
    globalMessagesByChatId,
    fetchingStatus,
    suggestedChannelIds: similarChannelIds
  };
})(ChatResults)));

/***/ }),

/***/ "./src/components/left/search/DateSuggest.tsx":
/*!****************************************************!*\
  !*** ./src/components/left/search/DateSuggest.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _DateSuggest_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./DateSuggest.scss */ "./src/components/left/search/DateSuggest.scss");




const SUGGESTION_COUNT = 8;
const DateSuggest = ({
  searchDate,
  onSelect
}) => {
  const suggestions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => getSuggestionsFromDate(searchDate), [searchDate]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("section", {
    className: "DateSuggest custom-scroll custom-scroll-x"
  }, suggestions.map(({
    date,
    text
  }) => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      onClick: () => onSelect(date),
      className: "date-item",
      key: text
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_2__["default"], {
      name: "calendar"
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, text));
  }));
};
function getSuggestionsFromDate(searchDate) {
  const hasYear = searchDate.match(/^\d{2,4}-\d{2}-\d{2}$/g);
  if (hasYear) {
    const date = new Date(searchDate);
    return [{
      date,
      text: (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_1__.formatDateToString)(date)
    }];
  }
  const suggestion = [];
  const currentDate = new Date();
  const currentYear = currentDate.getFullYear();
  const latestYear = currentDate.getTime() > new Date(`${currentYear}-${searchDate}`).getTime() ? currentYear : currentYear - 1;
  for (let i = 0; i < SUGGESTION_COUNT; i++) {
    const date = new Date(`${latestYear - i}-${searchDate}`);
    suggestion.push({
      date,
      text: (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_1__.formatDateToString)(date)
    });
  }
  return suggestion;
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(DateSuggest));

/***/ }),

/***/ "./src/components/left/search/FileResults.tsx":
/*!****************************************************!*\
  !*** ./src/components/left/search/FileResults.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/keys/searchResultKey */ "./src/util/keys/searchResultKey.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _helpers_createMapStateToProps__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./helpers/createMapStateToProps */ "./src/components/left/search/helpers/createMapStateToProps.ts");
/* harmony import */ var _helpers_getSenderName__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./helpers/getSenderName */ "./src/components/left/search/helpers/getSenderName.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../right/hooks/useAsyncRendering */ "./src/components/right/hooks/useAsyncRendering.ts");
/* harmony import */ var _common_Document__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/Document */ "./src/components/common/Document.tsx");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");


















const CURRENT_TYPE = 'documents';
const INTERSECTION_THROTTLE = 500;
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_8__.throttle)(cb => cb(), 500, true);
const FileResults = ({
  searchQuery,
  isLoading,
  chatsById,
  usersById,
  globalMessagesByChatId,
  foundIds,
  activeDownloads,
  shouldWarnAboutSvg
}) => {
  const {
    searchMessagesGlobal,
    focusMessage
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const {
    observe: observeIntersectionForMedia
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_11__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: INTERSECTION_THROTTLE
  });
  const handleLoadMore = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards) {
      runThrottled(() => {
        searchMessagesGlobal({
          type: CURRENT_TYPE
        });
      });
    }
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps -- `searchQuery` is required to prevent infinite message loading
  }, [searchQuery]);
  const foundMessages = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!foundIds || !globalMessagesByChatId) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_7__.MEMO_EMPTY_ARRAY;
    }
    return foundIds.map(id => {
      const [chatId, messageId] = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_6__.parseSearchResultKey)(id);
      const message = globalMessagesByChatId[chatId]?.byId[messageId];
      return message && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getMessageDocument)(message) ? message : undefined;
    }).filter(Boolean);
  }, [globalMessagesByChatId, foundIds]);
  const handleMessageFocus = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(message => {
    focusMessage({
      chatId: message.chatId,
      messageId: message.id
    });
  }, [focusMessage]);
  function renderList() {
    return foundMessages.map((message, index) => {
      const isFirst = index === 0;
      const shouldDrawDateDivider = isFirst || (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.toYearMonth)(message.date) !== (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.toYearMonth)(foundMessages[index - 1].date);
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, shouldDrawDateDivider && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
        className: "section-heading",
        dir: lang.isRtl ? 'rtl' : undefined,
        key: message.date
      }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatMonthAndYear)(lang, new Date(message.date * 1000))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: "ListItem small-icon",
        key: message.id
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Document__WEBPACK_IMPORTED_MODULE_14__["default"], {
        document: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getMessageDocument)(message),
        message: message,
        withDate: true,
        datetime: message.date,
        smaller: true,
        sender: (0,_helpers_getSenderName__WEBPACK_IMPORTED_MODULE_10__.getSenderName)(lang, message, chatsById, usersById),
        className: "scroll-item",
        isDownloading: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getIsDownloading)(activeDownloads, message.content.document),
        shouldWarnAboutSvg: shouldWarnAboutSvg,
        observeIntersection: observeIntersectionForMedia,
        onDateClick: handleMessageFocus
      })));
    });
  }
  const canRenderContents = (0,_right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_13__["default"])([searchQuery], _config__WEBPACK_IMPORTED_MODULE_3__.SLIDE_TRANSITION_DURATION) && !isLoading;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: "LeftSearch--content"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_16__["default"], {
    className: "search-content documents-list custom-scroll",
    items: canRenderContents ? foundMessages : undefined,
    onLoadMore: handleLoadMore,
    noFastList: true
  }, !canRenderContents && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_17__["default"], null), canRenderContents && (!foundIds || foundIds.length === 0) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_15__["default"], {
    text: lang('ChatList.Search.NoResults'),
    description: lang('ChatList.Search.NoResultsDescription')
  }), canRenderContents && foundIds && foundIds.length > 0 && renderList()));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((0,_helpers_createMapStateToProps__WEBPACK_IMPORTED_MODULE_9__.createMapStateToProps)(CURRENT_TYPE))(FileResults)));

/***/ }),

/***/ "./src/components/left/search/LeftSearch.tsx":
/*!***************************************************!*\
  !*** ./src/components/left/search/LeftSearch.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useKeyboardListNavigation */ "./src/hooks/useKeyboardListNavigation.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _ui_TabList__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/TabList */ "./src/components/ui/TabList.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _AudioResults__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./AudioResults */ "./src/components/left/search/AudioResults.tsx");
/* harmony import */ var _BotAppResults__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./BotAppResults */ "./src/components/left/search/BotAppResults.tsx");
/* harmony import */ var _ChatMessageResults__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./ChatMessageResults */ "./src/components/left/search/ChatMessageResults.tsx");
/* harmony import */ var _ChatResults__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./ChatResults */ "./src/components/left/search/ChatResults.tsx");
/* harmony import */ var _FileResults__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./FileResults */ "./src/components/left/search/FileResults.tsx");
/* harmony import */ var _LinkResults__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./LinkResults */ "./src/components/left/search/LinkResults.tsx");
/* harmony import */ var _MediaResults__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./MediaResults */ "./src/components/left/search/MediaResults.tsx");
/* harmony import */ var _LeftSearch_scss__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./LeftSearch.scss */ "./src/components/left/search/LeftSearch.scss");



















const TABS = [{
  type: _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.ChatList,
  key: 'SearchTabChats'
}, {
  type: _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.ChannelList,
  key: 'SearchTabChannels'
}, {
  type: _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.BotApps,
  key: 'SearchTabApps'
}, {
  type: _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Media,
  key: 'SearchTabMedia'
}, {
  type: _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Links,
  key: 'SearchTabLinks'
}, {
  type: _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Files,
  key: 'SearchTabFiles'
}, {
  type: _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Music,
  key: 'SearchTabMusic'
}, {
  type: _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Voice,
  key: 'SearchTabVoice'
}];
const CHAT_TABS = [{
  type: _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.ChatList,
  key: 'SearchTabMessages'
}, ...TABS.slice(3) // Skip ChatList, ChannelList and BotApps, replaced with All Messages
];
const LeftSearch = ({
  searchQuery,
  searchDate,
  isActive,
  currentContent = _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.ChatList,
  chatId,
  onReset
}) => {
  const {
    setGlobalSearchContent,
    setGlobalSearchDate
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [activeTab, setActiveTab] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentContent);
  const dateSearchQuery = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.parseDateString)(searchQuery), [searchQuery]);
  const tabs = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const arr = chatId ? CHAT_TABS : TABS;
    return arr.map(tab => ({
      ...tab,
      title: lang(tab.key)
    }));
  }, [chatId, lang]);
  const handleSwitchTab = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(index => {
    const tab = tabs[index];
    setGlobalSearchContent({
      content: tab.type
    });
    setActiveTab(index);
  });
  const handleSearchDateSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(value => {
    setGlobalSearchDate({
      date: value.getTime() / 1000
    });
  });
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onReset
  });

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const handleKeyDown = (0,_hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_6__["default"])(containerRef, isActive, undefined, '.ListItem-button', true);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "LeftSearch",
    ref: containerRef,
    onKeyDown: handleKeyDown
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_TabList__WEBPACK_IMPORTED_MODULE_9__["default"], {
    activeTab: activeTab,
    tabs: tabs,
    onSwitchTab: handleSwitchTab
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: lang.isRtl ? 'slideOptimizedRtl' : 'slideOptimized',
    renderCount: tabs.length,
    activeKey: currentContent
  }, (() => {
    switch (currentContent) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.ChatList:
      case _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.ChannelList:
        if (chatId) {
          return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatMessageResults__WEBPACK_IMPORTED_MODULE_13__["default"], {
            searchQuery: searchQuery,
            dateSearchQuery: dateSearchQuery,
            onReset: onReset,
            onSearchDateSelect: handleSearchDateSelect
          });
        }
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatResults__WEBPACK_IMPORTED_MODULE_14__["default"], {
          isChannelList: currentContent === _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.ChannelList,
          searchQuery: searchQuery,
          searchDate: searchDate,
          dateSearchQuery: dateSearchQuery,
          onReset: onReset,
          onSearchDateSelect: handleSearchDateSelect
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Media:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MediaResults__WEBPACK_IMPORTED_MODULE_17__["default"], {
          searchQuery: searchQuery
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Links:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_LinkResults__WEBPACK_IMPORTED_MODULE_16__["default"], {
          searchQuery: searchQuery
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Files:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_FileResults__WEBPACK_IMPORTED_MODULE_15__["default"], {
          searchQuery: searchQuery
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Music:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_AudioResults__WEBPACK_IMPORTED_MODULE_11__["default"], {
          key: "audio",
          searchQuery: searchQuery
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.Voice:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_AudioResults__WEBPACK_IMPORTED_MODULE_11__["default"], {
          key: "voice",
          isVoice: true,
          searchQuery: searchQuery
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.GlobalSearchContent.BotApps:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_BotAppResults__WEBPACK_IMPORTED_MODULE_12__["default"], {
          key: "botApps",
          searchQuery: searchQuery
        });
      default:
        return undefined;
    }
  })()));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    currentContent,
    chatId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).globalSearch;
  return {
    currentContent,
    chatId
  };
})(LeftSearch)));

/***/ }),

/***/ "./src/components/left/search/LeftSearchResultChat.tsx":
/*!*************************************************************!*\
  !*** ./src/components/left/search/LeftSearchResultChat.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_themeStyle__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/themeStyle */ "./src/util/themeStyle.ts");
/* harmony import */ var _hooks_useChatContextActions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useChatContextActions */ "./src/hooks/useChatContextActions.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useSelectWithEnter__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useSelectWithEnter */ "./src/hooks/useSelectWithEnter.ts");
/* harmony import */ var _common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/GroupChatInfo */ "./src/components/common/GroupChatInfo.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ChatFolderModal_async__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ChatFolderModal.async */ "./src/components/left/ChatFolderModal.async.tsx");
/* harmony import */ var _MuteChatModal_async__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../MuteChatModal.async */ "./src/components/left/MuteChatModal.async.tsx");

















const LeftSearchResultChat = ({
  chatId,
  withUsername,
  chat,
  user,
  isPinned,
  isMuted,
  canChangeFolder,
  withOpenAppButton,
  onClick
}) => {
  const {
    requestMainWebView
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isMuteModalOpen, openMuteModal, closeMuteModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [isChatFolderModalOpen, openChatFolderModal, closeChatFolderModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [shouldRenderChatFolderModal, markRenderChatFolderModal, unmarkRenderChatFolderModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [shouldRenderMuteModal, markRenderMuteModal, unmarkRenderMuteModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const handleChatFolderChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    markRenderChatFolderModal();
    openChatFolderModal();
  }, [markRenderChatFolderModal, openChatFolderModal]);
  const handleMute = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    markRenderMuteModal();
    openMuteModal();
  }, [markRenderMuteModal, openMuteModal]);
  const contextActions = (0,_hooks_useChatContextActions__WEBPACK_IMPORTED_MODULE_6__["default"])({
    chat,
    user,
    isPinned,
    isMuted,
    canChangeFolder,
    handleMute,
    handleChatFolderChange
  }, true);
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    onClick(chatId);
  });
  const handleOpenApp = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(e => {
    e.stopPropagation();
    const theme = (0,_util_themeStyle__WEBPACK_IMPORTED_MODULE_5__.extractCurrentThemeParams)();
    requestMainWebView({
      botId: chatId,
      peerId: chatId,
      theme,
      shouldMarkBotTrusted: true
    });
  });
  const buttonRef = (0,_hooks_useSelectWithEnter__WEBPACK_IMPORTED_MODULE_10__["default"])(handleClick);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: "chat-item-clickable search-result",
    onClick: handleClick,
    contextActions: contextActions,
    buttonRef: buttonRef
  }, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserId)(chatId) ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_12__["default"], {
    userId: chatId,
    withUsername: withUsername,
    withStory: true,
    avatarSize: "medium",
    storyViewerOrigin: _types__WEBPACK_IMPORTED_MODULE_2__.StoryViewerOrigin.SearchResult
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_11__["default"], {
    chatId: chatId,
    withUsername: withUsername,
    avatarSize: "medium",
    withStory: true,
    storyViewerOrigin: _types__WEBPACK_IMPORTED_MODULE_2__.StoryViewerOrigin.SearchResult
  }), withOpenAppButton && user?.hasMainMiniApp && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    className: "ChatBadge miniapp",
    pill: true,
    fluid: true,
    size: "tiny",
    onClick: handleOpenApp
  }, oldLang('BotOpen')), shouldRenderMuteModal && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MuteChatModal_async__WEBPACK_IMPORTED_MODULE_16__["default"], {
    isOpen: isMuteModalOpen,
    onClose: closeMuteModal,
    onCloseAnimationEnd: unmarkRenderMuteModal,
    chatId: chatId
  }), shouldRenderChatFolderModal && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatFolderModal_async__WEBPACK_IMPORTED_MODULE_15__["default"], {
    isOpen: isChatFolderModalOpen,
    onClose: closeChatFolderModal,
    onCloseAnimationEnd: unmarkRenderChatFolderModal,
    chatId: chatId
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  const user = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectUser)(global, chatId);
  const isPinned = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsChatPinned)(global, chatId);
  const isMuted = chat ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.selectIsChatMuted)(chat, (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectNotifySettings)(global), (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectNotifyExceptions)(global)) : undefined;
  return {
    chat,
    user,
    isPinned,
    isMuted,
    canChangeFolder: Boolean(global.chatFolders.orderedIds?.length)
  };
})(LeftSearchResultChat)));

/***/ }),

/***/ "./src/components/left/search/LeftSearchResultTopic.tsx":
/*!**************************************************************!*\
  !*** ./src/components/left/search/LeftSearchResultTopic.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useSelectWithEnter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useSelectWithEnter */ "./src/hooks/useSelectWithEnter.ts");
/* harmony import */ var _common_TopicIcon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/TopicIcon */ "./src/components/common/TopicIcon.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");








const TOPIC_ICON_SIZE = 2 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_3__.REM;
const LeftSearchResultTopic = ({
  topicId,
  topic,
  onClick
}) => {
  const handleClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onClick(topicId);
  }, [topicId, onClick]);
  const buttonRef = (0,_hooks_useSelectWithEnter__WEBPACK_IMPORTED_MODULE_5__["default"])(handleClick);
  if (!topic) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_7__["default"], {
    className: "chat-item-clickable search-result",
    onClick: handleClick,
    buttonClassName: "topic-item",
    buttonRef: buttonRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_TopicIcon__WEBPACK_IMPORTED_MODULE_6__["default"], {
    size: TOPIC_ICON_SIZE,
    topic: topic,
    className: "topic-icon",
    letterClassName: "topic-icon-letter"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    dir: "auto",
    className: "fullName"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(topic.title)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId,
  topicId
}) => {
  const topic = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTopic)(global, chatId, topicId);
  return {
    topic
  };
})(LeftSearchResultTopic)));

/***/ }),

/***/ "./src/components/left/search/LinkResults.tsx":
/*!****************************************************!*\
  !*** ./src/components/left/search/LinkResults.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/keys/searchResultKey */ "./src/util/keys/searchResultKey.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _helpers_createMapStateToProps__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./helpers/createMapStateToProps */ "./src/components/left/search/helpers/createMapStateToProps.ts");
/* harmony import */ var _helpers_getSenderName__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./helpers/getSenderName */ "./src/components/left/search/helpers/getSenderName.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../right/hooks/useAsyncRendering */ "./src/components/right/hooks/useAsyncRendering.ts");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _common_WebLink__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/WebLink */ "./src/components/common/WebLink.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");

















const CURRENT_TYPE = 'links';
const INTERSECTION_THROTTLE = 500;
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_7__.throttle)(cb => cb(), 500, true);
const LinkResults = ({
  searchQuery,
  isLoading,
  chatsById,
  usersById,
  globalMessagesByChatId,
  foundIds,
  isChatProtected
}) => {
  const {
    searchMessagesGlobal,
    focusMessage
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const {
    observe: observeIntersectionForMedia
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_10__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: INTERSECTION_THROTTLE
  });
  const handleLoadMore = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards) {
      runThrottled(() => {
        searchMessagesGlobal({
          type: CURRENT_TYPE
        });
      });
    }
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps -- `searchQuery` is required to prevent infinite message loading
  }, [searchQuery]);
  const foundMessages = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!foundIds || !globalMessagesByChatId) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_6__.MEMO_EMPTY_ARRAY;
    }
    return foundIds.map(id => {
      const [chatId, messageId] = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_5__.parseSearchResultKey)(id);
      return globalMessagesByChatId[chatId]?.byId[messageId];
    }).filter(Boolean);
  }, [globalMessagesByChatId, foundIds]);
  const handleMessageFocus = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(message => {
    focusMessage({
      chatId: message.chatId,
      messageId: message.id
    });
  }, [focusMessage]);
  function renderList() {
    return foundMessages.map((message, index) => {
      const isFirst = index === 0;
      const shouldDrawDateDivider = isFirst || (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.toYearMonth)(message.date) !== (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.toYearMonth)(foundMessages[index - 1].date);
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, shouldDrawDateDivider && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
        className: "section-heading",
        key: message.date,
        dir: lang.isRtl ? 'rtl' : undefined
      }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.formatMonthAndYear)(lang, new Date(message.date * 1000))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: "ListItem small-icon",
        dir: lang.isRtl ? 'rtl' : undefined,
        key: message.id
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_WebLink__WEBPACK_IMPORTED_MODULE_14__["default"], {
        key: message.id,
        message: message,
        senderTitle: (0,_helpers_getSenderName__WEBPACK_IMPORTED_MODULE_9__.getSenderName)(lang, message, chatsById, usersById),
        isProtected: isChatProtected || message.isProtected,
        observeIntersection: observeIntersectionForMedia,
        onMessageClick: handleMessageFocus
      })));
    });
  }
  const canRenderContents = (0,_right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_12__["default"])([searchQuery], _config__WEBPACK_IMPORTED_MODULE_3__.SLIDE_TRANSITION_DURATION) && !isLoading;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: "LeftSearch--content"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_15__["default"], {
    className: "search-content documents-list custom-scroll",
    items: canRenderContents ? foundMessages : undefined,
    onLoadMore: handleLoadMore,
    noFastList: true
  }, !canRenderContents && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_16__["default"], null), canRenderContents && (!foundIds || foundIds.length === 0) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_13__["default"], {
    text: lang('ChatList.Search.NoResults'),
    description: lang('ChatList.Search.NoResultsDescription')
  }), canRenderContents && foundIds && foundIds.length > 0 && renderList()));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((0,_helpers_createMapStateToProps__WEBPACK_IMPORTED_MODULE_8__.createMapStateToProps)(CURRENT_TYPE))(LinkResults)));

/***/ }),

/***/ "./src/components/left/search/MediaResults.tsx":
/*!*****************************************************!*\
  !*** ./src/components/left/search/MediaResults.tsx ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/keys/searchResultKey */ "./src/util/keys/searchResultKey.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _helpers_createMapStateToProps__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./helpers/createMapStateToProps */ "./src/components/left/search/helpers/createMapStateToProps.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../right/hooks/useAsyncRendering */ "./src/components/right/hooks/useAsyncRendering.ts");
/* harmony import */ var _common_Media__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/Media */ "./src/components/common/Media.tsx");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ChatMessage__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./ChatMessage */ "./src/components/left/search/ChatMessage.tsx");

















const CURRENT_TYPE = 'media';
const INTERSECTION_THROTTLE = 500;
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_7__.throttle)(cb => cb(), 500, true);
const MediaResults = ({
  searchQuery,
  isLoading,
  globalMessagesByChatId,
  foundIds,
  isChatProtected
}) => {
  const {
    searchMessagesGlobal,
    openMediaViewer
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const {
    observe: observeIntersectionForMedia
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_9__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: INTERSECTION_THROTTLE
  });
  const handleLoadMore = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards) {
      runThrottled(() => {
        searchMessagesGlobal({
          type: CURRENT_TYPE
        });
      });
    }
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps -- `searchQuery` is required to prevent infinite message loading
  }, [searchMessagesGlobal, searchQuery]);
  const foundMessages = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!foundIds || !globalMessagesByChatId) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_6__.MEMO_EMPTY_ARRAY;
    }
    return foundIds.map(id => {
      const [chatId, messageId] = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_5__.parseSearchResultKey)(id);
      return globalMessagesByChatId[chatId]?.byId[messageId];
    }).filter(Boolean);
  }, [globalMessagesByChatId, foundIds]);
  const handleSelectMedia = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((id, chatId) => {
    openMediaViewer({
      chatId,
      messageId: id,
      origin: _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.SearchResult
    });
  }, [openMediaViewer]);
  function renderGallery() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "media-list",
      dir: lang.isRtl ? 'rtl' : undefined
    }, foundMessages.map(message => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Media__WEBPACK_IMPORTED_MODULE_12__["default"], {
      key: `${message.chatId}-${message.id}`,
      idPrefix: "search-media",
      message: message,
      isProtected: isChatProtected || message.isProtected,
      observeIntersection: observeIntersectionForMedia,
      onClick: handleSelectMedia
    })));
  }
  function renderSearchResult() {
    return foundMessages.map(message => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatMessage__WEBPACK_IMPORTED_MODULE_16__["default"], {
      key: message.id,
      chatId: message.chatId,
      message: message
    }));
  }
  const canRenderContents = (0,_right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_11__["default"])([searchQuery], _config__WEBPACK_IMPORTED_MODULE_3__.SLIDE_TRANSITION_DURATION) && !isLoading;
  const isMediaGrid = canRenderContents && foundIds && foundIds.length > 0 && !searchQuery;
  const isMessageList = canRenderContents && foundIds && foundIds.length > 0 && searchQuery;
  const classNames = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('search-content custom-scroll', isMessageList && 'chat-list');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: "LeftSearch--content LeftSearch--media"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: classNames,
    items: canRenderContents ? foundMessages : undefined,
    itemSelector: !searchQuery ? '.Media' : '.ListItem',
    onLoadMore: handleLoadMore,
    noFastList: true
  }, !canRenderContents && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_15__["default"], null), canRenderContents && (!foundIds || foundIds.length === 0) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_13__["default"], {
    text: lang('ChatList.Search.NoResults'),
    description: lang('ChatList.Search.NoResultsDescription')
  }), isMediaGrid && renderGallery(), isMessageList && renderSearchResult()));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((0,_helpers_createMapStateToProps__WEBPACK_IMPORTED_MODULE_8__.createMapStateToProps)(CURRENT_TYPE))(MediaResults)));

/***/ }),

/***/ "./src/components/left/search/RecentContacts.tsx":
/*!*******************************************************!*\
  !*** ./src/components/left/search/RecentContacts.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useHorizontalScroll */ "./src/hooks/useHorizontalScroll.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _LeftSearchResultChat__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./LeftSearchResultChat */ "./src/components/left/search/LeftSearchResultChat.tsx");
/* harmony import */ var _RecentContacts_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./RecentContacts.scss */ "./src/components/left/search/RecentContacts.scss");













const SEARCH_CLOSE_TIMEOUT_MS = 250;
const NBSP = '\u00A0';
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_4__.throttle)(cb => cb(), 60000, true);
const RecentContacts = ({
  topUserIds,
  usersById,
  recentlyFoundChatIds,
  onReset
}) => {
  const {
    loadTopUsers,
    openChat,
    addRecentlyFoundChatId,
    clearRecentlyFoundChats
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const topUsersRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);

  // Due to the parent Transition, this component never gets unmounted,
  // that's why we use throttled API call on every update.
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    runThrottled(() => {
      loadTopUsers();
    });
  }, [loadTopUsers]);
  (0,_hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_6__["default"])(topUsersRef, !topUserIds);
  const handleClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(id => {
    openChat({
      id,
      shouldReplaceHistory: true
    });
    onReset();
    setTimeout(() => {
      addRecentlyFoundChatId({
        id
      });
    }, SEARCH_CLOSE_TIMEOUT_MS);
  }, [openChat, addRecentlyFoundChatId, onReset]);
  const handleClearRecentlyFoundChats = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    clearRecentlyFoundChats();
  }, [clearRecentlyFoundChats]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "RecentContacts custom-scroll"
  }, topUserIds && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "top-peers-section",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: topUsersRef,
    className: "top-peers"
  }, topUserIds.map(userId => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    key: userId,
    className: "top-peer-item",
    onClick: () => handleClick(userId),
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_8__["default"], {
    peer: usersById[userId]
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "top-peer-name"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFirstOrLastName)(usersById[userId]) || NBSP)))))), recentlyFoundChatIds && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "search-section pt-1"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('section-heading mt-0 recent-chats-header', !topUserIds && 'without-border'),
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('Recent'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "clear-recent-chats",
    round: true,
    size: "smaller",
    color: "translucent",
    ariaLabel: lang('Clear'),
    onClick: handleClearRecentlyFoundChats,
    isRtl: lang.isRtl
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    name: "close"
  }))), recentlyFoundChatIds.map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_LeftSearchResultChat__WEBPACK_IMPORTED_MODULE_11__["default"], {
    chatId: id,
    withOpenAppButton: true,
    onClick: handleClick
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    userIds: topUserIds
  } = global.topPeers;
  const usersById = global.users.byId;
  const {
    recentlyFoundChatIds
  } = global;
  return {
    topUserIds,
    usersById,
    recentlyFoundChatIds
  };
})(RecentContacts)));

/***/ }),

/***/ "./src/components/left/search/helpers/createMapStateToProps.ts":
/*!*********************************************************************!*\
  !*** ./src/components/left/search/helpers/createMapStateToProps.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   createMapStateToProps: () => (/* binding */ createMapStateToProps)
/* harmony export */ });
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");

function createMapStateToProps(type) {
  return (global, props) => {
    const tabState = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_0__.selectTabState)(global);
    const {
      byId: chatsById
    } = global.chats;
    const {
      byId: usersById
    } = global.users;
    const {
      fetchingStatus,
      resultsByType,
      chatId
    } = tabState.globalSearch;

    // One component is used for two different types of results.
    // The differences between them are only in the isVoice property.
    // The rest of the search results use their own personal components.
    const currentType = type !== 'audio' ? type : props?.isVoice ? 'voice' : 'audio';
    const {
      byChatId: globalMessagesByChatId
    } = global.messages;
    const foundIds = resultsByType?.[currentType]?.foundIds;
    const activeDownloads = tabState.activeDownloads;
    return {
      theme: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_0__.selectTheme)(global),
      isLoading: foundIds === undefined || (fetchingStatus ? Boolean(fetchingStatus.chats || fetchingStatus.messages) : false),
      chatsById,
      usersById,
      globalMessagesByChatId,
      foundIds,
      searchChatId: chatId,
      activeDownloads,
      isChatProtected: chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_0__.selectChat)(global, chatId)?.isProtected : undefined,
      shouldWarnAboutSvg: global.settings.byKey.shouldWarnAboutSvg
    };
  };
}

/***/ }),

/***/ "./src/components/left/settings/BlockUserModal.tsx":
/*!*********************************************************!*\
  !*** ./src/components/left/settings/BlockUserModal.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_ChatOrUserPicker__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/pickers/ChatOrUserPicker */ "./src/components/common/pickers/ChatOrUserPicker.tsx");







const BlockUserModal = ({
  usersById,
  blockedIds,
  contactIds,
  localContactIds,
  currentUserId,
  isOpen,
  onClose
}) => {
  const {
    setUserSearchQuery,
    blockUser
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const [search, setSearch] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setUserSearchQuery({
      query: search
    });
  }, [search, setUserSearchQuery]);
  const filteredContactIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const availableContactIds = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.unique)([...(contactIds || []), ...(localContactIds || [])].filter(contactId => {
      return contactId !== currentUserId && !blockedIds.includes(contactId);
    }));
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.filterUsersByName)(availableContactIds, usersById, search).sort((firstId, secondId) => {
      const firstName = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(usersById[firstId]) || '';
      const secondName = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(usersById[secondId]) || '';
      return firstName.localeCompare(secondName);
    });
  }, [blockedIds, contactIds, currentUserId, search, localContactIds, usersById]);
  const handleRemoveUser = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(userId => {
    blockUser({
      userId
    });
    onClose();
  }, [onClose]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_ChatOrUserPicker__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isOpen: isOpen,
    chatOrUserIds: filteredContactIds,
    searchPlaceholder: lang('BlockedUsers.BlockUser'),
    search: search,
    onSearchChange: setSearch,
    onSelectChatOrUser: handleRemoveUser,
    onClose: onClose
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    users: {
      byId: usersById
    },
    blocked: {
      ids: blockedIds
    },
    contactList,
    currentUserId
  } = global;
  return {
    usersById,
    blockedIds,
    contactIds: contactList?.userIds,
    localContactIds: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).userSearch.localUserIds,
    currentUserId
  };
})(BlockUserModal)));

/***/ }),

/***/ "./src/components/left/settings/PremiumStatusItem.tsx":
/*!************************************************************!*\
  !*** ./src/components/left/settings/PremiumStatusItem.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/icons/StarIcon */ "./src/components/common/icons/StarIcon.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");






function PremiumStatusItem({
  premiumSection
}) {
  const {
    openPremiumModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const handleOpenPremiumModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__["default"])(() => openPremiumModal({
    initialSection: premiumSection
  }));
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_5__["default"], {
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_4__["default"], {
      className: "icon ListItem-main-icon",
      type: "premium",
      size: "big"
    }),
    onClick: handleOpenPremiumModal
  }, lang('PrivacyLastSeenPremium')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description-larger premium-info",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('lng_messages_privacy_premium_about')));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PremiumStatusItem));

/***/ }),

/***/ "./src/components/left/settings/PrivacyLockedOption.tsx":
/*!**************************************************************!*\
  !*** ./src/components/left/settings/PrivacyLockedOption.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _PrivacyLockedOption_module_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./PrivacyLockedOption.module.scss */ "./src/components/left/settings/PrivacyLockedOption.module.scss");





function PrivacyLockedOption({
  label
}) {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const {
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PrivacyLockedOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].contactsAndPremiumOptionTitle,
    onClick: () => showNotification({
      message: lang('OptionPremiumRequiredMessage')
    })
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, label), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_3__["default"], {
    name: "lock-badge",
    className: _PrivacyLockedOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].lockIcon
  }));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PrivacyLockedOption));

/***/ }),

/***/ "./src/components/left/settings/PrivacyMessages.tsx":
/*!**********************************************************!*\
  !*** ./src/components/left/settings/PrivacyMessages.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");
/* harmony import */ var _PremiumStatusItem__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./PremiumStatusItem */ "./src/components/left/settings/PremiumStatusItem.tsx");
/* harmony import */ var _PrivacyLockedOption__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./PrivacyLockedOption */ "./src/components/left/settings/PrivacyLockedOption.tsx");









function PrivacyMessages({
  isActive,
  canLimitNewMessagesWithoutPremium,
  shouldNewNonContactPeersRequirePremium,
  isCurrentUserPremium,
  onReset
}) {
  const {
    updateGlobalPrivacySettings
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const canChange = isCurrentUserPremium || canLimitNewMessagesWithoutPremium;
  const options = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return [{
      value: 'everybody',
      label: lang('P2PEverybody')
    }, {
      value: 'contacts_and_premium',
      label: canChange ? lang('PrivacyMessagesContactsAndPremium') : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PrivacyLockedOption__WEBPACK_IMPORTED_MODULE_8__["default"], {
        label: lang('PrivacyMessagesContactsAndPremium')
      }),
      hidden: !canChange
    }];
  }, [lang, canChange]);
  const handleChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(privacy => {
    updateGlobalPrivacySettings({
      shouldNewNonContactPeersRequirePremium: privacy === 'contacts_and_premium'
    });
  });
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('PrivacyMessagesTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_6__["default"], {
    name: "privacy-messages",
    options: options,
    onChange: handleChange,
    selected: shouldNewNonContactPeersRequirePremium ? 'contacts_and_premium' : 'everybody'
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description-larger",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('Privacy.Messages.SectionFooter'))), !canChange && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PremiumStatusItem__WEBPACK_IMPORTED_MODULE_7__["default"], {
    premiumSection: "message_privacy"
  }));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    shouldNewNonContactPeersRequirePremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectNewNoncontactPeersRequirePremium)(global),
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectIsCurrentUserPremium)(global),
    canLimitNewMessagesWithoutPremium: global.appConfig?.canLimitNewMessagesWithoutPremium
  };
})(PrivacyMessages)));

/***/ }),

/***/ "./src/components/left/settings/Settings.tsx":
/*!***************************************************!*\
  !*** ./src/components/left/settings/Settings.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_reducers_useTwoFaReducer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/reducers/useTwoFaReducer */ "./src/hooks/reducers/useTwoFaReducer.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _folders_SettingsFolders__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./folders/SettingsFolders */ "./src/components/left/settings/folders/SettingsFolders.tsx");
/* harmony import */ var _passcode_SettingsPasscode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./passcode/SettingsPasscode */ "./src/components/left/settings/passcode/SettingsPasscode.tsx");
/* harmony import */ var _PrivacyMessages__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./PrivacyMessages */ "./src/components/left/settings/PrivacyMessages.tsx");
/* harmony import */ var _SettingsActiveSessions__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./SettingsActiveSessions */ "./src/components/left/settings/SettingsActiveSessions.tsx");
/* harmony import */ var _SettingsActiveWebsites__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./SettingsActiveWebsites */ "./src/components/left/settings/SettingsActiveWebsites.tsx");
/* harmony import */ var _SettingsCustomEmoji__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SettingsCustomEmoji */ "./src/components/left/settings/SettingsCustomEmoji.tsx");
/* harmony import */ var _SettingsDataStorage__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./SettingsDataStorage */ "./src/components/left/settings/SettingsDataStorage.tsx");
/* harmony import */ var _SettingsDoNotTranslate__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./SettingsDoNotTranslate */ "./src/components/left/settings/SettingsDoNotTranslate.tsx");
/* harmony import */ var _SettingsEditProfile__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./SettingsEditProfile */ "./src/components/left/settings/SettingsEditProfile.tsx");
/* harmony import */ var _SettingsExperimental__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./SettingsExperimental */ "./src/components/left/settings/SettingsExperimental.tsx");
/* harmony import */ var _SettingsGeneral__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./SettingsGeneral */ "./src/components/left/settings/SettingsGeneral.tsx");
/* harmony import */ var _SettingsGeneralBackground__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./SettingsGeneralBackground */ "./src/components/left/settings/SettingsGeneralBackground.tsx");
/* harmony import */ var _SettingsGeneralBackgroundColor__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./SettingsGeneralBackgroundColor */ "./src/components/left/settings/SettingsGeneralBackgroundColor.tsx");
/* harmony import */ var _SettingsHeader__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./SettingsHeader */ "./src/components/left/settings/SettingsHeader.tsx");
/* harmony import */ var _SettingsLanguage__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./SettingsLanguage */ "./src/components/left/settings/SettingsLanguage.tsx");
/* harmony import */ var _SettingsMain__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./SettingsMain */ "./src/components/left/settings/SettingsMain.tsx");
/* harmony import */ var _SettingsNotifications__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./SettingsNotifications */ "./src/components/left/settings/SettingsNotifications.tsx");
/* harmony import */ var _SettingsPerformance__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./SettingsPerformance */ "./src/components/left/settings/SettingsPerformance.tsx");
/* harmony import */ var _SettingsPrivacy__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./SettingsPrivacy */ "./src/components/left/settings/SettingsPrivacy.tsx");
/* harmony import */ var _SettingsPrivacyBlockedUsers__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./SettingsPrivacyBlockedUsers */ "./src/components/left/settings/SettingsPrivacyBlockedUsers.tsx");
/* harmony import */ var _SettingsPrivacyVisibility__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./SettingsPrivacyVisibility */ "./src/components/left/settings/SettingsPrivacyVisibility.tsx");
/* harmony import */ var _SettingsPrivacyVisibilityExceptionList__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./SettingsPrivacyVisibilityExceptionList */ "./src/components/left/settings/SettingsPrivacyVisibilityExceptionList.tsx");
/* harmony import */ var _SettingsQuickReaction__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./SettingsQuickReaction */ "./src/components/left/settings/SettingsQuickReaction.tsx");
/* harmony import */ var _SettingsStickers__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./SettingsStickers */ "./src/components/left/settings/SettingsStickers.tsx");
/* harmony import */ var _twoFa_SettingsTwoFa__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./twoFa/SettingsTwoFa */ "./src/components/left/settings/twoFa/SettingsTwoFa.tsx");
/* harmony import */ var _Settings_scss__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./Settings.scss */ "./src/components/left/settings/Settings.scss");


































const TRANSITION_RENDER_COUNT = Object.keys(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens).length / 2;
const TRANSITION_DURATION = 200;
const TWO_FA_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaDisabled, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPassword, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordHint, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaEnabled, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordCurrent, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordNew, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordHint, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaTurnOff, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCurrentPassword, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmail, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCode];
const PASSCODE_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeDisabled, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeEnabled];
const FOLDERS_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Folders, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderFromChatList, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderInvites, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChatsFromChatList, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChats, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChatsFromChatList, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersShare];
const PRIVACY_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBlockedUsers, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.ActiveWebsites];
const PRIVACY_PHONE_NUMBER_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberDeniedContacts];
const PRIVACY_LAST_SEEN_PHONE_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenDeniedContacts];
const PRIVACY_PROFILE_PHOTO_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoDeniedContacts];
const PRIVACY_BIO_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioDeniedContacts];
const PRIVACY_BIRTHDAY_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayDeniedContacts];
const PRIVACY_GIFTS_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsDeniedContacts];
const PRIVACY_PHONE_CALL_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallDeniedContacts];
const PRIVACY_PHONE_P2P_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PDeniedContacts];
const PRIVACY_FORWARDING_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingDeniedContacts];
const PRIVACY_VOICE_MESSAGES_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesDeniedContacts];
const PRIVACY_GROUP_CHATS_SCREENS = [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsAllowedContacts, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsDeniedContacts];
const Settings = ({
  isActive,
  currentScreen,
  foldersState,
  foldersDispatch,
  onScreenSelect,
  onReset,
  shouldSkipTransition
}) => {
  const {
    closeShareChatFolderModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [twoFaState, twoFaDispatch] = (0,_hooks_reducers_useTwoFaReducer__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const [privacyPasscode, setPrivacyPasscode] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const handleReset = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(forceReturnToChatList => {
    const isFromSettings = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)()).shareFolderScreen?.isFromSettings;
    if (currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersShare) {
      closeShareChatFolderModal();
    }
    if (forceReturnToChatList === true || isFromSettings !== undefined && !isFromSettings) {
      onReset(true);
      return;
    }
    if (currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder || currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder || currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderFromChatList || currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderInvites) {
      setTimeout(() => {
        foldersDispatch({
          type: 'reset'
        });
      }, TRANSITION_DURATION);
    }
    if (currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats || currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChats) {
      if (foldersState.mode === 'create') {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder);
      } else {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder);
      }
      return;
    }
    onReset();
  });
  function renderCurrentSectionContent(isScreenActive, activeScreen) {
    const privacyAllowScreens = {
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumber]: PRIVACY_PHONE_NUMBER_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen]: PRIVACY_LAST_SEEN_PHONE_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhoto]: PRIVACY_PROFILE_PHOTO_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBio]: PRIVACY_BIO_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthday]: PRIVACY_BIRTHDAY_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGifts]: PRIVACY_GIFTS_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCall]: PRIVACY_PHONE_CALL_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2P]: PRIVACY_PHONE_P2P_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwarding]: PRIVACY_FORWARDING_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages]: PRIVACY_VOICE_MESSAGES_SCREENS.includes(activeScreen),
      [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChats]: PRIVACY_GROUP_CHATS_SCREENS.includes(activeScreen)
    };
    const isTwoFaScreen = TWO_FA_SCREENS.includes(activeScreen);
    const isPasscodeScreen = PASSCODE_SCREENS.includes(activeScreen);
    const isFoldersScreen = FOLDERS_SCREENS.includes(activeScreen);
    const isPrivacyScreen = PRIVACY_SCREENS.includes(activeScreen) || isTwoFaScreen || isPasscodeScreen || Object.keys(privacyAllowScreens).map(Number).includes(activeScreen) || Object.values(privacyAllowScreens).includes(true);
    switch (currentScreen) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Main:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsMain__WEBPACK_IMPORTED_MODULE_23__["default"], {
          onScreenSelect: onScreenSelect,
          isActive: isActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.EditProfile:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsEditProfile__WEBPACK_IMPORTED_MODULE_16__["default"], {
          isActive: isActive && isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.General:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsGeneral__WEBPACK_IMPORTED_MODULE_18__["default"], {
          onScreenSelect: onScreenSelect,
          isActive: isScreenActive || activeScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.GeneralChatBackgroundColor || activeScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.GeneralChatBackground || activeScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.QuickReaction || activeScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.CustomEmoji || isPrivacyScreen || isFoldersScreen,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.QuickReaction:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsQuickReaction__WEBPACK_IMPORTED_MODULE_30__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.CustomEmoji:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsCustomEmoji__WEBPACK_IMPORTED_MODULE_13__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Notifications:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsNotifications__WEBPACK_IMPORTED_MODULE_24__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.DataStorage:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsDataStorage__WEBPACK_IMPORTED_MODULE_14__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Privacy:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPrivacy__WEBPACK_IMPORTED_MODULE_26__["default"], {
          onScreenSelect: onScreenSelect,
          isActive: isScreenActive || isPrivacyScreen,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Language:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsLanguage__WEBPACK_IMPORTED_MODULE_22__["default"], {
          isActive: isScreenActive || activeScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.DoNotTranslate,
          onReset: handleReset,
          onScreenSelect: onScreenSelect
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.DoNotTranslate:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsDoNotTranslate__WEBPACK_IMPORTED_MODULE_15__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Stickers:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsStickers__WEBPACK_IMPORTED_MODULE_31__["default"], {
          isActive: isScreenActive,
          onReset: handleReset,
          onScreenSelect: onScreenSelect
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Experimental:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsExperimental__WEBPACK_IMPORTED_MODULE_17__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.GeneralChatBackground:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsGeneralBackground__WEBPACK_IMPORTED_MODULE_19__["default"], {
          onScreenSelect: onScreenSelect,
          isActive: isScreenActive || activeScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.GeneralChatBackgroundColor,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.GeneralChatBackgroundColor:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsGeneralBackgroundColor__WEBPACK_IMPORTED_MODULE_20__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.ActiveSessions:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsActiveSessions__WEBPACK_IMPORTED_MODULE_11__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.ActiveWebsites:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsActiveWebsites__WEBPACK_IMPORTED_MODULE_12__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBlockedUsers:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPrivacyBlockedUsers__WEBPACK_IMPORTED_MODULE_27__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumber:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhoto:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBio:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthday:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGifts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCall:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwarding:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChats:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPrivacyVisibility__WEBPACK_IMPORTED_MODULE_28__["default"], {
          screen: currentScreen,
          onScreenSelect: onScreenSelect,
          isActive: isScreenActive || privacyAllowScreens[currentScreen],
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsAllowedContacts:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPrivacyVisibilityExceptionList__WEBPACK_IMPORTED_MODULE_29__["default"], {
          isAllowList: true,
          withPremiumCategory: currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsAllowedContacts,
          withMiniAppsCategory: currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsAllowedContacts,
          screen: currentScreen,
          onScreenSelect: onScreenSelect,
          isActive: isScreenActive || privacyAllowScreens[currentScreen],
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsDeniedContacts:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPrivacyVisibilityExceptionList__WEBPACK_IMPORTED_MODULE_29__["default"], {
          screen: currentScreen,
          onScreenSelect: onScreenSelect,
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyMessages:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PrivacyMessages__WEBPACK_IMPORTED_MODULE_10__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Folders:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderFromChatList:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderInvites:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChatsFromChatList:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChats:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChatsFromChatList:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersShare:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_folders_SettingsFolders__WEBPACK_IMPORTED_MODULE_8__["default"], {
          currentScreen: currentScreen,
          shownScreen: activeScreen,
          state: foldersState,
          dispatch: foldersDispatch,
          isActive: isScreenActive,
          onScreenSelect: onScreenSelect,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaDisabled:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPassword:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordConfirm:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordHint:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaEnabled:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordCurrent:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordNew:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordConfirm:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordHint:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaTurnOff:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCurrentPassword:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmail:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCode:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_twoFa_SettingsTwoFa__WEBPACK_IMPORTED_MODULE_32__["default"], {
          currentScreen: currentScreen,
          state: twoFaState,
          dispatch: twoFaDispatch,
          shownScreen: activeScreen,
          isActive: isScreenActive,
          onScreenSelect: onScreenSelect,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeDisabled:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscode:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscodeConfirm:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeCurrent:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeNew:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeConfirm:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeEnabled:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeTurnOff:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_passcode_SettingsPasscode__WEBPACK_IMPORTED_MODULE_9__["default"], {
          currentScreen: currentScreen,
          passcode: privacyPasscode,
          onSetPasscode: setPrivacyPasscode,
          shownScreen: activeScreen,
          isActive: isScreenActive,
          onScreenSelect: onScreenSelect,
          onReset: handleReset
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Performance:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPerformance__WEBPACK_IMPORTED_MODULE_25__["default"], {
          isActive: isScreenActive,
          onReset: handleReset
        });
      default:
        return undefined;
    }
  }
  function renderCurrentSection(isScreenActive, _isFrom, _currentKey, activeKey) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsHeader__WEBPACK_IMPORTED_MODULE_21__["default"], {
      currentScreen: currentScreen,
      onReset: handleReset,
      onScreenSelect: onScreenSelect,
      editedFolderId: foldersState.folderId
    }), renderCurrentSectionContent(isScreenActive, activeKey));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_7__["default"], {
    id: "Settings",
    name: shouldSkipTransition ? 'none' : _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.LAYERS_ANIMATION_NAME,
    activeKey: currentScreen,
    renderCount: TRANSITION_RENDER_COUNT,
    shouldWrap: true,
    withSwipeControl: true
  }, renderCurrentSection);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(Settings));

/***/ }),

/***/ "./src/components/left/settings/SettingsActiveSession.tsx":
/*!****************************************************************!*\
  !*** ./src/components/left/settings/SettingsActiveSession.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _helpers_getSessionIcon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./helpers/getSessionIcon */ "./src/components/left/settings/helpers/getSessionIcon.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Switcher__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Switcher */ "./src/components/ui/Switcher.tsx");
/* harmony import */ var _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./SettingsActiveSession.module.scss */ "./src/components/left/settings/SettingsActiveSession.module.scss");













const SettingsActiveSession = ({
  isOpen,
  session,
  onClose
}) => {
  const {
    changeSessionSettings,
    terminateAuthorization
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const renderingSession = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_5__["default"])(session, true);
  const handleSecretChatsStateChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    changeSessionSettings({
      hash: session.hash,
      areSecretChatsEnabled: !session.areSecretChatsEnabled
    });
  }, [changeSessionSettings, session]);
  const handleCallsStateChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    changeSessionSettings({
      hash: session.hash,
      areCallsEnabled: !session.areCallsEnabled
    });
  }, [changeSessionSettings, session]);
  const handleTerminateSessionClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    terminateAuthorization({
      hash: session.hash
    });
    onClose();
  }, [onClose, session, terminateAuthorization]);
  if (!renderingSession) {
    return undefined;
  }
  function renderHeader() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header-condensed",
      dir: lang.isRtl ? 'rtl' : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: lang('Close'),
      onClick: onClose
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
      name: "close"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-title"
    }, lang('SessionPreview.Title')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
      color: "danger",
      onClick: handleTerminateSessionClick,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('modal-action-button', _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].headerButton)
    }, lang('SessionPreview.TerminateSession')));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_10__["default"], {
    header: renderHeader(),
    isOpen: isOpen,
    hasCloseButton: true,
    onClose: onClose,
    className: _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].SettingsActiveSession
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].iconDevice, renderingSession && _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"][`iconDevice__${(0,_helpers_getSessionIcon__WEBPACK_IMPORTED_MODULE_4__["default"])(renderingSession)}`])
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].title,
    dir: "auto"
  }, renderingSession?.deviceModel), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].date,
    "aria-label": lang('PrivacySettings.LastSeen')
  }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.formatDateTimeToString)(renderingSession.dateActive * 1000, lang.code)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dl", {
    className: _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].box
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dt", null, lang('SessionPreview.App')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dd", null, renderingSession?.appName, " ", renderingSession?.appVersion, ",", ' ', renderingSession?.platform, " ", renderingSession?.systemVersion), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dt", null, lang('SessionPreview.Ip')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dd", null, renderingSession?.ip), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dt", null, lang('SessionPreview.Location')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dd", null, renderingSession && getLocation(renderingSession))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].note
  }, lang('SessionPreview.IpDesc')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].actionHeader
  }, lang('AuthSessions.View.AcceptTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    onClick: handleSecretChatsStateChange
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].actionName
  }, lang('SessionPreview.Accept.Secret')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Switcher__WEBPACK_IMPORTED_MODULE_11__["default"], {
    id: "accept_secrets",
    label: "On",
    checked: renderingSession.areSecretChatsEnabled
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    onClick: handleCallsStateChange
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _SettingsActiveSession_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].actionName
  }, lang('SessionPreview.Accept.Calls')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Switcher__WEBPACK_IMPORTED_MODULE_11__["default"], {
    id: "accept_calls",
    label: "On",
    checked: renderingSession.areCallsEnabled
  })));
};
function getLocation(session) {
  return [session.region, session.country].filter(Boolean).join(', ');
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  hash
}) => {
  return {
    session: hash ? global.activeSessions.byHash[hash] : undefined
  };
})(SettingsActiveSession)));

/***/ }),

/***/ "./src/components/left/settings/SettingsActiveSessions.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/left/settings/SettingsActiveSessions.tsx ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _helpers_getSessionIcon__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./helpers/getSessionIcon */ "./src/components/left/settings/helpers/getSessionIcon.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");
/* harmony import */ var _SettingsActiveSession__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./SettingsActiveSession */ "./src/components/left/settings/SettingsActiveSession.tsx");
/* harmony import */ var _SettingsActiveSessions_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./SettingsActiveSessions.scss */ "./src/components/left/settings/SettingsActiveSessions.scss");
/* eslint-disable react/jsx-no-bind */













const SettingsActiveSessions = ({
  isActive,
  onReset,
  byHash,
  orderedHashes,
  ttlDays
}) => {
  const {
    terminateAuthorization,
    terminateAllAuthorizations,
    changeSessionTtl
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [isConfirmTerminateAllDialogOpen, openConfirmTerminateAllDialog, closeConfirmTerminateAllDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const [openedSessionHash, setOpenedSessionHash] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [isModalOpen, openModal, closeModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const autoTerminateValue = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    // eslint-disable-next-line max-len
    // https://github.com/DrKLO/Telegram/blob/96dce2c9aabc33b87db61d830aa087b6b03fe397/TMessagesProj/src/main/java/org/telegram/ui/SessionsActivity.java#L195
    if (ttlDays === undefined) {
      return undefined;
    }
    if (ttlDays <= 7) {
      return '7';
    }
    if (ttlDays <= 30) {
      return '30';
    }
    if (ttlDays <= 93) {
      return '90';
    }
    if (ttlDays <= 183) {
      return '183';
    }
    if (ttlDays > 183) {
      return '365';
    }
    return undefined;
  }, [ttlDays]);
  const AUTO_TERMINATE_OPTIONS = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const options = [{
      label: lang('Weeks', 1, 'i'),
      value: '7'
    }, {
      label: lang('Months', 1, 'i'),
      value: '30'
    }, {
      label: lang('Months', 3, 'i'),
      value: '90'
    }, {
      label: lang('Months', 6, 'i'),
      value: '183'
    }];
    if (ttlDays && ttlDays >= 365) {
      options.push({
        label: lang('Years', 1, 'i'),
        value: '365'
      });
    }
    return options;
  }, [lang, ttlDays]);
  const handleTerminateSessionClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(hash => {
    terminateAuthorization({
      hash
    });
  }, [terminateAuthorization]);
  const handleTerminateAllSessions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeConfirmTerminateAllDialog();
    terminateAllAuthorizations();
  }, [closeConfirmTerminateAllDialog, terminateAllAuthorizations]);
  const handleOpenSessionModal = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(hash => {
    setOpenedSessionHash(hash);
    openModal();
  }, [openModal]);
  const handleCloseSessionModal = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setOpenedSessionHash(undefined);
    closeModal();
  }, [closeModal]);
  const handleChangeSessionTtl = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    changeSessionTtl({
      days: Number(value)
    });
  }, [changeSessionTtl]);
  const currentSession = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const currentSessionHash = orderedHashes.find(hash => byHash[hash].isCurrent);
    return currentSessionHash ? byHash[currentSessionHash] : undefined;
  }, [byHash, orderedHashes]);
  const otherSessionHashes = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return orderedHashes.filter(hash => !byHash[hash].isCurrent);
  }, [byHash, orderedHashes]);
  const hasOtherSessions = Boolean(otherSessionHashes.length);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onReset
  });
  function renderCurrentSession(session) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "settings-item"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
      className: "settings-item-header",
      dir: lang.isRtl ? 'rtl' : undefined
    }, lang('AuthSessions.CurrentSession')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_8__["default"], {
      narrow: true,
      inactive: true,
      icon: `device-${(0,_helpers_getSessionIcon__WEBPACK_IMPORTED_MODULE_3__["default"])(session)}`,
      iconClassName: "icon-device"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "multiline-item full-size",
      dir: "auto"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "title",
      dir: "auto"
    }, session.deviceModel), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "subtitle black tight"
    }, session.appName, " ", session.appVersion, ", ", session.platform, " ", session.systemVersion), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "subtitle"
    }, session.ip, " - ", getLocation(session)))), hasOtherSessions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_8__["default"], {
      className: "destructive mb-0 no-icon",
      icon: "stop",
      ripple: true,
      narrow: true,
      onClick: openConfirmTerminateAllDialog
    }, lang('TerminateAllSessions')));
  }
  function renderOtherSessions(sessionHashes) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "settings-item"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
      className: "settings-item-header",
      dir: lang.isRtl ? 'rtl' : undefined
    }, lang('OtherSessions')), sessionHashes.map(renderSession));
  }
  function renderAutoTerminate() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "settings-item"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
      className: "settings-item-header",
      dir: lang.isRtl ? 'rtl' : undefined
    }, lang('TerminateOldSessionHeader')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "settings-item-description-larger"
    }, lang('IfInactiveFor')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_9__["default"], {
      name: "session_ttl",
      options: AUTO_TERMINATE_OPTIONS,
      selected: autoTerminateValue,
      onChange: handleChangeSessionTtl
    }));
  }
  function renderSession(sessionHash) {
    const session = byHash[sessionHash];
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_8__["default"], {
      key: session.hash,
      ripple: true,
      narrow: true,
      contextActions: [{
        title: 'Terminate',
        icon: 'stop',
        destructive: true,
        handler: () => {
          handleTerminateSessionClick(session.hash);
        }
      }],
      icon: `device-${(0,_helpers_getSessionIcon__WEBPACK_IMPORTED_MODULE_3__["default"])(session)}`,
      iconClassName: "icon-device",
      onClick: () => {
        handleOpenSessionModal(session.hash);
      }
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "multiline-item full-size",
      dir: "auto"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "date"
    }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_2__.formatPastTimeShort)(lang, session.dateActive * 1000)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "title"
    }, session.deviceModel), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "subtitle black tight"
    }, session.appName, " ", session.appVersion, ", ", session.platform, " ", session.systemVersion), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "subtitle"
    }, session.ip, " ", getLocation(session))));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll SettingsActiveSessions"
  }, currentSession && renderCurrentSession(currentSession), hasOtherSessions && renderOtherSessions(otherSessionHashes), renderAutoTerminate(), hasOtherSessions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_7__["default"], {
    isOpen: isConfirmTerminateAllDialogOpen,
    onClose: closeConfirmTerminateAllDialog,
    text: lang('AreYouSureSessions'),
    confirmLabel: lang('TerminateAllSessions'),
    confirmHandler: handleTerminateAllSessions,
    confirmIsDestructive: true,
    areButtonsInColumn: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsActiveSession__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isOpen: isModalOpen,
    hash: openedSessionHash,
    onClose: handleCloseSessionModal
  }));
};
function getLocation(session) {
  return [session.region, session.country].filter(Boolean).join(', ');
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => global.activeSessions)(SettingsActiveSessions)));

/***/ }),

/***/ "./src/components/left/settings/SettingsActiveWebsite.tsx":
/*!****************************************************************!*\
  !*** ./src/components/left/settings/SettingsActiveWebsite.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_FullNameTitle__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/FullNameTitle */ "./src/components/common/FullNameTitle.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _SettingsActiveWebsite_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./SettingsActiveWebsite.module.scss */ "./src/components/left/settings/SettingsActiveWebsite.module.scss");











const SettingsActiveWebsite = ({
  isOpen,
  session,
  bot,
  onClose
}) => {
  const {
    terminateWebAuthorization
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const renderingSession = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_3__["default"])(session, true);
  const renderingBot = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_3__["default"])(bot, true);
  const handleTerminateSessionClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    terminateWebAuthorization({
      hash: session.hash
    });
    onClose();
  }, [onClose, session, terminateWebAuthorization]);
  if (!renderingSession) {
    return undefined;
  }
  function renderHeader() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header-condensed",
      dir: lang.isRtl ? 'rtl' : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: lang('Close'),
      onClick: onClose
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
      name: "close"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-title"
    }, lang('WebSessionsTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
      color: "danger",
      onClick: handleTerminateSessionClick,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('modal-action-button', _SettingsActiveWebsite_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].headerButton)
    }, lang('AuthSessions.LogOut')));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_9__["default"], {
    header: renderHeader(),
    isOpen: isOpen,
    hasCloseButton: true,
    onClose: onClose,
    className: _SettingsActiveWebsite_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].root
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_5__["default"], {
    className: _SettingsActiveWebsite_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].avatar,
    peer: renderingBot,
    size: "large"
  }), renderingBot && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_FullNameTitle__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: _SettingsActiveWebsite_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].title,
    peer: renderingBot
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _SettingsActiveWebsite_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].note
  }, renderingSession?.domain), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dl", {
    className: _SettingsActiveWebsite_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].box
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dt", null, lang('AuthSessions.View.Browser')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dd", null, renderingSession?.browser), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dt", null, lang('SessionPreview.Ip')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dd", null, renderingSession?.ip), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dt", null, lang('SessionPreview.Location')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("dd", null, renderingSession?.region)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _SettingsActiveWebsite_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].note
  }, lang('AuthSessions.View.LocationInfo')));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  hash
}) => {
  const session = hash ? global.activeWebSessions.byHash[hash] : undefined;
  const bot = session ? global.users.byId[session.botId] : undefined;
  return {
    session,
    bot
  };
})(SettingsActiveWebsite)));

/***/ }),

/***/ "./src/components/left/settings/SettingsActiveWebsites.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/left/settings/SettingsActiveWebsites.tsx ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_FullNameTitle__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/FullNameTitle */ "./src/components/common/FullNameTitle.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _SettingsActiveWebsite__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./SettingsActiveWebsite */ "./src/components/left/settings/SettingsActiveWebsite.tsx");
/* harmony import */ var _SettingsActiveWebsites_module_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./SettingsActiveWebsites.module.scss */ "./src/components/left/settings/SettingsActiveWebsites.module.scss");













const SettingsActiveWebsites = ({
  isActive,
  byHash,
  orderedHashes,
  onReset
}) => {
  const {
    terminateWebAuthorization,
    terminateAllWebAuthorizations
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [isConfirmTerminateAllDialogOpen, openConfirmTerminateAllDialog, closeConfirmTerminateAllDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const [openedWebsiteHash, setOpenedWebsiteHash] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [isModalOpen, openModal, closeModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const handleTerminateAuthClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(hash => {
    terminateWebAuthorization({
      hash
    });
  }, [terminateWebAuthorization]);
  const handleTerminateAllAuth = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeConfirmTerminateAllDialog();
    terminateAllWebAuthorizations();
  }, [closeConfirmTerminateAllDialog, terminateAllWebAuthorizations]);
  const handleOpenSessionModal = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(hash => {
    setOpenedWebsiteHash(hash);
    openModal();
  }, [openModal]);
  const handleCloseWebsiteModal = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setOpenedWebsiteHash(undefined);
    closeModal();
  }, [closeModal]);

  // Close when empty
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!orderedHashes.length) {
      onReset();
    }
  }, [onReset, orderedHashes]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onReset
  });
  function renderSessions(sessionHashes) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "settings-item"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
      className: "settings-item-header",
      dir: lang.isRtl ? 'rtl' : undefined
    }, lang('WebSessionsTitle')), sessionHashes.map(renderSession));
  }
  function renderSession(sessionHash) {
    const session = byHash[sessionHash];
    const bot = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId[session.botId];
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_10__["default"], {
      key: session.hash,
      ripple: true,
      narrow: true,
      contextActions: [{
        title: 'Terminate',
        icon: 'stop',
        destructive: true,
        handler: () => {
          handleTerminateAuthClick(session.hash);
        }
      }]
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => handleOpenSessionModal(session.hash)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_7__["default"], {
      className: _SettingsActiveWebsites_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].avatar,
      peer: bot,
      size: "tiny"
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "multiline-item full-size",
      dir: "auto"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "date"
    }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.formatPastTimeShort)(lang, session.dateActive * 1000)), bot && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_FullNameTitle__WEBPACK_IMPORTED_MODULE_8__["default"], {
      className: _SettingsActiveWebsites_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].title,
      peer: bot
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('subtitle', 'black', 'tight', _SettingsActiveWebsites_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].platform)
    }, session.domain, ", ", session.browser, ", ", session.platform), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('subtitle', _SettingsActiveWebsites_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].subtitle)
    }, session.ip, " ", session.region)));
  }
  if (!orderedHashes.length) return undefined;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "destructive mb-0 no-icon",
    icon: "stop",
    ripple: true,
    narrow: true,
    onClick: openConfirmTerminateAllDialog
  }, lang('AuthSessions.LogOutApplications')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('settings-item-description', _SettingsActiveWebsites_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].clearHelp)
  }, lang('ClearOtherWebSessionsHelp'))), renderSessions(orderedHashes), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_9__["default"], {
    isOpen: isConfirmTerminateAllDialogOpen,
    onClose: closeConfirmTerminateAllDialog,
    title: lang('AuthSessions.LogOutApplications'),
    text: lang('AreYouSureWebSessions'),
    confirmHandler: handleTerminateAllAuth,
    confirmIsDestructive: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsActiveWebsite__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isOpen: isModalOpen,
    hash: openedWebsiteHash,
    onClose: handleCloseWebsiteModal
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    byHash,
    orderedHashes
  } = global.activeWebSessions;
  return {
    byHash,
    orderedHashes
  };
})(SettingsActiveWebsites)));

/***/ }),

/***/ "./src/components/left/settings/SettingsCustomEmoji.tsx":
/*!**************************************************************!*\
  !*** ./src/components/left/settings/SettingsCustomEmoji.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_StickerSetCard__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/StickerSetCard */ "./src/components/common/StickerSetCard.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");










const SettingsCustomEmoji = ({
  isActive,
  customEmojiSetIds,
  stickerSetsById,
  shouldSuggestCustomEmoji,
  canPlayAnimatedEmojis,
  onReset
}) => {
  const {
    openStickerSet,
    setSettingOption
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();

  // eslint-disable-next-line no-null/no-null
  const stickerSettingsRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    observe: observeIntersectionForCovers
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_6__.useIntersectionObserver)({
    rootRef: stickerSettingsRef
  });
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onReset
  });
  const handleStickerSetClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(sticker => {
    openStickerSet({
      stickerSetInfo: sticker.stickerSetInfo
    });
  }, [openStickerSet]);
  const handleSuggestCustomEmojiChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newValue => {
    setSettingOption({
      shouldSuggestCustomEmoji: newValue
    });
  }, [setSettingOption]);
  const customEmojiSets = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => customEmojiSetIds && Object.values((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_3__.pick)(stickerSetsById, customEmojiSetIds)), [customEmojiSetIds, stickerSetsById]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, customEmojiSets && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_9__["default"], {
    label: lang('SuggestAnimatedEmoji'),
    checked: shouldSuggestCustomEmoji,
    onCheck: handleSuggestCustomEmojiChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "mt-4",
    ref: stickerSettingsRef
  }, customEmojiSets.map(stickerSet => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_StickerSetCard__WEBPACK_IMPORTED_MODULE_8__["default"], {
    key: stickerSet.id,
    stickerSet: stickerSet,
    observeIntersection: observeIntersectionForCovers,
    onClick: handleStickerSetClick,
    noPlay: !canPlayAnimatedEmojis
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mt-3",
    dir: "auto"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(lang('EmojiBotInfo'), ['links']))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    ...(0,_util_iteratees__WEBPACK_IMPORTED_MODULE_3__.pick)(global.settings.byKey, ['shouldSuggestCustomEmoji']),
    customEmojiSetIds: global.customEmojis.added.setIds,
    stickerSetsById: global.stickers.setsById,
    canPlayAnimatedEmojis: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCanPlayAnimatedEmojis)(global)
  };
})(SettingsCustomEmoji)));

/***/ }),

/***/ "./src/components/left/settings/SettingsDataStorage.tsx":
/*!**************************************************************!*\
  !*** ./src/components/left/settings/SettingsDataStorage.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_RangeSlider__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/RangeSlider */ "./src/components/ui/RangeSlider.tsx");








const SettingsDataStorage = ({
  isActive,
  onReset,
  canAutoLoadPhotoFromContacts,
  canAutoLoadPhotoInPrivateChats,
  canAutoLoadPhotoInGroups,
  canAutoLoadPhotoInChannels,
  canAutoLoadVideoFromContacts,
  canAutoLoadVideoInPrivateChats,
  canAutoLoadVideoInGroups,
  canAutoLoadVideoInChannels,
  canAutoLoadFileFromContacts,
  canAutoLoadFileInPrivateChats,
  canAutoLoadFileInGroups,
  canAutoLoadFileInChannels,
  autoLoadFileMaxSizeMb
}) => {
  const {
    setSettingOption
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__["default"])({
    isActive,
    onBack: onReset
  });
  const renderFileSizeCallback = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    return lang('AutodownloadSizeLimitUpTo', {
      limit: lang('FileSizeMB', {
        count: _config__WEBPACK_IMPORTED_MODULE_2__.AUTODOWNLOAD_FILESIZE_MB_LIMITS[value]
      })
    });
  }, [lang]);
  const handleFileSizeChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    setSettingOption({
      autoLoadFileMaxSizeMb: _config__WEBPACK_IMPORTED_MODULE_2__.AUTODOWNLOAD_FILESIZE_MB_LIMITS[value]
    });
  }, [setSettingOption]);
  function renderContentSizeSlider() {
    const value = _config__WEBPACK_IMPORTED_MODULE_2__.AUTODOWNLOAD_FILESIZE_MB_LIMITS.indexOf(autoLoadFileMaxSizeMb);
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "pt-5"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RangeSlider__WEBPACK_IMPORTED_MODULE_7__["default"], {
      label: lang('AutoDownloadMaxFileSize'),
      min: 0,
      max: 5,
      value: value !== -1 ? value : 2,
      renderValue: renderFileSizeCallback,
      onChange: handleFileSizeChange
    }));
  }
  function renderAutoDownloadBlock(title, key, canAutoLoadFromContacts, canAutoLoadInPrivateChats, canAutoLoadInGroups, canAutoLoadInChannels) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "settings-item"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
      className: "settings-item-header",
      dir: lang.isRtl ? 'rtl' : undefined
    }, title), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
      label: lang('AutoDownloadSettingsContacts'),
      checked: canAutoLoadFromContacts
      // TODO rewrite to support `useCallback`
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onCheck: isChecked => setSettingOption({
        [`canAutoLoad${key}FromContacts`]: isChecked
      })
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
      label: lang('AutoDownloadSettingsPrivateChats'),
      checked: canAutoLoadInPrivateChats
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onCheck: isChecked => setSettingOption({
        [`canAutoLoad${key}InPrivateChats`]: isChecked
      })
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
      label: lang('AutoDownloadSettingsGroupChats'),
      checked: canAutoLoadInGroups
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onCheck: isChecked => setSettingOption({
        [`canAutoLoad${key}InGroups`]: isChecked
      })
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
      label: lang('AutoDownloadSettingsChannels'),
      checked: canAutoLoadInChannels
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onCheck: isChecked => setSettingOption({
        [`canAutoLoad${key}InChannels`]: isChecked
      })
    }), key === 'File' && renderContentSizeSlider());
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, renderAutoDownloadBlock(lang('AutoDownloadPhotosTitle'), 'Photo', canAutoLoadPhotoFromContacts, canAutoLoadPhotoInPrivateChats, canAutoLoadPhotoInGroups, canAutoLoadPhotoInChannels), renderAutoDownloadBlock(lang('AutoDownloadVideosTitle'), 'Video', canAutoLoadVideoFromContacts, canAutoLoadVideoInPrivateChats, canAutoLoadVideoInGroups, canAutoLoadVideoInChannels), renderAutoDownloadBlock(lang('AutoDownloadFilesTitle'), 'File', canAutoLoadFileFromContacts, canAutoLoadFileInPrivateChats, canAutoLoadFileInGroups, canAutoLoadFileInChannels));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_3__.pick)(global.settings.byKey, ['canAutoLoadPhotoFromContacts', 'canAutoLoadPhotoInPrivateChats', 'canAutoLoadPhotoInGroups', 'canAutoLoadPhotoInChannels', 'canAutoLoadVideoFromContacts', 'canAutoLoadVideoInPrivateChats', 'canAutoLoadVideoInGroups', 'canAutoLoadVideoInChannels', 'canAutoLoadFileFromContacts', 'canAutoLoadFileInPrivateChats', 'canAutoLoadFileInGroups', 'canAutoLoadFileInChannels', 'autoLoadFileMaxSizeMb']);
})(SettingsDataStorage)));

/***/ }),

/***/ "./src/components/left/settings/SettingsDoNotTranslate.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/left/settings/SettingsDoNotTranslate.tsx ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useEffectWithPrevDeps */ "./src/hooks/useEffectWithPrevDeps.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_ItemPicker__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/pickers/ItemPicker */ "./src/components/common/pickers/ItemPicker.tsx");
/* harmony import */ var _SettingsDoNotTranslate_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./SettingsDoNotTranslate.module.scss */ "./src/components/left/settings/SettingsDoNotTranslate.module.scss");












// https://fasttext.cc/docs/en/language-identification.html
const LOCAL_SUPPORTED_DETECTION_LANGUAGES = ['af', 'als', 'am', 'an', 'ar', 'arz', 'as', 'ast', 'av', 'az', 'azb', 'ba', 'bar', 'bcl', 'be', 'bg', 'bh', 'bn', 'bo', 'bpy', 'br', 'bs', 'bxr', 'ca', 'cbk', 'ce', 'ceb', 'ckb', 'co', 'cs', 'cv', 'cy', 'da', 'de', 'diq', 'dsb', 'dty', 'dv', 'el', 'eml', 'en', 'eo', 'es', 'et', 'eu', 'fa', 'fi', 'fr', 'frr', 'fy', 'ga', 'gd', 'gl', 'gn', 'gom', 'gu', 'gv', 'he', 'hi', 'hif', 'hr', 'hsb', 'ht', 'hu', 'hy', 'ia', 'id', 'ie', 'ilo', 'io', 'is', 'it', 'ja', 'jbo', 'jv', 'ka', 'kk', 'km', 'kn', 'ko', 'krc', 'ku', 'kv', 'kw', 'ky', 'la', 'lb', 'lez', 'li', 'lmo', 'lo', 'lrc', 'lt', 'lv', 'mai', 'mg', 'mhr', 'min', 'mk', 'ml', 'mn', 'mr', 'mrj', 'ms', 'mt', 'mwl', 'my', 'myv', 'mzn', 'nah', 'nap', 'nds', 'ne', 'new', 'nl', 'nn', 'no', 'oc', 'or', 'os', 'pa', 'pam', 'pfl', 'pl', 'pms', 'pnb', 'ps', 'pt', 'qu', 'rm', 'ro', 'ru', 'rue', 'sa', 'sah', 'sc', 'scn', 'sco', 'sd', 'sh', 'si', 'sk', 'sl', 'so', 'sq', 'sr', 'su', 'sv', 'sw', 'ta', 'te', 'tg', 'th', 'tk', 'tl', 'tr', 'tt', 'tyv', 'ug', 'uk', 'ur', 'uz', 'vec', 'vep', 'vi', 'vls', 'vo', 'wa', 'war', 'wuu', 'xal', 'xmf', 'yi', 'yo', 'yue', 'zh'];
const SUPPORTED_LANGUAGES = _config__WEBPACK_IMPORTED_MODULE_2__.SUPPORTED_TRANSLATION_LANGUAGES.filter(lang => LOCAL_SUPPORTED_DETECTION_LANGUAGES.includes(lang));
const SettingsDoNotTranslate = ({
  isActive,
  doNotTranslate,
  onReset
}) => {
  const {
    setSettingOption
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const language = lang.code || 'en';
  const [displayedOptions, setDisplayedOptions] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const [searchQuery, setSearchQuery] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const displayedOptionList = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const options = SUPPORTED_LANGUAGES.map(langCode => {
      const translatedNames = new Intl.DisplayNames([language], {
        type: 'language'
      });
      const translatedName = translatedNames.of(langCode);
      const originalNames = new Intl.DisplayNames([langCode], {
        type: 'language'
      });
      const originalName = originalNames.of(langCode);
      return {
        langCode,
        translatedName,
        originalName
      };
    }).filter(Boolean).map(({
      langCode,
      translatedName,
      originalName
    }) => ({
      label: translatedName,
      subLabel: originalName,
      value: langCode
    }));
    if (!searchQuery.trim()) {
      const currentLanguageOption = options.find(option => option.value === language);
      const otherOptionList = options.filter(option => option.value !== language);
      return currentLanguageOption ? [currentLanguageOption, ...otherOptionList] : options;
    }
    return options?.filter(option => option.label.toLowerCase().includes(searchQuery.toLowerCase()));
  }, [language, searchQuery]);
  (0,_hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_5__["default"])(([prevIsActive, prevLanguage]) => {
    if (prevIsActive === isActive && prevLanguage?.find(option => option === language)) return;
    const [selected] = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.partition)(displayedOptionList, option => doNotTranslate.includes(option.value));
    setDisplayedOptions([...selected.map(option => option.value)]);
  }, [isActive, doNotTranslate, displayedOptions.length, language, displayedOptionList]);
  const handleChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(newSelectedIds => {
    setDisplayedOptions(newSelectedIds);
    setSettingOption({
      doNotTranslate: newSelectedIds
    });
  });
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_SettingsDoNotTranslate_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].root, 'settings-content infinite-scroll')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_SettingsDoNotTranslate_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].item)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_ItemPicker__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: _SettingsDoNotTranslate_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].picker,
    items: displayedOptionList,
    selectedValues: displayedOptions,
    onSelectedValuesChange: handleChange,
    filterValue: searchQuery,
    onFilterChange: setSearchQuery,
    isSearchable: true,
    allowMultiple: true,
    withDefaultPadding: true,
    itemInputType: "checkbox",
    searchInputId: "lang-picker-search"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    doNotTranslate
  } = global.settings.byKey;
  return {
    doNotTranslate
  };
})(SettingsDoNotTranslate)));

/***/ }),

/***/ "./src/components/left/settings/SettingsEditProfile.tsx":
/*!**************************************************************!*\
  !*** ./src/components/left/settings/SettingsEditProfile.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _global_selectors_limits__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../global/selectors/limits */ "./src/global/selectors/limits.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_ManageUsernames__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/ManageUsernames */ "./src/components/common/ManageUsernames.tsx");
/* harmony import */ var _common_SafeLink__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../common/SafeLink */ "./src/components/common/SafeLink.tsx");
/* harmony import */ var _common_UsernameInput__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../common/UsernameInput */ "./src/components/common/UsernameInput.tsx");
/* harmony import */ var _ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/AvatarEditable */ "./src/components/ui/AvatarEditable.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _ui_TextArea__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../ui/TextArea */ "./src/components/ui/TextArea.tsx");























const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_8__.throttle)(cb => cb(), 60000, true);
const ERROR_FIRST_NAME_MISSING = 'Please provide your first name';
const SettingsEditProfile = ({
  isActive,
  currentAvatarHash,
  currentFirstName,
  currentLastName,
  currentBio,
  progress,
  checkedUsername,
  editUsernameError,
  isUsernameAvailable,
  maxBioLength,
  usernames,
  onReset
}) => {
  const {
    loadCurrentUser,
    updateProfile
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const firstEditableUsername = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => usernames?.find(({
    isEditable
  }) => isEditable), [usernames]);
  const currentUsername = firstEditableUsername?.username || '';
  const [isUsernameTouched, setIsUsernameTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isProfileFieldsTouched, setIsProfileFieldsTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [error, setError] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [photo, setPhoto] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [firstName, setFirstName] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentFirstName || '');
  const [lastName, setLastName] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentLastName || '');
  const [bio, setBio] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentBio || '');
  const [editableUsername, setEditableUsername] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentUsername);
  const currentAvatarBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_11__["default"])(currentAvatarHash, false, _api_types__WEBPACK_IMPORTED_MODULE_2__.ApiMediaFormat.BlobUrl);
  const isLoading = progress === _types__WEBPACK_IMPORTED_MODULE_3__.ProfileEditProgress.InProgress;
  const isUsernameError = editableUsername === false;
  const previousIsUsernameAvailable = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_13__["default"])(isUsernameAvailable);
  const renderingIsUsernameAvailable = isUsernameAvailable ?? previousIsUsernameAvailable;
  const shouldRenderUsernamesManage = usernames && usernames.length > 1;
  const isSaveButtonShown = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (isUsernameError) {
      return false;
    }
    return Boolean(photo) || isProfileFieldsTouched || isUsernameTouched && renderingIsUsernameAvailable === true;
  }, [isUsernameError, photo, isProfileFieldsTouched, isUsernameTouched, renderingIsUsernameAvailable]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_10__["default"])({
    isActive,
    onBack: onReset
  });

  // Due to the parent Transition, this component never gets unmounted,
  // that's why we use throttled API call on every update.
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    runThrottled(() => {
      loadCurrentUser();
    });
  }, [loadCurrentUser]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setPhoto(undefined);
  }, [currentAvatarBlobUrl]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setFirstName(currentFirstName || '');
    setLastName(currentLastName || '');
    setBio(currentBio || '');
  }, [currentFirstName, currentLastName, currentBio]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setEditableUsername(currentUsername || '');
  }, [currentUsername]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (progress === _types__WEBPACK_IMPORTED_MODULE_3__.ProfileEditProgress.Complete) {
      setIsProfileFieldsTouched(false);
      setIsUsernameTouched(false);
      setError(undefined);
    }
  }, [progress]);
  const handlePhotoChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newPhoto => {
    setPhoto(newPhoto);
  }, []);
  const handleFirstNameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setFirstName(e.target.value);
    setIsProfileFieldsTouched(true);
  }, []);
  const handleLastNameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setLastName(e.target.value);
    setIsProfileFieldsTouched(true);
  }, []);
  const handleBioChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setBio(e.target.value);
    setIsProfileFieldsTouched(true);
  }, []);
  const handleUsernameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    setEditableUsername(value);
    setIsUsernameTouched(currentUsername !== value);
  }, [currentUsername]);
  const handleProfileSave = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const trimmedFirstName = firstName.trim();
    const trimmedLastName = lastName.trim();
    const trimmedBio = bio.trim();
    if (!editableUsername) return;
    if (!trimmedFirstName.length) {
      setError(ERROR_FIRST_NAME_MISSING);
      return;
    }
    updateProfile({
      photo,
      ...(isProfileFieldsTouched && {
        firstName: trimmedFirstName,
        lastName: trimmedLastName,
        bio: trimmedBio
      }),
      ...(isUsernameTouched && {
        username: editableUsername
      })
    });
  }, [photo, firstName, lastName, bio, isProfileFieldsTouched, editableUsername, isUsernameTouched, updateProfile]);
  function renderPurchaseLink() {
    const purchaseInfoLink = `${_config__WEBPACK_IMPORTED_MODULE_4__.TME_LINK_PREFIX}${_config__WEBPACK_IMPORTED_MODULE_4__.PURCHASE_USERNAME}`;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "settings-item-description",
      dir: lang.isRtl ? 'rtl' : undefined
    }, lang('lng_username_purchase_available').replace('{link}', '%PURCHASE_LINK%').split('%').map(s => {
      return s === 'PURCHASE_LINK' ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_SafeLink__WEBPACK_IMPORTED_MODULE_16__["default"], {
        url: purchaseInfoLink,
        text: `@${_config__WEBPACK_IMPORTED_MODULE_4__.PURCHASE_USERNAME}`
      }) : s;
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-fab-wrapper"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content no-border custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-edit-profile settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_18__["default"], {
    currentAvatarBlobUrl: currentAvatarBlobUrl,
    onChange: handlePhotoChange,
    title: "Edit your profile photo",
    disabled: isLoading
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_20__["default"], {
    value: firstName,
    onChange: handleFirstNameChange,
    label: lang('FirstName'),
    disabled: isLoading,
    error: error === ERROR_FIRST_NAME_MISSING ? error : undefined
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_20__["default"], {
    value: lastName,
    onChange: handleLastNameChange,
    label: lang('LastName'),
    disabled: isLoading
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_TextArea__WEBPACK_IMPORTED_MODULE_22__["default"], {
    value: bio,
    onChange: handleBioChange,
    label: lang('UserBio'),
    disabled: isLoading,
    maxLength: maxBioLength,
    maxLengthIndicator: maxBioLength ? (maxBioLength - bio.length).toString() : undefined
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description",
    dir: lang.isRtl ? 'rtl' : undefined
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(lang('lng_settings_about_bio'), ['br', 'simple_markdown']))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('Username')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-input"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_UsernameInput__WEBPACK_IMPORTED_MODULE_17__["default"], {
    currentUsername: currentUsername,
    isLoading: isLoading,
    isUsernameAvailable: isUsernameAvailable,
    checkedUsername: checkedUsername,
    onChange: handleUsernameChange
  })), editUsernameError === _config__WEBPACK_IMPORTED_MODULE_4__.USERNAME_PURCHASE_ERROR && renderPurchaseLink(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description",
    dir: lang.isRtl ? 'rtl' : undefined
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(lang('UsernameHelp'), ['br', 'simple_markdown'])), editableUsername && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('lng_username_link'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("br", null), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "username-link"
  }, _config__WEBPACK_IMPORTED_MODULE_4__.TME_LINK_PREFIX, editableUsername))), shouldRenderUsernamesManage && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_ManageUsernames__WEBPACK_IMPORTED_MODULE_15__["default"], {
    usernames: usernames,
    onEditUsername: setEditableUsername
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_19__["default"], {
    isShown: isSaveButtonShown,
    onClick: handleProfileSave,
    disabled: isLoading,
    ariaLabel: lang('Save')
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_21__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "check"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    currentUserId
  } = global;
  const {
    progress,
    isUsernameAvailable,
    checkedUsername,
    error: editUsernameError
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectTabState)(global).profileEdit || {};
  const currentUser = currentUserId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectUser)(global, currentUserId) : undefined;
  const maxBioLength = (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_7__.selectCurrentLimit)(global, 'aboutLength');
  if (!currentUser) {
    return {
      progress,
      checkedUsername,
      isUsernameAvailable,
      editUsernameError,
      maxBioLength
    };
  }
  const {
    firstName: currentFirstName,
    lastName: currentLastName,
    usernames
  } = currentUser;
  const currentUserFullInfo = currentUserId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectUserFullInfo)(global, currentUserId) : undefined;
  const currentAvatarHash = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_5__.getChatAvatarHash)(currentUser);
  return {
    currentAvatarHash,
    currentFirstName,
    currentLastName,
    currentBio: currentUserFullInfo?.bio,
    progress,
    isUsernameAvailable,
    checkedUsername,
    editUsernameError,
    maxBioLength,
    usernames
  };
})(SettingsEditProfile)));

/***/ }),

/***/ "./src/components/left/settings/SettingsExperimental.tsx":
/*!***************************************************************!*\
  !*** ./src/components/left/settings/SettingsExperimental.tsx ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_debugConsole__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/debugConsole */ "./src/util/debugConsole.ts");
/* harmony import */ var _util_download__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/download */ "./src/util/download.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/AnimatedIconWithPreview */ "./src/components/common/AnimatedIconWithPreview.tsx");
/* harmony import */ var _main_visualEffects_SnapEffectContainer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../main/visualEffects/SnapEffectContainer */ "./src/components/main/visualEffects/SnapEffectContainer.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");














const SettingsExperimental = ({
  isActive,
  onReset,
  shouldForceHttpTransport,
  shouldAllowHttpTransport,
  shouldCollectDebugLogs,
  shouldDebugExportedSenders
}) => {
  const {
    requestConfetti,
    setSettingOption,
    requestWave
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const snapButtonRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [isSnapButtonAnimating, setIsSnapButtonAnimating] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isAutoUpdateEnabled, setIsAutoUpdateEnabled] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    window.electron?.getIsAutoUpdateEnabled().then(setIsAutoUpdateEnabled);
  }, []);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onReset
  });
  const handleDownloadLog = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    const file = new File([(0,_util_debugConsole__WEBPACK_IMPORTED_MODULE_3__.getDebugLogs)()], _config__WEBPACK_IMPORTED_MODULE_2__.DEBUG_LOG_FILENAME, {
      type: 'text/plain'
    });
    const url = URL.createObjectURL(file);
    (0,_util_download__WEBPACK_IMPORTED_MODULE_4__["default"])(url, _config__WEBPACK_IMPORTED_MODULE_2__.DEBUG_LOG_FILENAME);
  });
  const handleIsAutoUpdateEnabledChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(isChecked => {
    window.electron?.setIsAutoUpdateEnabled(isChecked);
  }, []);
  const handleRequestWave = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(e => {
    requestWave({
      startX: e.clientX,
      startY: e.clientY
    });
  });
  const handleRequestConfetti = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    requestConfetti({
      withStars: true
    });
  });
  const handleSnap = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    const button = snapButtonRef.current;
    if (!button) return;
    if ((0,_main_visualEffects_SnapEffectContainer__WEBPACK_IMPORTED_MODULE_11__.animateSnap)(button)) {
      setIsSnapButtonAnimating(true);
      // Manual reset for debug
      setTimeout(() => {
        setIsSnapButtonAnimating(false);
      }, 1500);
    }
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_10__["default"], {
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_6__.LOCAL_TGS_URLS.Experimental,
    size: 200,
    className: "experimental-duck",
    nonInteractive: true,
    noLoop: false
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description pt-3",
    dir: "auto"
  }, lang('lng_settings_experimental_about'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
    onClick: handleRequestConfetti,
    icon: "animations"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "title"
  }, "Launch some confetti!")), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
    onClick: handleRequestWave,
    icon: "story-expired",
    disabled: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_WAVE_TRANSFORM_SUPPORTED
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "title"
  }, "Start wave")), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
    ref: snapButtonRef,
    onClick: handleSnap,
    icon: "spoiler",
    disabled: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_SNAP_EFFECT_SUPPORTED,
    style: isSnapButtonAnimating ? 'visibility: hidden' : ''
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "title"
  }, "Vaporize this button")), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__["default"], {
    label: "Allow HTTP Transport",
    checked: Boolean(shouldAllowHttpTransport)
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onCheck: () => setSettingOption({
      shouldAllowHttpTransport: !shouldAllowHttpTransport
    })
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__["default"], {
    label: "Force HTTP Transport",
    disabled: !shouldAllowHttpTransport,
    checked: Boolean(shouldForceHttpTransport)
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onCheck: () => setSettingOption({
      shouldForceHttpTransport: !shouldForceHttpTransport
    })
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__["default"], {
    label: lang('DebugMenuEnableLogs'),
    checked: Boolean(shouldCollectDebugLogs)
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onCheck: () => setSettingOption({
      shouldCollectDebugLogs: !shouldCollectDebugLogs
    })
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__["default"], {
    label: "Enable exported senders debug",
    checked: Boolean(shouldDebugExportedSenders)
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onCheck: () => setSettingOption({
      shouldDebugExportedSenders: !shouldDebugExportedSenders
    })
  }), _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_ELECTRON && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__["default"], {
    label: "Enable autoupdates",
    checked: Boolean(isAutoUpdateEnabled),
    onCheck: handleIsAutoUpdateEnabledChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
    onClick: handleDownloadLog,
    icon: "bug"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "title"
  }, "Download log"))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    shouldForceHttpTransport: global.settings.byKey.shouldForceHttpTransport,
    shouldAllowHttpTransport: global.settings.byKey.shouldAllowHttpTransport,
    shouldCollectDebugLogs: global.settings.byKey.shouldCollectDebugLogs,
    shouldDebugExportedSenders: global.settings.byKey.shouldDebugExportedSenders
  };
})(SettingsExperimental)));

/***/ }),

/***/ "./src/components/left/settings/SettingsGeneral.tsx":
/*!**********************************************************!*\
  !*** ./src/components/left/settings/SettingsGeneral.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_oldLangProvider__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/oldLangProvider */ "./src/util/oldLangProvider.ts");
/* harmony import */ var _util_systemTheme__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/systemTheme */ "./src/util/systemTheme.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");
/* harmony import */ var _ui_RangeSlider__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/RangeSlider */ "./src/components/ui/RangeSlider.tsx");














const SettingsGeneral = ({
  isActive,
  onScreenSelect,
  onReset,
  messageTextSize,
  messageSendKeyCombo,
  timeFormat,
  theme,
  shouldUseSystemTheme
}) => {
  const {
    setSettingOption
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const isMobileDevice = isMobile && (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_IOS || _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_ANDROID);
  const timeFormatOptions = [{
    label: lang('SettingsTimeFormat12'),
    value: '12h'
  }, {
    label: lang('SettingsTimeFormat24'),
    value: '24h'
  }];
  const appearanceThemeOptions = [{
    label: lang('EmptyChatAppearanceLight'),
    value: 'light'
  }, {
    label: lang('EmptyChatAppearanceDark'),
    value: 'dark'
  }, {
    label: lang('EmptyChatAppearanceSystem'),
    value: 'auto'
  }];
  const keyboardSendOptions = !isMobileDevice ? [{
    value: 'enter',
    label: lang('SettingsSendEnter'),
    subLabel: lang('SettingsSendEnterDescription')
  }, {
    value: 'ctrl-enter',
    label: lang(_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_MAC_OS || _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_IOS ? 'SettingsSendCmdenter' : 'SettingsSendCtrlenter'),
    subLabel: lang('SettingsSendPlusEnterDescription')
  }] : undefined;
  const handleMessageTextSizeChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newSize => {
    document.documentElement.style.setProperty('--composer-text-size', `${Math.max(newSize, _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_IOS ? 16 : 15)}px`);
    document.documentElement.style.setProperty('--message-meta-height', `${Math.floor(newSize * 1.3125)}px`);
    document.documentElement.style.setProperty('--message-text-size', `${newSize}px`);
    document.documentElement.setAttribute('data-message-text-size', newSize.toString());
    setSettingOption({
      messageTextSize: newSize
    });
  }, [setSettingOption]);
  const handleAppearanceThemeChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    const newTheme = value === 'auto' ? (0,_util_systemTheme__WEBPACK_IMPORTED_MODULE_5__.getSystemTheme)() : value;
    setSettingOption({
      theme: newTheme
    });
    setSettingOption({
      shouldUseSystemTheme: value === 'auto'
    });
  }, [setSettingOption]);
  const handleTimeFormatChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newTimeFormat => {
    setSettingOption({
      timeFormat: newTimeFormat
    });
    setSettingOption({
      wasTimeFormatSetManually: true
    });
    (0,_util_oldLangProvider__WEBPACK_IMPORTED_MODULE_4__.setTimeFormat)(newTimeFormat);
  }, [setSettingOption]);
  const handleMessageSendComboChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newCombo => {
    setSettingOption({
      messageSendKeyCombo: newCombo
    });
  }, [setSettingOption]);
  const [isTrayIconEnabled, setIsTrayIconEnabled] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    window.electron?.getIsTrayIconEnabled().then(setIsTrayIconEnabled);
  }, []);
  const handleIsTrayIconEnabledChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(isChecked => {
    window.electron?.setIsTrayIconEnabled(isChecked);
  }, []);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-3"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('Settings')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RangeSlider__WEBPACK_IMPORTED_MODULE_13__["default"], {
    label: lang('TextSize'),
    min: 12,
    max: 20,
    value: messageTextSize,
    onChange: handleMessageTextSizeChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
    icon: "photo",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.GeneralChatBackground)
  }, lang('ChatBackground')), _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_ELECTRON && _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_WINDOWS && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    label: lang('SettingsTray'),
    checked: Boolean(isTrayIconEnabled),
    onCheck: handleIsTrayIconEnabledChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('Theme')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "theme",
    options: appearanceThemeOptions,
    selected: shouldUseSystemTheme ? 'auto' : theme,
    onChange: handleAppearanceThemeChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('SettingsTimeFormat')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "timeformat",
    options: timeFormatOptions,
    selected: timeFormat,
    onChange: handleTimeFormatChange
  })), keyboardSendOptions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('SettingsKeyboard')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "keyboard-send-settings",
    options: keyboardSendOptions,
    onChange: handleMessageSendComboChange,
    selected: messageSendKeyCombo
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    theme,
    shouldUseSystemTheme
  } = global.settings.byKey;
  return {
    ...(0,_util_iteratees__WEBPACK_IMPORTED_MODULE_3__.pick)(global.settings.byKey, ['messageTextSize', 'animationLevel', 'messageSendKeyCombo', 'isSensitiveEnabled', 'canChangeSensitive', 'timeFormat']),
    theme,
    shouldUseSystemTheme
  };
})(SettingsGeneral)));

/***/ }),

/***/ "./src/components/left/settings/SettingsGeneralBackground.tsx":
/*!********************************************************************!*\
  !*** ./src/components/left/settings/SettingsGeneralBackground.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_colors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/colors */ "./src/util/colors.ts");
/* harmony import */ var _util_files__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/files */ "./src/util/files.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _util_systemFilesDialog__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/systemFilesDialog */ "./src/util/systemFilesDialog.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _WallpaperTile__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./WallpaperTile */ "./src/components/left/settings/WallpaperTile.tsx");
/* harmony import */ var _SettingsGeneralBackground_scss__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./SettingsGeneralBackground.scss */ "./src/components/left/settings/SettingsGeneralBackground.scss");
















const SUPPORTED_TYPES = 'image/jpeg';
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_7__.throttle)(cb => cb(), 60000, true);
const SettingsGeneralBackground = ({
  isActive,
  onScreenSelect,
  onReset,
  background,
  isBlurred,
  loadedWallpapers,
  theme
}) => {
  const {
    loadWallpapers,
    uploadWallpaper,
    setThemeSettings
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const themeRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  themeRef.current = theme;
  // Due to the parent Transition, this component never gets unmounted,
  // that's why we use throttled API call on every update.
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    runThrottled(() => {
      loadWallpapers();
    });
  }, [loadWallpapers]);
  const handleFileSelect = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const {
      files
    } = e.target;
    const validatedFiles = (0,_util_files__WEBPACK_IMPORTED_MODULE_6__.validateFiles)(files);
    if (validatedFiles?.length) {
      uploadWallpaper(validatedFiles[0]);
    }
  }, [uploadWallpaper]);
  const handleUploadWallpaper = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    (0,_util_systemFilesDialog__WEBPACK_IMPORTED_MODULE_8__.openSystemFilesDialog)(SUPPORTED_TYPES, handleFileSelect, true);
  }, [handleFileSelect]);
  const handleSetColor = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.GeneralChatBackgroundColor);
  }, [onScreenSelect]);
  const handleResetToDefault = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setThemeSettings({
      theme,
      background: undefined,
      backgroundColor: undefined,
      isBlurred: true,
      patternColor: theme === 'dark' ? _config__WEBPACK_IMPORTED_MODULE_3__.DARK_THEME_PATTERN_COLOR : _config__WEBPACK_IMPORTED_MODULE_3__.DEFAULT_PATTERN_COLOR
    });
  }, [setThemeSettings, theme]);
  const handleWallPaperSelect = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(slug => {
    setThemeSettings({
      theme: themeRef.current,
      background: slug
    });
    const currentWallpaper = loadedWallpapers && loadedWallpapers.find(wallpaper => wallpaper.slug === slug);
    if (currentWallpaper?.document.thumbnail) {
      (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.getAverageColor)(currentWallpaper.document.thumbnail.dataUri).then(color => {
        const patternColor = (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.getPatternColor)(color);
        const rgbColor = `#${(0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.rgb2hex)(color)}`;
        setThemeSettings({
          theme: themeRef.current,
          backgroundColor: rgbColor,
          patternColor
        });
      });
    }
  }, [loadedWallpapers, setThemeSettings]);
  const handleWallPaperBlurChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setThemeSettings({
      theme: themeRef.current,
      isBlurred: e.target.checked
    });
  }, [setThemeSettings]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__["default"])({
    isActive,
    onBack: onReset
  });
  const isUploading = loadedWallpapers?.[0] && loadedWallpapers[0].slug === _types__WEBPACK_IMPORTED_MODULE_2__.UPLOADING_WALLPAPER_SLUG;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "SettingsGeneralBackground settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-3"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    icon: "camera-add",
    className: "mb-0",
    disabled: isUploading,
    onClick: handleUploadWallpaper
  }, lang('UploadImage')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    icon: "colorize",
    className: "mb-0",
    onClick: handleSetColor
  }, lang('SetColor')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    icon: "favorite",
    onClick: handleResetToDefault
  }, lang('ThemeResetToDefaults')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__["default"], {
    label: lang('BackgroundBlurred'),
    checked: Boolean(isBlurred),
    onChange: handleWallPaperBlurChange
  })), loadedWallpapers ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-wallpapers"
  }, loadedWallpapers.map(wallpaper => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_WallpaperTile__WEBPACK_IMPORTED_MODULE_14__["default"], {
    key: wallpaper.slug,
    wallpaper: wallpaper,
    theme: theme,
    isSelected: background === wallpaper.slug,
    onClick: handleWallPaperSelect
  }))) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_13__["default"], null));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const theme = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTheme)(global);
  const {
    background,
    isBlurred
  } = global.settings.themes[theme] || {};
  const {
    loadedWallpapers
  } = global.settings;
  return {
    background,
    isBlurred,
    loadedWallpapers,
    theme
  };
})(SettingsGeneralBackground)));

/***/ }),

/***/ "./src/components/left/settings/SettingsGeneralBackgroundColor.tsx":
/*!*************************************************************************!*\
  !*** ./src/components/left/settings/SettingsGeneralBackgroundColor.tsx ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureEvents__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/captureEvents */ "./src/util/captureEvents.ts");
/* harmony import */ var _util_colors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/colors */ "./src/util/colors.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _SettingsGeneralBackgroundColor_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./SettingsGeneralBackgroundColor.scss */ "./src/components/left/settings/SettingsGeneralBackgroundColor.scss");











const DEFAULT_HSB = (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.rgb2hsb)((0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.hex2rgb)('e6ebee'));
const PREDEFINED_COLORS = ['#e6ebee', '#b2cee1', '#008dd0', '#c6e7cb', '#c4e1a6', '#60b16e', '#ccd0af', '#a6a997', '#7a7072', '#fdd7af', '#fdb76e', '#dd8851'];
const SettingsGeneralBackground = ({
  isActive,
  onReset,
  theme,
  backgroundColor
}) => {
  const {
    setThemeSettings
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const themeRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  themeRef.current = theme;
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const colorPickerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const huePickerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const isFirstRunRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(true);
  const [hsb, setHsb] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(getInitialHsb(backgroundColor));
  // Cache for drag handlers
  const hsbRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(hsb);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    hsbRef.current = hsb;
  }, [hsb]);
  const [isDragging, markIsDragging, unmarkIsDragging] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [rgbInput, setRgbInput] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [hexInput, setHexInput] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const rectsRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const colorCtxRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();

  // Setup: cache rects, subscribe for drag events
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    // We use `offsetLeft` instead of `left` to support screen transition
    const colorRect = {
      offsetLeft: colorPickerRef.current.offsetLeft,
      ...(0,_util_iteratees__WEBPACK_IMPORTED_MODULE_6__.pick)(colorPickerRef.current.getBoundingClientRect(), ['top', 'width', 'height'])
    };
    const hueRect = {
      offsetLeft: huePickerRef.current.offsetLeft,
      ...(0,_util_iteratees__WEBPACK_IMPORTED_MODULE_6__.pick)(huePickerRef.current.getBoundingClientRect(), ['width'])
    };
    rectsRef.current = {
      colorRect,
      hueRect
    };
    function handleColorDrag(e) {
      const colorPosition = [Math.min(Math.max(0, e.pageX - colorRect.offsetLeft), colorRect.width - 1), Math.min(Math.max(0, e.pageY - colorRect.top + containerRef.current.scrollTop), colorRect.height - 1)];
      const {
        huePosition
      } = hsb2positions(hsbRef.current, rectsRef.current);
      setHsb(positions2hsb({
        colorPosition,
        huePosition
      }, rectsRef.current));
      markIsDragging();
      return true;
    }
    (0,_util_captureEvents__WEBPACK_IMPORTED_MODULE_4__.captureEvents)(colorPickerRef.current, {
      onCapture: handleColorDrag,
      onDrag: handleColorDrag,
      onRelease: unmarkIsDragging,
      onClick: unmarkIsDragging,
      selectorToPreventScroll: '.SettingsGeneralBackgroundColor',
      withCursor: true
    });
    function handleHueDrag(e) {
      const {
        colorPosition
      } = hsb2positions(hsbRef.current, rectsRef.current);
      const huePosition = Math.min(Math.max(0, e.pageX - hueRect.offsetLeft), hueRect.width - 1);
      setHsb(positions2hsb({
        colorPosition,
        huePosition
      }, rectsRef.current));
      markIsDragging();
      return true;
    }
    (0,_util_captureEvents__WEBPACK_IMPORTED_MODULE_4__.captureEvents)(huePickerRef.current, {
      onCapture: handleHueDrag,
      onDrag: handleHueDrag,
      onRelease: unmarkIsDragging,
      onClick: unmarkIsDragging,
      selectorToPreventScroll: '.SettingsGeneralBackgroundColor',
      withCursor: true
    });
  }, [markIsDragging, unmarkIsDragging]);
  const {
    colorPosition = [0, 0],
    huePosition = 0
  } = rectsRef.current ? hsb2positions(hsb, rectsRef.current) : {};
  const hex = (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.rgb2hex)((0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.hsb2rgb)(hsb));
  const hue = hsb[0];
  const hueHex = (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.rgb2hex)((0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.hsb2rgb)([hue, 1, 1]));

  // Save value and update inputs when HSL changes
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const rgb = (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.hsb2rgb)(hsb);
    const color = `#${(0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.rgb2hex)(rgb)}`;
    setRgbInput(rgb.join(', '));
    setHexInput(color);
    if (!isFirstRunRef.current) {
      const patternColor = (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.getPatternColor)(rgb);
      setThemeSettings({
        theme: themeRef.current,
        background: undefined,
        backgroundColor: color,
        patternColor
      });
    }
    isFirstRunRef.current = false;
  }, [hsb, setThemeSettings]);

  // Redraw color picker when hue changes
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    drawColor(colorPickerRef.current.firstChild, hue, colorCtxRef, rectsRef);
  }, [hue]);

  // Initially draw hue picker
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    drawHue(huePickerRef.current.firstChild);
  }, []);
  const handleRgbChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const rgbValue = e.currentTarget.value.replace(/[^\d, ]/g, '').slice(0, 13);
    if (rgbValue.match(/^\d{1,3},\s?\d{1,3},\s?\d{1,3}$/)) {
      const rgb = rgbValue.split(',').map(channel => Number(channel.trim()));
      setHsb((0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.rgb2hsb)(rgb));
    }
    e.currentTarget.value = rgbValue;
  }, []);
  const handleHexChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const hexValue = e.currentTarget.value.replace(/[^0-9a-fA-F]/g, '').slice(0, 6);
    if (hexValue.match(/^#?[0-9a-fA-F]{6}$/)) {
      setHsb((0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.rgb2hsb)((0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.hex2rgb)(hexValue.replace('#', ''))));
    }
    e.currentTarget.value = hexValue;
  }, []);
  const handlePredefinedColorClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setHsb((0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.rgb2hsb)((0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.hex2rgb)(e.currentTarget.dataset.color.replace('#', ''))));
  }, []);
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('SettingsGeneralBackgroundColor settings-content custom-scroll', isDragging && 'is-dragging');
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: className
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-3"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: colorPickerRef,
    className: "color-picker"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", null), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "handle",
    style: `transform: translate(${colorPosition[0]}px, ${colorPosition[1]}px); background-color: #${hex};`
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: huePickerRef,
    className: "hue-picker"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", null), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "handle",
    style: `transform: translateX(${huePosition}px); background-color: #${hueHex};`
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "tools"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_9__["default"], {
    value: hexInput,
    label: "HEX",
    onChange: handleHexChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_9__["default"], {
    value: rgbInput,
    label: "RGB",
    onChange: handleRgbChange
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "predefined-colors"
  }, PREDEFINED_COLORS.map(color => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('predefined-color', color === `#${hex}` ? 'active' : undefined),
    "data-color": color,
    style: `background-color: ${color};`,
    onClick: handlePredefinedColorClick
  }))));
};
function getInitialHsb(backgroundColor) {
  return backgroundColor && backgroundColor.startsWith('#') ? (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.rgb2hsb)((0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.hex2rgb)(backgroundColor.replace('#', ''))) : DEFAULT_HSB;
}
function hsb2positions(hsb, rects) {
  return {
    colorPosition: [Math.round(hsb[1] * (rects.colorRect.width - 1)), Math.round((1 - hsb[2]) * (rects.colorRect.height - 1))],
    huePosition: Math.round(hsb[0] * (rects.hueRect.width - 1))
  };
}
function positions2hsb({
  colorPosition,
  huePosition
}, rects) {
  return [huePosition / (rects.hueRect.width - 1), colorPosition[0] / (rects.colorRect.width - 1), 1 - colorPosition[1] / (rects.colorRect.height - 1)];
}
function drawColor(canvas, hue, colorCtxRef, rectsRef) {
  let w;
  let h;
  let ctx;
  if (!colorCtxRef.current || !rectsRef.current) {
    // First run
    w = canvas.offsetWidth;
    h = canvas.offsetHeight;
    ctx = canvas.getContext('2d');
    canvas.width = w;
    canvas.height = h;
    colorCtxRef.current = ctx;
  } else {
    w = rectsRef.current.colorRect.width;
    h = rectsRef.current.colorRect.height;
    ctx = colorCtxRef.current;
  }
  const imgData = ctx.createImageData(w, h);
  const pixels = imgData.data;
  const col = (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.hsb2rgb)([hue, 1, 1]);
  let index = 0;
  for (let y = 0; y < h; y++) {
    const perY = 1 - y / (h - 1);
    const st = [255 * perY, 255 * perY, 255 * perY];
    const ed = [col[0] * perY, col[1] * perY, col[2] * perY];
    for (let x = 0; x < w; x++) {
      const perX = x / (w - 1);
      pixels[index++] = st[0] + (ed[0] - st[0]) * perX;
      pixels[index++] = st[1] + (ed[1] - st[1]) * perX;
      pixels[index++] = st[2] + (ed[2] - st[2]) * perX;
      pixels[index++] = 255;
    }
  }
  ctx.putImageData(imgData, 0, 0);
}
function drawHue(canvas) {
  const w = canvas.offsetWidth;
  const h = 1;
  canvas.width = w;
  canvas.height = h;
  const ctx = canvas.getContext('2d');
  const imgData = ctx.createImageData(w, h);
  const pixels = imgData.data;
  let index = 0;
  for (let x = 0; x < w; x++) {
    const hue = x / (w - 1);
    const rgb = (0,_util_colors__WEBPACK_IMPORTED_MODULE_5__.hsb2rgb)([hue, 1, 1]);
    /* eslint-disable prefer-destructuring */
    pixels[index++] = rgb[0];
    pixels[index++] = rgb[1];
    pixels[index++] = rgb[2];
    /* eslint-enable prefer-destructuring */
    pixels[index++] = 255;
  }
  ctx.putImageData(imgData, 0, 0);
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const theme = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTheme)(global);
  const {
    backgroundColor
  } = global.settings.themes[theme] || {};
  return {
    backgroundColor,
    theme
  };
})(SettingsGeneralBackground)));

/***/ }),

/***/ "./src/components/left/settings/SettingsHeader.tsx":
/*!*********************************************************!*\
  !*** ./src/components/left/settings/SettingsHeader.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useMultiClick__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useMultiClick */ "./src/hooks/useMultiClick.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/DropdownMenu */ "./src/components/ui/DropdownMenu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");












const SettingsHeader = ({
  currentScreen,
  editedFolderId,
  onReset,
  onScreenSelect
}) => {
  const {
    signOut,
    openDeleteChatFolderModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const [isSignOutDialogOpen, setIsSignOutDialogOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const handleMultiClick = (0,_hooks_useMultiClick__WEBPACK_IMPORTED_MODULE_5__["default"])(5, () => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Experimental);
  });
  const openSignOutConfirmation = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setIsSignOutDialogOpen(true);
  }, []);
  const closeSignOutConfirmation = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setIsSignOutDialogOpen(false);
  }, []);
  const openDeleteFolderConfirmation = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!editedFolderId) return;
    openDeleteChatFolderModal({
      folderId: editedFolderId
    });
  }, [editedFolderId, openDeleteChatFolderModal]);
  const handleSignOutMessage = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeSignOutConfirmation();
    signOut({
      forceInitApi: true
    });
  }, [closeSignOutConfirmation, signOut]);
  const SettingsMenuButton = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return ({
      onTrigger,
      isOpen
    }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
      round: true,
      ripple: !isMobile,
      size: "smaller",
      color: "translucent",
      className: isOpen ? 'active' : '',
      onClick: onTrigger,
      ariaLabel: "More actions"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
      name: "more"
    }));
  }, [isMobile]);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  function renderHeaderContent() {
    switch (currentScreen) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.EditProfile:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('lng_settings_information'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.General:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('General'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.QuickReaction:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('DoubleTapSetting'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.CustomEmoji:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('Emoji'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Notifications:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('Notifications'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.DataStorage:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('DataSettings'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Privacy:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PrivacySettings'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Language:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('Language'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.DoNotTranslate:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('DoNotTranslate'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Stickers:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('StickersName'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Experimental:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('lng_settings_experimental'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.GeneralChatBackground:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('ChatBackground'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.GeneralChatBackgroundColor:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('SetColor'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumber:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PrivacyPhone'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PrivacyLastSeen'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhoto:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('Privacy.ProfilePhoto'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBio:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PrivacyBio'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthday:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PrivacyBirthday'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGifts:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, lang('PrivacyGifts'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwarding:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PrivacyForwards'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PrivacyVoiceMessages'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyMessages:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PrivacyMessages'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChats:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('AutodownloadGroupChats'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCall:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('Calls'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsAllowedContacts:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('AlwaysShareWith'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsDeniedContacts:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('NeverShareWith'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallAllowedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PAllowedContacts:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('AlwaysAllow'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallDeniedContacts:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PDeniedContacts:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('NeverAllow'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Performance:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, lang('MenuAnimations'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.ActiveSessions:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('SessionsTitle'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.ActiveWebsites:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('OtherWebSessions'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBlockedUsers:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('BlockedUsers'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaDisabled:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaEnabled:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('TwoStepVerification'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPassword:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordNew:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordConfirm:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PleaseEnterCurrentPassword'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordConfirm:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PleaseReEnterPassword'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordHint:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordHint:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PasswordHint'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmail:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('RecoveryEmailTitle'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCode:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, "Recovery Email Code");
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('TwoStepVerificationPasswordSet'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordCurrent:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaTurnOff:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCurrentPassword:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PleaseEnterCurrentPassword'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeDisabled:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeEnabled:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscode:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscodeConfirm:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('Passcode'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeTurnOff:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PasscodeController.Disable.Title'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeCurrent:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeNew:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PasscodeController.Change.Title'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeConfirm:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('PasscodeController.ReEnterPasscode.Placeholder'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Folders:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('Filters'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('FilterNew'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersShare:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('FolderLinkScreen.Title'));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderFromChatList:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderInvites:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
          className: "settings-main-header"
        }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('FilterEdit')), Boolean(editedFolderId) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_10__["default"], {
          className: "settings-more-menu",
          trigger: SettingsMenuButton,
          positionX: "right"
        }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
          icon: "delete",
          destructive: true,
          onClick: openDeleteFolderConfirmation
        }, oldLang('Delete'))));
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChatsFromChatList:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChats:
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChatsFromChatList:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang(currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats || currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChatsFromChatList ? 'FilterInclude' : 'FilterExclude'));
      default:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
          className: "settings-main-header"
        }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
          onClick: handleMultiClick
        }, oldLang('SETTINGS')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
          round: true,
          ripple: !isMobile,
          size: "smaller",
          color: "translucent"
          // eslint-disable-next-line react/jsx-no-bind
          ,
          onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.EditProfile),
          ariaLabel: oldLang('lng_settings_information')
        }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
          name: "edit"
        })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_10__["default"], {
          className: "settings-more-menu",
          trigger: SettingsMenuButton,
          positionX: "right"
        }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
          icon: "logout",
          onClick: openSignOutConfirmation
        }, oldLang('LogOutTitle'))));
    }
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "left-header"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
    round: true,
    size: "smaller",
    color: "translucent",
    onClick: onReset,
    ariaLabel: oldLang('AccDescrGoBack')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
    name: "arrow-left"
  })), renderHeaderContent(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_9__["default"], {
    isOpen: isSignOutDialogOpen,
    onClose: closeSignOutConfirmation,
    text: oldLang('lng_sure_logout'),
    confirmLabel: oldLang('AccountSettings.Logout'),
    confirmHandler: handleSignOutMessage,
    confirmIsDestructive: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsHeader));

/***/ }),

/***/ "./src/components/left/settings/SettingsLanguage.tsx":
/*!***********************************************************!*\
  !*** ./src/components/left/settings/SettingsLanguage.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_oldLangProvider__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/oldLangProvider */ "./src/util/oldLangProvider.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_ItemPicker__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/pickers/ItemPicker */ "./src/components/common/pickers/ItemPicker.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");














const SettingsLanguage = ({
  isActive,
  isCurrentUserPremium,
  languages,
  language,
  canTranslate,
  canTranslateChats,
  doNotTranslate,
  onScreenSelect,
  onReset
}) => {
  const {
    loadLanguages,
    setSettingOption,
    openPremiumModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [selectedLanguage, setSelectedLanguage] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(language);
  const [isLoading, markIsLoading, unmarkIsLoading] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const canTranslateChatsEnabled = isCurrentUserPremium && canTranslateChats;
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!languages?.length) {
      loadLanguages();
    }
  }, [languages]);
  const handleChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(langCode => {
    setSelectedLanguage(langCode);
    markIsLoading();
    void (0,_util_oldLangProvider__WEBPACK_IMPORTED_MODULE_4__.oldSetLanguage)(langCode, () => {
      unmarkIsLoading();
      setSettingOption({
        language: langCode
      });
    });
  });
  const options = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!languages) return undefined;
    const currentLangCode = (window.navigator.language || 'en').toLowerCase();
    const shortLangCode = currentLangCode.substr(0, 2);
    return languages.map(({
      langCode,
      nativeName,
      name
    }) => ({
      value: langCode,
      label: nativeName,
      subLabel: name,
      isLoading: langCode === selectedLanguage && isLoading
    })).sort(a => {
      return currentLangCode && (a.value === currentLangCode || a.value === shortLangCode) ? -1 : 0;
    });
  }, [isLoading, languages, selectedLanguage]);
  const handleShouldTranslateChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(newValue => {
    setSettingOption({
      canTranslate: newValue
    });
  });
  const handleShouldTranslateChatsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(newValue => {
    setSettingOption({
      canTranslateChats: newValue
    });
  });
  const handleShouldTranslateChatsClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    if (!isCurrentUserPremium) {
      openPremiumModal({
        initialSection: 'translations'
      });
    }
  });
  const doNotTranslateText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TRANSLATION_SUPPORTED || !doNotTranslate.length) {
      return undefined;
    }
    if (doNotTranslate.length === 1) {
      const originalNames = new Intl.DisplayNames([language], {
        type: 'language'
      });
      return originalNames.of(doNotTranslate[0]);
    }
    return lang('Languages', doNotTranslate.length);
  }, [doNotTranslate, lang, language]);
  const handleDoNotSelectOpen = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.DoNotTranslate);
  });
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content settings-language custom-scroll"
  }, _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TRANSLATION_SUPPORTED && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__["default"], {
    label: lang('ShowTranslateButton'),
    checked: canTranslate,
    onCheck: handleShouldTranslateChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__["default"], {
    label: lang('ShowTranslateChatButton'),
    checked: canTranslateChatsEnabled,
    disabled: !isCurrentUserPremium,
    rightIcon: !isCurrentUserPremium ? 'lock' : undefined,
    onClickLabel: handleShouldTranslateChatsClick,
    onCheck: handleShouldTranslateChatsChange
  }), (canTranslate || canTranslateChatsEnabled) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    narrow: true,
    onClick: handleDoNotSelectOpen
  }, lang('DoNotTranslate'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "settings-item__current-value"
  }, doNotTranslateText)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-0 mt-1"
  }, lang('lng_translate_settings_about'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item settings-item-picker"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header"
  }, lang('Localization.InterfaceLanguage')), options ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_ItemPicker__WEBPACK_IMPORTED_MODULE_10__["default"], {
    items: options,
    selectedValue: selectedLanguage,
    forceRenderAllItems: true,
    onSelectedValueChange: handleChange,
    itemInputType: "radio",
    className: "settings-picker"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_13__["default"], null)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    language,
    canTranslate,
    canTranslateChats,
    doNotTranslate
  } = global.settings.byKey;
  const languages = global.settings.languages;
  const isCurrentUserPremium = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global);
  return {
    isCurrentUserPremium,
    languages,
    language,
    canTranslate,
    canTranslateChats,
    doNotTranslate
  };
})(SettingsLanguage)));

/***/ }),

/***/ "./src/components/left/settings/SettingsMain.tsx":
/*!*******************************************************!*\
  !*** ./src/components/left/settings/SettingsMain.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers_payments__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers/payments */ "./src/global/helpers/payments.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/icons/StarIcon */ "./src/components/common/icons/StarIcon.tsx");
/* harmony import */ var _common_profile_ChatExtra__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/profile/ChatExtra */ "./src/components/common/profile/ChatExtra.tsx");
/* harmony import */ var _common_ProfileInfo__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/ProfileInfo */ "./src/components/common/ProfileInfo.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");















const SettingsMain = ({
  isActive,
  currentUserId,
  sessionCount,
  canBuyPremium,
  isGiveawayAvailable,
  starsBalance,
  shouldDisplayStars,
  onScreenSelect,
  onReset
}) => {
  const {
    loadMoreProfilePhotos,
    openPremiumModal,
    openSupportChat,
    openUrl,
    openGiftRecipientPicker,
    openStarsBalanceModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isSupportDialogOpen, openSupportDialog, closeSupportDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])(false);
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (currentUserId) {
      loadMoreProfilePhotos({
        peerId: currentUserId,
        isPreload: true
      });
    }
  }, [currentUserId]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onReset
  });
  const handleOpenSupport = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    openSupportChat();
    closeSupportDialog();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-main-menu self-profile"
  }, currentUserId && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_ProfileInfo__WEBPACK_IMPORTED_MODULE_12__["default"], {
    peerId: currentUserId,
    canPlayVideo: Boolean(isActive),
    forceShowSelf: true
  }), currentUserId && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_profile_ChatExtra__WEBPACK_IMPORTED_MODULE_11__["default"], {
    chatOrUserId: currentUserId,
    isInSettings: true
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-main-menu"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "settings",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.General)
  }, lang('TelegramGeneralSettingsViewController')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "animations",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Performance)
  }, lang('MenuAnimations')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "unmute",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Notifications)
  }, lang('Notifications')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "data",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.DataStorage)
  }, lang('DataSettings')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "lock",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Privacy)
  }, lang('PrivacySettings')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "folder",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Folders)
  }, lang('Filters')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "active-sessions",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.ActiveSessions)
  }, lang('SessionsTitle'), sessionCount > 0 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "settings-item__current-value"
  }, sessionCount)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "language",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Language)
  }, lang('Language'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "settings-item__current-value"
  }, lang.languageInfo.nativeName)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "stickers",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Stickers)
  }, lang('MenuStickers'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-main-menu"
  }, canBuyPremium && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_10__["default"], {
      className: "icon ListItem-main-icon",
      type: "premium",
      size: "big"
    }),
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => openPremiumModal()
  }, lang('TelegramPremium')), shouldDisplayStars && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_10__["default"], {
      className: "icon ListItem-main-icon",
      type: "gold",
      size: "big"
    }),
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => openStarsBalanceModal({})
  }, lang('MenuStars'), Boolean(starsBalance) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "settings-item__current-value"
  }, (0,_global_helpers_payments__WEBPACK_IMPORTED_MODULE_4__.formatStarsAmount)(lang, starsBalance))), isGiveawayAvailable && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "gift",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => openGiftRecipientPicker()
  }, lang('MenuSendGift'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-main-menu"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "ask-support",
    narrow: true,
    onClick: openSupportDialog
  }, lang('AskAQuestion')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "help",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => openUrl({
      url: _config__WEBPACK_IMPORTED_MODULE_3__.FAQ_URL
    })
  }, lang('MenuTelegramFaq')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "privacy-policy",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => openUrl({
      url: _config__WEBPACK_IMPORTED_MODULE_3__.PRIVACY_URL
    })
  }, lang('MenuPrivacyPolicy'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isSupportDialogOpen,
    confirmLabel: lang('OK'),
    title: lang('AskAQuestion'),
    textParts: lang('MenuAskText', undefined, {
      withNodes: true,
      renderTextFilters: ['br']
    }),
    confirmHandler: handleOpenSupport,
    onClose: closeSupportDialog
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    currentUserId
  } = global;
  const isGiveawayAvailable = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsGiveawayGiftsPurchaseAvailable)(global);
  const starsBalance = global.stars?.balance;
  const shouldDisplayStars = Boolean(global.stars?.history?.all?.transactions.length);
  return {
    sessionCount: global.activeSessions.orderedHashes.length,
    currentUserId,
    canBuyPremium: !(0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsPremiumPurchaseBlocked)(global),
    isGiveawayAvailable,
    starsBalance,
    shouldDisplayStars
  };
})(SettingsMain)));

/***/ }),

/***/ "./src/components/left/settings/SettingsNotifications.tsx":
/*!****************************************************************!*\
  !*** ./src/components/left/settings/SettingsNotifications.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_notifications__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/notifications */ "./src/util/notifications.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useRunDebounced__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useRunDebounced */ "./src/hooks/useRunDebounced.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_RangeSlider__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/RangeSlider */ "./src/components/ui/RangeSlider.tsx");








const SettingsNotifications = ({
  isActive,
  onReset,
  hasPrivateChatsNotifications,
  hasPrivateChatsMessagePreview,
  hasGroupNotifications,
  hasGroupMessagePreview,
  hasBroadcastNotifications,
  hasBroadcastMessagePreview,
  hasContactJoinedNotifications,
  hasPushNotifications,
  hasWebNotifications,
  notificationSoundVolume
}) => {
  const {
    loadNotificationSettings,
    updateContactSignUpNotification,
    updateNotificationSettings,
    updateWebNotificationSettings
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    loadNotificationSettings();
  }, [loadNotificationSettings]);
  const runDebounced = (0,_hooks_useRunDebounced__WEBPACK_IMPORTED_MODULE_5__["default"])(500, true);
  const areNotificationsSupported = (0,_util_notifications__WEBPACK_IMPORTED_MODULE_2__.checkIfNotificationsSupported)();
  const areOfflineNotificationsSupported = areNotificationsSupported && !(0,_util_notifications__WEBPACK_IMPORTED_MODULE_2__.checkIfOfflinePushFailed)();
  const handleSettingsChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e, peerType, setting) => {
    const currentIsSilent = peerType === 'contact' ? !hasPrivateChatsNotifications : !(peerType === 'group' ? hasGroupNotifications : hasBroadcastNotifications);
    const currentShouldShowPreviews = peerType === 'contact' ? hasPrivateChatsMessagePreview : peerType === 'group' ? hasGroupMessagePreview : hasBroadcastMessagePreview;
    updateNotificationSettings({
      peerType,
      ...(setting === 'silent' && {
        isSilent: !e.target.checked,
        shouldShowPreviews: currentShouldShowPreviews
      }),
      ...(setting === 'showPreviews' && {
        shouldShowPreviews: e.target.checked,
        isSilent: currentIsSilent
      })
    });
  }, [hasBroadcastMessagePreview, hasBroadcastNotifications, hasGroupMessagePreview, hasGroupNotifications, hasPrivateChatsMessagePreview, hasPrivateChatsNotifications, updateNotificationSettings]);
  const handleWebNotificationsChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const isEnabled = e.target.checked;
    updateWebNotificationSettings({
      hasWebNotifications: isEnabled,
      ...(!isEnabled && {
        hasPushNotifications: false
      })
    });
  }, [updateWebNotificationSettings]);
  const handlePushNotificationsChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    updateWebNotificationSettings({
      hasPushNotifications: e.target.checked
    });
  }, [updateWebNotificationSettings]);
  const handlePrivateChatsNotificationsChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    handleSettingsChange(e, 'contact', 'silent');
  }, [handleSettingsChange]);
  const handlePrivateChatsPreviewChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    handleSettingsChange(e, 'contact', 'showPreviews');
  }, [handleSettingsChange]);
  const handleGroupsNotificationsChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    handleSettingsChange(e, 'group', 'silent');
  }, [handleSettingsChange]);
  const handleGroupsPreviewChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    handleSettingsChange(e, 'group', 'showPreviews');
  }, [handleSettingsChange]);
  const handleChannelsNotificationsChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    handleSettingsChange(e, 'broadcast', 'silent');
  }, [handleSettingsChange]);
  const handleChannelsPreviewChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    handleSettingsChange(e, 'broadcast', 'showPreviews');
  }, [handleSettingsChange]);
  const handleContactNotificationChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    updateContactSignUpNotification({
      isSilent: !e.target.checked
    });
  }, [updateContactSignUpNotification]);
  const handleVolumeChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(volume => {
    updateWebNotificationSettings({
      notificationSoundVolume: volume
    });
    runDebounced(() => (0,_util_notifications__WEBPACK_IMPORTED_MODULE_2__.playNotifySound)(undefined, volume));
  }, [runDebounced, updateWebNotificationSettings]);
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('NotificationsWeb')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: lang('NotificationsWeb'),
    subLabel: lang(hasWebNotifications ? 'UserInfoNotificationsEnabled' : 'UserInfoNotificationsDisabled'),
    checked: hasWebNotifications,
    disabled: !areNotificationsSupported,
    onChange: handleWebNotificationsChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: lang('NotificationsOffline'),
    disabled: !hasWebNotifications || !areOfflineNotificationsSupported,
    subLabel: areOfflineNotificationsSupported ? lang(hasPushNotifications ? 'UserInfoNotificationsEnabled' : 'UserInfoNotificationsDisabled') : lang('SettingsOfflineNotificationUnsupported'),
    checked: hasPushNotifications,
    onChange: handlePushNotificationsChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item-slider"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RangeSlider__WEBPACK_IMPORTED_MODULE_7__["default"], {
    label: lang('NotificationsSound'),
    min: 0,
    max: 10,
    disabled: !areNotificationsSupported,
    value: notificationSoundVolume,
    onChange: handleVolumeChange
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('AutodownloadPrivateChats')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: lang('NotificationsForPrivateChats'),
    subLabel: lang(hasPrivateChatsNotifications ? 'UserInfoNotificationsEnabled' : 'UserInfoNotificationsDisabled'),
    checked: hasPrivateChatsNotifications,
    onChange: handlePrivateChatsNotificationsChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: lang('MessagePreview'),
    disabled: !hasPrivateChatsNotifications,
    subLabel: lang(hasPrivateChatsMessagePreview ? 'UserInfoNotificationsEnabled' : 'UserInfoNotificationsDisabled'),
    checked: hasPrivateChatsMessagePreview,
    onChange: handlePrivateChatsPreviewChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('FilterGroups')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: lang('NotificationsForGroups'),
    subLabel: lang(hasGroupNotifications ? 'UserInfoNotificationsEnabled' : 'UserInfoNotificationsDisabled'),
    checked: hasGroupNotifications,
    onChange: handleGroupsNotificationsChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: lang('MessagePreview'),
    disabled: !hasGroupNotifications,
    subLabel: lang(hasGroupMessagePreview ? 'UserInfoNotificationsEnabled' : 'UserInfoNotificationsDisabled'),
    checked: hasGroupMessagePreview,
    onChange: handleGroupsPreviewChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('FilterChannels')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: lang('NotificationsForChannels'),
    subLabel: lang(hasBroadcastNotifications ? 'UserInfoNotificationsEnabled' : 'UserInfoNotificationsDisabled'),
    checked: hasBroadcastNotifications,
    onChange: handleChannelsNotificationsChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: lang('MessagePreview'),
    disabled: !hasBroadcastNotifications,
    subLabel: lang(hasBroadcastMessagePreview ? 'UserInfoNotificationsEnabled' : 'UserInfoNotificationsDisabled'),
    checked: hasBroadcastMessagePreview,
    onChange: handleChannelsPreviewChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('PhoneOther')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: lang('ContactJoined'),
    checked: hasContactJoinedNotifications,
    onChange: handleContactNotificationChange
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    hasPrivateChatsNotifications: Boolean(global.settings.byKey.hasPrivateChatsNotifications),
    hasPrivateChatsMessagePreview: Boolean(global.settings.byKey.hasPrivateChatsMessagePreview),
    hasGroupNotifications: Boolean(global.settings.byKey.hasGroupNotifications),
    hasGroupMessagePreview: Boolean(global.settings.byKey.hasGroupMessagePreview),
    hasBroadcastNotifications: Boolean(global.settings.byKey.hasBroadcastNotifications),
    hasBroadcastMessagePreview: Boolean(global.settings.byKey.hasBroadcastMessagePreview),
    hasContactJoinedNotifications: Boolean(global.settings.byKey.hasContactJoinedNotifications),
    hasWebNotifications: global.settings.byKey.hasWebNotifications,
    hasPushNotifications: global.settings.byKey.hasPushNotifications,
    notificationSoundVolume: global.settings.byKey.notificationSoundVolume
  };
})(SettingsNotifications)));

/***/ }),

/***/ "./src/components/left/settings/SettingsPasswordForm.tsx":
/*!***************************************************************!*\
  !*** ./src/components/left/settings/SettingsPasswordForm.tsx ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_PasswordForm__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/PasswordForm */ "./src/components/common/PasswordForm.tsx");
/* harmony import */ var _common_PasswordMonkey__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/PasswordMonkey */ "./src/components/common/PasswordMonkey.tsx");





const EQUAL_PASSWORD_ERROR = 'Passwords Should Be Equal';
const SettingsPasswordForm = ({
  isActive,
  onReset,
  error,
  isLoading,
  shouldDisablePasswordManager,
  expectedPassword,
  placeholder = 'Current Password',
  hint,
  submitLabel,
  clearError,
  onSubmit
}) => {
  const [validationError, setValidationError] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [shouldShowPassword, setShouldShowPassword] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const handleSubmit = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newPassword => {
    if (expectedPassword && newPassword !== expectedPassword) {
      setValidationError(EQUAL_PASSWORD_ERROR);
    } else {
      onSubmit(newPassword);
    }
  }, [onSubmit, expectedPassword]);
  const handleClearError = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (clearError) {
      clearError();
    }
    setValidationError('');
  }, [clearError]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_1__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content password-form custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PasswordMonkey__WEBPACK_IMPORTED_MODULE_4__["default"], {
    isBig: true,
    isPasswordVisible: shouldShowPassword
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PasswordForm__WEBPACK_IMPORTED_MODULE_3__["default"], {
    error: validationError || error,
    hint: hint,
    placeholder: placeholder,
    shouldDisablePasswordManager: shouldDisablePasswordManager,
    submitLabel: submitLabel || lang('Next'),
    clearError: handleClearError,
    isLoading: isLoading,
    isPasswordVisible: shouldShowPassword,
    shouldResetValue: isActive,
    onChangePasswordVisibility: setShouldShowPassword,
    onSubmit: handleSubmit
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsPasswordForm));

/***/ }),

/***/ "./src/components/left/settings/SettingsPerformance.tsx":
/*!**************************************************************!*\
  !*** ./src/components/left/settings/SettingsPerformance.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_initialState__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/initialState */ "./src/global/initialState.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_areDeepEqual__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/areDeepEqual */ "./src/util/areDeepEqual.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_RangeSlider__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/RangeSlider */ "./src/components/ui/RangeSlider.tsx");











const ANIMATION_LEVEL_OPTIONS = ['SettingsPerformanceSliderLow', 'SettingsPerformanceSliderMedium', 'SettingsPerformanceSliderHigh'];
const ANIMATION_LEVEL_CUSTOM_OPTIONS = ['SettingsPerformanceSliderLow', 'SettingsPerformanceSliderCustom', 'SettingsPerformanceSliderHigh'];
const PERFORMANCE_OPTIONS = [['SettingsPerformanceInterfaceAnimations', [{
  key: 'pageTransitions',
  label: 'SettingsPerformancePageTransitions'
}, {
  key: 'messageSendingAnimations',
  label: 'SettingsPerformanceSending'
}, {
  key: 'mediaViewerAnimations',
  label: 'SettingsPerformanceMediaViewer'
}, {
  key: 'messageComposerAnimations',
  label: 'SettingsPerformanceComposer'
}, {
  key: 'contextMenuAnimations',
  label: 'SettingsPerformanceContextAnimation'
}, {
  key: 'contextMenuBlur',
  label: 'SettingsPerformanceContextBlur',
  disabled: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_BACKDROP_BLUR_SUPPORTED
}, {
  key: 'rightColumnAnimations',
  label: 'SettingsPerformanceRightColumn'
}, {
  key: 'snapEffect',
  label: 'SettingsPerformanceThanos'
}]], ['SettingsPerformanceStickers', [{
  key: 'animatedEmoji',
  label: 'SettingsPerformanceAnimatedEmoji'
}, {
  key: 'loopAnimatedStickers',
  label: 'SettingsPerformanceLoopStickers'
}, {
  key: 'reactionEffects',
  label: 'SettingsPerformanceReactionEffects'
}, {
  key: 'stickerEffects',
  label: 'SettingsPerformanceStickerEffects'
}]], ['SettingsPerformanceMediaAutoplay', [{
  key: 'autoplayGifs',
  label: 'SettingsPerformanceAutoplayGif'
}, {
  key: 'autoplayVideos',
  label: 'SettingsPerformanceAutoplayVideo'
}]]];
function SettingsPerformance({
  isActive,
  performanceSettings,
  onReset
}) {
  const {
    setSettingOption,
    updatePerformanceSettings
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onReset
  });
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [sectionExpandedStates, setSectionExpandedStates] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)({});
  const sectionCheckedStates = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return PERFORMANCE_OPTIONS.reduce((acc, [, options], index) => {
      acc[index] = options.every(({
        key
      }) => performanceSettings[key]);
      return acc;
    }, {});
  }, [performanceSettings]);
  const animationLevelState = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if ((0,_util_areDeepEqual__WEBPACK_IMPORTED_MODULE_5__.areDeepEqual)(performanceSettings, _global_initialState__WEBPACK_IMPORTED_MODULE_3__.INITIAL_PERFORMANCE_STATE_MAX)) {
      return _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_LEVEL_MAX;
    }
    if ((0,_util_areDeepEqual__WEBPACK_IMPORTED_MODULE_5__.areDeepEqual)(performanceSettings, _global_initialState__WEBPACK_IMPORTED_MODULE_3__.INITIAL_PERFORMANCE_STATE_MIN)) {
      return _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_LEVEL_MIN;
    }
    if ((0,_util_areDeepEqual__WEBPACK_IMPORTED_MODULE_5__.areDeepEqual)(performanceSettings, _global_initialState__WEBPACK_IMPORTED_MODULE_3__.INITIAL_PERFORMANCE_STATE_MID)) {
      return _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_LEVEL_MED;
    }
    return _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_LEVEL_CUSTOM;
  }, [performanceSettings]);
  const animationLevelOptions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const options = animationLevelState === _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_LEVEL_CUSTOM ? ANIMATION_LEVEL_CUSTOM_OPTIONS : ANIMATION_LEVEL_OPTIONS;
    return options.map(option => lang(option));
  }, [animationLevelState, lang]);
  const handleToggleSection = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e, index) => {
    e.preventDefault();
    const sectionIndex = Number(index);
    setSectionExpandedStates(prev => ({
      ...prev,
      [sectionIndex]: !prev[sectionIndex]
    }));
  }, []);
  const handleAnimationLevelChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newLevel => {
    const performance = newLevel === _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_LEVEL_MIN ? _global_initialState__WEBPACK_IMPORTED_MODULE_3__.INITIAL_PERFORMANCE_STATE_MIN : newLevel === _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_LEVEL_MED ? _global_initialState__WEBPACK_IMPORTED_MODULE_3__.INITIAL_PERFORMANCE_STATE_MID : _global_initialState__WEBPACK_IMPORTED_MODULE_3__.INITIAL_PERFORMANCE_STATE_MAX;
    setSettingOption({
      animationLevel: newLevel
    });
    updatePerformanceSettings(performance);
  }, [setSettingOption]);
  const handlePropertyGroupChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const {
      name,
      checked
    } = e.target;
    const perfomanceSection = PERFORMANCE_OPTIONS.find(([sectionName]) => sectionName === name);
    if (!perfomanceSection) {
      return;
    }
    const newSettings = perfomanceSection[1].reduce((acc, {
      key
    }) => {
      acc[key] = checked;
      return acc;
    }, {});
    updatePerformanceSettings(newSettings);
  }, []);
  const handlePropertyChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const {
      name,
      checked
    } = e.target;
    updatePerformanceSettings({
      [name]: checked
    });
  }, []);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('SettingsPerformanceSliderTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('SettingsPerformanceSliderSubtitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RangeSlider__WEBPACK_IMPORTED_MODULE_10__["default"], {
    options: animationLevelOptions,
    value: animationLevelState === _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_LEVEL_CUSTOM ? _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_LEVEL_MED : animationLevelState,
    onChange: handleAnimationLevelChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item-simple settings-item__with-shifted-dropdown"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "settings-item-header",
    dir: "auto"
  }, "Resource-Intensive Processes"), PERFORMANCE_OPTIONS.map(([sectionName, options], index) => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      key: sectionName,
      className: "settings-dropdown-section"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "ListItem with-checkbox"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_9__["default"], {
      name: sectionName,
      value: index.toString(),
      checked: sectionCheckedStates[index],
      label: lang(sectionName),
      rightIcon: sectionExpandedStates[index] ? 'up' : 'down',
      onChange: handlePropertyGroupChange,
      onClickLabel: handleToggleSection
    })), Boolean(sectionExpandedStates[index]) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "DropdownList DropdownList--open"
    }, options.map(({
      key,
      label,
      disabled
    }) => {
      if (key === 'snapEffect' && !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_SNAP_EFFECT_SUPPORTED) return undefined;
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_9__["default"], {
        key: key,
        name: key,
        checked: performanceSettings[key],
        label: lang(label),
        disabled: disabled,
        onChange: handlePropertyChange
      });
    })));
  })));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    performanceSettings: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectPerformanceSettings)(global)
  };
})(SettingsPerformance)));

/***/ }),

/***/ "./src/components/left/settings/SettingsPrivacy.tsx":
/*!**********************************************************!*\
  !*** ./src/components/left/settings/SettingsPrivacy.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/icons/StarIcon */ "./src/components/common/icons/StarIcon.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");










const SettingsPrivacy = ({
  isActive,
  isCurrentUserPremium,
  hasPassword,
  hasPasscode,
  blockedCount,
  webAuthCount,
  isSensitiveEnabled,
  canChangeSensitive,
  canDisplayAutoarchiveSetting,
  shouldArchiveAndMuteNewNonContact,
  shouldNewNonContactPeersRequirePremium,
  canDisplayChatInTitle,
  canSetPasscode,
  privacy,
  onScreenSelect,
  onReset
}) => {
  const {
    loadPrivacySettings,
    loadBlockedUsers,
    loadContentSettings,
    updateContentSettings,
    loadGlobalPrivacySettings,
    updateGlobalPrivacySettings,
    loadWebAuthorizations,
    setSettingOption
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    loadBlockedUsers();
    loadPrivacySettings();
    loadContentSettings();
    loadWebAuthorizations();
  }, []);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isActive) {
      loadGlobalPrivacySettings();
    }
  }, [isActive, loadGlobalPrivacySettings]);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__["default"])({
    isActive,
    onBack: onReset
  });
  const handleArchiveAndMuteChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(isEnabled => {
    updateGlobalPrivacySettings({
      shouldArchiveAndMuteNewNonContact: isEnabled
    });
  }, [updateGlobalPrivacySettings]);
  const handleChatInTitleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(isChecked => {
    setSettingOption({
      canDisplayChatInTitle: isChecked
    });
  }, []);
  const handleUpdateContentSettings = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(isChecked => {
    updateContentSettings(isChecked);
  }, [updateContentSettings]);
  function getVisibilityValue(setting) {
    if (!setting) return oldLang('Loading');
    const {
      visibility,
      shouldAllowPremium,
      botsPrivacy
    } = setting;
    const isAllowBots = botsPrivacy === 'allow';
    const isVisibilityEverybody = visibility === 'everybody';
    const shouldShowBotsString = isAllowBots && !isVisibilityEverybody;
    const blockCount = setting.blockChatIds.length + setting.blockUserIds.length;
    const allowCount = setting.allowChatIds.length + setting.allowUserIds.length;
    const total = [];
    if (blockCount) total.push(`-${blockCount}`);
    if (allowCount && !isVisibilityEverybody) total.push(`+${allowCount}`);
    const botPrivacyString = shouldShowBotsString ? lang('PrivacyValueBots') : '';
    const totalString = lang.conjunction(total);
    const exceptionString = [botPrivacyString, totalString].filter(Boolean).join(' ');
    if (shouldShowBotsString && !isVisibilityEverybody) return exceptionString;
    if (shouldAllowPremium) {
      return oldLang(exceptionString ? 'ContactsAndPremium' : 'PrivacyPremium');
    }
    switch (visibility) {
      case 'everybody':
        return `${oldLang('P2PEverybody')} ${exceptionString}`;
      case 'contacts':
        return `${oldLang('P2PContacts')} ${exceptionString}`;
      case 'nobody':
        return `${oldLang('P2PNobody')} ${exceptionString}`;
    }
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-3"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    icon: "delete-user",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBlockedUsers)
  }, oldLang('BlockedUsers'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "settings-item__current-value"
  }, blockedCount || '')), canSetPasscode && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    icon: "key",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(hasPasscode ? _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeEnabled : _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeDisabled)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('Passcode')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, oldLang(hasPasscode ? 'PasswordOn' : 'PasswordOff')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    icon: "lock",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(hasPassword ? _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaEnabled : _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaDisabled)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('TwoStepVerification')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, oldLang(hasPassword ? 'PasswordOn' : 'PasswordOff')))), webAuthCount > 0 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    icon: "web",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.ActiveWebsites)
  }, oldLang('PrivacySettings.WebSessions'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "settings-item__current-value"
  }, webAuthCount))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: oldLang.isRtl ? 'rtl' : undefined
  }, oldLang('PrivacyTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumber)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('PrivacyPhoneTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.phoneNumber)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('LastSeenTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.lastSeen)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhoto)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('PrivacyProfilePhotoTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.profilePhoto)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBio)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('PrivacyBio')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.bio)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthday)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('PrivacyBirthday')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.birthday)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGifts)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('PrivacyGifts')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.gifts)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwarding)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('PrivacyForwardsTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.forwards)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCall)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('WhoCanCallMe')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.phoneCall)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    allowDisabledClick: true,
    rightElement: isCurrentUserPremium && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_7__["default"], {
      size: "big",
      type: "premium"
    }),
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('PrivacyVoiceMessagesTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.voiceMessages)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    rightElement: isCurrentUserPremium && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_7__["default"], {
      size: "big",
      type: "premium"
    }),
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyMessages)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('PrivacyMessagesTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, shouldNewNonContactPeersRequirePremium ? oldLang('PrivacyMessagesContactsAndPremium') : oldLang('P2PEverybody')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    className: "no-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChats)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('WhoCanAddMe')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, getVisibilityValue(privacy.chatInvite))))), canChangeSensitive && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: oldLang.isRtl ? 'rtl' : undefined
  }, oldLang('lng_settings_sensitive_title')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    label: oldLang('lng_settings_sensitive_disable_filtering'),
    subLabel: oldLang('lng_settings_sensitive_about'),
    checked: Boolean(isSensitiveEnabled),
    disabled: !canChangeSensitive,
    onCheck: handleUpdateContentSettings
  })), canDisplayAutoarchiveSetting && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: oldLang.isRtl ? 'rtl' : undefined
  }, oldLang('NewChatsFromNonContacts')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    label: oldLang('ArchiveAndMute'),
    subLabel: oldLang('ArchiveAndMuteInfo'),
    checked: Boolean(shouldArchiveAndMuteNewNonContact),
    onCheck: handleArchiveAndMuteChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: oldLang.isRtl ? 'rtl' : undefined
  }, oldLang('lng_settings_window_system')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    label: oldLang('lng_settings_title_chat_name'),
    checked: Boolean(canDisplayChatInTitle),
    onCheck: handleChatInTitleChange
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    settings: {
      byKey: {
        hasPassword,
        isSensitiveEnabled,
        canChangeSensitive,
        shouldArchiveAndMuteNewNonContact,
        canDisplayChatInTitle,
        shouldNewNonContactPeersRequirePremium
      },
      privacy
    },
    blocked,
    passcode: {
      hasPasscode
    },
    appConfig
  } = global;
  return {
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global),
    hasPassword,
    hasPasscode: Boolean(hasPasscode),
    blockedCount: blocked.totalCount,
    webAuthCount: global.activeWebSessions.orderedHashes.length,
    isSensitiveEnabled,
    canDisplayAutoarchiveSetting: Boolean(appConfig?.canDisplayAutoarchiveSetting),
    shouldArchiveAndMuteNewNonContact,
    canChangeSensitive,
    shouldNewNonContactPeersRequirePremium,
    privacy,
    canDisplayChatInTitle,
    canSetPasscode: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCanSetPasscode)(global)
  };
})(SettingsPrivacy)));

/***/ }),

/***/ "./src/components/left/settings/SettingsPrivacyBlockedUsers.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/left/settings/SettingsPrivacyBlockedUsers.tsx ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_phoneNumber__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/phoneNumber */ "./src/util/phoneNumber.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_FullNameTitle__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/FullNameTitle */ "./src/components/common/FullNameTitle.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _BlockUserModal__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./BlockUserModal */ "./src/components/left/settings/BlockUserModal.tsx");
















const SettingsPrivacyBlockedUsers = ({
  isActive,
  onReset,
  chatsByIds,
  usersByIds,
  blockedIds,
  phoneCodeList
}) => {
  const {
    unblockUser
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [isBlockUserModalOpen, openBlockUserModal, closeBlockUserModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const handleUnblockClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(userId => {
    unblockUser({
      userId
    });
  }, [unblockUser]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onReset
  });
  const blockedUsernamesById = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return blockedIds.reduce((acc, userId) => {
      const isPrivate = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserId)(userId);
      const user = isPrivate ? usersByIds[userId] : undefined;
      const mainUsername = user && !user.phoneNumber && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMainUsername)(user);
      if (mainUsername) {
        acc[userId] = mainUsername;
      }
      return acc;
    }, {});
  }, [blockedIds, usersByIds]);
  function renderContact(contactId, i, viewportOffset) {
    const isPrivate = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserId)(contactId);
    const user = usersByIds[contactId];
    const chat = chatsByIds[contactId];
    const peer = user || chat;
    const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('Chat chat-item-clickable blocked-list-item small-icon', isPrivate ? 'private' : 'group');
    const userMainUsername = blockedUsernamesById[contactId];
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
      key: `blocked_${contactId}`,
      className: className,
      ripple: true,
      narrow: true,
      contextActions: [{
        title: 'Unblock',
        icon: 'unlock',
        handler: () => {
          handleUnblockClick(contactId);
        }
      }],
      style: `top: ${(viewportOffset + i) * _config__WEBPACK_IMPORTED_MODULE_2__.CHAT_HEIGHT_PX}px;`
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_9__["default"], {
      size: "medium",
      peer: peer
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "contact-info",
      dir: "auto"
    }, peer && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_FullNameTitle__WEBPACK_IMPORTED_MODULE_10__["default"], {
      peer: peer
    }), user?.phoneNumber && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "contact-phone",
      dir: "auto"
    }, (0,_util_phoneNumber__WEBPACK_IMPORTED_MODULE_5__.formatPhoneNumberWithCode)(phoneCodeList, user.phoneNumber)), userMainUsername && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "contact-username",
      dir: "auto"
    }, "@", userMainUsername)));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-fab-wrapper"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content infinite-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description-larger mt-0 mb-2",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('BlockedUsersInfo'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "chat-list custom-scroll"
  }, blockedIds?.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "scroll-container settings-item"
  }, blockedIds.map((contactId, i) => renderContact(contactId, i, 0))) : blockedIds && !blockedIds.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "no-results",
    dir: "auto"
  }, lang('NoBlocked')) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_14__["default"], {
    key: "loading"
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isShown: true,
    className: "block-user-button",
    onClick: openBlockUserModal,
    ariaLabel: lang('BlockContact')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
    name: "add"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_BlockUserModal__WEBPACK_IMPORTED_MODULE_15__["default"], {
    isOpen: isBlockUserModalOpen,
    onClose: closeBlockUserModal
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    chats: {
      byId: chatsByIds
    },
    users: {
      byId: usersByIds
    },
    blocked: {
      ids
    },
    countryList: {
      phoneCodes: phoneCodeList
    }
  } = global;
  return {
    chatsByIds,
    usersByIds,
    blockedIds: ids,
    phoneCodeList
  };
})(SettingsPrivacyBlockedUsers)));

/***/ }),

/***/ "./src/components/left/settings/SettingsPrivacyLastSeen.tsx":
/*!******************************************************************!*\
  !*** ./src/components/left/settings/SettingsPrivacyLastSeen.tsx ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/icons/StarIcon */ "./src/components/common/icons/StarIcon.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");









const SettingsPrivacyLastSeen = ({
  isCurrentUserPremium,
  shouldHideReadMarks,
  visibility
}) => {
  const {
    updateGlobalPrivacySettings,
    openPremiumModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const canShowHideReadTime = visibility === 'nobody' || visibility === 'contacts';
  const handleChangeShouldHideReadMarks = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(isEnabled => updateGlobalPrivacySettings({
    shouldHideReadMarks: isEnabled
  }));
  const handleOpenPremiumModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    openPremiumModal({
      initialSection: 'last_seen'
    });
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, canShowHideReadTime && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_7__["default"], {
    label: lang('HideReadTime'),
    checked: shouldHideReadMarks,
    onCheck: handleChangeShouldHideReadMarks
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description-larger",
    dir: lang.isRtl ? 'rtl' : undefined
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(lang('HideReadTimeInfo'), ['br']))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_8__["default"], {
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_StarIcon__WEBPACK_IMPORTED_MODULE_6__["default"], {
      className: "icon ListItem-main-icon",
      type: "premium",
      size: "big"
    }),
    onClick: handleOpenPremiumModal
  }, isCurrentUserPremium ? lang('PrivacyLastSeenPremiumForPremium') : lang('PrivacyLastSeenPremium')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description-larger premium-info",
    dir: lang.isRtl ? 'rtl' : undefined
  }, isCurrentUserPremium ? lang('PrivacyLastSeenPremiumInfoForPremium') : lang('PrivacyLastSeenPremiumInfo'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectIsCurrentUserPremium)(global),
    shouldHideReadMarks: Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectShouldHideReadMarks)(global))
  };
})(SettingsPrivacyLastSeen)));

/***/ }),

/***/ "./src/components/left/settings/SettingsPrivacyPublicProfilePhoto.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/left/settings/SettingsPrivacyPublicProfilePhoto.tsx ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_SelectAvatar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/SelectAvatar */ "./src/components/ui/SelectAvatar.tsx");
/* harmony import */ var _SettingsPrivacyPublicPhoto_module_scss__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SettingsPrivacyPublicPhoto.module.scss */ "./src/components/left/settings/SettingsPrivacyPublicPhoto.module.scss");









const SettingsPrivacyPublicProfilePhoto = ({
  currentUserId,
  hasCurrentUserFullInfo,
  currentUserFallbackPhoto
}) => {
  const {
    loadFullUser,
    uploadProfilePhoto,
    deleteProfilePhoto,
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const [isDeleteFallbackPhotoModalOpen, openDeleteFallbackPhotoModal, closeDeleteFallbackPhotoModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_2__["default"])(false);

  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!hasCurrentUserFullInfo) {
      loadFullUser({
        userId: currentUserId
      });
    }
  }, [hasCurrentUserFullInfo, currentUserId, loadFullUser]);
  const handleSelectFile = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(file => {
    uploadProfilePhoto({
      file,
      isFallback: true
    });
    showNotification({
      message: lang('Privacy.ProfilePhoto.PublicPhotoSuccess')
    });
  }, [lang, showNotification, uploadProfilePhoto]);
  const handleConfirmDelete = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeDeleteFallbackPhotoModal();
    deleteProfilePhoto({
      photo: currentUserFallbackPhoto
    });
  }, [closeDeleteFallbackPhotoModal, deleteProfilePhoto, currentUserFallbackPhoto]);
  const handleOpenFileSelector = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    inputRef.current?.click();
  }, []);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_6__["default"], {
    narrow: true,
    icon: "camera-add",
    onClick: handleOpenFileSelector
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_SelectAvatar__WEBPACK_IMPORTED_MODULE_7__["default"], {
    onChange: handleSelectFile,
    inputRef: inputRef
  }), lang(currentUserFallbackPhoto ? 'Privacy.ProfilePhoto.UpdatePublicPhoto' : 'Privacy.ProfilePhoto.SetPublicPhoto')), currentUserFallbackPhoto && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_6__["default"], {
    narrow: true,
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_4__["default"], {
      photo: currentUserFallbackPhoto,
      size: "mini",
      className: _SettingsPrivacyPublicPhoto_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].fallbackPhoto
    }),
    onClick: openDeleteFallbackPhotoModal,
    destructive: true
  }, lang(currentUserFallbackPhoto.isVideo ? 'Privacy.ProfilePhoto.RemovePublicVideo' : 'Privacy.ProfilePhoto.RemovePublicPhoto'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_5__["default"], {
    isOpen: isDeleteFallbackPhotoModalOpen,
    onClose: closeDeleteFallbackPhotoModal,
    text: lang('Privacy.ResetPhoto.Confirm'),
    confirmLabel: lang('Delete'),
    confirmHandler: handleConfirmDelete,
    confirmIsDestructive: true
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description-larger",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('Privacy.ProfilePhoto.PublicPhotoInfo')));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsPrivacyPublicProfilePhoto));

/***/ }),

/***/ "./src/components/left/settings/SettingsPrivacyVisibility.tsx":
/*!********************************************************************!*\
  !*** ./src/components/left/settings/SettingsPrivacyVisibility.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _helpers_privacy__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./helpers/privacy */ "./src/components/left/settings/helpers/privacy.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");
/* harmony import */ var _PremiumStatusItem__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./PremiumStatusItem */ "./src/components/left/settings/PremiumStatusItem.tsx");
/* harmony import */ var _PrivacyLockedOption__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./PrivacyLockedOption */ "./src/components/left/settings/PrivacyLockedOption.tsx");
/* harmony import */ var _SettingsPrivacyLastSeen__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SettingsPrivacyLastSeen */ "./src/components/left/settings/SettingsPrivacyLastSeen.tsx");
/* harmony import */ var _SettingsPrivacyPublicProfilePhoto__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./SettingsPrivacyPublicProfilePhoto */ "./src/components/left/settings/SettingsPrivacyPublicProfilePhoto.tsx");















const SettingsPrivacyVisibility = ({
  screen,
  isActive,
  primaryPrivacy,
  secondaryPrivacy,
  currentUserId,
  hasCurrentUserFullInfo,
  currentUserFallbackPhoto,
  isPremiumRequired,
  onScreenSelect,
  onReset
}) => {
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onReset
  });
  const secondaryScreen = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    switch (screen) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCall:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2P;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumber:
        {
          return primaryPrivacy?.visibility === 'nobody' ? _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyAddByPhone : undefined;
        }
      default:
        return undefined;
    }
  }, [primaryPrivacy, screen]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(PrivacySubsection, {
    screen: screen,
    privacy: primaryPrivacy,
    onScreenSelect: onScreenSelect,
    isPremiumRequired: isPremiumRequired
  }), screen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhoto && primaryPrivacy?.visibility !== 'everybody' && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPrivacyPublicProfilePhoto__WEBPACK_IMPORTED_MODULE_14__["default"], {
    currentUserId: currentUserId,
    hasCurrentUserFullInfo: hasCurrentUserFullInfo,
    currentUserFallbackPhoto: currentUserFallbackPhoto
  }), screen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPrivacyLastSeen__WEBPACK_IMPORTED_MODULE_13__["default"], {
    visibility: primaryPrivacy?.visibility
  }), secondaryScreen && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(PrivacySubsection, {
    screen: secondaryScreen,
    privacy: secondaryPrivacy,
    onScreenSelect: onScreenSelect
  }));
};
function PrivacySubsection({
  screen,
  privacy,
  onScreenSelect,
  isPremiumRequired
}) {
  const {
    setPrivacyVisibility
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const visibilityOptions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const hasNobody = screen !== _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyAddByPhone;
    const options = [{
      value: 'everybody',
      label: oldLang('P2PEverybody')
    }, {
      value: 'contacts',
      label: isPremiumRequired ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PrivacyLockedOption__WEBPACK_IMPORTED_MODULE_12__["default"], {
        label: oldLang('P2PContacts')
      }) : oldLang('P2PContacts'),
      hidden: isPremiumRequired
    }];
    if (hasNobody) {
      options.push({
        value: 'nobody',
        label: isPremiumRequired ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PrivacyLockedOption__WEBPACK_IMPORTED_MODULE_12__["default"], {
          label: oldLang('P2PNobody')
        }) : oldLang('P2PNobody'),
        hidden: isPremiumRequired
      });
    }
    return options;
  }, [oldLang, screen, isPremiumRequired]);
  const primaryExceptionLists = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (screen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyAddByPhone) {
      return {
        shouldShowDenied: false,
        shouldShowAllowed: false
      };
    }
    return {
      shouldShowDenied: privacy?.visibility !== 'nobody',
      shouldShowAllowed: privacy?.visibility !== 'everybody'
    };
  }, [privacy, screen]);
  const privacyKey = (0,_helpers_privacy__WEBPACK_IMPORTED_MODULE_4__.getPrivacyKey)(screen);
  const descriptionText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    switch (screen) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGifts:
        return lang('PrivacyGiftsInfo');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen:
        return oldLang('CustomHelp');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyAddByPhone:
        {
          return privacy?.visibility === 'everybody' ? oldLang('PrivacyPhoneInfo') : oldLang('PrivacyPhoneInfo3');
        }
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages:
        return oldLang('PrivacyVoiceMessagesInfo');
      default:
        return undefined;
    }
  }, [oldLang, lang, screen, privacy]);
  const headerText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    switch (screen) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumber:
        return oldLang('PrivacyPhoneTitle');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyAddByPhone:
        return oldLang('PrivacyPhoneTitle2');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen:
        return oldLang('LastSeenTitle');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhoto:
        return oldLang('PrivacyProfilePhotoTitle');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBio:
        return oldLang('PrivacyBioTitle');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthday:
        return oldLang('PrivacyBirthdayTitle');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGifts:
        return lang('PrivacyGiftsTitle');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwarding:
        return oldLang('PrivacyForwardsTitle');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages:
        return oldLang('PrivacyVoiceMessagesTitle');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChats:
        return oldLang('WhoCanAddMe');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCall:
        return oldLang('WhoCanCallMe');
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2P:
        return oldLang('PrivacyP2P');
      default:
        return undefined;
    }
  }, [oldLang, lang, screen]);
  const prepareSubtitle = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])((userIds, chatIds, shouldAllowPremium, botsPrivacy) => {
    const userIdsCount = userIds?.length || 0;
    const chatIdsCount = chatIds?.length || 0;
    const isAllowBots = botsPrivacy === 'allow';
    const hasPeers = userIdsCount || chatIdsCount;
    if (!hasPeers && !isAllowBots) {
      return shouldAllowPremium ? oldLang('PrivacyPremium') : oldLang('EditAdminAddUsers');
    } else if (shouldAllowPremium) {
      return oldLang('ContactsAndPremium');
    }
    const userCountString = userIdsCount > 0 ? oldLang('Users', userIdsCount) : undefined;
    const chatCountString = chatIdsCount > 0 ? oldLang('Chats', chatIdsCount) : undefined;
    const botPrivacyString = isAllowBots ? lang('PrivacyValueBots') : '';
    const peersString = lang.conjunction([userCountString, chatCountString].filter(Boolean));
    return [botPrivacyString, peersString].filter(Boolean).join(' ');
  });
  const allowedString = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return prepareSubtitle(privacy?.allowUserIds, privacy?.allowChatIds, privacy?.shouldAllowPremium, privacy?.botsPrivacy);
  }, [privacy]);
  const blockString = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return prepareSubtitle(privacy?.blockUserIds, privacy?.blockChatIds);
  }, [privacy]);
  const handleVisibilityChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    setPrivacyVisibility({
      privacyKey: privacyKey,
      visibility: value
    });
  }, [privacyKey]);
  const allowedContactsScreen = (() => {
    switch (screen) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumber:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberAllowedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenAllowedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhoto:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoAllowedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBio:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioAllowedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthday:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayAllowedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGifts:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsAllowedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwarding:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingAllowedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCall:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallAllowedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2P:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PAllowedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesAllowedContacts;
      default:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsAllowedContacts;
    }
  })();
  const deniedContactsScreen = (() => {
    switch (screen) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumber:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberDeniedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenDeniedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhoto:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoDeniedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBio:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioDeniedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthday:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayDeniedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGifts:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsDeniedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwarding:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingDeniedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCall:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallDeniedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2P:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PDeniedContacts;
      case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesDeniedContacts;
      default:
        return _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsDeniedContacts;
    }
  })();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: oldLang.isRtl ? 'rtl' : undefined
  }, headerText), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: `visibility-${privacyKey}`,
    options: visibilityOptions,
    onChange: handleVisibilityChange,
    selected: privacy?.visibility
  }), descriptionText && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description-larger",
    dir: oldLang.isRtl ? 'rtl' : undefined
  }, descriptionText)), !isPremiumRequired && (primaryExceptionLists.shouldShowAllowed || primaryExceptionLists.shouldShowDenied) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: oldLang.isRtl ? 'rtl' : undefined
  }, oldLang('PrivacyExceptions')), primaryExceptionLists.shouldShowAllowed && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    icon: "add-user"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => {
      onScreenSelect(allowedContactsScreen);
    }
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item full-size"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('AlwaysAllow')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, allowedString))), primaryExceptionLists.shouldShowDenied && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    icon: "delete-user"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => {
      onScreenSelect(deniedContactsScreen);
    }
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item full-size"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, oldLang('NeverAllow')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, blockString)))), isPremiumRequired && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PremiumStatusItem__WEBPACK_IMPORTED_MODULE_11__["default"], null));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  screen
}) => {
  let primaryPrivacy;
  let secondaryPrivacy;
  const {
    currentUserId,
    settings: {
      privacy
    }
  } = global;
  const currentUserFullInfo = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUserFullInfo)(global, currentUserId);
  switch (screen) {
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumber:
      primaryPrivacy = privacy.phoneNumber;
      secondaryPrivacy = privacy.addByPhone;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeen:
      primaryPrivacy = privacy.lastSeen;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhoto:
      primaryPrivacy = privacy.profilePhoto;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBio:
      primaryPrivacy = privacy.bio;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthday:
      primaryPrivacy = privacy.birthday;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGifts:
      primaryPrivacy = privacy.gifts;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2P:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCall:
      primaryPrivacy = privacy.phoneCall;
      secondaryPrivacy = privacy.phoneP2P;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwarding:
      primaryPrivacy = privacy.forwards;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages:
      primaryPrivacy = privacy.voiceMessages;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChats:
      primaryPrivacy = privacy.chatInvite;
      break;
  }
  if (!primaryPrivacy) {
    return {
      currentUserId: currentUserId,
      hasCurrentUserFullInfo: Boolean(currentUserFullInfo),
      currentUserFallbackPhoto: currentUserFullInfo?.fallbackPhoto
    };
  }
  return {
    primaryPrivacy,
    secondaryPrivacy,
    currentUserId: currentUserId,
    hasCurrentUserFullInfo: Boolean(currentUserFullInfo),
    currentUserFallbackPhoto: currentUserFullInfo?.fallbackPhoto,
    isPremiumRequired: screen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessages && !(0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global)
  };
})(SettingsPrivacyVisibility)));

/***/ }),

/***/ "./src/components/left/settings/SettingsPrivacyVisibilityExceptionList.tsx":
/*!*********************************************************************************!*\
  !*** ./src/components/left/settings/SettingsPrivacyVisibilityExceptionList.tsx ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_objects_customPeer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/objects/customPeer */ "./src/util/objects/customPeer.ts");
/* harmony import */ var _helpers_privacy__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./helpers/privacy */ "./src/components/left/settings/helpers/privacy.ts");
/* harmony import */ var _hooks_useFolderManager__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useFolderManager */ "./src/hooks/useFolderManager.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");















const PREMIUM_CATEGORY = [_util_objects_customPeer__WEBPACK_IMPORTED_MODULE_6__.CUSTOM_PEER_PREMIUM];
const SettingsPrivacyVisibilityExceptionList = ({
  isAllowList,
  withPremiumCategory,
  withMiniAppsCategory,
  screen,
  isActive,
  currentUserId,
  settings,
  onScreenSelect,
  onReset
}) => {
  const {
    setPrivacySettings
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const customPeerBots = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return {
      isCustomPeer: true,
      type: 'bots',
      title: lang('PrivacyValueBots'),
      avatarIcon: 'bots',
      isAvatarSquare: true,
      peerColorId: 6
    };
  }, [lang]);
  const miniAppsCategory = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return [customPeerBots];
  }, [customPeerBots]);
  const selectedContactIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!settings) {
      return [];
    }
    if (isAllowList) {
      return [...settings.allowUserIds, ...settings.allowChatIds];
    } else {
      return [...settings.blockUserIds, ...settings.blockChatIds];
    }
  }, [isAllowList, settings]);
  const selectedCategoryTypes = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!settings) {
      return [];
    }
    if (settings.shouldAllowPremium) {
      return [_util_objects_customPeer__WEBPACK_IMPORTED_MODULE_6__.CUSTOM_PEER_PREMIUM.type];
    }
    if (settings.botsPrivacy === 'allow' && isAllowList) {
      return [customPeerBots.type];
    }
    return [];
  }, [settings, isAllowList, customPeerBots]);
  const [searchQuery, setSearchQuery] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [isSubmitShown, setIsSubmitShown] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [newSelectedContactIds, setNewSelectedContactIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(selectedContactIds);
  const [newSelectedCategoryTypes, setNewSelectedCategoryTypes] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(selectedCategoryTypes);

  // Reset selected contact ids on change from other client when screen is not active
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isActive) {
      setNewSelectedContactIds(selectedContactIds);
      setNewSelectedCategoryTypes(selectedCategoryTypes);
    }
  }, [isActive, selectedCategoryTypes, selectedContactIds]);
  const folderAllOrderedIds = (0,_hooks_useFolderManager__WEBPACK_IMPORTED_MODULE_8__.useFolderManagerForOrderedIds)(_config__WEBPACK_IMPORTED_MODULE_3__.ALL_FOLDER_ID);
  const folderArchivedOrderedIds = (0,_hooks_useFolderManager__WEBPACK_IMPORTED_MODULE_8__.useFolderManagerForOrderedIds)(_config__WEBPACK_IMPORTED_MODULE_3__.ARCHIVED_FOLDER_ID);
  const displayedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    // No need for expensive global updates on chats, so we avoid them
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    const chatIds = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_5__.unique)([...(folderAllOrderedIds || []), ...(folderArchivedOrderedIds || [])]).filter(chatId => {
      const chat = chatsById[chatId];
      const user = usersById[chatId];
      const isDeleted = user && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isDeletedUser)(user);
      const isChannel = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatChannel)(chat);
      return chatId !== currentUserId && chatId !== _config__WEBPACK_IMPORTED_MODULE_3__.SERVICE_NOTIFICATIONS_USER_ID && !isChannel && !isDeleted;
    });
    const filteredChats = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.filterChatsByName)(oldLang, chatIds, chatsById, searchQuery);

    // Show only relevant items
    if (searchQuery) return filteredChats;
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_5__.unique)([...selectedContactIds, ...(0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.filterChatsByName)(oldLang, chatIds, chatsById, searchQuery)]);
  }, [folderAllOrderedIds, folderArchivedOrderedIds, selectedContactIds, oldLang, searchQuery, currentUserId]);
  const handleSelectedCategoriesChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    setNewSelectedCategoryTypes(value);
    setIsSubmitShown(true);
  }, []);
  const handleSelectedContactIdsChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    setNewSelectedContactIds(value);
    setIsSubmitShown(true);
  }, []);
  const handleSubmit = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setPrivacySettings({
      privacyKey: (0,_helpers_privacy__WEBPACK_IMPORTED_MODULE_7__.getPrivacyKey)(screen),
      isAllowList: Boolean(isAllowList),
      updatedIds: newSelectedContactIds,
      isPremiumAllowed: newSelectedCategoryTypes.includes(_util_objects_customPeer__WEBPACK_IMPORTED_MODULE_6__.CUSTOM_PEER_PREMIUM.type) || undefined,
      botsPrivacy: !withMiniAppsCategory ? 'none' : newSelectedCategoryTypes.includes(customPeerBots.type) ? 'allow' : 'disallow'
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Privacy);
  }, [isAllowList, withMiniAppsCategory, newSelectedCategoryTypes, newSelectedContactIds, onScreenSelect, screen, customPeerBots]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__["default"])({
    isActive,
    onBack: onReset
  });
  function getCustomCategory() {
    if (withPremiumCategory) return PREMIUM_CATEGORY;
    if (withMiniAppsCategory && isAllowList) return miniAppsCategory;
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "NewChat-inner step-1"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_13__["default"], {
    categories: getCustomCategory(),
    itemIds: displayedIds || [],
    selectedIds: newSelectedContactIds,
    selectedCategories: newSelectedCategoryTypes,
    filterValue: searchQuery,
    filterPlaceholder: isAllowList ? oldLang('AlwaysAllowPlaceholder') : oldLang('NeverAllowPlaceholder'),
    categoryPlaceholderKey: "PrivacyUserTypes",
    searchInputId: "new-group-picker-search",
    isSearchable: true,
    onSelectedIdsChange: handleSelectedContactIdsChange,
    onSelectedCategoriesChange: handleSelectedCategoriesChange,
    onFilterChange: setSearchQuery,
    allowMultiple: true,
    itemInputType: "checkbox",
    withDefaultPadding: true,
    withStatus: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isShown: isSubmitShown,
    onClick: handleSubmit,
    ariaLabel: isAllowList ? oldLang('AlwaysAllow') : oldLang('NeverAllow')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "check"
  })));
};
function getCurrentPrivacySettings(global, screen) {
  const {
    privacy
  } = global.settings;
  switch (screen) {
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneNumberDeniedContacts:
      return privacy.phoneNumber;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyLastSeenDeniedContacts:
      return privacy.lastSeen;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyProfilePhotoDeniedContacts:
      return privacy.profilePhoto;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBioDeniedContacts:
      return privacy.bio;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyBirthdayDeniedContacts:
      return privacy.birthday;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGiftsDeniedContacts:
      return privacy.gifts;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneCallDeniedContacts:
      return privacy.phoneCall;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyPhoneP2PDeniedContacts:
      return privacy.phoneP2P;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyForwardingDeniedContacts:
      return privacy.forwards;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyVoiceMessagesDeniedContacts:
      return privacy.voiceMessages;
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsDeniedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PrivacyGroupChatsAllowedContacts:
      return privacy.chatInvite;
  }
  return undefined;
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  screen
}) => {
  return {
    currentUserId: global.currentUserId,
    settings: getCurrentPrivacySettings(global, screen)
  };
})(SettingsPrivacyVisibilityExceptionList)));

/***/ }),

/***/ "./src/components/left/settings/SettingsQuickReaction.tsx":
/*!****************************************************************!*\
  !*** ./src/components/left/settings/SettingsQuickReaction.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/reactions/ReactionStaticEmoji */ "./src/components/common/reactions/ReactionStaticEmoji.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");





const SettingsQuickReaction = ({
  isActive,
  availableReactions,
  selectedReaction,
  onReset
}) => {
  const {
    setDefaultReaction
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_2__["default"])({
    isActive,
    onBack: onReset
  });
  const options = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (availableReactions || []).filter(availableReaction => !availableReaction.isInactive).map(availableReaction => ({
    label: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_3__["default"], {
      reaction: availableReaction.reaction,
      availableReactions: availableReactions
    }), availableReaction.title),
    value: availableReaction.reaction.emoticon
  })), [availableReactions]);
  const handleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(reaction => {
    setDefaultReaction({
      reaction: {
        type: 'emoji',
        emoticon: reaction
      }
    });
  }, [setDefaultReaction]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content settings-item custom-scroll settings-quick-reaction"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_4__["default"], {
    name: "quick-reaction-settings",
    options: options,
    selected: selectedReaction,
    onChange: handleChange,
    withIcon: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    config,
    reactions
  } = global;
  return {
    availableReactions: reactions.availableReactions,
    selectedReaction: config?.defaultReaction
  };
})(SettingsQuickReaction)));

/***/ }),

/***/ "./src/components/left/settings/SettingsStickers.tsx":
/*!***********************************************************!*\
  !*** ./src/components/left/settings/SettingsStickers.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/reactions/ReactionStaticEmoji */ "./src/components/common/reactions/ReactionStaticEmoji.tsx");
/* harmony import */ var _common_StickerSetCard__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/StickerSetCard */ "./src/components/common/StickerSetCard.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");














const DEFAULT_REACTION_SIZE = 1.5 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__.REM;
const SettingsStickers = ({
  isActive,
  addedSetIds,
  customEmojiSetIds,
  stickerSetsById,
  defaultReaction,
  shouldSuggestStickers,
  shouldUpdateStickerSetOrder,
  availableReactions,
  canPlayAnimatedEmojis,
  onReset,
  onScreenSelect
}) => {
  const {
    setSettingOption,
    openStickerSet
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();

  // eslint-disable-next-line no-null/no-null
  const stickerSettingsRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    observe: observeIntersectionForCovers
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_8__.useIntersectionObserver)({
    rootRef: stickerSettingsRef
  });
  const handleStickerSetClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(sticker => {
    openStickerSet({
      stickerSetInfo: sticker.stickerSetInfo
    });
  }, [openStickerSet]);
  const handleSuggestStickerSetOrderChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newValue => {
    setSettingOption({
      shouldUpdateStickerSetOrder: newValue
    });
  }, [setSettingOption]);
  const handleSuggestStickersChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newValue => {
    setSettingOption({
      shouldSuggestStickers: newValue
    });
  }, [setSettingOption]);
  const stickerSets = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => addedSetIds && Object.values((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.pick)(stickerSetsById, addedSetIds)), [addedSetIds, stickerSetsById]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__["default"], {
    label: lang('SuggestStickers'),
    checked: shouldSuggestStickers,
    onCheck: handleSuggestStickersChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.CustomEmoji),
    icon: "smile"
  }, lang('StickersList.EmojiItem'), customEmojiSetIds && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "settings-item__current-value"
  }, customEmojiSetIds.length)), defaultReaction && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
    className: "SettingsDefaultReaction",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.QuickReaction)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_10__["default"], {
    reaction: defaultReaction,
    className: "current-default-reaction",
    size: DEFAULT_REACTION_SIZE,
    availableReactions: availableReactions
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "title"
  }, lang('DoubleTapSetting')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('InstalledStickers.DynamicPackOrder')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__["default"], {
    label: lang('InstalledStickers.DynamicPackOrder'),
    checked: shouldUpdateStickerSetOrder,
    onCheck: handleSuggestStickerSetOrderChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mt-3",
    dir: "auto"
  }, lang('InstalledStickers.DynamicPackOrderInfo'))), stickerSets && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('ChooseStickerMyStickerSets')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: stickerSettingsRef
  }, stickerSets.map(stickerSet => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_StickerSetCard__WEBPACK_IMPORTED_MODULE_11__["default"], {
    key: stickerSet.id,
    stickerSet: stickerSet,
    observeIntersection: observeIntersectionForCovers,
    onClick: handleStickerSetClick,
    noPlay: !canPlayAnimatedEmojis
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mt-3",
    dir: "auto"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang('StickersBotInfo'), ['links']))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    ...(0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.pick)(global.settings.byKey, ['shouldSuggestStickers', 'shouldUpdateStickerSetOrder']),
    addedSetIds: global.stickers.added.setIds,
    customEmojiSetIds: global.customEmojis.added.setIds,
    stickerSetsById: global.stickers.setsById,
    defaultReaction: global.config?.defaultReaction,
    availableReactions: global.reactions.availableReactions,
    canPlayAnimatedEmojis: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCanPlayAnimatedEmojis)(global)
  };
})(SettingsStickers)));

/***/ }),

/***/ "./src/components/left/settings/WallpaperTile.tsx":
/*!********************************************************!*\
  !*** ./src/components/left/settings/WallpaperTile.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_cacheApi__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/cacheApi */ "./src/util/cacheApi.ts");
/* harmony import */ var _util_files__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/files */ "./src/util/files.ts");
/* harmony import */ var _hooks_useCanvasBlur__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useCanvasBlur */ "./src/hooks/useCanvasBlur.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useMediaWithLoadProgress__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useMediaWithLoadProgress */ "./src/hooks/useMediaWithLoadProgress.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _ui_ProgressSpinner__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/ProgressSpinner */ "./src/components/ui/ProgressSpinner.tsx");
/* harmony import */ var _WallpaperTile_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./WallpaperTile.scss */ "./src/components/left/settings/WallpaperTile.scss");













const WallpaperTile = ({
  wallpaper,
  theme,
  isSelected,
  onClick
}) => {
  const {
    slug,
    document
  } = wallpaper;
  const localMediaHash = `wallpaper${document.id}`;
  const localBlobUrl = document.previewBlobUrl;
  const previewBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_7__["default"])(`${localMediaHash}?size=m`);
  const thumbRef = (0,_hooks_useCanvasBlur__WEBPACK_IMPORTED_MODULE_6__["default"])(document.thumbnail?.dataUri, Boolean(previewBlobUrl), true);
  const {
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(Boolean(previewBlobUrl || localBlobUrl), undefined, undefined, 'slow');
  const isLoadingRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);
  const [isLoadAllowed, setIsLoadAllowed] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const {
    mediaData: fullMedia,
    loadProgress
  } = (0,_hooks_useMediaWithLoadProgress__WEBPACK_IMPORTED_MODULE_8__["default"])(localMediaHash, !isLoadAllowed);
  const wasLoadDisabled = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_9__["default"])(isLoadAllowed) === false;
  const {
    shouldRender: shouldRenderSpinner,
    transitionClassNames: spinnerClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(isLoadAllowed && !fullMedia || slug === _types__WEBPACK_IMPORTED_MODULE_1__.UPLOADING_WALLPAPER_SLUG, undefined, wasLoadDisabled, 'slow');
  // To prevent triggering of the effect for useCallback
  const cacheKeyRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  cacheKeyRef.current = theme;
  const handleSelect = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    (async () => {
      const blob = await (0,_util_files__WEBPACK_IMPORTED_MODULE_5__.fetchBlob)(fullMedia);
      await _util_cacheApi__WEBPACK_IMPORTED_MODULE_4__.save(_config__WEBPACK_IMPORTED_MODULE_2__.CUSTOM_BG_CACHE_NAME, cacheKeyRef.current, blob);
      onClick(slug);
    })();
  }, [fullMedia, onClick, slug]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    // If we've clicked on a wallpaper, select it when full media is loaded
    if (fullMedia && isLoadingRef.current) {
      handleSelect();
      isLoadingRef.current = false;
    }
  }, [fullMedia, handleSelect]);
  const handleClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (fullMedia) {
      handleSelect();
    } else {
      isLoadingRef.current = true;
      setIsLoadAllowed(isAllowed => !isAllowed);
    }
  }, [fullMedia, handleSelect]);
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('WallpaperTile', isSelected && 'selected');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: className,
    onClick: handleClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "media-inner"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: thumbRef,
    className: "thumbnail"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: previewBlobUrl || localBlobUrl,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('full-media', transitionClassNames),
    alt: "",
    draggable: false
  }), shouldRenderSpinner && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('spinner-container', spinnerClassNames)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ProgressSpinner__WEBPACK_IMPORTED_MODULE_11__["default"], {
    progress: loadProgress,
    onClick: handleClick
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(WallpaperTile));

/***/ }),

/***/ "./src/components/left/settings/folders/FolderTitleInput.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/left/settings/folders/FolderTitleInput.tsx ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _middle_composer_EmojiPicker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../middle/composer/EmojiPicker */ "./src/components/middle/composer/EmojiPicker.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _FolderTitleInput_scss__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./FolderTitleInput.scss */ "./src/components/left/settings/folders/FolderTitleInput.scss");









const FolderTitleInput = ({
  value,
  error,
  lang,
  onChange,
  onEmojiSelect
}) => {
  const [isEmojiPickerOpen, openEmojiPicker, closeEmojiPicker] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const [folderName, setFolderName] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('folder');
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const handleEmojiSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])((emoji, name) => {
    setFolderName(name);
    if (onEmojiSelect) {
      onEmojiSelect(emoji);
    }
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "folder-title-input-wrapper"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    ref: inputRef,
    className: "mb-0",
    label: lang('FilterNameHint'),
    value: value,
    onChange: onChange,
    error: error
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_4__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])('emoji-button', isEmojiPickerOpen && 'active'),
    round: true,
    color: "translucent",
    onClick: isEmojiPickerOpen ? closeEmojiPicker : openEmojiPicker,
    ariaLabel: "Choose emoji"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("i", {
    // className={buildClassName(`icon icon-${folderName}`)}
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])('icon icon-folder')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isOpen: isEmojiPickerOpen,
    onClose: closeEmojiPicker,
    className: "emoji-menu",
    positionX: "left",
    positionY: "top",
    transformOriginX: 90,
    autoClose: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "SymbolMenu-main "
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_middle_composer_EmojiPicker__WEBPACK_IMPORTED_MODULE_3__["default"], {
    onEmojiSelect: handleEmojiSelect,
    isFolderPicker: true
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (FolderTitleInput);

/***/ }),

/***/ "./src/components/left/settings/folders/SettingsFolders.tsx":
/*!******************************************************************!*\
  !*** ./src/components/left/settings/folders/SettingsFolders.tsx ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../types */ "./src/types/index.ts");
/* harmony import */ var _hooks_reducers_useFoldersReducer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/reducers/useFoldersReducer */ "./src/hooks/reducers/useFoldersReducer.ts");
/* harmony import */ var _SettingsFoldersChatFilters__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SettingsFoldersChatFilters */ "./src/components/left/settings/folders/SettingsFoldersChatFilters.tsx");
/* harmony import */ var _SettingsFoldersEdit__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./SettingsFoldersEdit */ "./src/components/left/settings/folders/SettingsFoldersEdit.tsx");
/* harmony import */ var _SettingsFoldersMain__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SettingsFoldersMain */ "./src/components/left/settings/folders/SettingsFoldersMain.tsx");
/* harmony import */ var _SettingsShareChatlist__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./SettingsShareChatlist */ "./src/components/left/settings/folders/SettingsShareChatlist.tsx");
/* harmony import */ var _SettingsFolders_scss__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SettingsFolders.scss */ "./src/components/left/settings/folders/SettingsFolders.scss");









const TRANSITION_DURATION = 200;
const SettingsFolders = ({
  currentScreen,
  shownScreen,
  state,
  dispatch,
  isActive,
  onScreenSelect,
  onReset
}) => {
  const {
    openShareChatFolderModal,
    editChatFolder,
    addChatFolder
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const handleReset = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder || currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder || currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderFromChatList || currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderInvites) {
      setTimeout(() => {
        dispatch({
          type: 'reset'
        });
      }, TRANSITION_DURATION);
    }
    if (currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats || currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChats) {
      if (state.mode === 'create') {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder);
      } else {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder);
      }
      return;
    }
    onReset();
  }, [state.mode, dispatch, currentScreen, onReset, onScreenSelect]);
  const isCreating = state.mode === 'create';
  const saveState = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newState => {
    const {
      title,
      emoticon
    } = newState.folder;
    console.log(newState.folder);
    if (!title) {
      dispatch({
        type: 'setError',
        payload: _SettingsFoldersEdit__WEBPACK_IMPORTED_MODULE_5__.ERROR_NO_TITLE
      });
      return false;
    }
    const {
      selectedChatIds: includedChatIds,
      selectedChatTypes: includedChatTypes
    } = (0,_hooks_reducers_useFoldersReducer__WEBPACK_IMPORTED_MODULE_3__.selectChatFilters)(newState, 'included');
    if (!includedChatIds.length && !Object.keys(includedChatTypes).length) {
      dispatch({
        type: 'setError',
        payload: _SettingsFoldersEdit__WEBPACK_IMPORTED_MODULE_5__.ERROR_NO_CHATS
      });
      return false;
    }
    if (!isCreating) {
      editChatFolder({
        id: newState.folderId,
        folderUpdate: newState.folder
      });
    } else {
      addChatFolder({
        folder: newState.folder
      });
    }
    dispatch({
      type: 'setError',
      payload: undefined
    });
    dispatch({
      type: 'setIsTouched',
      payload: false
    });
    return true;
  }, [dispatch, isCreating]);
  const handleSaveFolder = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(cb => {
    if (!saveState(state)) {
      return;
    }
    cb?.();
  }, [saveState, state]);
  const handleSaveFilter = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const newState = dispatch({
      type: 'saveFilters'
    });
    handleReset();
    saveState(newState);
  }, [dispatch, handleReset, saveState]);
  const handleCreateFolder = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    dispatch({
      type: 'reset'
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder);
  }, [onScreenSelect, dispatch]);
  const handleEditFolder = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(folder => {
    dispatch({
      type: 'editFolder',
      payload: folder
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder);
  }, [dispatch, onScreenSelect]);
  const handleAddIncludedChats = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    dispatch({
      type: 'editIncludeFilters'
    });
    onScreenSelect(currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderFromChatList ? _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChatsFromChatList : _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats);
  }, [currentScreen, dispatch, onScreenSelect]);
  const handleAddExcludedChats = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    dispatch({
      type: 'editExcludeFilters'
    });
    onScreenSelect(currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderFromChatList ? _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChatsFromChatList : _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChats);
  }, [currentScreen, dispatch, onScreenSelect]);
  const handleShareFolder = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    openShareChatFolderModal({
      folderId: state.folderId,
      noRequestNextScreen: true
    });
    dispatch({
      type: 'setIsChatlist',
      payload: true
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersShare);
  }, [dispatch, onScreenSelect, state.folderId]);
  const handleOpenInvite = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(url => {
    openShareChatFolderModal({
      folderId: state.folderId,
      url,
      noRequestNextScreen: true
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersShare);
  }, [onScreenSelect, state.folderId]);
  switch (currentScreen) {
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Folders:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsFoldersMain__WEBPACK_IMPORTED_MODULE_6__["default"], {
        onCreateFolder: handleCreateFolder,
        onEditFolder: handleEditFolder,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChats].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersCreateFolder:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolder:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderFromChatList:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderInvites:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsFoldersEdit__WEBPACK_IMPORTED_MODULE_5__["default"], {
        state: state,
        dispatch: dispatch,
        onAddIncludedChats: handleAddIncludedChats,
        onAddExcludedChats: handleAddExcludedChats,
        onShareFolder: handleShareFolder,
        onOpenInvite: handleOpenInvite,
        onReset: handleReset,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChats].includes(shownScreen),
        isOnlyInvites: currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersEditFolderInvites,
        onBack: onReset,
        onSaveFolder: handleSaveFolder
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChats:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersIncludedChatsFromChatList:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsFoldersChatFilters__WEBPACK_IMPORTED_MODULE_4__["default"], {
        mode: "included",
        state: state,
        dispatch: dispatch,
        onReset: handleReset,
        onSaveFilter: handleSaveFilter,
        isActive: isActive
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChats:
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersExcludedChatsFromChatList:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsFoldersChatFilters__WEBPACK_IMPORTED_MODULE_4__["default"], {
        mode: "excluded",
        state: state,
        dispatch: dispatch,
        onReset: handleReset,
        onSaveFilter: handleSaveFilter,
        isActive: isActive
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.FoldersShare:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsShareChatlist__WEBPACK_IMPORTED_MODULE_7__["default"], {
        isActive: isActive,
        onReset: handleReset
      });
    default:
      return undefined;
  }
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsFolders));

/***/ }),

/***/ "./src/components/left/settings/folders/SettingsFoldersChatFilters.tsx":
/*!*****************************************************************************!*\
  !*** ./src/components/left/settings/folders/SettingsFoldersChatFilters.tsx ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors_limits__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../global/selectors/limits */ "./src/global/selectors/limits.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_objects_customPeer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../util/objects/customPeer */ "./src/util/objects/customPeer.ts");
/* harmony import */ var _hooks_reducers_useFoldersReducer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../hooks/reducers/useFoldersReducer */ "./src/hooks/reducers/useFoldersReducer.ts");
/* harmony import */ var _hooks_useFolderManager__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../hooks/useFolderManager */ "./src/hooks/useFolderManager.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../ui/Loading */ "./src/components/ui/Loading.tsx");
















const SettingsFoldersChatFilters = ({
  mode,
  state,
  dispatch,
  isActive,
  onReset,
  onSaveFilter,
  maxChats
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const {
    openLimitReachedModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    chatFilter
  } = state;
  const {
    selectedChatIds,
    selectedChatTypes
  } = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (0,_hooks_reducers_useFoldersReducer__WEBPACK_IMPORTED_MODULE_7__.selectChatFilters)(state, mode, true), [mode, state]);
  const chatTypes = mode === 'included' ? _util_objects_customPeer__WEBPACK_IMPORTED_MODULE_6__.CUSTOM_PEER_INCLUDED_CHAT_TYPES : _util_objects_customPeer__WEBPACK_IMPORTED_MODULE_6__.CUSTOM_PEER_EXCLUDED_CHAT_TYPES;
  const [isTouched, setIsTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const folderAllOrderedIds = (0,_hooks_useFolderManager__WEBPACK_IMPORTED_MODULE_8__.useFolderManagerForOrderedIds)(_config__WEBPACK_IMPORTED_MODULE_2__.ALL_FOLDER_ID);
  const folderArchivedOrderedIds = (0,_hooks_useFolderManager__WEBPACK_IMPORTED_MODULE_8__.useFolderManagerForOrderedIds)(_config__WEBPACK_IMPORTED_MODULE_2__.ARCHIVED_FOLDER_ID);
  const shouldHideChatTypes = state.folder.isChatList;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isActive) {
      setIsTouched(false);
    }
  }, [isActive]);
  const displayedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    // No need for expensive global updates on chats, so we avoid them
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    const chatIds = [...(folderAllOrderedIds || []), ...(folderArchivedOrderedIds || [])];
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_5__.unique)([...(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.filterChatsByName)(lang, chatIds, chatsById, chatFilter)]);
  }, [folderAllOrderedIds, folderArchivedOrderedIds, lang, chatFilter]);
  const handleFilterChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(newFilter => {
    dispatch({
      type: 'setChatFilter',
      payload: newFilter
    });
    setIsTouched(true);
  });
  const handleSelectedIdsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(ids => {
    if (mode === 'included') {
      if (ids.length >= maxChats) {
        openLimitReachedModal({
          limit: 'dialogFiltersChats'
        });
        return;
      }
      dispatch({
        type: 'setIncludeFilters',
        payload: {
          ...state.includeFilters,
          includedChatIds: ids
        }
      });
    } else {
      dispatch({
        type: 'setExcludeFilters',
        payload: {
          ...state.excludeFilters,
          excludedChatIds: ids
        }
      });
    }
    setIsTouched(true);
  });
  const handleSelectedChatTypesChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(keys => {
    const newFilters = {};
    keys.forEach(key => {
      newFilters[key] = true;
    });
    if (mode === 'included') {
      dispatch({
        type: 'setIncludeFilters',
        payload: {
          includedChatIds: selectedChatIds,
          ...newFilters
        }
      });
    } else {
      dispatch({
        type: 'setExcludeFilters',
        payload: {
          excludedChatIds: selectedChatIds,
          ...newFilters
        }
      });
    }
    setIsTouched(true);
  });
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__["default"])({
    isActive,
    onBack: onReset
  });
  if (!displayedIds) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_15__["default"], null);
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Picker settings-folders-chat-list"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_13__["default"], {
    categories: shouldHideChatTypes ? undefined : chatTypes,
    itemIds: displayedIds,
    selectedIds: selectedChatIds,
    selectedCategories: selectedChatTypes,
    filterValue: chatFilter,
    filterPlaceholder: lang('Search'),
    categoryPlaceholderKey: "FilterChatTypes",
    searchInputId: "new-group-picker-search",
    isSearchable: true,
    withDefaultPadding: true,
    withPeerTypes: true,
    allowMultiple: true,
    itemInputType: "checkbox",
    onSelectedIdsChange: handleSelectedIdsChange,
    onSelectedCategoriesChange: handleSelectedChatTypesChange,
    onFilterChange: handleFilterChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isShown: isTouched,
    onClick: onSaveFilter,
    ariaLabel: lang('Save')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "check"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    maxChats: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_4__.selectCurrentLimit)(global, 'dialogFiltersChats')
  };
})(SettingsFoldersChatFilters)));

/***/ }),

/***/ "./src/components/left/settings/folders/SettingsFoldersEdit.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/left/settings/folders/SettingsFoldersEdit.tsx ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ERROR_NO_CHATS: () => (/* binding */ ERROR_NO_CHATS),
/* harmony export */   ERROR_NO_TITLE: () => (/* binding */ ERROR_NO_TITLE),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../global/selectors/limits */ "./src/global/selectors/limits.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_objects_customPeer__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../util/objects/customPeer */ "./src/util/objects/customPeer.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_reducers_useFoldersReducer__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../hooks/reducers/useFoldersReducer */ "./src/hooks/reducers/useFoldersReducer.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../common/AnimatedIcon */ "./src/components/common/AnimatedIcon.tsx");
/* harmony import */ var _common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../common/GroupChatInfo */ "./src/components/common/GroupChatInfo.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _FolderTitleInput__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./FolderTitleInput */ "./src/components/left/settings/folders/FolderTitleInput.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");






















const SUBMIT_TIMEOUT = 500;
const INITIAL_CHATS_LIMIT = 5;
const ERROR_NO_TITLE = 'Please provide a title for this folder.';
const ERROR_NO_CHATS = 'ChatList.Filter.Error.Empty';
const SettingsFoldersEdit = ({
  state,
  dispatch,
  onAddIncludedChats,
  onAddExcludedChats,
  onShareFolder,
  onOpenInvite,
  isActive,
  onReset,
  isRemoved,
  onBack,
  loadedActiveChatIds,
  isOnlyInvites,
  loadedArchivedChatIds,
  invites,
  maxInviteLinks,
  maxChatLists,
  chatListCount,
  onSaveFolder
}) => {
  const {
    loadChatlistInvites,
    openLimitReachedModal,
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const isCreating = state.mode === 'create';
  const isEditingChatList = state.folder.isChatList;
  const [isIncludedChatsListExpanded, setIsIncludedChatsListExpanded] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isExcludedChatsListExpanded, setIsExcludedChatsListExpanded] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [emoji, setEmoji] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isRemoved) {
      onReset();
    }
  }, [isRemoved, onReset]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isActive && state.folderId && state.folder.isChatList) {
      loadChatlistInvites({
        folderId: state.folderId
      });
    }
  }, [isActive, state.folder.isChatList, state.folderId]);
  const {
    selectedChatIds: includedChatIds,
    selectedChatTypes: includedChatTypes
  } = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (0,_hooks_reducers_useFoldersReducer__WEBPACK_IMPORTED_MODULE_10__.selectChatFilters)(state, 'included'), [state]);
  const {
    selectedChatIds: excludedChatIds,
    selectedChatTypes: excludedChatTypes
  } = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (0,_hooks_reducers_useFoldersReducer__WEBPACK_IMPORTED_MODULE_10__.selectChatFilters)(state, 'excluded'), [state]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setIsIncludedChatsListExpanded(false);
    setIsExcludedChatsListExpanded(false);
  }, [state.folderId]);
  const [visibleIncludedChatIds, visibleExcludedChatIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const allLoadedChatsSet = new Set([...(loadedActiveChatIds || []), ...(loadedArchivedChatIds || [])]);
    const loadedIncludedChatIds = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_6__.findIntersectionWithSet)(includedChatIds, allLoadedChatsSet);
    const loadedExcludedChatIds = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_6__.findIntersectionWithSet)(excludedChatIds, allLoadedChatsSet);
    return [isIncludedChatsListExpanded ? loadedIncludedChatIds : loadedIncludedChatIds.slice(0, INITIAL_CHATS_LIMIT - includedChatTypes.length), isExcludedChatsListExpanded ? loadedExcludedChatIds : loadedExcludedChatIds.slice(0, INITIAL_CHATS_LIMIT - excludedChatTypes.length)];
  }, [excludedChatIds, includedChatIds, includedChatTypes, excludedChatTypes, isExcludedChatsListExpanded, isIncludedChatsListExpanded, loadedActiveChatIds, loadedArchivedChatIds]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_11__["default"])({
    isActive,
    onBack
  });
  const onEmojiSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_21__["default"])(emoji => {
    console.log('test emoji', emoji);
    setEmoji(emoji);
    dispatch({
      type: 'setEmoticon',
      payload: emoji
    });
  });
  const handleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(event => {
    const {
      currentTarget
    } = event;
    dispatch({
      type: 'setTitle',
      payload: currentTarget.value.trim()
    });
  }, [dispatch]);
  const handleSubmit = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    dispatch({
      type: 'setIsLoading',
      payload: true
    });
    onSaveFolder(() => {
      setTimeout(() => {
        onReset();
      }, SUBMIT_TIMEOUT);
    });
  }, [dispatch, onSaveFolder, onReset]);
  const handleCreateInviteClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!invites) {
      if (isCreating) {
        onSaveFolder(onShareFolder);
      }
      return;
    }

    // Ignoring global updates is a known drawback here
    if (!(0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCanShareFolder)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), state.folderId)) {
      showNotification({
        message: lang('ChatList.Filter.InviteLink.IncludeExcludeError')
      });
      return;
    }
    if (chatListCount >= maxChatLists && !state.folder.isChatList) {
      openLimitReachedModal({
        limit: 'chatlistJoined'
      });
      return;
    }
    if (invites.length < maxInviteLinks) {
      if (state.isTouched) {
        onSaveFolder(onShareFolder);
      } else {
        onShareFolder();
      }
      return;
    }
    openLimitReachedModal({
      limit: 'chatlistInvites'
    });
  }, [invites, state.folderId, state.isTouched, chatListCount, maxInviteLinks, isCreating, onSaveFolder, onShareFolder, lang, maxChatLists, state.folder.isChatList]);
  const handleEditInviteClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e, url) => {
    if (state.isTouched) {
      onSaveFolder(() => onOpenInvite(url));
    } else {
      onOpenInvite(url);
    }
  }, [onSaveFolder, onOpenInvite, state.isTouched]);
  function renderChatType(key, mode) {
    const chatType = mode === 'included' ? _util_objects_customPeer__WEBPACK_IMPORTED_MODULE_8__.CUSTOM_PEER_INCLUDED_CHAT_TYPES.find(({
      type: typeKey
    }) => typeKey === key) : _util_objects_customPeer__WEBPACK_IMPORTED_MODULE_8__.CUSTOM_PEER_EXCLUDED_CHAT_TYPES.find(({
      type: typeKey
    }) => typeKey === key);
    if (!chatType) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_18__["default"], {
      key: chatType.type,
      className: "settings-folders-list-item mb-1",
      narrow: true,
      inactive: true
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_16__["default"], {
      avatarSize: "small",
      customPeer: chatType
    }));
  }
  function renderChats(mode) {
    const selectedChatTypes = mode === 'included' ? includedChatTypes : excludedChatTypes;
    const visibleChatIds = mode === 'included' ? visibleIncludedChatIds : visibleExcludedChatIds;
    const isExpanded = mode === 'included' ? isIncludedChatsListExpanded : isExcludedChatsListExpanded;
    const allChatIds = mode === 'included' ? includedChatIds : excludedChatIds;
    const leftChatsCount = allChatIds.length - visibleChatIds.length;
    const clickHandler = mode === 'included' ? () => setIsIncludedChatsListExpanded(true) : () => setIsExcludedChatsListExpanded(true);
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, selectedChatTypes.map(key => renderChatType(key, mode)), visibleChatIds.map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_18__["default"], {
      className: "settings-folders-list-item mb-1",
      narrow: true,
      inactive: true
    }, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserId)(id) ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_16__["default"], {
      avatarSize: "small",
      userId: id
    }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_14__["default"], {
      avatarSize: "small",
      chatId: id
    }))), !isExpanded && leftChatsCount > 0 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_18__["default"], {
      key: "load-more",
      className: "settings-folders-list-item",
      narrow: true
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: clickHandler,
      icon: "down"
    }, lang('FilterShowMoreChats', leftChatsCount, 'i')));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-fab-wrapper"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content no-border custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_13__["default"], {
    size: _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_FOLDER_SETTINGS,
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_9__.LOCAL_TGS_URLS.FoldersNew,
    play: String(state.folderId),
    className: "settings-content-icon"
  }), isCreating && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('FilterIncludeInfo')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_FolderTitleInput__WEBPACK_IMPORTED_MODULE_20__["default"], {
    value: state.folder.title.text,
    onChange: handleChange,
    onEmojiSelect: onEmojiSelect,
    error: state.error && state.error === ERROR_NO_TITLE ? ERROR_NO_TITLE : undefined,
    lang: lang
  })), !isOnlyInvites && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-3"
  }, state.error && state.error === ERROR_NO_CHATS && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description color-danger mb-2",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang(state.error)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header mb-3",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('FilterInclude')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_18__["default"], {
    className: "settings-folders-list-item color-primary",
    icon: "add",
    narrow: true,
    onClick: onAddIncludedChats
  }, lang('FilterAddChats')), renderChats('included')), !isOnlyInvites && !isEditingChatList && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-3"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header mb-3",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('FilterExclude')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_18__["default"], {
    className: "settings-folders-list-item color-primary",
    icon: "add",
    narrow: true,
    onClick: onAddExcludedChats
  }, lang('FilterAddChats')), renderChats('excluded')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-3"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header mb-3",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('FolderLinkScreen.Title')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_18__["default"], {
    className: "settings-folders-list-item color-primary",
    icon: "add",
    narrow: true,
    onClick: handleCreateInviteClick
  }, lang('ChatListFilter.CreateLinkNew')), invites?.map(invite => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_18__["default"], {
    className: "settings-folders-list-item",
    icon: "link",
    narrow: true,
    multiline: true,
    onClick: handleEditInviteClick,
    clickArg: invite.url
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title",
    dir: "auto"
  }, invite.title || invite.url), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, lang('ChatListFilter.LinkLabelChatCount', invite.peerIds.length, 'i')))))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_17__["default"], {
    isShown: Boolean(state.isTouched),
    disabled: state.isLoading,
    onClick: handleSubmit,
    ariaLabel: state.mode === 'edit' ? 'Save changes' : 'Create folder'
  }, state.isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_19__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: "check"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  state
}) => {
  const {
    listIds
  } = global.chats;
  const {
    byId,
    invites
  } = global.chatFolders;
  const chatListCount = Object.values(byId).reduce((acc, el) => acc + (el.isChatList ? 1 : 0), 0);
  return {
    loadedActiveChatIds: listIds.active,
    loadedArchivedChatIds: listIds.archived,
    invites: state.folderId ? invites[state.folderId] || _util_memo__WEBPACK_IMPORTED_MODULE_7__.MEMO_EMPTY_ARRAY : undefined,
    isRemoved: state.folderId !== undefined && !byId[state.folderId],
    maxInviteLinks: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__.selectCurrentLimit)(global, 'chatlistInvites'),
    maxChatLists: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__.selectCurrentLimit)(global, 'chatlistJoined'),
    chatListCount
  };
})(SettingsFoldersEdit)));

/***/ }),

/***/ "./src/components/left/settings/folders/SettingsFoldersMain.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/left/settings/folders/SettingsFoldersMain.tsx ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../global/selectors/limits */ "./src/global/selectors/limits.ts");
/* harmony import */ var _util_math__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../util/math */ "./src/util/math.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../common/helpers/renderTextWithEntities */ "./src/components/common/helpers/renderTextWithEntities.tsx");
/* harmony import */ var _hooks_useFolderManager__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../hooks/useFolderManager */ "./src/hooks/useFolderManager.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../common/AnimatedIcon */ "./src/components/common/AnimatedIcon.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Draggable__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../ui/Draggable */ "./src/components/ui/Draggable.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../../ui/Loading */ "./src/components/ui/Loading.tsx");





















const FOLDER_HEIGHT_PX = 68;
const runThrottledForLoadRecommended = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_8__.throttle)(cb => cb(), 60000, true);
const SettingsFoldersMain = ({
  isActive,
  onCreateFolder,
  onEditFolder,
  onReset,
  folderIds,
  foldersById,
  isPremium,
  recommendedChatFolders,
  maxFolders
}) => {
  const {
    loadRecommendedChatFolders,
    addChatFolder,
    openLimitReachedModal,
    openDeleteChatFolderModal,
    sortChatFolders
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [state, setState] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)({
    orderedFolderIds: folderIds,
    dragOrderIds: folderIds,
    draggedIndex: undefined
  });
  const prevFolderIds = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_14__["default"])(folderIds);

  // Sync folders state after changing folders in other clients
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (prevFolderIds !== folderIds) {
      setState({
        orderedFolderIds: folderIds,
        dragOrderIds: folderIds,
        draggedIndex: undefined
      });
    }
  }, [prevFolderIds, folderIds, state.orderedFolderIds?.length]);

  // Due to the parent Transition, this component never gets unmounted,
  // that's why we use throttled API call on every update.
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    runThrottledForLoadRecommended(() => {
      loadRecommendedChatFolders();
    });
  }, [loadRecommendedChatFolders]);
  const handleCreateFolder = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (Object.keys(foldersById).length >= maxFolders - 1) {
      openLimitReachedModal({
        limit: 'dialogFilters'
      });
      return;
    }
    onCreateFolder();
  }, [foldersById, maxFolders, onCreateFolder, openLimitReachedModal]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_12__["default"])({
    isActive,
    onBack: onReset
  });
  const chatsCountByFolderId = (0,_hooks_useFolderManager__WEBPACK_IMPORTED_MODULE_11__.useFolderManagerForChatsCount)();
  const userFolders = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!folderIds) {
      return undefined;
    }
    if (folderIds.length <= 1) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_7__.MEMO_EMPTY_ARRAY;
    }
    return folderIds.map(id => {
      const folder = foldersById[id];
      if (id === _config__WEBPACK_IMPORTED_MODULE_2__.ALL_FOLDER_ID) {
        return {
          id,
          title: {
            text: lang('FilterAllChats'),
            entities: []
          }
        };
      }
      return {
        id: folder.id,
        title: folder.title,
        subtitle: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getFolderDescriptionText)(lang, folder, chatsCountByFolderId[folder.id]),
        isChatList: folder.isChatList,
        noTitleAnimations: folder.noTitleAnimations
      };
    });
  }, [folderIds, foldersById, lang, chatsCountByFolderId]);
  const handleCreateFolderFromRecommended = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(folder => {
    if (Object.keys(foldersById).length >= maxFolders - 1) {
      openLimitReachedModal({
        limit: 'dialogFilters'
      });
      return;
    }
    addChatFolder({
      folder
    });
  }, [foldersById, maxFolders, addChatFolder, openLimitReachedModal]);
  const handleDrag = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((translation, id) => {
    const delta = Math.round(translation.y / FOLDER_HEIGHT_PX);
    const index = state.orderedFolderIds?.indexOf(id) || 0;
    const dragOrderIds = state.orderedFolderIds?.filter(folderId => folderId !== id);
    if (!dragOrderIds || !(0,_util_math__WEBPACK_IMPORTED_MODULE_6__.isBetween)(index + delta, 0, folderIds?.length || 0)) {
      return;
    }
    dragOrderIds.splice(index + delta + (isPremium ? 0 : 1), 0, id);
    setState(current => ({
      ...current,
      draggedIndex: index,
      dragOrderIds
    }));
  }, [folderIds?.length, isPremium, state.orderedFolderIds]);
  const handleDragEnd = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setState(current => {
      sortChatFolders({
        folderIds: current.dragOrderIds
      });
      return {
        ...current,
        orderedFolderIds: current.dragOrderIds,
        draggedIndex: undefined
      };
    });
  }, [sortChatFolders]);
  const canCreateNewFolder = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return !isPremium || Object.keys(foldersById).length < maxFolders - 1;
  }, [foldersById, isPremium, maxFolders]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content no-border custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    size: _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_FOLDER_SETTINGS,
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_9__.LOCAL_TGS_URLS.FoldersAll,
    className: "settings-content-icon"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: "auto"
  }, lang('CreateNewFilterInfo')), canCreateNewFolder && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_17__["default"]
  // TODO: Refactor button component to handle icon placemenet with props
  , {
    className: "settings-button with-icon mb-2",
    color: "primary",
    size: "smaller",
    pill: true,
    fluid: true,
    onClick: handleCreateFolder,
    isRtl: lang.isRtl
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_16__["default"], {
    name: "add"
  }), lang('CreateNewFilter'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-3"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header mb-3",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('Filters')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-sortable-container",
    style: `height: ${(folderIds?.length || 0) * FOLDER_HEIGHT_PX}px`
  }, userFolders?.length ? userFolders.map((folder, i) => {
    const isBlocked = i > maxFolders - 1;
    const isDragged = state.draggedIndex === i;
    const draggedTop = (state.orderedFolderIds?.indexOf(folder.id) ?? 0) * FOLDER_HEIGHT_PX;
    const top = (state.dragOrderIds?.indexOf(folder.id) ?? 0) * FOLDER_HEIGHT_PX;
    if (folder.id === _config__WEBPACK_IMPORTED_MODULE_2__.ALL_FOLDER_ID) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Draggable__WEBPACK_IMPORTED_MODULE_18__["default"], {
        key: folder.id,
        id: folder.id,
        onDrag: handleDrag,
        onDragEnd: handleDragEnd,
        style: `top: ${isDragged ? draggedTop : top}px;`,
        knobStyle: `${lang.isRtl ? 'left' : 'right'}: 0.375rem;`,
        isDisabled: !isPremium || !isActive
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_19__["default"], {
        key: folder.id,
        className: "drag-item mb-2 no-icon settings-sortable-item",
        narrow: true,
        inactive: true,
        multiline: true,
        isStatic: true,
        allowSelection: true
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
        className: "title"
      }, (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_10__.renderTextWithEntities)({
        text: folder.title.text,
        entities: folder.title.entities,
        noCustomEmojiPlayback: folder.noTitleAnimations
      })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
        className: "subtitle"
      }, lang('FoldersAllChatsDesc'))));
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Draggable__WEBPACK_IMPORTED_MODULE_18__["default"], {
      key: folder.id,
      id: folder.id,
      onDrag: handleDrag,
      onDragEnd: handleDragEnd,
      style: `top: ${isDragged ? draggedTop : top}px;`,
      knobStyle: `${lang.isRtl ? 'left' : 'right'}: 3rem;`,
      isDisabled: isBlocked || !isActive
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_19__["default"], {
      className: "drag-item mb-2 no-icon settings-sortable-item",
      narrow: true,
      secondaryIcon: "more",
      multiline: true,
      contextActions: [{
        handler: () => {
          openDeleteChatFolderModal({
            folderId: folder.id
          });
        },
        destructive: true,
        title: lang('Delete'),
        icon: 'delete'
      }]
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => {
        if (isBlocked) {
          openLimitReachedModal({
            limit: 'dialogFilters'
          });
        } else {
          onEditFolder(foldersById[folder.id]);
        }
      }
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "title"
    }, (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_10__.renderTextWithEntities)({
      text: folder.title.text,
      entities: folder.title.entities,
      noCustomEmojiPlayback: folder.noTitleAnimations
    }), isBlocked && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_16__["default"], {
      name: "lock-badge",
      className: "settings-folders-blocked-icon"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "subtitle"
    }, folder.isChatList && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_16__["default"], {
      name: "link",
      className: "mr-1"
    }), folder.subtitle)));
  }) : userFolders && !userFolders.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description my-4",
    dir: "auto"
  }, "You have no folders yet.") : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_20__["default"], null))), recommendedChatFolders && Boolean(recommendedChatFolders.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-3"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", {
    className: "settings-item-header mb-3",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('FilterRecommended')), recommendedChatFolders.map(folder => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_19__["default"], {
    className: "mb-2",
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleCreateFolderFromRecommended(folder)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-folders-recommended-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "multiline-item"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_10__.renderTextWithEntities)({
    text: folder.title.text,
    entities: folder.title.entities,
    noCustomEmojiPlayback: folder.noTitleAnimations
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, folder.description)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_17__["default"], {
    className: "px-3",
    color: "primary",
    size: "tiny",
    pill: true,
    fluid: true,
    isRtl: lang.isRtl
  }, lang('Add')))))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    orderedIds: folderIds,
    byId: foldersById,
    recommended: recommendedChatFolders
  } = global.chatFolders;
  return {
    folderIds,
    foldersById,
    isPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsCurrentUserPremium)(global),
    recommendedChatFolders,
    maxFolders: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__.selectCurrentLimit)(global, 'dialogFilters')
  };
})(SettingsFoldersMain)));

/***/ }),

/***/ "./src/components/left/settings/folders/SettingsShareChatlist.tsx":
/*!************************************************************************!*\
  !*** ./src/components/left/settings/folders/SettingsShareChatlist.tsx ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../common/helpers/renderTextWithEntities */ "./src/components/common/helpers/renderTextWithEntities.tsx");
/* harmony import */ var _hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../hooks/useEffectWithPrevDeps */ "./src/hooks/useEffectWithPrevDeps.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../common/AnimatedIcon */ "./src/components/common/AnimatedIcon.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_LinkField__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../common/LinkField */ "./src/components/common/LinkField.tsx");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../ui/Spinner */ "./src/components/ui/Spinner.tsx");



















const SettingsShareChatlist = ({
  isActive,
  onReset,
  folderId,
  folder,
  peerIds,
  url,
  isLoading
}) => {
  const {
    createChatlistInvite,
    deleteChatlistInvite,
    editChatlistInvite,
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const [isTouched, setIsTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__["default"])({
    isActive,
    onBack: onReset
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isLoading) {
      setIsTouched(false);
    }
  }, [isLoading]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!url && folderId && isActive) {
      createChatlistInvite({
        folderId
      });
    }
  }, [folderId, isActive, url]);
  const handleRevoke = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    if (!url || !folderId) return;
    deleteChatlistInvite({
      folderId,
      url
    });
    onReset();
  });
  const itemIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return (folder?.includedChatIds || []).concat(folder?.pinnedChatIds || []);
  }, [folder?.includedChatIds, folder?.pinnedChatIds]);
  const [unlockedIds, lockedIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_5__.partition)(itemIds, id => (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCanInviteToChat)(global, id));
  }, [itemIds]);
  const [selectedIds, setSelectedIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(peerIds || []);
  const isFirstRenderRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(true);
  (0,_hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_8__["default"])(([prevUrl]) => {
    if (prevUrl !== url) {
      isFirstRenderRef.current = true;
    }
    if (!isFirstRenderRef.current) return;
    isFirstRenderRef.current = false;
    if (!url) {
      setSelectedIds(unlockedIds);
    } else if (peerIds) {
      setSelectedIds(peerIds);
    }
  }, [url, unlockedIds, peerIds]);
  const handleClickDisabled = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(id => {
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    const user = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectUser)(global, id);
    const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, id);
    if (user && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserBot)(user)) {
      showNotification({
        message: oldLang('FolderLinkScreen.AlertTextUnavailableBot')
      });
    } else if (user) {
      showNotification({
        message: oldLang('FolderLinkScreen.AlertTextUnavailableUser')
      });
    } else if (chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatChannel)(chat)) {
      showNotification({
        message: oldLang('FolderLinkScreen.AlertTextUnavailablePublicChannel')
      });
    } else {
      showNotification({
        message: oldLang('FolderLinkScreen.AlertTextUnavailablePublicGroup')
      });
    }
  });
  const handleSelectedIdsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(ids => {
    setSelectedIds(ids);
    setIsTouched(true);
  });
  const handleSubmit = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    if (!folderId || !url || !isTouched) return;
    editChatlistInvite({
      folderId,
      peerIds: selectedIds,
      url
    });
  });
  const chatsCount = selectedIds.length;
  const isDisabled = !chatsCount || isLoading;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content no-border custom-scroll SettingsFoldersChatsPicker"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_13__["default"], {
    size: _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_FOLDER_SETTINGS,
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_6__.LOCAL_TGS_URLS.FoldersShare,
    className: "settings-content-icon"
  }), folder && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: "auto"
  }, lang('FolderLinkTitleDescription', {
    folder: (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_7__.renderTextWithEntities)({
      text: folder.title.text,
      entities: folder.title.entities,
      noCustomEmojiPlayback: folder.noTitleAnimations
    }),
    chats: lang('FolderLinkTitleDescriptionChats', {
      count: chatsCount
    }, {
      pluralValue: chatsCount
    })
  }, {
    withMarkdown: true,
    withNodes: true
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_LinkField__WEBPACK_IMPORTED_MODULE_15__["default"], {
    className: "settings-item",
    link: !url ? oldLang('Loading') : url,
    withShare: true,
    onRevoke: handleRevoke,
    isDisabled: !chatsCount || isTouched
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item settings-item-picker"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_16__["default"], {
    itemIds: itemIds,
    lockedUnselectedIds: lockedIds,
    onSelectedIdsChange: handleSelectedIdsChange,
    selectedIds: selectedIds,
    onDisabledClick: handleClickDisabled,
    allowMultiple: true,
    withStatus: true,
    itemInputType: "checkbox"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_17__["default"], {
    isShown: isLoading || isTouched,
    disabled: isDisabled,
    onClick: handleSubmit,
    ariaLabel: "Save changes"
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_18__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "check"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    folderId,
    url,
    isLoading
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global).shareFolderScreen || {};
  const folder = folderId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFolder)(global, folderId) : undefined;
  const invite = folderId ? global.chatFolders.invites[folderId]?.find(i => i.url === url) : undefined;
  return {
    folderId,
    folder,
    url,
    isLoading,
    peerIds: invite?.peerIds
  };
})(SettingsShareChatlist)));

/***/ }),

/***/ "./src/components/left/settings/helpers/getSessionIcon.ts":
/*!****************************************************************!*\
  !*** ./src/components/left/settings/helpers/getSessionIcon.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ getSessionIcon)
/* harmony export */ });
function getSessionIcon(session) {
  const platform = session.platform.toLowerCase();
  const device = session.deviceModel.toLowerCase();
  const systemVersion = session.systemVersion.toLowerCase();
  if (device.includes('xbox')) {
    return 'xbox';
  }
  if (device.includes('chrome') && !device.includes('chromebook')) {
    return 'chrome';
  }
  if (device.includes('brave')) {
    return 'brave';
  }
  if (device.includes('vivaldi')) {
    return 'vivaldi';
  }
  if (device.includes('safari')) {
    return 'safari';
  }
  if (device.includes('firefox')) {
    return 'firefox';
  }
  if (device.includes('opera')) {
    return 'opera';
  }
  if (device.includes('samsungbrowser')) {
    return 'samsung';
  }
  if (platform.includes('android')) {
    return 'android';
  }
  if (device.includes('iphone') || device.includes('ipad') || platform.includes('ios') || platform.includes('macos') || systemVersion.includes('macos')) {
    return 'apple';
  }
  if (platform.includes('ubuntu') || systemVersion.includes('ubuntu')) {
    return 'ubuntu';
  }
  if (platform.includes('linux') || systemVersion.includes('linux')) {
    return 'linux';
  }
  if (platform.includes('windows') || systemVersion.includes('windows')) {
    return 'windows';
  }
  return 'unknown';
}

/***/ }),

/***/ "./src/components/left/settings/helpers/privacy.ts":
/*!*********************************************************!*\
  !*** ./src/components/left/settings/helpers/privacy.ts ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getPrivacyKey: () => (/* binding */ getPrivacyKey)
/* harmony export */ });
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../types */ "./src/types/index.ts");

function getPrivacyKey(screen) {
  switch (screen) {
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyPhoneNumber:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyPhoneNumberAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyPhoneNumberDeniedContacts:
      return 'phoneNumber';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyLastSeen:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyLastSeenAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyLastSeenDeniedContacts:
      return 'lastSeen';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyProfilePhoto:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyProfilePhotoAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyProfilePhotoDeniedContacts:
      return 'profilePhoto';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyBio:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyBioAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyBioDeniedContacts:
      return 'bio';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyBirthday:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyBirthdayAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyBirthdayDeniedContacts:
      return 'birthday';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyGifts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyGiftsAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyGiftsDeniedContacts:
      return 'gifts';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyForwarding:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyForwardingAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyForwardingDeniedContacts:
      return 'forwards';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyVoiceMessages:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyVoiceMessagesAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyVoiceMessagesDeniedContacts:
      return 'voiceMessages';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyGroupChats:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyGroupChatsAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyGroupChatsDeniedContacts:
      return 'chatInvite';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyPhoneCall:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyPhoneCallAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyPhoneCallDeniedContacts:
      return 'phoneCall';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyPhoneP2P:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyPhoneP2PAllowedContacts:
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyPhoneP2PDeniedContacts:
      return 'phoneP2P';
    case _types__WEBPACK_IMPORTED_MODULE_0__.SettingsScreens.PrivacyAddByPhone:
      return 'addByPhone';
  }
  return undefined;
}

/***/ }),

/***/ "./src/components/left/settings/passcode/SettingsPasscode.tsx":
/*!********************************************************************!*\
  !*** ./src/components/left/settings/passcode/SettingsPasscode.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../types */ "./src/types/index.ts");
/* harmony import */ var _util_passcode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../util/passcode */ "./src/util/passcode.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../SettingsPasswordForm */ "./src/components/left/settings/SettingsPasswordForm.tsx");
/* harmony import */ var _SettingsPasscodeCongratulations__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SettingsPasscodeCongratulations */ "./src/components/left/settings/passcode/SettingsPasscodeCongratulations.tsx");
/* harmony import */ var _SettingsPasscodeEnabled__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./SettingsPasscodeEnabled */ "./src/components/left/settings/passcode/SettingsPasscodeEnabled.tsx");
/* harmony import */ var _SettingsPasscodeStart__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SettingsPasscodeStart */ "./src/components/left/settings/passcode/SettingsPasscodeStart.tsx");









const SettingsPasscode = ({
  passcode,
  currentScreen,
  shownScreen,
  error,
  isActive,
  isLoading,
  onScreenSelect,
  onSetPasscode,
  onReset
}) => {
  const {
    setPasscode,
    clearPasscode,
    setPasscodeError,
    clearPasscodeError
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const handleStartWizard = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onSetPasscode('');
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscode);
  }, [onScreenSelect, onSetPasscode]);
  const handleNewPassword = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    onSetPasscode(value);
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscodeConfirm);
  }, [onScreenSelect, onSetPasscode]);
  const handleNewPasswordConfirm = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setPasscode({
      passcode
    });
    onSetPasscode('');
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations);
  }, [onScreenSelect, onSetPasscode, passcode, setPasscode]);
  const handleChangePasswordCurrent = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(currentPasscode => {
    onSetPasscode('');
    (0,_util_passcode__WEBPACK_IMPORTED_MODULE_3__.decryptSession)(currentPasscode).then(() => {
      onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeNew);
    }, () => {
      setPasscodeError({
        error: lang('PasscodeController.Error.Current')
      });
    });
  }, [lang, onScreenSelect, onSetPasscode, setPasscodeError]);
  const handleChangePasswordNew = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    onSetPasscode(value);
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeConfirm);
  }, [onScreenSelect, onSetPasscode]);
  const handleTurnOff = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(currentPasscode => {
    (0,_util_passcode__WEBPACK_IMPORTED_MODULE_3__.decryptSession)(currentPasscode).then(() => {
      clearPasscode();
      onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Privacy);
    }, () => {
      setPasscodeError({
        error: lang('PasscodeController.Error.Current')
      });
    });
  }, [clearPasscode, lang, onScreenSelect, setPasscodeError]);
  switch (currentScreen) {
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeDisabled:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasscodeStart__WEBPACK_IMPORTED_MODULE_8__["default"], {
        onStart: handleStartWizard,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscodeConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscode:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        shouldDisablePasswordManager: true,
        placeholder: lang('EnterNewPasscode'),
        submitLabel: lang('Continue'),
        onSubmit: handleNewPassword,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscodeConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeNewPasscodeConfirm:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        shouldDisablePasswordManager: true,
        expectedPassword: passcode,
        placeholder: lang('ReEnterYourPasscode'),
        submitLabel: lang('Continue'),
        isLoading: isLoading,
        onSubmit: handleNewPasswordConfirm,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasscodeCongratulations__WEBPACK_IMPORTED_MODULE_6__["default"], {
        isActive: isActive,
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeEnabled:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasscodeEnabled__WEBPACK_IMPORTED_MODULE_7__["default"], {
        onScreenSelect: onScreenSelect,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeCurrent, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeNew, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeTurnOff].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeCurrent:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        shouldDisablePasswordManager: true,
        error: error,
        clearError: clearPasscodeError,
        placeholder: lang('PasscodeController.Current.Placeholder'),
        onSubmit: handleChangePasswordCurrent,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeNew, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeNew:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        shouldDisablePasswordManager: true,
        placeholder: lang('PleaseEnterNewFirstPassword'),
        onSubmit: handleChangePasswordNew,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeChangePasscodeConfirm:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        shouldDisablePasswordManager: true,
        expectedPassword: passcode,
        placeholder: lang('PasscodeController.ReEnterPasscode.Placeholder'),
        isLoading: isLoading,
        onSubmit: handleNewPasswordConfirm,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.PasscodeTurnOff:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        shouldDisablePasswordManager: true,
        error: error ? lang(error) : undefined,
        clearError: clearPasscodeError,
        placeholder: lang('PasscodeController.Current.Placeholder'),
        onSubmit: handleTurnOff,
        isActive: isActive,
        onReset: onReset
      });
    default:
      return undefined;
  }
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => ({
  ...global.passcode
}))(SettingsPasscode)));

/***/ }),

/***/ "./src/components/left/settings/passcode/SettingsPasscodeCongratulations.tsx":
/*!***********************************************************************************!*\
  !*** ./src/components/left/settings/passcode/SettingsPasscodeCongratulations.tsx ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../config */ "./src/config.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../common/AnimatedIcon */ "./src/components/common/AnimatedIcon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../ui/Button */ "./src/components/ui/Button.tsx");







const SettingsPasscodeCongratulations = ({
  isActive,
  onReset
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const fullReset = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onReset(true);
  }, [onReset]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content local-passcode custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_5__["default"], {
    size: _config__WEBPACK_IMPORTED_MODULE_1__.STICKER_SIZE_PASSCODE,
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__.LOCAL_TGS_URLS.Congratulations,
    className: "settings-content-icon"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: "auto"
  }, "Congratulations!"), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: "auto"
  }, "Now you can lock the app with a passcode so that others can't open it.")), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    onClick: fullReset
  }, lang('Back'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsPasscodeCongratulations));

/***/ }),

/***/ "./src/components/left/settings/passcode/SettingsPasscodeEnabled.tsx":
/*!***************************************************************************!*\
  !*** ./src/components/left/settings/passcode/SettingsPasscodeEnabled.tsx ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../types */ "./src/types/index.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../common/AnimatedIconWithPreview */ "./src/components/common/AnimatedIconWithPreview.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _assets_lock_png__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../assets/lock.png */ "./src/assets/lock.png");








const SettingsPasscodeEnabled = ({
  isActive,
  onReset,
  onScreenSelect
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content local-passcode custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_5__["default"], {
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__.LOCAL_TGS_URLS.Lock,
    previewUrl: _assets_lock_png__WEBPACK_IMPORTED_MODULE_7__,
    size: 160,
    className: "settings-content-icon"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: "auto"
  }, "Local passcode is enabled.")), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_6__["default"], {
    icon: "edit"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_1__.SettingsScreens.PasscodeChangePasscodeCurrent)
  }, lang('Passcode.Change')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_6__["default"], {
    icon: "password-off"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_1__.SettingsScreens.PasscodeTurnOff)
  }, lang('Passcode.TurnOff'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsPasscodeEnabled));

/***/ }),

/***/ "./src/components/left/settings/passcode/SettingsPasscodeStart.tsx":
/*!*************************************************************************!*\
  !*** ./src/components/left/settings/passcode/SettingsPasscodeStart.tsx ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../config */ "./src/config.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../common/AnimatedIconWithPreview */ "./src/components/common/AnimatedIconWithPreview.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _assets_lock_png__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../assets/lock.png */ "./src/assets/lock.png");








const SettingsPasscodeStart = ({
  isActive,
  onReset,
  onStart
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_3__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content local-passcode custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_5__["default"], {
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__.LOCAL_TGS_URLS.Lock,
    previewUrl: _assets_lock_png__WEBPACK_IMPORTED_MODULE_7__,
    size: _config__WEBPACK_IMPORTED_MODULE_1__.STICKER_SIZE_PASSCODE,
    className: "settings-content-icon"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description",
    dir: "auto"
  }, "When you set up an additional passcode, a lock icon will appear on the chats page. Tap it to lock and unlock your Telegram Web A."), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: "auto"
  }, "Note: if you forget your local passcode, you'll need to log out of Telegram Web A and log in again.")), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    onClick: onStart
  }, lang('EnablePasscode'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsPasscodeStart));

/***/ }),

/***/ "./src/components/left/settings/twoFa/SettingsTwoFa.tsx":
/*!**************************************************************!*\
  !*** ./src/components/left/settings/twoFa/SettingsTwoFa.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../types */ "./src/types/index.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../SettingsPasswordForm */ "./src/components/left/settings/SettingsPasswordForm.tsx");
/* harmony import */ var _SettingsTwoFaCongratulations__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SettingsTwoFaCongratulations */ "./src/components/left/settings/twoFa/SettingsTwoFaCongratulations.tsx");
/* harmony import */ var _SettingsTwoFaEmailCode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./SettingsTwoFaEmailCode */ "./src/components/left/settings/twoFa/SettingsTwoFaEmailCode.tsx");
/* harmony import */ var _SettingsTwoFaEnabled__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SettingsTwoFaEnabled */ "./src/components/left/settings/twoFa/SettingsTwoFaEnabled.tsx");
/* harmony import */ var _SettingsTwoFaSkippableForm__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./SettingsTwoFaSkippableForm */ "./src/components/left/settings/twoFa/SettingsTwoFaSkippableForm.tsx");
/* harmony import */ var _SettingsTwoFaStart__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./SettingsTwoFaStart */ "./src/components/left/settings/twoFa/SettingsTwoFaStart.tsx");











const SettingsTwoFa = ({
  currentScreen,
  shownScreen,
  state,
  hint,
  isLoading,
  errorKey,
  waitingEmailCodeLength,
  dispatch,
  isActive,
  onScreenSelect,
  onReset
}) => {
  const {
    updatePassword,
    checkPassword,
    clearTwoFaError,
    updateRecoveryEmail,
    provideTwoFaEmailCode,
    clearPassword
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (waitingEmailCodeLength) {
      if (currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail) {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode);
      } else if (currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmail) {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCode);
      }
    }
  }, [currentScreen, onScreenSelect, waitingEmailCodeLength]);
  const handleStartWizard = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    dispatch({
      type: 'reset'
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPassword);
  }, [dispatch, onScreenSelect]);
  const handleNewPassword = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'setPassword',
      payload: value
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordConfirm);
  }, [dispatch, onScreenSelect]);
  const handleNewPasswordConfirm = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordHint);
  }, [onScreenSelect]);
  const handleNewPasswordHint = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'setHint',
      payload: value
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail);
  }, [dispatch, onScreenSelect]);
  const handleNewPasswordEmail = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'setEmail',
      payload: value
    });
    updatePassword({
      ...state,
      email: value,
      onSuccess: () => {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations);
      }
    });
  }, [dispatch, onScreenSelect, state, updatePassword]);
  const handleChangePasswordCurrent = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'setCurrentPassword',
      payload: value
    });
    checkPassword({
      currentPassword: value,
      onSuccess: () => {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordNew);
      }
    });
  }, [checkPassword, dispatch, onScreenSelect]);
  const handleChangePasswordNew = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'setPassword',
      payload: value
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordConfirm);
  }, [dispatch, onScreenSelect]);
  const handleChangePasswordConfirm = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordHint);
  }, [onScreenSelect]);
  const handleChangePasswordHint = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'setHint',
      payload: value
    });
    updatePassword({
      ...state,
      hint: value,
      onSuccess: () => {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations);
      }
    });
  }, [dispatch, onScreenSelect, state, updatePassword]);
  const handleTurnOff = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    clearPassword({
      currentPassword: value,
      onSuccess: () => {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.Privacy);
      }
    });
  }, [clearPassword, onScreenSelect]);
  const handleRecoveryEmailCurrentPassword = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'setCurrentPassword',
      payload: value
    });
    checkPassword({
      currentPassword: value,
      onSuccess: () => {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmail);
      }
    });
  }, [checkPassword, dispatch, onScreenSelect]);
  const handleRecoveryEmail = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'setEmail',
      payload: value
    });
    updateRecoveryEmail({
      ...state,
      email: value,
      onSuccess: () => {
        onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations);
      }
    });
  }, [dispatch, onScreenSelect, state, updateRecoveryEmail]);
  const handleEmailCode = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(code => {
    provideTwoFaEmailCode({
      code
    });
  }, [provideTwoFaEmailCode]);
  switch (currentScreen) {
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaDisabled:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsTwoFaStart__WEBPACK_IMPORTED_MODULE_10__["default"], {
        onStart: handleStartWizard,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPassword, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordHint, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPassword:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        placeholder: oldLang('PleaseEnterPassword'),
        submitLabel: oldLang('Continue'),
        onSubmit: handleNewPassword,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordHint, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordConfirm:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        expectedPassword: state.password,
        placeholder: oldLang('PleaseReEnterPassword'),
        submitLabel: oldLang('Continue'),
        onSubmit: handleNewPasswordConfirm,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordHint, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordHint:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsTwoFaSkippableForm__WEBPACK_IMPORTED_MODULE_9__["default"], {
        icon: "hint",
        placeholder: oldLang('PasswordHintPlaceholder'),
        onSubmit: handleNewPasswordHint,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmail:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsTwoFaSkippableForm__WEBPACK_IMPORTED_MODULE_9__["default"], {
        icon: "email",
        type: "email",
        isLoading: isLoading,
        error: errorKey && lang.withRegular(errorKey),
        clearError: clearTwoFaError,
        placeholder: oldLang('RecoveryEmailTitle'),
        shouldConfirm: true,
        onSubmit: handleNewPasswordEmail,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaNewPasswordEmailCode:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsTwoFaEmailCode__WEBPACK_IMPORTED_MODULE_7__["default"], {
        isLoading: isLoading,
        error: errorKey && lang.withRegular(errorKey),
        clearError: clearTwoFaError,
        onSubmit: handleEmailCode,
        isActive: isActive || shownScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations,
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsTwoFaCongratulations__WEBPACK_IMPORTED_MODULE_6__["default"], {
        onScreenSelect: onScreenSelect,
        isActive: isActive,
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaEnabled:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsTwoFaEnabled__WEBPACK_IMPORTED_MODULE_8__["default"], {
        onScreenSelect: onScreenSelect,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordCurrent, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordNew, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordHint, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaTurnOff, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCurrentPassword, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmail, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordCurrent:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        isLoading: isLoading,
        error: errorKey && lang.withRegular(errorKey),
        clearError: clearTwoFaError,
        hint: hint,
        onSubmit: handleChangePasswordCurrent,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordNew, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordHint, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordNew:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        placeholder: oldLang('PleaseEnterNewFirstPassword'),
        onSubmit: handleChangePasswordNew,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordConfirm, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordHint, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordConfirm:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        expectedPassword: state.password,
        placeholder: oldLang('PleaseReEnterPassword'),
        onSubmit: handleChangePasswordConfirm,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordHint, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaChangePasswordHint:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsTwoFaSkippableForm__WEBPACK_IMPORTED_MODULE_9__["default"], {
        isLoading: isLoading,
        error: errorKey && lang.withRegular(errorKey),
        clearError: clearTwoFaError,
        icon: "hint",
        placeholder: oldLang('PasswordHintPlaceholder'),
        onSubmit: handleChangePasswordHint,
        isActive: isActive || shownScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations,
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaTurnOff:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        isLoading: isLoading,
        error: errorKey && lang.withRegular(errorKey),
        clearError: clearTwoFaError,
        hint: hint,
        onSubmit: handleTurnOff,
        isActive: isActive,
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCurrentPassword:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsPasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
        isLoading: isLoading,
        error: errorKey && lang.withRegular(errorKey),
        clearError: clearTwoFaError,
        hint: hint,
        onSubmit: handleRecoveryEmailCurrentPassword,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmail, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmail:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsTwoFaSkippableForm__WEBPACK_IMPORTED_MODULE_9__["default"], {
        icon: "email",
        type: "email",
        placeholder: oldLang('RecoveryEmailTitle'),
        onSubmit: handleRecoveryEmail,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCode, _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations].includes(shownScreen),
        onReset: onReset
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaRecoveryEmailCode:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SettingsTwoFaEmailCode__WEBPACK_IMPORTED_MODULE_7__["default"], {
        isLoading: isLoading,
        error: errorKey && lang.withRegular(errorKey),
        clearError: clearTwoFaError,
        onSubmit: handleEmailCode,
        isActive: isActive || shownScreen === _types__WEBPACK_IMPORTED_MODULE_2__.SettingsScreens.TwoFaCongratulations,
        onReset: onReset
      });
    default:
      return undefined;
  }
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => ({
  ...global.twoFaSettings
}))(SettingsTwoFa)));

/***/ }),

/***/ "./src/components/left/settings/twoFa/SettingsTwoFaCongratulations.tsx":
/*!*****************************************************************************!*\
  !*** ./src/components/left/settings/twoFa/SettingsTwoFaCongratulations.tsx ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../config */ "./src/config.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../common/AnimatedIcon */ "./src/components/common/AnimatedIcon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../ui/Button */ "./src/components/ui/Button.tsx");








const SettingsTwoFaCongratulations = ({
  isActive,
  onReset,
  onScreenSelect
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const handleClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_1__.SettingsScreens.Privacy);
  }, [onScreenSelect]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content two-fa custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_6__["default"], {
    size: _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_TWO_FA,
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_3__.LOCAL_TGS_URLS.Congratulations,
    className: "settings-content-icon"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: "auto"
  }, lang('TwoStepVerificationPasswordSetInfo'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
    onClick: handleClick
  }, lang('TwoStepVerificationPasswordReturnSettings'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsTwoFaCongratulations));

/***/ }),

/***/ "./src/components/left/settings/twoFa/SettingsTwoFaEmailCode.tsx":
/*!***********************************************************************!*\
  !*** ./src/components/left/settings/twoFa/SettingsTwoFaEmailCode.tsx ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIconFromSticker__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../common/AnimatedIconFromSticker */ "./src/components/common/AnimatedIconFromSticker.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../ui/Loading */ "./src/components/ui/Loading.tsx");










const ICON_SIZE = 160;
const SettingsTwoFaEmailCode = ({
  animatedEmoji,
  codeLength,
  isLoading,
  error,
  clearError,
  onSubmit,
  isActive,
  onReset
}) => {
  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const focusDelayTimeoutMs = isMobile ? 550 : 400;
  const [value, setValue] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__.IS_TOUCH_ENV) {
      setTimeout(() => {
        inputRef.current.focus();
      }, focusDelayTimeoutMs);
    }
  }, [focusDelayTimeoutMs]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onReset
  });
  const handleInputChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    if (error && clearError) {
      clearError();
    }
    const newValue = e.target.value.slice(0, codeLength);
    if (newValue.length === codeLength) {
      onSubmit(newValue);
    }
    setValue(newValue);
    e.target.value = newValue;
  }, [clearError, codeLength, error, onSubmit]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content two-fa custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIconFromSticker__WEBPACK_IMPORTED_MODULE_7__["default"], {
    sticker: animatedEmoji,
    size: ICON_SIZE,
    className: "settings-content-icon"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_8__["default"], {
    value: value,
    ref: inputRef,
    inputMode: "decimal",
    label: lang('YourEmailCode'),
    error: error,
    onChange: handleInputChange
  }), isLoading && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_9__["default"], null)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    animatedEmoji: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectAnimatedEmoji)(global, '💌'),
    codeLength: global.twoFaSettings.waitingEmailCodeLength
  };
})(SettingsTwoFaEmailCode)));

/***/ }),

/***/ "./src/components/left/settings/twoFa/SettingsTwoFaEnabled.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/left/settings/twoFa/SettingsTwoFaEnabled.tsx ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../types */ "./src/types/index.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../common/AnimatedIconWithPreview */ "./src/components/common/AnimatedIconWithPreview.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _assets_lock_png__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../assets/lock.png */ "./src/assets/lock.png");









const SettingsTwoFaEnabled = ({
  isActive,
  onReset,
  onScreenSelect
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content two-fa custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_6__["default"], {
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_2__.LOCAL_TGS_URLS.Lock,
    previewUrl: _assets_lock_png__WEBPACK_IMPORTED_MODULE_8__,
    size: 160,
    className: "settings-content-icon"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: "auto"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(lang('EnabledPasswordText'), ['br']))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_7__["default"], {
    icon: "edit"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_1__.SettingsScreens.TwoFaChangePasswordCurrent)
  }, lang('ChangePassword')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_7__["default"], {
    icon: "password-off"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_1__.SettingsScreens.TwoFaTurnOff)
  }, lang('TurnPasswordOff')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_7__["default"], {
    icon: "email"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_1__.SettingsScreens.TwoFaRecoveryEmailCurrentPassword)
  }, lang('SetRecoveryEmail'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsTwoFaEnabled));

/***/ }),

/***/ "./src/components/left/settings/twoFa/SettingsTwoFaSkippableForm.tsx":
/*!***************************************************************************!*\
  !*** ./src/components/left/settings/twoFa/SettingsTwoFaSkippableForm.tsx ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIconFromSticker__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../common/AnimatedIconFromSticker */ "./src/components/common/AnimatedIconFromSticker.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../ui/Modal */ "./src/components/ui/Modal.tsx");













const ICON_SIZE = 160;
const SettingsTwoFaSkippableForm = ({
  animatedEmoji,
  type = 'text',
  isLoading,
  error,
  placeholder,
  shouldConfirm,
  clearError,
  onSubmit,
  isActive,
  onReset
}) => {
  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const focusDelayTimeoutMs = isMobile ? 550 : 400;
  const [value, setValue] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [isConfirmShown, markIsConfirmShown, unmarkIsConfirmShown] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])(false);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__.IS_TOUCH_ENV) {
      setTimeout(() => {
        inputRef.current.focus();
      }, focusDelayTimeoutMs);
    }
  }, [focusDelayTimeoutMs]);
  const handleInputChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    if (error && clearError) {
      clearError();
    }
    setValue(e.target.value);
  }, [clearError, error]);
  const handleSubmit = e => {
    e.preventDefault();
    if (!inputRef.current) {
      return;
    }
    onSubmit(value);
  };
  const handleSkip = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onSubmit();
  }, [onSubmit]);
  const handleSkipConfirm = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    unmarkIsConfirmShown();
    onSubmit();
  }, [onSubmit, unmarkIsConfirmShown]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content two-fa custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIconFromSticker__WEBPACK_IMPORTED_MODULE_9__["default"], {
    sticker: animatedEmoji,
    size: ICON_SIZE,
    className: "settings-content-icon"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("form", {
    action: "",
    onSubmit: handleSubmit
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_11__["default"], {
    ref: inputRef,
    value: value,
    inputMode: type,
    label: placeholder,
    error: error,
    onChange: handleInputChange
  }), value ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    type: "submit",
    isLoading: isLoading,
    ripple: true
  }, lang('Continue')) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isText: true,
    isLoading: isLoading,
    ripple: true,
    onClick: shouldConfirm ? markIsConfirmShown : handleSkip
  }, lang('YourEmailSkip'))), shouldConfirm && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: "narrow",
    isOpen: isConfirmShown,
    title: lang('YourEmailSkipWarning'),
    onClose: unmarkIsConfirmShown
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(lang('YourEmailSkipWarningText'), ['br', 'simple_markdown']), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    color: "danger",
    ripple: true,
    isText: true,
    className: "confirm-dialog-button",
    onClick: handleSkipConfirm
  }, lang('YourEmailSkip')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    color: "primary",
    ripple: true,
    isText: true,
    className: "confirm-dialog-button",
    onClick: unmarkIsConfirmShown
  }, lang('Cancel'))))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  icon
}) => {
  return {
    animatedEmoji: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectAnimatedEmoji)(global, icon === 'email' ? '💌' : '💡')
  };
})(SettingsTwoFaSkippableForm)));

/***/ }),

/***/ "./src/components/left/settings/twoFa/SettingsTwoFaStart.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/left/settings/twoFa/SettingsTwoFaStart.tsx ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../common/AnimatedIconWithPreview */ "./src/components/common/AnimatedIconWithPreview.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _assets_lock_png__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../assets/lock.png */ "./src/assets/lock.png");







const SettingsTwoFaStart = ({
  isActive,
  onReset,
  onStart
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_2__["default"])({
    isActive,
    onBack: onReset
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content two-fa custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-content-header no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_4__["default"], {
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_1__.LOCAL_TGS_URLS.Lock,
    previewUrl: _assets_lock_png__WEBPACK_IMPORTED_MODULE_6__,
    size: 160,
    className: "settings-content-icon"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "settings-item-description mb-3",
    dir: "auto"
  }, lang('SetAdditionalPasswordInfo'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-item pt-0"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_5__["default"], {
    onClick: onStart
  }, lang('EditAdminTransferSetPassword'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SettingsTwoFaStart));

/***/ }),

/***/ "./src/components/main/AttachBotRecipientPicker.tsx":
/*!**********************************************************!*\
  !*** ./src/components/main/AttachBotRecipientPicker.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_RecipientPicker__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/RecipientPicker */ "./src/components/common/RecipientPicker.tsx");





const AttachBotRecipientPicker = ({
  requestedAttachBotInChat
}) => {
  const {
    cancelAttachBotInChat,
    callAttachBot
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const isOpen = Boolean(requestedAttachBotInChat);
  const [isShown, markIsShown, unmarkIsShown] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_2__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      markIsShown();
    }
  }, [isOpen, markIsShown]);
  const {
    bot,
    filter,
    startParam
  } = requestedAttachBotInChat || {};
  const handlePeerRecipient = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(recipientId => {
    callAttachBot({
      bot: bot,
      chatId: recipientId,
      startParam
    });
    cancelAttachBotInChat();
  }, [bot, callAttachBot, cancelAttachBotInChat, startParam]);
  if (!isOpen && !isShown) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_RecipientPicker__WEBPACK_IMPORTED_MODULE_4__["default"], {
    isOpen: isOpen,
    searchPlaceholder: lang('Search'),
    filter: filter,
    onSelectRecipient: handlePeerRecipient,
    onClose: cancelAttachBotInChat,
    onCloseAnimationEnd: unmarkIsShown
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(AttachBotRecipientPicker));

/***/ }),

/***/ "./src/components/main/BotTrustModal.tsx":
/*!***********************************************!*\
  !*** ./src/components/main/BotTrustModal.tsx ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");







const BotTrustModal = ({
  bot,
  type,
  shouldRequestWriteAccess
}) => {
  const {
    cancelBotTrustRequest,
    markBotTrusted
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isWriteAllowed, setIsWriteAllowed] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(shouldRequestWriteAccess || false);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const handleBotTrustAccept = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    markBotTrusted({
      botId: bot.id,
      isWriteAllowed
    });
  }, [markBotTrusted, isWriteAllowed, bot]);
  const handleBotTrustDecline = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    cancelBotTrustRequest();
  }, []);
  const title = type === 'game' ? lang('AppName') : lang('BotOpenPageTitle');
  const text = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    switch (type) {
      case 'game':
        return lang('BotPermissionGameAlert', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(bot));
      case 'webApp':
        return lang('BotOpenPageMessage', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(bot));
      case 'botApp':
      default:
        return lang('BotWebViewStartPermission');
    }
  }, [bot, type, lang]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isOpen: Boolean(bot),
    onClose: handleBotTrustDecline,
    title: title,
    confirmHandler: handleBotTrustAccept
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(text, ['simple_markdown']), shouldRequestWriteAccess && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_5__["default"], {
    className: "dialog-checkbox",
    checked: isWriteAllowed,
    label: (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(lang('WebApp.AddToAttachmentAllowMessages', bot?.firstName), ['simple_markdown']),
    onCheck: setIsWriteAllowed
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(BotTrustModal));

/***/ }),

/***/ "./src/components/main/DeleteFolderDialog.tsx":
/*!****************************************************!*\
  !*** ./src/components/main/DeleteFolderDialog.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");





const DeleteFolderDialog = ({
  folder
}) => {
  const {
    closeDeleteChatFolderModal,
    deleteChatFolder,
    openDeleteChatFolderModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const isOpen = Boolean(folder);
  const renderingFolder = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_3__["default"])(folder) || folder;
  const isMyChatlist = renderingFolder?.hasMyInvites;
  const handleDeleteFolderMessage = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeDeleteChatFolderModal();
    if (isMyChatlist) {
      openDeleteChatFolderModal({
        folderId: renderingFolder.id,
        isConfirmedForChatlist: true
      });
    } else {
      deleteChatFolder({
        id: renderingFolder.id
      });
    }
  }, [isMyChatlist, renderingFolder]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_4__["default"], {
    isOpen: isOpen,
    onClose: closeDeleteChatFolderModal,
    text: isMyChatlist ? lang('FilterDeleteAlertLinks') : lang('FilterDeleteAlert'),
    confirmLabel: lang('Delete'),
    confirmHandler: handleDeleteFolderMessage,
    confirmIsDestructive: true
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(DeleteFolderDialog));

/***/ }),

/***/ "./src/components/main/Dialogs.tsx":
/*!*****************************************!*\
  !*** ./src/components/main/Dialogs.tsx ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_getReadableErrorText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/getReadableErrorText */ "./src/util/getReadableErrorText.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");










const Dialogs = ({
  dialogs,
  currentMessageList
}) => {
  const {
    dismissDialog,
    sendMessage
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isModalOpen, openModal, closeModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (dialogs.length > 0) {
      openModal();
    }
  }, [dialogs, openModal]);
  if (!dialogs.length) {
    return undefined;
  }
  const renderContactRequest = contactRequest => {
    const handleConfirm = () => {
      if (!currentMessageList) {
        return;
      }
      sendMessage({
        contact: (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.pick)(contactRequest, ['firstName', 'lastName', 'phoneNumber']),
        messageList: currentMessageList
      });
      closeModal();
    };
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_9__["default"], {
      isOpen: isModalOpen,
      onClose: closeModal,
      className: "confirm",
      title: lang('ShareYouPhoneNumberTitle'),
      onCloseAnimationEnd: dismissDialog
    }, lang('AreYouSureShareMyContactInfoBot'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "dialog-buttons mt-2"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
      className: "confirm-dialog-button",
      isText: true
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: handleConfirm
    }, lang('OK')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
      className: "confirm-dialog-button",
      isText: true,
      onClick: closeModal
    }, lang('Cancel'))));
  };
  const renderError = error => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_9__["default"], {
      isOpen: isModalOpen,
      onClose: closeModal,
      onCloseAnimationEnd: dismissDialog,
      className: "error",
      title: getErrorHeader(error)
    }, error.hasErrorKey ? (0,_util_getReadableErrorText__WEBPACK_IMPORTED_MODULE_3__["default"])(error) : (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__["default"])(error.message, ['simple_markdown', 'emoji', 'br']), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "dialog-buttons mt-2"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
      isText: true,
      onClick: closeModal
    }, lang('OK'))));
  };
  const renderDialog = dialog => {
    if ('phoneNumber' in dialog) {
      return renderContactRequest(dialog);
    }
    return renderError(dialog);
  };
  return Boolean(dialogs.length) && renderDialog(dialogs[dialogs.length - 1]);
};
function getErrorHeader(error) {
  if (error.isSlowMode) {
    return 'Slowmode enabled';
  }
  if (!error.hasErrorKey) {
    return 'Telegram';
  }
  return 'Something went wrong';
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    dialogs: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global).dialogs,
    currentMessageList: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCurrentMessageList)(global)
  };
})(Dialogs)));

/***/ }),

/***/ "./src/components/main/DraftRecipientPicker.tsx":
/*!******************************************************!*\
  !*** ./src/components/main/DraftRecipientPicker.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_RecipientPicker__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/RecipientPicker */ "./src/components/common/RecipientPicker.tsx");





const DraftRecipientPicker = ({
  requestedDraft
}) => {
  const isOpen = Boolean(requestedDraft && !requestedDraft.chatId);
  const {
    openChatWithDraft,
    resetOpenChatWithDraft
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const [isShown, markIsShown, unmarkIsShown] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_2__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      markIsShown();
    }
  }, [isOpen, markIsShown]);
  const handleSelectRecipient = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((recipientId, threadId) => {
    openChatWithDraft({
      chatId: recipientId,
      threadId,
      text: requestedDraft.text,
      files: requestedDraft.files
    });
  }, [openChatWithDraft, requestedDraft]);
  const handleClose = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    resetOpenChatWithDraft();
  }, [resetOpenChatWithDraft]);
  if (!isOpen && !isShown) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_RecipientPicker__WEBPACK_IMPORTED_MODULE_4__["default"], {
    isOpen: isOpen,
    searchPlaceholder: lang('ForwardTo'),
    filter: requestedDraft?.filter,
    onSelectRecipient: handleSelectRecipient,
    onClose: handleClose,
    onCloseAnimationEnd: unmarkIsShown
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(DraftRecipientPicker));

/***/ }),

/***/ "./src/components/main/ForwardRecipientPicker.tsx":
/*!********************************************************!*\
  !*** ./src/components/main/ForwardRecipientPicker.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _common_RecipientPicker__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/RecipientPicker */ "./src/components/common/RecipientPicker.tsx");








const ForwardRecipientPicker = ({
  isOpen,
  currentUserId,
  isManyMessages,
  isStory,
  isForwarding
}) => {
  const {
    openChatOrTopicWithReplyInDraft,
    setForwardChatOrTopic,
    exitForwardMode,
    forwardToSavedMessages,
    forwardStory,
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const renderingIsStory = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__["default"])(isStory, true);
  const [isShown, markIsShown, unmarkIsShown] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      markIsShown();
    }
  }, [isOpen, markIsShown]);
  const handleSelectRecipient = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((recipientId, threadId) => {
    const isSelf = recipientId === currentUserId;
    if (isStory) {
      forwardStory({
        toChatId: recipientId
      });
      const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
      if ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(recipientId)) {
        showNotification({
          message: isSelf ? lang('Conversation.StoryForwardTooltip.SavedMessages.One') : lang('StorySharedTo', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFirstOrLastName)((0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, recipientId)))
        });
      } else {
        const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, recipientId);
        if (!chat) return;
        showNotification({
          message: lang('StorySharedTo', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getChatTitle)(lang, chat))
        });
      }
      return;
    }
    if (isSelf) {
      const message = lang(isManyMessages ? 'Conversation.ForwardTooltip.SavedMessages.Many' : 'Conversation.ForwardTooltip.SavedMessages.One');
      forwardToSavedMessages();
      showNotification({
        message
      });
    } else {
      const chatId = recipientId;
      const topicId = threadId ? Number(threadId) : undefined;
      if (isForwarding) {
        setForwardChatOrTopic({
          chatId,
          topicId
        });
      } else {
        openChatOrTopicWithReplyInDraft({
          chatId,
          topicId
        });
      }
    }
  }, [currentUserId, isManyMessages, isStory, lang, isForwarding]);
  const handleClose = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    exitForwardMode();
  }, [exitForwardMode]);
  if (!isOpen && !isShown) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_RecipientPicker__WEBPACK_IMPORTED_MODULE_7__["default"], {
    isOpen: isOpen,
    className: renderingIsStory ? 'component-theme-dark' : undefined,
    searchPlaceholder: lang(isForwarding ? 'ForwardTo' : 'ReplyToDialog'),
    onSelectRecipient: handleSelectRecipient,
    onClose: handleClose,
    onCloseAnimationEnd: unmarkIsShown
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    messageIds,
    storyId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).forwardMessages;
  const isForwarding = messageIds && messageIds.length > 0;
  return {
    currentUserId: global.currentUserId,
    isManyMessages: (messageIds?.length || 0) > 1,
    isStory: Boolean(storyId),
    isForwarding
  };
})(ForwardRecipientPicker)));

/***/ }),

/***/ "./src/components/main/HistoryCalendar.tsx":
/*!*************************************************!*\
  !*** ./src/components/main/HistoryCalendar.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_CalendarModal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/CalendarModal */ "./src/components/common/CalendarModal.tsx");





const HistoryCalendar = ({
  isOpen,
  selectedAt
}) => {
  const {
    searchMessagesByDate,
    closeHistoryCalendar
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const handleJumpToDate = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(date => {
    searchMessagesByDate({
      timestamp: date.getTime() / 1000
    });
    closeHistoryCalendar();
  }, [closeHistoryCalendar, searchMessagesByDate]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CalendarModal__WEBPACK_IMPORTED_MODULE_4__["default"], {
    isOpen: isOpen,
    selectedAt: selectedAt,
    isPastMode: true,
    submitButtonLabel: lang('JumpToDate'),
    onClose: closeHistoryCalendar,
    onSubmit: handleJumpToDate
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    selectedAt: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global).historyCalendarSelectedAt
  };
})(HistoryCalendar)));

/***/ }),

/***/ "./src/components/main/NewContactModal.tsx":
/*!*************************************************!*\
  !*** ./src/components/main/NewContactModal.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_phoneNumber__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/phoneNumber */ "./src/util/phoneNumber.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _NewContactModal_scss__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./NewContactModal.scss */ "./src/components/main/NewContactModal.scss");
















const ANIMATION_DURATION = 200;
const NewContactModal = ({
  isOpen,
  userId,
  isByPhoneNumber,
  user,
  userStatus,
  phoneCodeList
}) => {
  const {
    updateContact,
    importContact,
    closeNewContactDialog
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const renderingUser = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_7__["default"])(user);
  const renderingIsByPhoneNumber = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_7__["default"])(isByPhoneNumber);
  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [isShown, markIsShown, unmarkIsShown] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [firstName, setFirstName] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(renderingUser?.firstName ?? '');
  const [lastName, setLastName] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(renderingUser?.lastName ?? '');
  const [phone, setPhone] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(renderingUser?.phoneNumber ?? '');
  const [shouldSharePhoneNumber, setShouldSharePhoneNumber] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const canBeSubmitted = Boolean(firstName && (!isByPhoneNumber || phone));
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      markIsShown();
      setFirstName(renderingUser?.firstName ?? '');
      setLastName(renderingUser?.lastName ?? '');
      setPhone(renderingUser?.phoneNumber ?? '');
      setShouldSharePhoneNumber(true);
    }
  }, [isOpen, markIsShown, renderingUser?.firstName, renderingUser?.lastName, renderingUser?.phoneNumber]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV && isShown) {
      setTimeout(() => {
        inputRef.current?.focus();
      }, ANIMATION_DURATION);
    }
  }, [isShown]);
  const handleFirstNameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setFirstName(e.target.value);
  }, []);
  const handlePhoneChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setPhone((0,_util_phoneNumber__WEBPACK_IMPORTED_MODULE_4__.formatPhoneNumberWithCode)(phoneCodeList, e.target.value));
  }, [phoneCodeList]);
  const handleLastNameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setLastName(e.target.value);
  }, []);
  const handleClose = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeNewContactDialog();
    setFirstName('');
    setLastName('');
    setPhone('');
  }, [closeNewContactDialog]);
  const handleSubmit = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (isByPhoneNumber || !userId) {
      importContact({
        firstName,
        lastName,
        phoneNumber: phone
      });
    } else {
      updateContact({
        userId,
        firstName,
        lastName,
        shouldSharePhoneNumber
      });
    }
  }, [firstName, importContact, isByPhoneNumber, lastName, phone, shouldSharePhoneNumber, updateContact, userId]);
  if (!isOpen && !isShown) {
    return undefined;
  }
  function renderAddContact() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "NewContactModal__profile",
      dir: lang.isRtl ? 'rtl' : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_10__["default"], {
      size: "jumbo",
      peer: renderingUser,
      text: `${firstName} ${lastName}`
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "NewContactModal__profile-info"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "NewContactModal__phone-number"
    }, renderingUser?.phoneNumber ? (0,_util_phoneNumber__WEBPACK_IMPORTED_MODULE_4__.formatPhoneNumberWithCode)(phoneCodeList, renderingUser.phoneNumber) : lang('MobileHidden')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "NewContactModal__user-status",
      dir: "auto"
    }, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserStatus)(lang, renderingUser, userStatus)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_13__["default"], {
      ref: inputRef,
      value: firstName,
      label: lang('FirstName'),
      tabIndex: 0,
      onChange: handleFirstNameChange
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_13__["default"], {
      value: lastName,
      label: lang('LastName'),
      tabIndex: 0,
      onChange: handleLastNameChange
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "NewContactModal__help-text"
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang('NewContact.Phone.Hidden.Text', renderingUser?.firstName || ''), ['emoji', 'simple_markdown'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__["default"], {
      checked: shouldSharePhoneNumber,
      tabIndex: 0,
      onCheck: setShouldSharePhoneNumber,
      label: lang('lng_new_contact_share')
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "NewContactModal__help-text"
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang('AddContact.SharedContactExceptionInfo', renderingUser?.firstName))));
  }
  function renderCreateContact() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "NewContactModal__new-contact",
      dir: lang.isRtl ? 'rtl' : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_10__["default"], {
      size: "jumbo",
      text: `${firstName} ${lastName}`
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "NewContactModal__new-contact-fieldset"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_13__["default"], {
      ref: inputRef,
      value: phone,
      inputMode: "tel",
      label: lang('lng_contact_phone'),
      tabIndex: 0,
      onChange: handlePhoneChange
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_13__["default"], {
      value: firstName,
      label: lang('FirstName'),
      tabIndex: 0,
      onChange: handleFirstNameChange
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_13__["default"], {
      value: lastName,
      label: lang('LastName'),
      tabIndex: 0,
      onChange: handleLastNameChange
    })));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: "NewContactModal",
    title: lang('NewContact'),
    isOpen: isOpen,
    onClose: handleClose,
    onCloseAnimationEnd: unmarkIsShown
  }, renderingUser && renderAddContact(), renderingIsByPhoneNumber && renderCreateContact(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isText: true,
    className: "confirm-dialog-button",
    disabled: !canBeSubmitted,
    onClick: handleSubmit
  }, lang('Done')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isText: true,
    className: "confirm-dialog-button",
    onClick: handleClose
  }, lang('Cancel'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  userId
}) => {
  const user = userId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, userId) : undefined;
  return {
    user,
    userStatus: userId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUserStatus)(global, userId) : undefined,
    phoneCodeList: global.countryList.phoneCodes
  };
})(NewContactModal)));

/***/ }),

/***/ "./src/components/main/Notifications.tsx":
/*!***********************************************!*\
  !*** ./src/components/main/Notifications.tsx ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _ui_Notification__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui/Notification */ "./src/components/ui/Notification.tsx");





const Notifications = ({
  notifications
}) => {
  if (!notifications.length) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    id: "Notifications"
  }, notifications.map(notification => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Notification__WEBPACK_IMPORTED_MODULE_4__["default"], {
    notification: notification
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_3__.pick)((0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global), ['notifications']))(Notifications)));

/***/ }),

/***/ "./src/components/main/PermissionCheckboxList.tsx":
/*!********************************************************!*\
  !*** ./src/components/main/PermissionCheckboxList.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_stopEvent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/stopEvent */ "./src/util/stopEvent.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");









const permissionKeyList = ['sendPhotos', 'sendVideos', 'sendStickers', 'sendAudios', 'sendDocs', 'sendVoices', 'sendRoundvideos', 'embedLinks', 'sendPolls'];
const PermissionCheckboxList = ({
  chat,
  isMediaDropdownOpen,
  setIsMediaDropdownOpen,
  hasLinkedChat,
  permissions,
  handlePermissionChange,
  className,
  shiftedClassName,
  dropdownClassName,
  withCheckbox,
  getControlIsDisabled,
  permissionGroup
}) => {
  const {
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    isForum
  } = chat || {};
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const isPublic = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatPublic)(chat), [chat]);
  const shouldDisablePermissionForPublicGroup = hasLinkedChat || isPublic;
  const countCheckedPermissions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return permissionKeyList.reduce((count, key) => {
      if (!permissions[key]) {
        count += 1;
      }
      return count;
    }, 0);
  }, [permissions]);
  const handleOpenMediaDropdown = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(e => {
    (0,_util_stopEvent__WEBPACK_IMPORTED_MODULE_5__["default"])(e);
    setIsMediaDropdownOpen(!isMediaDropdownOpen);
  });
  const handleDisabledClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    showNotification({
      message: lang('lng_rights_permission_unavailable')
    });
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendPlain",
    checked: !permissions.sendPlain,
    label: lang('UserRestrictionsSend'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('sendPlain')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendMedia",
    checked: !permissions.sendMedia,
    label: lang('UserRestrictionsSendMedia'),
    labelText: `${countCheckedPermissions}/${permissionKeyList.length}`,
    blocking: true,
    permissionGroup: permissionGroup,
    rightIcon: isMediaDropdownOpen ? 'up' : 'down',
    onChange: handlePermissionChange,
    onClickLabel: handleOpenMediaDropdown,
    disabled: getControlIsDisabled && getControlIsDisabled('sendMedia')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: dropdownClassName
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: className
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendPhotos",
    checked: !permissions.sendPhotos,
    label: lang('UserRestrictionsSendPhotos'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('sendPhotos')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendVideos",
    checked: !permissions.sendVideos,
    label: lang('UserRestrictionsSendVideos'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('sendVideos')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendStickers",
    checked: !permissions.sendStickers && !permissions.sendGifs,
    label: lang('UserRestrictionsSendStickers'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('sendStickers')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendAudios",
    checked: !permissions.sendAudios,
    label: lang('UserRestrictionsSendMusic'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('sendAudios')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendDocs",
    checked: !permissions.sendDocs,
    label: lang('UserRestrictionsSendFiles'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('sendDocs')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendVoices",
    checked: !permissions.sendVoices,
    label: lang('UserRestrictionsSendVoices'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('sendVoices')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendRoundvideos",
    checked: !permissions.sendRoundvideos,
    label: lang('UserRestrictionsSendRound'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('sendRoundvideos')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "embedLinks",
    checked: !permissions.embedLinks,
    label: lang('UserRestrictionsEmbedLinks'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('embedLinks')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "sendPolls",
    checked: !permissions.sendPolls,
    label: lang('UserRestrictionsSendPolls'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('sendPolls')
  })))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: shiftedClassName
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "inviteUsers",
    checked: !permissions.inviteUsers,
    label: lang('UserRestrictionsInviteUsers'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('inviteUsers')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox'),
    onClick: shouldDisablePermissionForPublicGroup ? handleDisabledClick : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "pinMessages",
    checked: !permissions.pinMessages,
    label: lang('UserRestrictionsPinMessages'),
    disabled: getControlIsDisabled ? getControlIsDisabled('pinMessages') : shouldDisablePermissionForPublicGroup,
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox'),
    onClick: shouldDisablePermissionForPublicGroup ? handleDisabledClick : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "changeInfo",
    checked: !permissions.changeInfo,
    label: lang('UserRestrictionsChangeInfo'),
    blocking: true,
    permissionGroup: permissionGroup,
    disabled: getControlIsDisabled ? getControlIsDisabled('changeInfo') : shouldDisablePermissionForPublicGroup,
    onChange: handlePermissionChange
  })), isForum && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('ListItem', withCheckbox && 'with-checkbox')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "manageTopics",
    checked: !permissions.manageTopics,
    label: lang('CreateTopicsPermission'),
    blocking: true,
    permissionGroup: permissionGroup,
    onChange: handlePermissionChange,
    disabled: getControlIsDisabled && getControlIsDisabled('manageTopics')
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId) : undefined;
  const fullInfo = chat && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chat.id);
  const hasLinkedChat = Boolean(fullInfo?.linkedChatId);
  return {
    chat,
    hasLinkedChat
  };
})(PermissionCheckboxList)));

/***/ }),

/***/ "./src/components/main/SafeLinkModal.tsx":
/*!***********************************************!*\
  !*** ./src/components/main/SafeLinkModal.tsx ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _util_ensureProtocol__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/ensureProtocol */ "./src/util/ensureProtocol.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");







const SafeLinkModal = ({
  url
}) => {
  const {
    toggleSafeLinkModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const handleOpen = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    window.open((0,_util_ensureProtocol__WEBPACK_IMPORTED_MODULE_2__.ensureProtocol)(url), '_blank', 'noopener');
    toggleSafeLinkModal({
      url: undefined
    });
  }, [toggleSafeLinkModal, url]);
  const handleDismiss = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    toggleSafeLinkModal({
      url: undefined
    });
  }, [toggleSafeLinkModal]);
  const renderingUrl = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_4__["default"])(url);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isOpen: Boolean(url),
    onClose: handleDismiss,
    title: lang('OpenUrlTitle'),
    textParts: (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(lang('OpenUrlAlert2', renderingUrl), ['links']),
    confirmLabel: lang('OpenUrlTitle'),
    confirmHandler: handleOpen
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SafeLinkModal));

/***/ }),

/***/ "./src/components/main/WebAppsCloseConfirmationModal.tsx":
/*!***************************************************************!*\
  !*** ./src/components/main/WebAppsCloseConfirmationModal.tsx ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useKeyboardListNavigation */ "./src/hooks/useKeyboardListNavigation.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");









const WebAppsCloseConfirmationModal = ({
  isOpen
}) => {
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const {
    closeWebAppsCloseConfirmationModal,
    closeWebAppModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [shouldSkipInFuture, setShouldSkipInFuture] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const onClose = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeWebAppsCloseConfirmationModal({
      shouldSkipInFuture
    });
  }, [shouldSkipInFuture]);
  const confirmHandler = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeWebAppModal({
      shouldSkipConfirmation: true
    });
    closeWebAppsCloseConfirmationModal({
      shouldSkipInFuture
    });
  }, [shouldSkipInFuture]);
  const handleSelectWithEnter = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(index => {
    if (index === -1) confirmHandler();
  }, [confirmHandler]);
  const handleKeyDown = (0,_hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_3__["default"])(containerRef, isOpen, handleSelectWithEnter, '.Button');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_8__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('confirm'),
    title: lang('CloseMiniApps'),
    isOpen: isOpen,
    onClose: onClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, lang('AreYouSureCloseMiniApps')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_7__["default"], {
    label: lang('DoNotAskAgain'),
    checked: shouldSkipInFuture,
    onCheck: setShouldSkipInFuture
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons mt-2",
    ref: containerRef,
    onKeyDown: handleKeyDown
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: confirmHandler,
    color: "danger"
  }, oldLang('Confirm')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onClose
  }, oldLang('Cancel'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(WebAppsCloseConfirmationModal));

/***/ }),

/***/ "./src/components/main/premium/GiveawayChannelPickerModal.tsx":
/*!********************************************************************!*\
  !*** ./src/components/main/premium/GiveawayChannelPickerModal.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/sortChatIds */ "./src/components/common/helpers/sortChatIds.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _common_pickers_PickerModal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/pickers/PickerModal */ "./src/components/common/pickers/PickerModal.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");











const GiveawayChannelPickerModal = ({
  isOpen,
  giveawayChatId,
  selectionLimit,
  initialSelectedIds,
  onSelectedIdsConfirmed,
  onClose
}) => {
  const {
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [pendingChannelId, setPendingChannelId] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [searchQuery, setSearchQuery] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [isConfirmModalOpen, openConfirmModal, closeConfirmModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const [selectedIds, setSelectedIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(initialSelectedIds);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setSelectedIds(initialSelectedIds);
  }, [initialSelectedIds]);
  const channelIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    const chatsById = global.chats.byId;
    const {
      active,
      archived
    } = global.chats.listIds;
    const ids = (active || []).concat(archived || []);
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_3__.unique)(ids).map(id => chatsById[id]).filter(chat => chat && ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatChannel)(chat) || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatSuperGroup)(chat)) && chat.id !== giveawayChatId).map(chat => chat.id);
  }, [giveawayChatId]);
  const displayedChannelIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    const foundChannelIds = channelIds ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.filterChatsByName)(lang, channelIds, chatsById, searchQuery) : [];
    return (0,_common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_4__["default"])(foundChannelIds, false, selectedIds);
  }, [channelIds, lang, searchQuery, selectedIds]);
  const handleSelectedChannelIdsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(newSelectedIds => {
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    const newlyAddedIds = newSelectedIds.filter(id => !selectedIds.includes(id));
    const privateLinkChannelId = newlyAddedIds.find(id => {
      const chat = chatsById[id];
      return chat && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatPublic)(chat);
    });
    if (selectedIds?.length >= selectionLimit) {
      showNotification({
        message: lang('BoostingSelectUpToWarningChannelsPlural', selectionLimit)
      });
      return;
    }
    if (privateLinkChannelId) {
      setPendingChannelId(privateLinkChannelId);
      openConfirmModal();
    } else {
      setSelectedIds(newSelectedIds);
    }
  });
  const confirmPrivateLinkChannelSelection = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    if (pendingChannelId) {
      setSelectedIds((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_3__.unique)([...selectedIds, pendingChannelId]));
    }
    closeConfirmModal();
  });
  const handleModalConfirm = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    onSelectedIdsConfirmed(selectedIds);
    onClose();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PickerModal__WEBPACK_IMPORTED_MODULE_9__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    title: lang('RequestPeer.ChooseChannelTitle'),
    hasCloseButton: true,
    shouldAdaptToSearch: true,
    withFixedHeight: true,
    confirmButtonText: lang('Save'),
    onConfirm: handleModalConfirm,
    onEnter: handleModalConfirm
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_8__["default"], {
    itemIds: displayedChannelIds,
    selectedIds: selectedIds,
    filterValue: searchQuery,
    filterPlaceholder: lang('Search'),
    onSelectedIdsChange: handleSelectedChannelIdsChange,
    onFilterChange: setSearchQuery,
    isSearchable: true,
    withDefaultPadding: true,
    withStatus: true,
    allowMultiple: true,
    itemInputType: "checkbox"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_10__["default"], {
    title: lang('BoostingGiveawayPrivateChannel'),
    text: lang('BoostingGiveawayPrivateChannelWarning'),
    confirmLabel: lang('Add'),
    isOpen: isConfirmModalOpen,
    onClose: closeConfirmModal,
    confirmHandler: confirmPrivateLinkChannelSelection
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(GiveawayChannelPickerModal));

/***/ }),

/***/ "./src/components/main/premium/GiveawayModal.tsx":
/*!*******************************************************!*\
  !*** ./src/components/main/premium/GiveawayModal.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_CalendarModal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/CalendarModal */ "./src/components/common/CalendarModal.tsx");
/* harmony import */ var _common_CountryPickerModal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/CountryPickerModal */ "./src/components/common/CountryPickerModal.tsx");
/* harmony import */ var _common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/GroupChatInfo */ "./src/components/common/GroupChatInfo.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _modals_stars_StarTopupOptionList__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../modals/stars/StarTopupOptionList */ "./src/components/modals/stars/StarTopupOptionList.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Link__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/Link */ "./src/components/ui/Link.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");
/* harmony import */ var _ui_RangeSliderWithMarks__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../ui/RangeSliderWithMarks */ "./src/components/ui/RangeSliderWithMarks.tsx");
/* harmony import */ var _ui_Switcher__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../../ui/Switcher */ "./src/components/ui/Switcher.tsx");
/* harmony import */ var _GiveawayChannelPickerModal__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./GiveawayChannelPickerModal */ "./src/components/main/premium/GiveawayChannelPickerModal.tsx");
/* harmony import */ var _GiveawayTypeOption__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./GiveawayTypeOption */ "./src/components/main/premium/GiveawayTypeOption.tsx");
/* harmony import */ var _GiveawayUserPickerModal__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./GiveawayUserPickerModal */ "./src/components/main/premium/GiveawayUserPickerModal.tsx");
/* harmony import */ var _PremiumSubscriptionOption__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./PremiumSubscriptionOption */ "./src/components/main/premium/PremiumSubscriptionOption.tsx");
/* harmony import */ var _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./GiveawayModal.module.scss */ "./src/components/main/premium/GiveawayModal.module.scss");
/* harmony import */ var _assets_premium_GiftBlueRound_svg__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../../../assets/premium/GiftBlueRound.svg */ "./src/assets/premium/GiftBlueRound.svg");
/* harmony import */ var _assets_premium_GiftGreenRound_svg__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../../../assets/premium/GiftGreenRound.svg */ "./src/assets/premium/GiftGreenRound.svg");
/* harmony import */ var _assets_premium_GiftRedRound_svg__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../../../assets/premium/GiftRedRound.svg */ "./src/assets/premium/GiftRedRound.svg");
/* harmony import */ var _assets_premium_GiftStar_svg__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../../../assets/premium/GiftStar.svg */ "./src/assets/premium/GiftStar.svg");
/* harmony import */ var _assets_premium_PremiumLogo_svg__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../../../assets/premium/PremiumLogo.svg */ "./src/assets/premium/PremiumLogo.svg");




































const DEFAULT_CUSTOM_EXPIRE_DATE = 86400 * 3 * 1000; // 3 days
const MAX_ADDITIONAL_CHANNELS = 9;
const DEFAULT_BOOST_COUNT = 5;
const GIVEAWAY_IMG_LIST = {
  3: _assets_premium_GiftGreenRound_svg__WEBPACK_IMPORTED_MODULE_32__,
  6: _assets_premium_GiftBlueRound_svg__WEBPACK_IMPORTED_MODULE_31__,
  12: _assets_premium_GiftRedRound_svg__WEBPACK_IMPORTED_MODULE_33__
};
const GiveawayModal = ({
  chatId,
  gifts,
  isOpen,
  isChannel,
  selectedMemberList,
  selectedChannelList,
  giveawayBoostPerPremiumLimit = _config__WEBPACK_IMPORTED_MODULE_2__.GIVEAWAY_BOOST_PER_PREMIUM,
  countryList,
  prepaidGiveaway,
  countrySelectionLimit = _config__WEBPACK_IMPORTED_MODULE_2__.GIVEAWAY_MAX_ADDITIONAL_COUNTRIES,
  userSelectionLimit = _config__WEBPACK_IMPORTED_MODULE_2__.GIVEAWAY_MAX_ADDITIONAL_USERS,
  isStarsGiftEnabled,
  starsGiftOptions
}) => {
  // eslint-disable-next-line no-null/no-null
  const dialogRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    closeGiveawayModal,
    openInvoice,
    openPremiumModal,
    launchPrepaidGiveaway,
    launchPrepaidStarsGiveaway
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const [isCalendarOpened, openCalendar, closeCalendar] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isCountryPickerModalOpen, openCountryPickerModal, closeCountryPickerModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isConfirmModalOpen, openConfirmModal, closeConfirmModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isUserPickerModalOpen, openUserPickerModal, closeUserPickerModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isChannelPickerModalOpen, openChannelPickerModal, closeChannelPickerModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const TYPE_OPTIONS = [{
    name: 'Premium.Title',
    text: 'BoostingWinnersRandomly',
    value: 'premium_giveaway',
    img: _assets_premium_GiftBlueRound_svg__WEBPACK_IMPORTED_MODULE_31__,
    actions: 'createPremiumGiveaway',
    isLink: true,
    onClickAction: () => {
      openUserPickerModal();
    }
  }];
  if (isStarsGiftEnabled) {
    TYPE_OPTIONS.push({
      name: 'TelegramStars',
      text: 'BoostingWinnersRandomly',
      value: 'stars_giveaway',
      img: _assets_premium_GiftStar_svg__WEBPACK_IMPORTED_MODULE_34__,
      actions: 'createStarsGiveaway',
      isLink: false
    });
  }
  const [customExpireDate, setCustomExpireDate] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(Date.now() + DEFAULT_CUSTOM_EXPIRE_DATE);
  const [isHeaderHidden, setHeaderHidden] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [selectedRandomUserCount, setSelectedRandomUserCount] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(DEFAULT_BOOST_COUNT);
  const [selectedGiveawayOption, setGiveawayOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(TYPE_OPTIONS[0].value);
  const [selectedStarOption, setSelectedStarOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [selectedSubscriberOption, setSelectedSubscriberOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('all');
  const [selectedMonthOption, setSelectedMonthOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [selectedUserIds, setSelectedUserIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const [selectedChannelIds, setSelectedChannelIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const [selectedCountryIds, setSelectedCountryIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const [shouldShowWinners, setShouldShowWinners] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [shouldShowPrizes, setShouldShowPrizes] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [prizeDescription, setPrizeDescription] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [dataPrepaidGiveaway, setDataPrepaidGiveaway] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [dataStarsPrepaidGiveaway, setDataStarsPrepaidGiveaway] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const isPremiumGiveaway = selectedGiveawayOption === 'premium_giveaway';
  const isStarsGiveaway = selectedGiveawayOption === 'stars_giveaway';
  const selectedUserCount = isPremiumGiveaway && !selectedUserIds.length ? selectedRandomUserCount : selectedUserIds.length;
  const boostQuantity = selectedUserCount * giveawayBoostPerPremiumLimit;
  const boostStarsQuantity = selectedStarOption?.yearlyBoosts;
  const SUBSCRIBER_OPTIONS = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => [{
    value: 'all',
    label: lang(isChannel ? 'BoostingAllSubscribers' : 'BoostingAllMembers'),
    subLabel: selectedCountryIds && selectedCountryIds.length > 0 ? lang('Giveaway.ReceiverType.Countries', selectedCountryIds.length) : lang('BoostingFromAllCountries')
  }, {
    value: 'new',
    label: lang(isChannel ? 'BoostingNewSubscribers' : 'BoostingNewMembers'),
    subLabel: selectedCountryIds && selectedCountryIds.length > 0 ? lang('Giveaway.ReceiverType.Countries', selectedCountryIds.length) : lang('BoostingFromAllCountries')
  }], [isChannel, lang, selectedCountryIds]);
  const monthQuantity = lang('Months', selectedMonthOption);
  const isStarsPrepaidGiveaway = prepaidGiveaway?.type === 'starsGiveaway';
  const isPremiumPrepaidGiveaway = prepaidGiveaway?.type === 'giveaway';
  const selectedGift = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return gifts?.find(gift => gift.months === selectedMonthOption && gift.users === selectedUserCount);
  }, [gifts, selectedMonthOption, selectedUserCount]);
  const selectedStarsGift = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return starsGiftOptions?.find(gift => {
      return isStarsPrepaidGiveaway && gift.stars === dataStarsPrepaidGiveaway?.stars;
    });
  }, [dataStarsPrepaidGiveaway, starsGiftOptions, isStarsPrepaidGiveaway]);
  const filteredGifts = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return gifts?.filter(gift => gift.users === selectedUserCount);
  }, [gifts, selectedUserCount]);
  const fullMonthlyAmount = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const basicGift = filteredGifts?.reduce((acc, gift) => {
      return gift.amount < acc.amount ? gift : acc;
    }, filteredGifts[0]);
    return basicGift && Math.floor(basicGift.amount / basicGift.months);
  }, [filteredGifts]);
  const userCountOptions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_7__.unique)(gifts?.map(winner => winner.users) || []).sort((a, b) => a - b);
  }, [gifts]);
  const winnerCountOptions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_7__.unique)(selectedStarOption?.winners?.map(winner => winner.users) || []).sort((a, b) => a - b);
  }, [selectedStarOption]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && gifts?.length && !isStarsPrepaidGiveaway) {
      setSelectedMonthOption(gifts?.[0].months);
    }
  }, [isOpen, gifts, isStarsPrepaidGiveaway]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && starsGiftOptions?.length && !isPremiumPrepaidGiveaway) {
      setSelectedStarOption(starsGiftOptions?.[0]);
    }
  }, [isOpen, starsGiftOptions, isPremiumPrepaidGiveaway]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && isStarsPrepaidGiveaway) {
      setSelectedRandomUserCount(prepaidGiveaway.quantity);
      setDataStarsPrepaidGiveaway(prepaidGiveaway);
    }
  }, [isOpen, isStarsPrepaidGiveaway, prepaidGiveaway]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && isPremiumPrepaidGiveaway) {
      setSelectedRandomUserCount(prepaidGiveaway.quantity);
      setDataPrepaidGiveaway(prepaidGiveaway);
      setSelectedMonthOption(prepaidGiveaway.months);
    }
  }, [isOpen, isPremiumPrepaidGiveaway, prepaidGiveaway]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (selectedMemberList) {
      setSelectedUserIds(selectedMemberList);
    }
  }, [selectedMemberList]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (selectedChannelList) {
      setSelectedChannelIds(selectedChannelList);
    }
  }, [selectedChannelList]);
  const handlePremiumClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    openPremiumModal();
  });
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    setDataStarsPrepaidGiveaway(undefined);
    setDataPrepaidGiveaway(undefined);
    setSelectedStarOption(undefined);
    setSelectedMonthOption(undefined);
    setSelectedRandomUserCount(DEFAULT_BOOST_COUNT);
    closeGiveawayModal();
  });
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (isPremiumGiveaway) {
      if (selectedUserIds?.length) {
        openInvoice({
          type: 'giftcode',
          boostChannelId: chatId,
          userIds: selectedUserIds,
          currency: selectedGift.currency,
          amount: selectedGift.amount,
          option: selectedGift
        });
      } else {
        openInvoice({
          type: 'giveaway',
          chatId: chatId,
          additionalChannelIds: selectedChannelIds,
          isOnlyForNewSubscribers: selectedSubscriberOption === 'new',
          countries: selectedCountryIds,
          areWinnersVisible: shouldShowWinners,
          prizeDescription,
          untilDate: customExpireDate / 1000,
          currency: selectedGift.currency,
          amount: selectedGift.amount,
          option: selectedGift
        });
      }
    } else {
      openInvoice({
        type: 'starsgiveaway',
        chatId: chatId,
        additionalChannelIds: selectedChannelIds,
        isOnlyForNewSubscribers: selectedSubscriberOption === 'new',
        countries: selectedCountryIds,
        areWinnersVisible: shouldShowWinners,
        prizeDescription,
        untilDate: customExpireDate / 1000,
        currency: selectedStarOption.currency,
        amount: selectedStarOption.amount,
        stars: selectedStarOption.stars,
        users: selectedRandomUserCount
      });
    }
    handleClose();
  });
  const confirmLaunchPrepaidGiveaway = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (isStarsPrepaidGiveaway) {
      launchPrepaidStarsGiveaway({
        chatId: chatId,
        giveawayId: dataStarsPrepaidGiveaway.id,
        paymentPurpose: {
          additionalChannelIds: selectedChannelIds,
          countries: selectedCountryIds,
          prizeDescription,
          areWinnersVisible: shouldShowWinners,
          untilDate: customExpireDate / 1000,
          stars: dataStarsPrepaidGiveaway.stars,
          currency: selectedStarsGift.currency,
          amount: selectedStarsGift.amount,
          users: dataStarsPrepaidGiveaway.quantity
        }
      });
    } else {
      launchPrepaidGiveaway({
        chatId: chatId,
        giveawayId: dataPrepaidGiveaway.id,
        paymentPurpose: {
          additionalChannelIds: selectedChannelIds,
          countries: selectedCountryIds,
          prizeDescription,
          areWinnersVisible: shouldShowWinners,
          untilDate: customExpireDate / 1000,
          currency: selectedGift.currency,
          amount: selectedGift.amount
        }
      });
    }
    closeConfirmModal();
    handleClose();
  });
  const handleRandomUserCountChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(newValue => {
    setSelectedRandomUserCount(newValue);
  });
  const handleWinnerCountChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(newValue => {
    setSelectedRandomUserCount(newValue);
  });
  const handlePrizeDescriptionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    setPrizeDescription(e.target.value);
  });
  const userNames = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    return selectedUserIds?.map(userId => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFullName)(usersById[userId])).join(', ');
  }, [selectedUserIds]);
  function handleScroll(e) {
    const {
      scrollTop
    } = e.currentTarget;
    setHeaderHidden(scrollTop <= 150);
  }
  const handleChangeSubscriberOption = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(value => {
    setSelectedSubscriberOption(value);
  });
  const handleChangeTypeOption = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(value => {
    setGiveawayOption(value);
    setSelectedUserIds([]);
    setSelectedRandomUserCount(DEFAULT_BOOST_COUNT);
  });
  const handleExpireDateChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(date => {
    setCustomExpireDate(date.getTime());
    closeCalendar();
  });
  const handleSetCountriesListChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(value => {
    setSelectedCountryIds(value);
  });
  const handleSelectedUserIdsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(newSelectedIds => {
    setSelectedUserIds(newSelectedIds);
    if (!newSelectedIds.length) {
      setGiveawayOption('premium_giveaway');
    }
  });
  const handleSelectedChannelIdsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(newSelectedIds => {
    setSelectedChannelIds(newSelectedIds);
  });
  const handleShouldShowWinnersChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    setShouldShowWinners(e.target.checked);
  });
  const handleShouldShowPrizesChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    setShouldShowPrizes(e.target.checked);
  });
  const onClickActionHandler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    openCountryPickerModal();
  });
  const handleStarClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(option => {
    setSelectedStarOption(option);
  });
  function renderTypeOptions() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].options
    }, TYPE_OPTIONS.map(option => {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_GiveawayTypeOption__WEBPACK_IMPORTED_MODULE_27__["default"], {
        key: option.name,
        name: option.name,
        text: option.text,
        option: option.value,
        img: option.img,
        onChange: handleChangeTypeOption,
        checked: selectedGiveawayOption === option.value,
        isLink: option.isLink,
        userNames: userNames,
        selectedMemberIds: selectedUserIds,
        onClickAction: option.onClickAction
      });
    }));
  }
  function renderSubscribersOptions() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].options
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_23__["default"], {
      name: "subscribers",
      options: SUBSCRIBER_OPTIONS,
      selected: selectedSubscriberOption,
      onChange: handleChangeSubscriberOption,
      onClickAction: onClickActionHandler,
      subLabelClassName: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subLabelClassName,
      isLink: true
    }));
  }
  function renderSubscriptionOptions() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].options
    }, filteredGifts?.map(gift => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PremiumSubscriptionOption__WEBPACK_IMPORTED_MODULE_29__["default"], {
      isGiveaway: true,
      key: gift.months,
      option: gift,
      fullMonthlyAmount: fullMonthlyAmount,
      checked: gift.months === selectedMonthOption,
      onChange: setSelectedMonthOption
    })));
  }
  function renderPremiumFeaturesLink() {
    const info = lang('GiftPremiumListFeaturesAndTerms');
    const parts = info.match(/([^*]*)\*([^*]+)\*(.*)/);
    if (!parts || parts.length < 4) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].premiumFeatures
    }, parts[1], /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Link__WEBPACK_IMPORTED_MODULE_20__["default"], {
      isPrimary: true,
      onClick: handlePremiumClick
    }, parts[2]), parts[3]);
  }
  function deleteParticipantsHandler(id) {
    const filteredChannelIds = selectedChannelIds.filter(channelId => channelId !== id);
    setSelectedChannelIds(filteredChannelIds);
  }
  function renderStarOptionList() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_modals_stars_StarTopupOptionList__WEBPACK_IMPORTED_MODULE_16__["default"], {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].starOptions,
      options: starsGiftOptions,
      selectedStarCount: selectedRandomUserCount,
      selectedStarOption: selectedStarOption,
      onClick: handleStarClick
    });
  }
  function renderGiveawayOptionList() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].giveawayTitle
    }, lang('BoostingChannelsGroupsIncludedGiveaway')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_21__["default"], {
      inactive: true,
      className: "chat-item-clickable contact-list-item"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_14__["default"], {
      chatId: chatId,
      status: lang(isChannel ? 'BoostingChannelWillReceiveBoost' : 'BoostingGroupWillReceiveBoost', boostQuantity || boostStarsQuantity, 'i')
    })), selectedChannelIds?.map(channelId => {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_21__["default"], {
        ripple: true,
        key: channelId,
        className: "chat-item-clickable contact-list-item"
        /* eslint-disable-next-line react/jsx-no-bind */,
        onClick: () => deleteParticipantsHandler(channelId),
        rightElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
          name: "close",
          className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].removeChannel
        })
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_14__["default"], {
        chatId: channelId.toString()
      }));
    }), selectedChannelIds.length < MAX_ADDITIONAL_CHANNELS && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_21__["default"], {
      icon: "add",
      ripple: true,
      onClick: openChannelPickerModal,
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].addButton,
      iconClassName: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].addChannel
    }, lang('BoostingAddChannelOrGroup'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].giveawayTitle
    }, lang('BoostingEligibleUsers')), renderSubscribersOptions()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscription
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang(isChannel ? 'BoostGift.LimitSubscribersInfo' : 'lng_giveaway_users_about_group'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].checkboxSection
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].title
    }, lang('BoostingGiveawayAdditionalPrizes')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Switcher__WEBPACK_IMPORTED_MODULE_25__["default"], {
      label: lang('BoostingGiveawayAdditionalPrizes'),
      checked: shouldShowPrizes,
      onChange: handleShouldShowPrizesChange
    })), shouldShowPrizes && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].prizesSection
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].title
    }, selectedRandomUserCount), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_19__["default"], {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].prizesInput,
      value: prizeDescription,
      onChange: handlePrizeDescriptionChange,
      label: lang('BoostingGiveawayEnterYourPrize')
    }))), shouldShowPrizes ? !isStarsGiveaway && !isStarsPrepaidGiveaway ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscription
    }, prizeDescription?.length ? (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang('BoostingGiveawayAdditionPrizeCountNameHint', dataPrepaidGiveaway ? [dataPrepaidGiveaway.quantity, prizeDescription, monthQuantity] : [selectedUserCount, prizeDescription, monthQuantity], undefined, selectedMonthOption), ['simple_markdown']) : (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang('BoostingGiveawayAdditionPrizeCountHint', dataPrepaidGiveaway ? [dataPrepaidGiveaway.quantity, monthQuantity] : [selectedUserCount, monthQuantity], undefined, selectedMonthOption), ['simple_markdown'])) : undefined : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscription
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang('BoostingGiveawayAdditionPrizeHint'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].checkboxSection
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].title
    }, lang('BoostingGiveawayShowWinners')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Switcher__WEBPACK_IMPORTED_MODULE_25__["default"], {
      label: lang('BoostingGiveawayAdditionalPrizes'),
      checked: shouldShowWinners,
      onChange: handleShouldShowWinnersChange
    }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscription
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang('BoostingGiveawayShowWinnersHint'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section, (dataPrepaidGiveaway || dataStarsPrepaidGiveaway || isStarsGiveaway) && _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscriptionFooter)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].giveawayTitle
    }, lang('BoostingDateWhenGiveawayEnds')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_17__["default"], {
      ariaLabel: lang('BoostGift.DateEnds'),
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].dateButton, 'expire-limit'),
      isText: true,
      onClick: openCalendar
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].title
    }, lang('BoostGift.DateEnds')), (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_6__.formatDateTimeToString)(customExpireDate, lang.code))));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_22__["default"], {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].root,
    onClose: handleClose,
    isOpen: isOpen,
    dialogRef: dialogRef,
    onEnter: dataPrepaidGiveaway || dataStarsPrepaidGiveaway ? openConfirmModal : handleClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].main,
    onScroll: handleScroll
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_17__["default"], {
    round: true,
    size: "smaller",
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].closeButton,
    color: "translucent",
    onClick: handleClose,
    ariaLabel: lang('Close')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].logo,
    src: _assets_premium_PremiumLogo_svg__WEBPACK_IMPORTED_MODULE_35__,
    alt: "",
    draggable: false
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].headerText
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang('BoostingBoostsViaGifts'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].description
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang(isChannel ? 'BoostingGetMoreBoost' : 'BoostingGetMoreBoostsGroup'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].header, isHeaderHidden && _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].hiddenHeader)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].premiumHeaderText
  }, lang('BoostingBoostsViaGifts'))), dataPrepaidGiveaway || dataStarsPrepaidGiveaway ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].status
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, dataStarsPrepaidGiveaway ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].prepaidImg,
    src: _assets_premium_GiftStar_svg__WEBPACK_IMPORTED_MODULE_34__,
    alt: ""
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].prepaidImg,
    src: GIVEAWAY_IMG_LIST[dataPrepaidGiveaway.months],
    alt: ""
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].info
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].title
  }, dataStarsPrepaidGiveaway ? lang('Giveaway.Stars.Prepaid.Title', dataStarsPrepaidGiveaway?.stars) : lang('BoostingTelegramPremiumCountPlural', dataPrepaidGiveaway.quantity)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].month
  }, dataStarsPrepaidGiveaway ? lang('Giveaway.Stars.Prepaid.Desc', dataStarsPrepaidGiveaway?.quantity) : lang('PrepaidGiveawayMonths', dataPrepaidGiveaway?.months))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].quantity
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadge, _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadgeColor)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: "boost",
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadgeIcon
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadgeValue,
    dir: lang.isRtl ? 'rtl' : undefined
  }, dataStarsPrepaidGiveaway ? dataStarsPrepaidGiveaway?.boosts : dataPrepaidGiveaway.quantity * (giveawayBoostPerPremiumLimit ?? _config__WEBPACK_IMPORTED_MODULE_2__.GIVEAWAY_BOOST_PER_PREMIUM))))) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section, _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].types)
  }, renderTypeOptions()), isPremiumGiveaway && !selectedUserIds?.length && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, !dataPrepaidGiveaway && !dataStarsPrepaidGiveaway && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].quantity
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].giveawayTitle
  }, lang('BoostingQuantityPrizes')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadge, _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadgeColor)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: "boost",
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadgeIcon
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadgeValue,
    dir: lang.isRtl ? 'rtl' : undefined
  }, boostQuantity))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RangeSliderWithMarks__WEBPACK_IMPORTED_MODULE_24__["default"], {
    rangeCount: selectedUserCount,
    marks: userCountOptions,
    onChange: handleRandomUserCountChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscription
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang('BoostingChooseHowMany')))), renderGiveawayOptionList()), isStarsGiveaway && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, !dataStarsPrepaidGiveaway && !dataPrepaidGiveaway && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].quantity
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].giveawayTitle
  }, lang('BoostingStarsOptions')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadge, _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadgeColor)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: "boost",
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadgeIcon
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].floatingBadgeValue,
    dir: lang.isRtl ? 'rtl' : undefined
  }, boostStarsQuantity))), renderStarOptionList()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscription, _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].starSubscription)
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang('BoostGift.Stars.Info'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].giveawayTitle
  }, lang('BoostingStarsQuantityPrizes')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RangeSliderWithMarks__WEBPACK_IMPORTED_MODULE_24__["default"], {
    rangeCount: selectedRandomUserCount,
    marks: winnerCountOptions,
    onChange: handleWinnerCountChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscription
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(lang('BoostingStarsQuantityPrizesInfo'))))), renderGiveawayOptionList()), !dataPrepaidGiveaway && !dataStarsPrepaidGiveaway && isPremiumGiveaway && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].section
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].giveawayTitle
  }, lang('BoostingDurationOfPremium')), renderSubscriptionOptions()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscription, _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].subscriptionFooter)
  }, renderPremiumFeaturesLink())), selectedGiveawayOption && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].footer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_17__["default"], {
    className: _GiveawayModal_module_scss__WEBPACK_IMPORTED_MODULE_30__["default"].button,
    onClick: dataPrepaidGiveaway || dataStarsPrepaidGiveaway ? openConfirmModal : handleClick
  }, lang('BoostingStartGiveaway')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CalendarModal__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isOpen: isCalendarOpened,
    isFutureMode: true,
    withTimePicker: true,
    onClose: closeCalendar,
    onSubmit: handleExpireDateChange,
    selectedAt: customExpireDate,
    submitButtonLabel: lang('Save')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CountryPickerModal__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isCountryPickerModalOpen,
    onClose: closeCountryPickerModal,
    countryList: countryList,
    onSubmit: handleSetCountriesListChange,
    selectionLimit: countrySelectionLimit
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_GiveawayUserPickerModal__WEBPACK_IMPORTED_MODULE_28__["default"], {
    isOpen: isUserPickerModalOpen,
    onClose: closeUserPickerModal,
    onSelectedIdsConfirmed: handleSelectedUserIdsChange,
    initialSelectedIds: selectedUserIds,
    selectionLimit: userSelectionLimit,
    giveawayChatId: chatId
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_GiveawayChannelPickerModal__WEBPACK_IMPORTED_MODULE_26__["default"], {
    isOpen: isChannelPickerModalOpen,
    onClose: closeChannelPickerModal,
    initialSelectedIds: selectedChannelIds,
    onSelectedIdsConfirmed: handleSelectedChannelIdsChange,
    selectionLimit: _config__WEBPACK_IMPORTED_MODULE_2__.GIVEAWAY_MAX_ADDITIONAL_CHANNELS,
    giveawayChatId: chatId
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_18__["default"], {
    title: lang('BoostingStartGiveawayConfirmTitle'),
    text: lang('BoostingStartGiveawayConfirmText'),
    confirmLabel: lang('Start'),
    isOpen: isConfirmModalOpen,
    onClose: closeConfirmModal,
    confirmHandler: confirmLaunchPrepaidGiveaway
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    giveawayModal
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global);
  const chatId = giveawayModal?.chatId;
  const chat = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId) : undefined;
  const isChannel = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatChannel)(chat);
  return {
    chatId,
    gifts: giveawayModal?.gifts,
    selectedMemberList: giveawayModal?.selectedMemberIds,
    selectedChannelList: giveawayModal?.selectedChannelIds,
    giveawayBoostPerPremiumLimit: global.appConfig?.giveawayBoostsPerPremium,
    isStarsGiftEnabled: global.appConfig?.isStarsGiftEnabled,
    userSelectionLimit: global.appConfig?.giveawayAddPeersMax,
    countrySelectionLimit: global.appConfig?.giveawayCountriesMax,
    countryList: global.countryList.general,
    prepaidGiveaway: giveawayModal?.prepaidGiveaway,
    isChannel,
    starsGiftOptions: giveawayModal?.starOptions
  };
})(GiveawayModal)));

/***/ }),

/***/ "./src/components/main/premium/GiveawayTypeOption.tsx":
/*!************************************************************!*\
  !*** ./src/components/main/premium/GiveawayTypeOption.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _GiveawayTypeOption_module_scss__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./GiveawayTypeOption.module.scss */ "./src/components/main/premium/GiveawayTypeOption.module.scss");






const GiveawayTypeOption = ({
  option,
  checked,
  name,
  text,
  img,
  isLink,
  onChange,
  onClickAction,
  className,
  userNames,
  selectedMemberIds
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  let displayText = lang(text);
  if (isLink && selectedMemberIds?.length) {
    displayText = selectedMemberIds.length > 2 ? `${selectedMemberIds.length}` : userNames;
  }
  const handleChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__["default"])(e => {
    if (e.target.checked) {
      onChange(option);
    }
  });
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__["default"])(() => {
    onClickAction?.();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("label", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_GiveawayTypeOption_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].wrapper, className),
    dir: lang.isRtl ? 'rtl' : undefined,
    role: "button",
    tabIndex: 0
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    className: _GiveawayTypeOption_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].input,
    type: "radio",
    name: "giveaway_option",
    value: option,
    checked: checked,
    onChange: handleChange,
    onClick: e => e.stopPropagation()
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayTypeOption_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].content
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    className: _GiveawayTypeOption_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].optionImg,
    src: img,
    alt: "",
    draggable: false
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayTypeOption_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].giveaway
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: _GiveawayTypeOption_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].title
  }, lang(`${name}`)), isLink ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _GiveawayTypeOption_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].link,
    onClick: handleClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, displayText), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_4__["default"], {
    name: "next"
  })) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _GiveawayTypeOption_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].contentText
  }, displayText))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(GiveawayTypeOption));

/***/ }),

/***/ "./src/components/main/premium/GiveawayUserPickerModal.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/main/premium/GiveawayUserPickerModal.tsx ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/helpers/sortChatIds */ "./src/components/common/helpers/sortChatIds.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _common_pickers_PickerModal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/pickers/PickerModal */ "./src/components/common/pickers/PickerModal.tsx");










const GiveawayUserPickerModal = ({
  isOpen,
  selectionLimit,
  members,
  adminMembersById,
  initialSelectedIds,
  onSelectedIdsConfirmed,
  onClose
}) => {
  const {
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [searchQuery, setSearchQuery] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [selectedIds, setSelectedIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(initialSelectedIds);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setSelectedIds(initialSelectedIds);
  }, [initialSelectedIds]);
  const memberIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    const {
      byId,
      statusesById
    } = global.users;
    if (!members?.length) {
      return [];
    }
    const adminIdsSet = adminMembersById && new Set(Object.keys(adminMembersById));
    const userIds = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.sortUserIds)(members.map(({
      userId
    }) => userId), byId, statusesById);
    return adminIdsSet ? userIds.filter(userId => !adminIdsSet.has(userId)) : userIds;
  }, [adminMembersById, members]);
  const displayedMemberIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    const filteredContactIds = memberIds ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.filterUsersByName)(memberIds, usersById, searchQuery) : [];
    return (0,_common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_5__["default"])((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.unique)(filteredContactIds).filter(userId => {
      const user = usersById[userId];
      if (!user) {
        return true;
      }
      return !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserBot)(user);
    }));
  }, [memberIds, searchQuery]);
  const handleSelectedMemberIdsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(newSelectedIds => {
    if (newSelectedIds.length > selectionLimit) {
      showNotification({
        message: lang('BoostingSelectUpToWarningUsers', selectionLimit)
      });
      return;
    }
    setSelectedIds(newSelectedIds);
  });
  const handleModalConfirm = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    onSelectedIdsConfirmed(selectedIds);
    onClose();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PickerModal__WEBPACK_IMPORTED_MODULE_9__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    title: lang('BoostingAwardSpecificUsers'),
    hasCloseButton: true,
    shouldAdaptToSearch: true,
    withFixedHeight: true,
    confirmButtonText: lang('Save'),
    onConfirm: handleModalConfirm,
    onEnter: handleModalConfirm
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_8__["default"], {
    itemIds: displayedMemberIds,
    selectedIds: selectedIds,
    filterValue: searchQuery,
    filterPlaceholder: lang('Search'),
    onSelectedIdsChange: handleSelectedMemberIdsChange,
    onFilterChange: setSearchQuery,
    isSearchable: true,
    withDefaultPadding: true,
    withStatus: true,
    allowMultiple: true,
    itemInputType: "checkbox"
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  giveawayChatId
}) => {
  const chatFullInfo = giveawayChatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, giveawayChatId) : undefined;
  if (!chatFullInfo) {
    return {};
  }
  return {
    members: chatFullInfo.members,
    adminMembersById: chatFullInfo.adminMembersById
  };
})(GiveawayUserPickerModal)));

/***/ }),

/***/ "./src/components/main/premium/PremiumFeatureItem.tsx":
/*!************************************************************!*\
  !*** ./src/components/main/premium/PremiumFeatureItem.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_switchTheme__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/switchTheme */ "./src/util/switchTheme.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _PremiumFeatureItem_module_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./PremiumFeatureItem.module.scss */ "./src/components/main/premium/PremiumFeatureItem.module.scss");







const COLORS = ['#F2862D', '#EB7B4D', '#E46D72', '#DD6091', '#CC5FBA', '#B464E7', '#9873FF', '#768DFF', '#55A5FC', '#52B0C9', '#4FBC93', '#4CC663'].map(_util_switchTheme__WEBPACK_IMPORTED_MODULE_1__.hexToRgb);

// eslint-disable-next-line @typescript-eslint/comma-dangle
const PremiumFeatureItem = ({
  icon,
  isFontIcon,
  title,
  text,
  index,
  count,
  section,
  onClick
}) => {
  const newIndex = index / count * COLORS.length;
  const colorA = COLORS[Math.floor(newIndex)];
  const colorB = COLORS[Math.ceil(newIndex)] ?? colorA;
  const {
    r,
    g,
    b
  } = (0,_util_switchTheme__WEBPACK_IMPORTED_MODULE_1__.lerpRgb)(colorA, colorB, 0.5);
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__["default"])(() => {
    onClick?.(section);
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_5__["default"], {
    buttonClassName: _PremiumFeatureItem_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].root,
    onClick: handleClick,
    inactive: !onClick
  }, isFontIcon ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_4__["default"], {
    name: icon,
    className: _PremiumFeatureItem_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].fontIcon,
    style: `--item-color: rgb(${r},${g},${b})`
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: icon,
    className: _PremiumFeatureItem_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].icon,
    alt: "",
    style: `--item-color: rgb(${r},${g},${b})`,
    draggable: false
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeatureItem_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].text
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeatureItem_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].title
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_2__["default"])(title, ['br'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeatureItem_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].description
  }, text)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PremiumFeatureItem));

/***/ }),

/***/ "./src/components/main/premium/PremiumFeatureModal.tsx":
/*!*************************************************************!*\
  !*** ./src/components/main/premium/PremiumFeatureModal.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   PREMIUM_FEATURE_DESCRIPTIONS: () => (/* binding */ PREMIUM_FEATURE_DESCRIPTIONS),
/* harmony export */   PREMIUM_FEATURE_TITLES: () => (/* binding */ PREMIUM_FEATURE_TITLES),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _lib_teact_teact_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/teact/teact-dom */ "./src/lib/teact/teact-dom.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/animateHorizontalScroll */ "./src/util/animateHorizontalScroll.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_formatCurrency__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/formatCurrency */ "./src/util/formatCurrency.tsx");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_SliderDots__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/SliderDots */ "./src/components/common/SliderDots.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _common_PremiumLimitPreview__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./common/PremiumLimitPreview */ "./src/components/main/premium/common/PremiumLimitPreview.tsx");
/* harmony import */ var _previews_PremiumFeaturePreviewStickers__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./previews/PremiumFeaturePreviewStickers */ "./src/components/main/premium/previews/PremiumFeaturePreviewStickers.tsx");
/* harmony import */ var _previews_PremiumFeaturePreviewStories__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./previews/PremiumFeaturePreviewStories */ "./src/components/main/premium/previews/PremiumFeaturePreviewStories.tsx");
/* harmony import */ var _previews_PremiumFeaturePreviewVideo__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./previews/PremiumFeaturePreviewVideo */ "./src/components/main/premium/previews/PremiumFeaturePreviewVideo.tsx");
/* harmony import */ var _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./PremiumFeatureModal.module.scss */ "./src/components/main/premium/PremiumFeatureModal.module.scss");




















const PREMIUM_FEATURE_TITLES = {
  double_limits: 'PremiumPreviewLimits',
  infinite_reactions: 'PremiumPreviewReactions2',
  premium_stickers: 'PremiumPreviewStickers',
  animated_emoji: 'PremiumPreviewEmoji',
  no_ads: 'PremiumPreviewNoAds',
  voice_to_text: 'PremiumPreviewVoiceToText',
  profile_badge: 'PremiumPreviewProfileBadge',
  faster_download: 'PremiumPreviewDownloadSpeed',
  more_upload: 'PremiumPreviewUploads',
  advanced_chat_management: 'PremiumPreviewAdvancedChatManagement',
  animated_userpics: 'PremiumPreviewAnimatedProfiles',
  emoji_status: 'PremiumPreviewEmojiStatus',
  translations: 'PremiumPreviewTranslations',
  stories: 'PremiumPreviewStories',
  saved_tags: 'PremiumPreviewTags2',
  last_seen: 'PremiumPreviewLastSeen',
  message_privacy: 'PremiumPreviewMessagePrivacy',
  effects: 'Premium.MessageEffects'
};
const PREMIUM_FEATURE_DESCRIPTIONS = {
  double_limits: 'PremiumPreviewLimitsDescription',
  infinite_reactions: 'PremiumPreviewReactions2Description',
  premium_stickers: 'PremiumPreviewStickersDescription',
  no_ads: 'PremiumPreviewNoAdsDescription',
  animated_emoji: 'PremiumPreviewEmojiDescription',
  voice_to_text: 'PremiumPreviewVoiceToTextDescription',
  profile_badge: 'PremiumPreviewProfileBadgeDescription',
  faster_download: 'PremiumPreviewDownloadSpeedDescription',
  more_upload: 'PremiumPreviewUploadsDescription',
  advanced_chat_management: 'PremiumPreviewAdvancedChatManagementDescription',
  animated_userpics: 'PremiumPreviewAnimatedProfilesDescription',
  emoji_status: 'PremiumPreviewEmojiStatusDescription',
  translations: 'PremiumPreviewTranslationsDescription',
  stories: 'PremiumPreviewStoriesDescription',
  saved_tags: 'PremiumPreviewTagsDescription2',
  last_seen: 'PremiumPreviewLastSeenDescription',
  message_privacy: 'PremiumPreviewMessagePrivacyDescription',
  effects: 'Premium.MessageEffectsInfo'
};
const LIMITS_TITLES = {
  channels: 'GroupsAndChannelsLimitTitle',
  dialogFolderPinned: 'PinChatsLimitTitle',
  channelsPublic: 'PublicLinksLimitTitle',
  savedGifs: 'SavedGifsLimitTitle',
  stickersFaved: 'FavoriteStickersLimitTitle',
  aboutLength: 'BioLimitTitle',
  captionLength: 'CaptionsLimitTitle',
  dialogFilters: 'FoldersLimitTitle',
  dialogFiltersChats: 'ChatPerFolderLimitTitle',
  recommendedChannels: 'SimilarChannelsLimitTitle'
};
const LIMITS_DESCRIPTIONS = {
  channels: 'GroupsAndChannelsLimitSubtitle',
  dialogFolderPinned: 'PinChatsLimitSubtitle',
  channelsPublic: 'PublicLinksLimitSubtitle',
  savedGifs: 'SavedGifsLimitSubtitle',
  stickersFaved: 'FavoriteStickersLimitSubtitle',
  aboutLength: 'BioLimitSubtitle',
  captionLength: 'CaptionsLimitSubtitle',
  dialogFilters: 'FoldersLimitSubtitle',
  dialogFiltersChats: 'ChatPerFolderLimitSubtitle',
  recommendedChannels: 'SimilarChannelsLimitSubtitle'
};
const BORDER_THRESHOLD = 20;
const PremiumFeatureModal = ({
  promo,
  initialSection,
  isPremium,
  limits,
  premiumPromoOrder,
  subscriptionOption,
  onBack,
  onClickSubscribe
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  // eslint-disable-next-line no-null/no-null
  const scrollContainerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [currentSlideIndex, setCurrentSlideIndex] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(_config__WEBPACK_IMPORTED_MODULE_2__.PREMIUM_FEATURE_SECTIONS.indexOf(initialSection));
  const [reverseAnimationSlideIndex, setReverseAnimationSlideIndex] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  const [isScrolling, startScrolling, stopScrolling] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [isScrolledToTop, setIsScrolledToTop] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [isScrolledToBottom, setIsScrolledToBottom] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const prevInitialSection = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_11__["default"])(initialSection);
  const filteredSections = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!premiumPromoOrder) return _config__WEBPACK_IMPORTED_MODULE_2__.PREMIUM_FEATURE_SECTIONS;
    return premiumPromoOrder.filter(section => _config__WEBPACK_IMPORTED_MODULE_2__.PREMIUM_FEATURE_SECTIONS.includes(section));
  }, [premiumPromoOrder]);
  const subscriptionButtonText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!subscriptionOption) return undefined;
    const {
      amount,
      months,
      currency
    } = subscriptionOption;
    const perMonthPrice = Math.floor(amount / months);
    return isPremium ? lang('OK') : lang('SubscribeToPremium', (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_6__.formatCurrency)(perMonthPrice, currency, lang.code));
  }, [isPremium, lang, subscriptionOption]);
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onClickSubscribe(initialSection);
  });
  function handleScroll(e) {
    const target = e.currentTarget;
    const {
      clientWidth,
      scrollLeft: scrollLeftOriginal
    } = target;
    const scrollLeft = Math.round(scrollLeftOriginal);
    const left = scrollLeft % clientWidth;
    const progress = left / clientWidth;
    const reverseIndex = Math.ceil((scrollLeft + 1) / clientWidth);
    setReverseAnimationSlideIndex(reverseIndex);
    const prevElement = target.querySelector(`#premium_feature_preview_video_${reverseIndex - 1}`);
    const reverseElement = target.querySelector(`#premium_feature_preview_video_${reverseIndex}`);
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
      target.style.setProperty('--scroll-progress', progress.toString());
      target.style.setProperty('--abs-scroll-progress', Math.abs(progress).toString());
      if (prevElement) (0,_lib_teact_teact_dom__WEBPACK_IMPORTED_MODULE_1__.toggleExtraClass)(prevElement, 'reverse', false);
      if (reverseElement) (0,_lib_teact_teact_dom__WEBPACK_IMPORTED_MODULE_1__.toggleExtraClass)(reverseElement, 'reverse', true);
    });
    if (isScrolling) return;
    const slide = Math.round(scrollLeft / clientWidth);
    setCurrentSlideIndex(slide);
  }
  function handleLimitsScroll(e) {
    const {
      scrollTop,
      clientHeight,
      scrollHeight
    } = e.currentTarget;
    setIsScrolledToTop(scrollTop <= BORDER_THRESHOLD);
    setIsScrolledToBottom(scrollTop >= scrollHeight - clientHeight - BORDER_THRESHOLD);
  }
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const scrollContainer = scrollContainerRef.current;
    if (!scrollContainer || prevInitialSection === initialSection) return;
    const index = filteredSections.indexOf(initialSection);
    setCurrentSlideIndex(index);
    startScrolling();
    (0,_util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_4__["default"])(scrollContainer, scrollContainer.clientWidth * index, 0).then(stopScrolling);
  }, [currentSlideIndex, filteredSections, initialSection, prevInitialSection]);
  const handleSelectSlide = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(async index => {
    const scrollContainer = scrollContainerRef.current;
    if (!scrollContainer) return;
    setCurrentSlideIndex(index);
    startScrolling();
    await (0,_util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_4__["default"])(scrollContainer, scrollContainer.clientWidth * index, 800);
    stopScrolling();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].root
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    round: true,
    size: "smaller",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].backButton, currentSlideIndex !== 0 && _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].whiteBackButton),
    color: currentSlideIndex === 0 ? 'translucent' : 'translucent-white',
    onClick: onBack,
    ariaLabel: lang('Back')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "arrow-left"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].preview
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].content, 'no-scrollbar'),
    onScroll: handleScroll,
    ref: scrollContainerRef
  }, filteredSections.map((section, index) => {
    if (section === 'double_limits') {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].slide, _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].limits)
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
        className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].header, isScrolledToTop && _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].noHeaderBorder)
      }, lang(PREMIUM_FEATURE_TITLES.double_limits)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].limitsContent, 'custom-scroll'),
        onScroll: handleLimitsScroll
      }, _config__WEBPACK_IMPORTED_MODULE_2__.PREMIUM_LIMITS_ORDER.map((limit, i) => {
        const defaultLimit = limits?.[limit][0].toString();
        const premiumLimit = limits?.[limit][1].toString();
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PremiumLimitPreview__WEBPACK_IMPORTED_MODULE_15__["default"], {
          title: lang(LIMITS_TITLES[limit]),
          description: lang(LIMITS_DESCRIPTIONS[limit], premiumLimit),
          leftValue: defaultLimit,
          rightValue: premiumLimit,
          colorStepProgress: i / (_config__WEBPACK_IMPORTED_MODULE_2__.PREMIUM_LIMITS_ORDER.length - 1)
        });
      })));
    }
    if (section === 'premium_stickers') {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].slide
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].frame
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_previews_PremiumFeaturePreviewStickers__WEBPACK_IMPORTED_MODULE_16__["default"], {
        isActive: currentSlideIndex === index
      })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h1", {
        className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].title
      }, lang(PREMIUM_FEATURE_TITLES.premium_stickers)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].description
      }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__["default"])(lang(PREMIUM_FEATURE_DESCRIPTIONS.premium_stickers), ['br'])));
    }
    if (section === 'stories') {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].slide, _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].stories)
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_previews_PremiumFeaturePreviewStories__WEBPACK_IMPORTED_MODULE_17__["default"], null));
    }
    const i = promo.videoSections.indexOf(section);
    if (i === -1) return undefined;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].slide
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].frame
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_previews_PremiumFeaturePreviewVideo__WEBPACK_IMPORTED_MODULE_18__["default"], {
      isActive: currentSlideIndex === index,
      videoId: promo.videos[i].id,
      videoThumbnail: promo.videos[i].thumbnail,
      isDown: _config__WEBPACK_IMPORTED_MODULE_2__.PREMIUM_BOTTOM_VIDEOS.includes(section),
      index: index,
      isReverseAnimation: index === reverseAnimationSlideIndex
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h1", {
      className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].title
    }, lang(PREMIUM_FEATURE_TITLES[promo.videoSections[i]])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].description
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__["default"])(lang(PREMIUM_FEATURE_DESCRIPTIONS[promo.videoSections[i]]), ['br'])));
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].footer, (isScrolledToBottom || currentSlideIndex !== 0) && _PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].noFooterBorder)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_SliderDots__WEBPACK_IMPORTED_MODULE_13__["default"], {
    length: _config__WEBPACK_IMPORTED_MODULE_2__.PREMIUM_FEATURE_SECTIONS.length,
    active: currentSlideIndex,
    onSelectSlide: handleSelectSlide
  }), subscriptionButtonText && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_PremiumFeatureModal_module_scss__WEBPACK_IMPORTED_MODULE_19__["default"].button),
    isShiny: !isPremium,
    withPremiumGradient: !isPremium,
    onClick: isPremium ? onBack : handleClick
  }, subscriptionButtonText)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PremiumFeatureModal));

/***/ }),

/***/ "./src/components/main/premium/PremiumMainModal.tsx":
/*!**********************************************************!*\
  !*** ./src/components/main/premium/PremiumMainModal.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors/limits */ "./src/global/selectors/limits.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_formatCurrency__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/formatCurrency */ "./src/util/formatCurrency.tsx");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/helpers/renderTextWithEntities */ "./src/components/common/helpers/renderTextWithEntities.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useSyncEffect */ "./src/hooks/useSyncEffect.ts");
/* harmony import */ var _common_CustomEmoji__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/CustomEmoji */ "./src/components/common/CustomEmoji.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _PremiumFeatureItem__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./PremiumFeatureItem */ "./src/components/main/premium/PremiumFeatureItem.tsx");
/* harmony import */ var _PremiumFeatureModal__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./PremiumFeatureModal */ "./src/components/main/premium/PremiumFeatureModal.tsx");
/* harmony import */ var _PremiumSubscriptionOption__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./PremiumSubscriptionOption */ "./src/components/main/premium/PremiumSubscriptionOption.tsx");
/* harmony import */ var _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./PremiumMainModal.module.scss */ "./src/components/main/premium/PremiumMainModal.module.scss");
/* harmony import */ var _assets_premium_PremiumAds_svg__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../../assets/premium/PremiumAds.svg */ "./src/assets/premium/PremiumAds.svg");
/* harmony import */ var _assets_premium_PremiumBadge_svg__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../../assets/premium/PremiumBadge.svg */ "./src/assets/premium/PremiumBadge.svg");
/* harmony import */ var _assets_premium_PremiumChats_svg__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../../../assets/premium/PremiumChats.svg */ "./src/assets/premium/PremiumChats.svg");
/* harmony import */ var _assets_premium_PremiumEffects_svg__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../../../assets/premium/PremiumEffects.svg */ "./src/assets/premium/PremiumEffects.svg");
/* harmony import */ var _assets_premium_PremiumEmoji_svg__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../../../assets/premium/PremiumEmoji.svg */ "./src/assets/premium/PremiumEmoji.svg");
/* harmony import */ var _assets_premium_PremiumFile_svg__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../../../assets/premium/PremiumFile.svg */ "./src/assets/premium/PremiumFile.svg");
/* harmony import */ var _assets_premium_PremiumLastSeen_svg__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../../../assets/premium/PremiumLastSeen.svg */ "./src/assets/premium/PremiumLastSeen.svg");
/* harmony import */ var _assets_premium_PremiumLimits_svg__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../../../assets/premium/PremiumLimits.svg */ "./src/assets/premium/PremiumLimits.svg");
/* harmony import */ var _assets_premium_PremiumLogo_svg__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../../../assets/premium/PremiumLogo.svg */ "./src/assets/premium/PremiumLogo.svg");
/* harmony import */ var _assets_premium_PremiumMessagePrivacy_svg__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../../../assets/premium/PremiumMessagePrivacy.svg */ "./src/assets/premium/PremiumMessagePrivacy.svg");
/* harmony import */ var _assets_premium_PremiumReactions_svg__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../../../assets/premium/PremiumReactions.svg */ "./src/assets/premium/PremiumReactions.svg");
/* harmony import */ var _assets_premium_PremiumSpeed_svg__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../../../assets/premium/PremiumSpeed.svg */ "./src/assets/premium/PremiumSpeed.svg");
/* harmony import */ var _assets_premium_PremiumStatus_svg__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../../../assets/premium/PremiumStatus.svg */ "./src/assets/premium/PremiumStatus.svg");
/* harmony import */ var _assets_premium_PremiumStickers_svg__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../../../assets/premium/PremiumStickers.svg */ "./src/assets/premium/PremiumStickers.svg");
/* harmony import */ var _assets_premium_PremiumTags_svg__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../../../assets/premium/PremiumTags.svg */ "./src/assets/premium/PremiumTags.svg");
/* harmony import */ var _assets_premium_PremiumTranslate_svg__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../../../assets/premium/PremiumTranslate.svg */ "./src/assets/premium/PremiumTranslate.svg");
/* harmony import */ var _assets_premium_PremiumVideo_svg__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../../../assets/premium/PremiumVideo.svg */ "./src/assets/premium/PremiumVideo.svg");
/* harmony import */ var _assets_premium_PremiumVoice_svg__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ../../../assets/premium/PremiumVoice.svg */ "./src/assets/premium/PremiumVoice.svg");









































const LIMIT_ACCOUNTS = 4;
const STATUS_EMOJI_SIZE = 8 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_8__.REM;
const PREMIUM_FEATURE_COLOR_ICONS = {
  stories: _assets_premium_PremiumStatus_svg__WEBPACK_IMPORTED_MODULE_35__,
  double_limits: _assets_premium_PremiumLimits_svg__WEBPACK_IMPORTED_MODULE_30__,
  infinite_reactions: _assets_premium_PremiumReactions_svg__WEBPACK_IMPORTED_MODULE_33__,
  premium_stickers: _assets_premium_PremiumStickers_svg__WEBPACK_IMPORTED_MODULE_36__,
  animated_emoji: _assets_premium_PremiumEmoji_svg__WEBPACK_IMPORTED_MODULE_27__,
  no_ads: _assets_premium_PremiumAds_svg__WEBPACK_IMPORTED_MODULE_23__,
  voice_to_text: _assets_premium_PremiumVoice_svg__WEBPACK_IMPORTED_MODULE_40__,
  profile_badge: _assets_premium_PremiumBadge_svg__WEBPACK_IMPORTED_MODULE_24__,
  faster_download: _assets_premium_PremiumSpeed_svg__WEBPACK_IMPORTED_MODULE_34__,
  more_upload: _assets_premium_PremiumFile_svg__WEBPACK_IMPORTED_MODULE_28__,
  advanced_chat_management: _assets_premium_PremiumChats_svg__WEBPACK_IMPORTED_MODULE_25__,
  animated_userpics: _assets_premium_PremiumVideo_svg__WEBPACK_IMPORTED_MODULE_39__,
  emoji_status: _assets_premium_PremiumStatus_svg__WEBPACK_IMPORTED_MODULE_35__,
  translations: _assets_premium_PremiumTranslate_svg__WEBPACK_IMPORTED_MODULE_38__,
  saved_tags: _assets_premium_PremiumTags_svg__WEBPACK_IMPORTED_MODULE_37__,
  last_seen: _assets_premium_PremiumLastSeen_svg__WEBPACK_IMPORTED_MODULE_29__,
  message_privacy: _assets_premium_PremiumMessagePrivacy_svg__WEBPACK_IMPORTED_MODULE_32__,
  effects: _assets_premium_PremiumEffects_svg__WEBPACK_IMPORTED_MODULE_26__
};
const PremiumMainModal = ({
  isOpen,
  currentUserId,
  fromUser,
  fromUserStatusEmoji,
  fromUserStatusSet,
  promo,
  initialSection,
  isPremium,
  limitChannels,
  limitLinks,
  limitFolders,
  limitPins,
  limits,
  premiumSlug,
  premiumBotUsername,
  isSuccess,
  isGift,
  toUser,
  monthsAmount,
  premiumPromoOrder
}) => {
  // eslint-disable-next-line no-null/no-null
  const dialogRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    closePremiumModal,
    openInvoice,
    requestConfetti,
    openTelegramLink,
    loadStickers,
    openStickerSet
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const [isHeaderHidden, setHeaderHidden] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [currentSection, setCurrentSection] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(initialSection);
  const [selectedSubscriptionOption, setSubscriptionOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      setHeaderHidden(true);
      setCurrentSection(undefined);
    }
  }, [isOpen]);
  const handleOpenSection = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(section => {
    setCurrentSection(section);
  });
  const handleResetSection = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    setCurrentSection(undefined);
  });
  function handleScroll(e) {
    const {
      scrollTop
    } = e.currentTarget;
    setHeaderHidden(scrollTop <= 150);
  }
  const handleClickWithStartParam = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(startParam => {
    const dialog = dialogRef.current;
    if (!dialog) return;
    if (premiumSlug) {
      openInvoice({
        type: 'slug',
        slug: premiumSlug
      });
    } else if (premiumBotUsername) {
      openTelegramLink({
        url: `${_config__WEBPACK_IMPORTED_MODULE_2__.TME_LINK_PREFIX}${premiumBotUsername}?start=${startParam || 'promo'}`
      });
      closePremiumModal();
    }
  });
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    if (selectedSubscriptionOption) {
      handleClickWithStartParam(String(selectedSubscriptionOption.months));
    } else {
      handleClickWithStartParam();
    }
  });
  const handleChangeSubscriptionOption = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(months => {
    const foundOption = promo?.options.find(option => option.months === months);
    setSubscriptionOption(foundOption);
  });
  const showConfetti = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    const dialog = dialogRef.current;
    if (!dialog) return;
    if (isOpen) {
      const {
        top,
        left,
        width,
        height
      } = dialog.querySelector('.modal-content').getBoundingClientRect();
      requestConfetti({
        top,
        left,
        width,
        height,
        withStars: true
      });
    }
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isSuccess) {
      showConfetti();
    }
  }, [isSuccess, showConfetti]);
  (0,_hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_13__["default"])(([prevIsPremium]) => {
    if (prevIsPremium === isPremium) return;
    showConfetti();
  }, [isPremium, showConfetti]);
  const filteredSections = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!premiumPromoOrder) return _config__WEBPACK_IMPORTED_MODULE_2__.PREMIUM_FEATURE_SECTIONS;
    return premiumPromoOrder.filter(section => _config__WEBPACK_IMPORTED_MODULE_2__.PREMIUM_FEATURE_SECTIONS.includes(section));
  }, [premiumPromoOrder]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!fromUserStatusEmoji || fromUserStatusSet) return;
    loadStickers({
      stickerSetInfo: fromUserStatusEmoji.stickerSetInfo
    });
  }, [loadStickers, fromUserStatusEmoji, fromUserStatusSet]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const [defaultOption] = promo?.options ?? [];
    setSubscriptionOption(defaultOption);
  }, [promo]);
  const handleOpenStatusSet = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    if (!fromUserStatusSet) return;
    openStickerSet({
      stickerSetInfo: fromUserStatusSet
    });
  });
  const fullMonthlyAmount = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const monthOption = promo?.options.find(option => option.months === 1);
    if (!monthOption) {
      return undefined;
    }
    return Number(monthOption.amount);
  }, [promo]);
  const subscribeButtonText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!selectedSubscriptionOption) {
      return undefined;
    }
    const {
      amount,
      months,
      currency
    } = selectedSubscriptionOption;
    const perMonthPrice = Math.floor(amount / months);
    return (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_7__.formatCurrency)(perMonthPrice, currency, lang.code);
  }, [selectedSubscriptionOption, lang.code]);
  if (!promo || fromUserStatusEmoji && !fromUserStatusSet) return undefined;
  function getHeaderText() {
    if (isGift) {
      return (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(fromUser?.id === currentUserId ? lang('TelegramPremiumUserGiftedPremiumOutboundDialogTitle', [(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFullName)(toUser), monthsAmount]) : lang('TelegramPremiumUserGiftedPremiumDialogTitle', [(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFullName)(fromUser), monthsAmount]), ['simple_markdown', 'emoji']);
    }
    if (fromUserStatusSet && fromUser) {
      const template = lang('lng_premium_emoji_status_title').replace('{user}', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFullName)(fromUser));
      const [first, second] = template.split('{link}');
      const emoji = fromUserStatusSet.thumbCustomEmojiId ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmoji__WEBPACK_IMPORTED_MODULE_14__["default"], {
        className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].stickerSetLinkIcon,
        documentId: fromUserStatusSet.thumbCustomEmojiId
      }) : undefined;
      const link = /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
        className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].stickerSetLink,
        onClick: handleOpenStatusSet
      }, emoji, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(fromUserStatusSet.title));
      return [(0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(first), link, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(second)];
    }
    return (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(fromUser ? lang('TelegramPremiumUserDialogTitle', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFullName)(fromUser)) : lang(isPremium ? 'TelegramPremiumSubscribedTitle' : 'TelegramPremium'), ['simple_markdown', 'emoji']);
  }
  function getHeaderDescription() {
    if (isGift) {
      return fromUser?.id === currentUserId ? lang('TelegramPremiumUserGiftedPremiumOutboundDialogSubtitle', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFullName)(toUser)) : lang('TelegramPremiumUserGiftedPremiumDialogSubtitle');
    }
    if (fromUserStatusSet) {
      return lang('TelegramPremiumUserStatusDialogSubtitle');
    }
    return fromUser ? lang('TelegramPremiumUserDialogSubtitle') : lang(isPremium ? 'TelegramPremiumSubscribedSubtitle' : 'TelegramPremiumSubtitle');
  }
  function renderFooterText() {
    if (!promo || isGift && fromUser?.id === currentUserId) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].footerText,
      dir: lang.isRtl ? 'rtl' : undefined
    }, (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_10__.renderTextWithEntities)({
      text: promo.statusText,
      entities: promo.statusEntities
    }));
  }
  function renderSubscriptionOptions() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].subscriptionOptions
    }, promo?.options.map(option => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PremiumSubscriptionOption__WEBPACK_IMPORTED_MODULE_21__["default"], {
      className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].subscriptionOption,
      key: option.amount,
      option: option,
      onChange: handleChangeSubscriptionOption,
      fullMonthlyAmount: fullMonthlyAmount,
      checked: selectedSubscriptionOption?.months === option.months
    })));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_17__["default"], {
    className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].root,
    onClose: closePremiumModal,
    isOpen: isOpen,
    dialogRef: dialogRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_18__["default"], {
    name: "slide",
    activeKey: currentSection ? 1 : 0,
    className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].transition
  }, !currentSection ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].main, 'custom-scroll'),
    onScroll: handleScroll
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
    round: true,
    size: "smaller",
    className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].closeButton,
    color: "translucent"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => closePremiumModal(),
    ariaLabel: lang('Close')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: "close"
  })), fromUserStatusEmoji ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmoji__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].statusEmoji,
    onClick: handleOpenStatusSet,
    documentId: fromUserStatusEmoji.id,
    isBig: true,
    size: STATUS_EMOJI_SIZE
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].logo,
    src: _assets_premium_PremiumLogo_svg__WEBPACK_IMPORTED_MODULE_31__,
    alt: "",
    draggable: false
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].headerText, fromUserStatusSet && _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].stickerSetText)
  }, getHeaderText()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].description
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(getHeaderDescription(), ['simple_markdown', 'emoji'])), !isPremium && !isGift && renderSubscriptionOptions(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].header, isHeaderHidden && _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].hiddenHeader)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].premiumHeaderText
  }, lang('TelegramPremium'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].list, isPremium && _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].noButton)
  }, filteredSections.map((section, index) => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PremiumFeatureItem__WEBPACK_IMPORTED_MODULE_19__["default"], {
      key: section,
      title: lang(_PremiumFeatureModal__WEBPACK_IMPORTED_MODULE_20__.PREMIUM_FEATURE_TITLES[section]),
      text: section === 'double_limits' ? lang(_PremiumFeatureModal__WEBPACK_IMPORTED_MODULE_20__.PREMIUM_FEATURE_DESCRIPTIONS[section], [limitChannels, limitFolders, limitPins, limitLinks, LIMIT_ACCOUNTS]) : lang(_PremiumFeatureModal__WEBPACK_IMPORTED_MODULE_20__.PREMIUM_FEATURE_DESCRIPTIONS[section]),
      icon: PREMIUM_FEATURE_COLOR_ICONS[section],
      index: index,
      count: filteredSections.length,
      section: section,
      onClick: handleOpenSection
    });
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].footerText, _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].primaryFooterText),
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(lang('AboutPremiumDescription'), ['simple_markdown'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_9__["default"])(lang('AboutPremiumDescription2'), ['simple_markdown']))), renderFooterText()), !isPremium && selectedSubscriptionOption && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].footer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
    className: _PremiumMainModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].button,
    isShiny: true,
    withPremiumGradient: true,
    onClick: handleClick
  }, lang('SubscribeToPremium', subscribeButtonText)))) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PremiumFeatureModal__WEBPACK_IMPORTED_MODULE_20__["default"], {
    initialSection: currentSection,
    onBack: handleResetSection,
    promo: promo,
    onClickSubscribe: handleClickWithStartParam,
    isPremium: isPremium,
    limits: limits,
    premiumPromoOrder: premiumPromoOrder,
    subscriptionOption: selectedSubscriptionOption
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    premiumModal
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global);
  const fromUser = premiumModal?.fromUserId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectUser)(global, premiumModal.fromUserId) : undefined;
  const fromUserStatusEmoji = fromUser?.emojiStatus ? global.customEmojis.byId[fromUser.emojiStatus.documentId] : undefined;
  const fromUserStatusSet = fromUserStatusEmoji ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectStickerSet)(global, fromUserStatusEmoji.stickerSetInfo) : undefined;
  return {
    currentUserId: global.currentUserId,
    promo: premiumModal?.promo,
    isSuccess: premiumModal?.isSuccess,
    isGift: premiumModal?.isGift,
    monthsAmount: premiumModal?.monthsAmount,
    fromUser,
    fromUserStatusEmoji,
    fromUserStatusSet,
    toUser: premiumModal?.toUserId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectUser)(global, premiumModal.toUserId) : undefined,
    initialSection: premiumModal?.initialSection,
    isPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsCurrentUserPremium)(global),
    limitChannels: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__.selectPremiumLimit)(global, 'channels'),
    limitFolders: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__.selectPremiumLimit)(global, 'dialogFilters'),
    limitPins: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__.selectPremiumLimit)(global, 'dialogFolderPinned'),
    limitLinks: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_5__.selectPremiumLimit)(global, 'channelsPublic'),
    limits: global.appConfig?.limits,
    premiumSlug: global.appConfig?.premiumInvoiceSlug,
    premiumBotUsername: global.appConfig?.premiumBotUsername,
    premiumPromoOrder: global.appConfig?.premiumPromoOrder
  };
})(PremiumMainModal)));

/***/ }),

/***/ "./src/components/main/premium/PremiumSubscriptionOption.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/main/premium/PremiumSubscriptionOption.tsx ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_formatCurrency__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/formatCurrency */ "./src/util/formatCurrency.tsx");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./PremiumSubscriptionOption.module.scss */ "./src/components/main/premium/PremiumSubscriptionOption.module.scss");





const PremiumSubscriptionOption = ({
  option,
  checked,
  fullMonthlyAmount,
  onChange,
  className,
  isGiveaway
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const {
    months,
    amount,
    currency
  } = option;
  const users = 'users' in option ? option.users : undefined;
  const perMonth = Math.floor(amount / months);
  const isUserCountPlural = users ? users > 1 : undefined;
  const discount = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return fullMonthlyAmount && fullMonthlyAmount > perMonth ? Math.ceil(100 - perMonth / (fullMonthlyAmount / 100)) : undefined;
  }, [fullMonthlyAmount, perMonth]);
  const handleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    if (e.target.checked) {
      onChange(months);
    }
  }, [months, onChange]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("label", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(isGiveaway ? _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].giveawayWrapper : _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].wrapper, checked && !isGiveaway && _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].active, className),
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    className: _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].input,
    type: "radio",
    name: "subscription_option",
    value: months,
    checked: checked,
    onChange: handleChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].content
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].month
  }, Boolean(discount) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].giveawayDiscount, _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].discount),
    title: lang('GiftDiscount')
  }, " \u2212", discount, "%"), lang('Months', months)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].perMonth
  }, isGiveaway || isUserCountPlural ? `${(0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_2__.formatCurrency)(amount, currency, lang.code)} x ${users}` : lang('PricePerMonth', (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_2__.formatCurrency)(perMonth, currency, lang.code))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumSubscriptionOption_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].amount
  }, (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_2__.formatCurrency)(amount, currency, lang.code))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PremiumSubscriptionOption));

/***/ }),

/***/ "./src/components/main/premium/common/PremiumLimitPreview.tsx":
/*!********************************************************************!*\
  !*** ./src/components/main/premium/common/PremiumLimitPreview.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_math__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../util/math */ "./src/util/math.ts");
/* harmony import */ var _PremiumLimitsCompare__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PremiumLimitsCompare */ "./src/components/main/premium/common/PremiumLimitsCompare.tsx");
/* harmony import */ var _PremiumLimitPreview_module_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./PremiumLimitPreview.module.scss */ "./src/components/main/premium/common/PremiumLimitPreview.module.scss");




const COLOR_START = [91, 160, 255];
const COLOR_END = [197, 100, 243];
const PremiumLimitPreview = ({
  title,
  description,
  leftValue,
  rightValue,
  colorStepProgress
}) => {
  const color = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return COLOR_START.map((start, i) => (0,_util_math__WEBPACK_IMPORTED_MODULE_1__.lerp)(start, COLOR_END[i], colorStepProgress));
  }, [colorStepProgress]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitPreview_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].root
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitPreview_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].title
  }, title), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitPreview_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].description
  }, description), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PremiumLimitsCompare__WEBPACK_IMPORTED_MODULE_2__["default"], {
    leftValue: leftValue,
    rightValue: rightValue,
    rightStyle: `background: rgb(${color.join(',')})`
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PremiumLimitPreview));

/***/ }),

/***/ "./src/components/main/premium/common/PremiumLimitReachedModal.tsx":
/*!*************************************************************************!*\
  !*** ./src/components/main/premium/common/PremiumLimitReachedModal.tsx ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_textFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../util/textFormat */ "./src/util/textFormat.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _PremiumLimitsCompare__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./PremiumLimitsCompare */ "./src/components/main/premium/common/PremiumLimitsCompare.tsx");
/* harmony import */ var _PremiumLimitReachedModal_module_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./PremiumLimitReachedModal.module.scss */ "./src/components/main/premium/common/PremiumLimitReachedModal.module.scss");














const LIMIT_DESCRIPTION = {
  dialogFiltersChats: 'LimitReachedChatInFolders',
  uploadMaxFileparts: 'LimitReachedFileSize',
  dialogFilters: 'LimitReachedFolders',
  dialogFolderPinned: 'LimitReachedPinDialogs',
  channelsPublic: 'LimitReachedPublicLinks',
  channels: 'LimitReachedCommunities',
  chatlistInvites: 'LimitReachedFolderLinks',
  chatlistJoined: 'LimitReachedSharedFolders',
  savedDialogsPinned: 'LimitReachedPinSavedDialogs'
};
const LIMIT_DESCRIPTION_BLOCKED = {
  dialogFiltersChats: 'LimitReachedChatInFoldersLocked',
  uploadMaxFileparts: 'LimitReachedFileSizeLocked',
  dialogFilters: 'LimitReachedFoldersLocked',
  dialogFolderPinned: 'LimitReachedPinDialogsLocked',
  channelsPublic: 'LimitReachedPublicLinksLocked',
  channels: 'LimitReachedCommunitiesLocked',
  chatlistInvites: 'LimitReachedFolderLinksLocked',
  chatlistJoined: 'LimitReachedSharedFoldersLocked',
  savedDialogsPinned: 'LimitReachedPinSavedDialogsLocked'
};
const LIMIT_DESCRIPTION_PREMIUM = {
  dialogFiltersChats: 'LimitReachedChatInFoldersPremium',
  uploadMaxFileparts: 'LimitReachedFileSizePremium',
  dialogFilters: 'LimitReachedFoldersPremium',
  dialogFolderPinned: 'LimitReachedPinDialogsPremium',
  channelsPublic: 'LimitReachedPublicLinksPremium',
  channels: 'LimitReachedCommunitiesPremium',
  chatlistInvites: 'LimitReachedFolderLinksPremium',
  chatlistJoined: 'LimitReachedSharedFoldersPremium',
  savedDialogsPinned: 'LimitReachedPinSavedDialogsPremium'
};
const LIMIT_ICON = {
  dialogFiltersChats: 'chat-badge',
  uploadMaxFileparts: 'file-badge',
  dialogFilters: 'folder-badge',
  dialogFolderPinned: 'pin-badge',
  channelsPublic: 'link-badge',
  channels: 'chats-badge',
  chatlistInvites: 'link-badge',
  chatlistJoined: 'folder-badge',
  savedDialogsPinned: 'pin-badge'
};
const LIMIT_VALUE_FORMATTER = {
  uploadMaxFileparts: (lang, value) => {
    // The real size is not exactly 4gb, so we need to round it
    if (value === 8000) return lang('FileSize.GB', '4');
    if (value === 4000) return lang('FileSize.GB', '2');
    return (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_5__.formatFileSize)(lang, value * _config__WEBPACK_IMPORTED_MODULE_2__.MAX_UPLOAD_FILEPART_SIZE);
  }
};
function getLimiterDescription({
  lang,
  limitType,
  isPremium,
  canBuyPremium,
  defaultValue,
  premiumValue,
  valueFormatter
}) {
  if (!limitType) {
    return undefined;
  }
  const defaultValueFormatted = valueFormatter ? valueFormatter(lang, defaultValue) : defaultValue;
  const premiumValueFormatted = valueFormatter ? valueFormatter(lang, premiumValue) : premiumValue;
  if (isPremium) {
    return lang(LIMIT_DESCRIPTION_PREMIUM[limitType], premiumValueFormatted);
  }
  return canBuyPremium ? lang(LIMIT_DESCRIPTION[limitType], limitType === 'channelsPublic' ? premiumValueFormatted : [defaultValueFormatted, premiumValueFormatted]) : lang(LIMIT_DESCRIPTION_BLOCKED[limitType], defaultValueFormatted);
}
const PremiumLimitReachedModal = ({
  defaultValue,
  premiumValue,
  limit,
  isPremium,
  canBuyPremium
}) => {
  const {
    closeLimitReachedModal,
    openPremiumModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [isClosing, startClosing, stopClosing] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const handleClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    openPremiumModal();
    startClosing();
  }, [openPremiumModal, startClosing]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!limit && isClosing) stopClosing();
  }, [isClosing, limit, stopClosing]);
  const title = lang('LimitReached');
  const valueFormatter = limit && LIMIT_VALUE_FORMATTER[limit];
  const description = getLimiterDescription({
    lang,
    limitType: limit,
    isPremium,
    canBuyPremium,
    defaultValue,
    premiumValue,
    valueFormatter
  });
  const icon = limit && LIMIT_ICON[limit];
  const canUpgrade = canBuyPremium && !isPremium;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_11__["default"], {
    onClose: startClosing,
    onCloseAnimationEnd: closeLimitReachedModal,
    isOpen: Boolean(limit) && !isClosing,
    title: title,
    className: _PremiumLimitReachedModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].root
  }, !canUpgrade && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitReachedModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].limitBadge
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("i", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_PremiumLimitReachedModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].limitIcon, icon, 'icon')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitReachedModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].limitValue
  }, valueFormatter?.(lang, isPremium ? premiumValue : defaultValue) || (isPremium ? premiumValue : defaultValue))), canUpgrade && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PremiumLimitsCompare__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: _PremiumLimitReachedModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].limitCompare,
    leftValue: valueFormatter?.(lang, defaultValue) || defaultValue?.toString(),
    rightValue: valueFormatter?.(lang, premiumValue) || premiumValue?.toString(),
    floatingBadgeIcon: icon
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(description || '', ['simple_markdown', 'br'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitReachedModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].dialogButtons
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: startClosing,
    color: "primary"
  }, lang(canUpgrade ? 'Cancel' : 'OK')), canUpgrade && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleClick,
    color: "primary"
  }, lang('IncreaseLimit'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    name: "double-badge",
    className: _PremiumLimitReachedModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].x2
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  limit
}) => {
  const {
    limits
  } = global.appConfig || {};
  const isPremium = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global);
  return {
    defaultValue: limit ? limits?.[limit][0] : undefined,
    premiumValue: limit ? limits?.[limit][1] : undefined,
    canBuyPremium: !(0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsPremiumPurchaseBlocked)(global),
    isPremium
  };
})(PremiumLimitReachedModal)));

/***/ }),

/***/ "./src/components/main/premium/common/PremiumLimitsCompare.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/main/premium/common/PremiumLimitsCompare.tsx ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./PremiumLimitsCompare.module.scss */ "./src/components/main/premium/common/PremiumLimitsCompare.module.scss");





const PremiumLimitsCompare = ({
  leftValue,
  rightValue,
  className,
  floatingBadgeIcon,
  rightStyle
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].root, className)
  }, floatingBadgeIcon && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].floatingBadge
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_3__["default"], {
    name: floatingBadgeIcon,
    className: _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].floatingBadgeIcon
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].floatingBadgeValue,
    dir: lang.isRtl ? 'rtl' : undefined
  }, leftValue), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].floatingBadgeTriangle
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("svg", {
    width: "26",
    height: "9",
    viewBox: "0 0 26 9",
    fill: "none"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("path", {
    d: "M0 0H26H24.4853C22.894 0 21.3679 0.632141 20.2426 1.75736L14.4142 7.58579C13.6332 8.36684 12.3668 8.36683 11.5858 7.58579L5.75736 1.75736C4.63214 0.632139 3.10602 0 1.51472 0H0Z",
    fill: "#7E85FF"
  })))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].line, _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].left)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].leftText,
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('LimitFree')), !floatingBadgeIcon && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].leftValue
  }, leftValue)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].line, _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].right),
    style: rightStyle
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].rightText,
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang('LimitPremium')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumLimitsCompare_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].rightValue
  }, rightValue)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PremiumLimitsCompare));

/***/ }),

/***/ "./src/components/main/premium/previews/PremiumFeaturePreviewStickers.tsx":
/*!********************************************************************************!*\
  !*** ./src/components/main/premium/previews/PremiumFeaturePreviewStickers.tsx ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_cycleRestrict__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../util/cycleRestrict */ "./src/util/cycleRestrict.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _common_AnimatedSticker__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../common/AnimatedSticker */ "./src/components/common/AnimatedSticker.tsx");
/* harmony import */ var _PremiumFeaturePreviewStickers_module_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./PremiumFeaturePreviewStickers.module.scss */ "./src/components/main/premium/previews/PremiumFeaturePreviewStickers.module.scss");








const EMOJI_SIZE_MULTIPLIER = 0.6;
const EFFECT_SIZE_MULTIPLIER = 0.8;
const MAX_EMOJIS = 15;
const ENDED_DELAY = 150;
const AnimatedCircleSticker = ({
  size,
  realIndex,
  canPlay,
  sticker,
  index,
  maxLength,
  onClick,
  onEnded
}) => {
  const mediaData = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_5__["default"])(`sticker${sticker.id}`);
  const mediaDataAround = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_5__["default"])(`sticker${sticker.id}?size=f`);
  const isActivated = index === 0;
  const [isAnimated, animate, inanimate] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_3__["default"])(isActivated);
  const circleSize = size - size * EMOJI_SIZE_MULTIPLIER;
  const width = circleSize * 3;
  const height = circleSize * 3.2;
  const a = index / maxLength;
  const angle = a * (Math.PI * 2);
  const scale = isActivated ? 1 : 0.66;
  const x = Math.cos(angle) * width - circleSize * 2.8;
  const y = Math.sin(angle) * height;
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    onClick(realIndex);
  });
  const handleEnded = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    inanimate();
    onEnded(realIndex);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isActivated) {
      animate();
    }
  }, [isActivated, animate]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, isActivated && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedSticker__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: _PremiumFeaturePreviewStickers_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].effectSticker,
    tgsUrl: mediaDataAround,
    play: canPlay,
    isLowPriority: true,
    noLoop: true,
    size: EFFECT_SIZE_MULTIPLIER * size,
    style: `--x: calc(${x}px - 10%); --y: ${y}px;`
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedSticker__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: _PremiumFeaturePreviewStickers_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].sticker,
    tgsUrl: mediaData,
    play: canPlay && isAnimated,
    noLoop: true,
    size: EMOJI_SIZE_MULTIPLIER * size,
    style: `--x: ${x}px; --y: ${y}px; --opacity: ${scale}`,
    onClick: handleClick,
    onEnded: handleEnded
  }));
};
const PremiumFeaturePreviewStickers = ({
  stickers,
  isActive
}) => {
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [offset, setOffset] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  const [size, setSize] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  const renderedStickers = stickers?.slice(0, MAX_EMOJIS);
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(i => {
    setOffset(-i);
  });
  const handleEnded = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(i => {
    const displayIndex = (0,_util_cycleRestrict__WEBPACK_IMPORTED_MODULE_2__["default"])(renderedStickers.length, i + offset);
    if (displayIndex !== 0) return;
    setTimeout(() => {
      setOffset(current => {
        return (0,_util_cycleRestrict__WEBPACK_IMPORTED_MODULE_2__["default"])(renderedStickers.length, current + 1);
      });
    }, ENDED_DELAY);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const container = containerRef.current;
    if (!container) return;
    setSize(container.closest('.modal-dialog').clientWidth);
  }, []);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeaturePreviewStickers_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].root,
    ref: containerRef
  }, Boolean(size) && renderedStickers?.map((sticker, i) => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(AnimatedCircleSticker, {
      size: size,
      sticker: sticker,
      realIndex: i,
      index: (i + offset + renderedStickers.length) % renderedStickers.length,
      maxLength: renderedStickers.length,
      onClick: handleClick,
      onEnded: handleEnded,
      canPlay: isActive
    });
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    stickers: global.stickers.premium.stickers
  };
})(PremiumFeaturePreviewStickers)));

/***/ }),

/***/ "./src/components/main/premium/previews/PremiumFeaturePreviewStories.tsx":
/*!*******************************************************************************!*\
  !*** ./src/components/main/premium/previews/PremiumFeaturePreviewStories.tsx ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../hooks/useScrolledState */ "./src/hooks/useScrolledState.ts");
/* harmony import */ var _hooks_window_useDevicePixelRatio__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../hooks/window/useDevicePixelRatio */ "./src/hooks/window/useDevicePixelRatio.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_AvatarStoryCircle__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../common/AvatarStoryCircle */ "./src/components/common/AvatarStoryCircle.tsx");
/* harmony import */ var _PremiumFeatureItem__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../PremiumFeatureItem */ "./src/components/main/premium/PremiumFeatureItem.tsx");
/* harmony import */ var _PremiumFeaturePreviewStories_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./PremiumFeaturePreviewStories.module.scss */ "./src/components/main/premium/previews/PremiumFeaturePreviewStories.module.scss");












const STORY_FEATURE_TITLES = {
  stories_order: 'PremiumStoriesPriority',
  stories_stealth: 'PremiumStoriesStealth',
  stories_views: 'PremiumStoriesViews',
  stories_timer: 'lng_premium_stories_subtitle_expiration',
  stories_save: 'PremiumStoriesSaveToGallery',
  stories_caption: 'lng_premium_stories_subtitle_caption',
  stories_link: 'lng_premium_stories_subtitle_links'
};
const STORY_FEATURE_DESCRIPTIONS = {
  stories_order: 'PremiumStoriesPriorityDescription',
  stories_stealth: 'PremiumStoriesStealthDescription',
  stories_views: 'PremiumStoriesViewsDescription',
  stories_timer: 'PremiumStoriesExpirationDescription',
  stories_save: 'PremiumStoriesSaveToGalleryDescription',
  stories_caption: 'PremiumStoriesCaptionDescription',
  stories_link: 'PremiumStoriesFormattingDescription'
};
const STORY_FEATURE_ICONS = {
  stories_order: 'story-priority',
  stories_stealth: 'eye-closed-outline',
  stories_views: 'eye-outline',
  stories_timer: 'timer',
  stories_save: 'arrow-down-circle',
  stories_caption: 'story-caption',
  stories_link: 'link-badge'
};
const STORY_FEATURE_ORDER = Object.keys(STORY_FEATURE_TITLES);
const CIRCLE_SIZE = _common_Avatar__WEBPACK_IMPORTED_MODULE_8__.AVATAR_SIZES.giant + 0.25 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.REM;
const CIRCLE_SEGMENTS = 8;
const CIRCLE_READ_SEGMENTS = 0;
const PremiumFeaturePreviewVideo = ({
  currentUser
}) => {
  // eslint-disable-next-line no-null/no-null
  const circleRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const dpr = (0,_hooks_window_useDevicePixelRatio__WEBPACK_IMPORTED_MODULE_7__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    if (!circleRef.current) {
      return;
    }
    (0,_common_AvatarStoryCircle__WEBPACK_IMPORTED_MODULE_9__.drawGradientCircle)({
      canvas: circleRef.current,
      size: CIRCLE_SIZE * dpr,
      segmentsCount: CIRCLE_SEGMENTS,
      color: 'purple',
      readSegmentsCount: CIRCLE_READ_SEGMENTS,
      readSegmentColor: 'transparent',
      dpr
    });
  }, [dpr]);
  const {
    handleScroll,
    isAtBeginning
  } = (0,_hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const maxSize = CIRCLE_SIZE;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeaturePreviewStories_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].root
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeaturePreviewStories_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].header
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_8__["default"], {
    forPremiumPromo: true,
    peer: currentUser,
    size: "giant"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    className: _PremiumFeaturePreviewStories_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].circle,
    ref: circleRef,
    style: `max-width: ${maxSize}px; max-height: ${maxSize}px`
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeaturePreviewStories_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].title
  }, lang('UpgradedStories')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_PremiumFeaturePreviewStories_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].features, !isAtBeginning && _PremiumFeaturePreviewStories_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].scrolled, 'custom-scroll'),
    onScroll: handleScroll
  }, STORY_FEATURE_ORDER.map((section, index) => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PremiumFeatureItem__WEBPACK_IMPORTED_MODULE_10__["default"], {
      key: section,
      title: lang(STORY_FEATURE_TITLES[section]),
      text: lang(STORY_FEATURE_DESCRIPTIONS[section]),
      icon: STORY_FEATURE_ICONS[section],
      isFontIcon: true,
      index: index,
      count: STORY_FEATURE_ORDER.length,
      section: section
    });
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeaturePreviewStories_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].mobile
  }, lang('lng_premium_stories_about_mobile'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    currentUser: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectUser)(global, global.currentUserId)
  };
})(PremiumFeaturePreviewVideo)));

/***/ }),

/***/ "./src/components/main/premium/previews/PremiumFeaturePreviewVideo.tsx":
/*!*****************************************************************************!*\
  !*** ./src/components/main/premium/previews/PremiumFeaturePreviewVideo.tsx ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useCanvasBlur__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../hooks/useCanvasBlur */ "./src/hooks/useCanvasBlur.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useMediaTransitionDeprecated */ "./src/hooks/useMediaTransitionDeprecated.ts");
/* harmony import */ var _ui_OptimizedVideo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../ui/OptimizedVideo */ "./src/components/ui/OptimizedVideo.tsx");
/* harmony import */ var _PremiumFeaturePreviewVideo_module_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./PremiumFeaturePreviewVideo.module.scss */ "./src/components/main/premium/previews/PremiumFeaturePreviewVideo.module.scss");
/* harmony import */ var _assets_premium_DeviceFrame_svg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../assets/premium/DeviceFrame.svg */ "./src/assets/premium/DeviceFrame.svg");








const PremiumFeaturePreviewVideo = ({
  videoId,
  isReverseAnimation,
  isDown,
  videoThumbnail,
  index,
  isActive
}) => {
  const mediaData = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_3__["default"])(`document${videoId}`);
  const thumbnailRef = (0,_hooks_useCanvasBlur__WEBPACK_IMPORTED_MODULE_2__["default"])(videoThumbnail.dataUri);
  const transitionClassNames = (0,_hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_4__["default"])(mediaData);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _PremiumFeaturePreviewVideo_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].root
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_PremiumFeaturePreviewVideo_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].wrapper, isReverseAnimation && _PremiumFeaturePreviewVideo_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].reverse, isDown && _PremiumFeaturePreviewVideo_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].down),
    id: `premium_feature_preview_video_${index}`
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: _assets_premium_DeviceFrame_svg__WEBPACK_IMPORTED_MODULE_7__,
    alt: "",
    className: _PremiumFeaturePreviewVideo_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].frame,
    draggable: false
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: thumbnailRef,
    className: _PremiumFeaturePreviewVideo_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].video
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_OptimizedVideo__WEBPACK_IMPORTED_MODULE_5__["default"], {
    canPlay: isActive,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_PremiumFeaturePreviewVideo_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].video, transitionClassNames),
    src: mediaData,
    disablePictureInPicture: true,
    playsInline: true,
    muted: true,
    loop: true
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PremiumFeaturePreviewVideo));

/***/ }),

/***/ "./src/components/mediaViewer/MediaViewer.tsx":
/*!****************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewer.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_audioPlayer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../util/audioPlayer */ "./src/util/audioPlayer.ts");
/* harmony import */ var _util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../util/captureEscKeyListener */ "./src/util/captureEscKeyListener.ts");
/* harmony import */ var _util_directInputManager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../util/directInputManager */ "./src/util/directInputManager.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common/helpers/renderMessageText */ "./src/components/common/helpers/renderMessageText.ts");
/* harmony import */ var _helpers_getViewableMedia__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./helpers/getViewableMedia */ "./src/components/mediaViewer/helpers/getViewableMedia.ts");
/* harmony import */ var _helpers_ghostAnimation__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./helpers/ghostAnimation */ "./src/components/mediaViewer/helpers/ghostAnimation.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useElectronDrag__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../hooks/useElectronDrag */ "./src/hooks/useElectronDrag.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../hooks/useForceUpdate */ "./src/hooks/useForceUpdate.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePictureInPicture__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../hooks/usePictureInPicture */ "./src/hooks/usePictureInPicture.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_usePriorityPlaybackCheck__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../hooks/usePriorityPlaybackCheck */ "./src/hooks/usePriorityPlaybackCheck.ts");
/* harmony import */ var _hooks_useMediaProps__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./hooks/useMediaProps */ "./src/components/mediaViewer/hooks/useMediaProps.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_ReportAvatarModal__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../common/ReportAvatarModal */ "./src/components/common/ReportAvatarModal.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ShowTransition__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../ui/ShowTransition */ "./src/components/ui/ShowTransition.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _MediaViewerActions__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./MediaViewerActions */ "./src/components/mediaViewer/MediaViewerActions.tsx");
/* harmony import */ var _MediaViewerSlides__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./MediaViewerSlides */ "./src/components/mediaViewer/MediaViewerSlides.tsx");
/* harmony import */ var _SenderInfo__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./SenderInfo */ "./src/components/mediaViewer/SenderInfo.tsx");
/* harmony import */ var _MediaViewer_scss__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./MediaViewer.scss */ "./src/components/mediaViewer/MediaViewer.scss");

































const ANIMATION_DURATION = 250;
const AVATAR_LOAD_TRIGGER = 4;
const MediaViewer = ({
  chatId,
  threadId,
  messageId,
  message,
  collectedMessageIds,
  isChatWithSelf,
  canUpdateMedia,
  origin,
  avatar,
  avatarOwner,
  profilePhotos,
  chatMessages,
  sponsoredMessage,
  standaloneMedia,
  mediaIndex,
  withAnimation,
  isHidden,
  shouldSkipHistoryAnimations,
  withDynamicLoading,
  isLoadingMoreMedia,
  isSynced
}) => {
  const {
    openMediaViewer,
    closeMediaViewer,
    openForwardMenu,
    focusMessage,
    toggleChatInfo,
    searchChatMediaMessages,
    loadMoreProfilePhotos,
    clickSponsoredMessage,
    openUrl
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const isOpen = Boolean(avatarOwner || message || standaloneMedia || sponsoredMessage);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_14__["default"])();

  /* Animation */
  const animationKey = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const senderId = message?.senderId || avatarOwner?.id || message?.chatId;
  const prevSenderId = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_21__["default"])(senderId);
  const headerAnimation = withAnimation ? 'slideFade' : 'none';
  const isGhostAnimation = Boolean(withAnimation && !shouldSkipHistoryAnimations);

  /* Controls */
  const [isReportAvatarModalOpen, openReportAvatarModal, closeReportAvatarModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_16__["default"])();
  const currentItem = (0,_helpers_getViewableMedia__WEBPACK_IMPORTED_MODULE_12__.getMediaViewerItem)({
    message,
    avatarOwner,
    standaloneMedia,
    profilePhotos,
    mediaIndex,
    sponsoredMessage
  });
  const {
    media,
    isSingle
  } = (0,_helpers_getViewableMedia__WEBPACK_IMPORTED_MODULE_12__["default"])(currentItem) || {};
  const {
    isVideo,
    isPhoto,
    bestImageData,
    bestData,
    dimensions,
    isGif,
    isFromSharedMedia
  } = (0,_hooks_useMediaProps__WEBPACK_IMPORTED_MODULE_23__.useMediaProps)({
    media,
    isAvatar: Boolean(avatarOwner),
    origin,
    delay: isGhostAnimation && ANIMATION_DURATION
  });
  const canReportAvatar = (() => {
    if (isChatWithSelf) return false;
    if (currentItem?.type !== 'avatar' || !avatarOwner) return false;
    const info = currentItem.profilePhotos;
    if (media === info.personalPhoto) return false;
    return true;
  })();
  const isVisible = !isHidden && isOpen;
  const messageMediaIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return withDynamicLoading ? collectedMessageIds : (0,_global_helpers__WEBPACK_IMPORTED_MODULE_5__.getChatMediaMessageIds)(chatMessages || {}, collectedMessageIds || [], isFromSharedMedia);
  }, [chatMessages, collectedMessageIds, isFromSharedMedia, withDynamicLoading]);
  if (isOpen && (!prevSenderId || prevSenderId !== senderId || animationKey.current === undefined)) {
    animationKey.current = isSingle ? 0 : messageId || mediaIndex;
  }
  const [getIsPictureInPicture] = (0,_hooks_usePictureInPicture__WEBPACK_IMPORTED_MODULE_20__.usePictureInPictureSignal)();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen || getIsPictureInPicture()) {
      return undefined;
    }
    (0,_util_directInputManager__WEBPACK_IMPORTED_MODULE_9__.disableDirectTextInput)();
    const stopPriorityPlayback = (0,_hooks_usePriorityPlaybackCheck__WEBPACK_IMPORTED_MODULE_22__.dispatchPriorityPlaybackEvent)();
    return () => {
      stopPriorityPlayback();
      (0,_util_directInputManager__WEBPACK_IMPORTED_MODULE_9__.enableDirectTextInput)();
    };
  }, [isOpen, getIsPictureInPicture]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isVisible) {
      (0,_hooks_usePictureInPicture__WEBPACK_IMPORTED_MODULE_20__.exitPictureInPictureIfNeeded)();
    }
  }, [isVisible]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isMobile) {
      (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_4__.requestMutation)(() => {
        document.body.classList.toggle('is-media-viewer-open', isOpen);
      });
    }
  }, [isMobile, isOpen]);

  // eslint-disable-next-line no-null/no-null
  const headerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_hooks_useElectronDrag__WEBPACK_IMPORTED_MODULE_15__["default"])(headerRef);
  const forceUpdate = (0,_hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_17__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const mql = window.matchMedia(_common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__.MEDIA_VIEWER_MEDIA_QUERY);
    mql.addEventListener('change', forceUpdate);
    return () => {
      mql.removeEventListener('change', forceUpdate);
    };
  }, [forceUpdate]);
  const prevMessage = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_21__["default"])(message);
  const prevIsHidden = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_21__["default"])(isHidden);
  const prevOrigin = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_21__["default"])(origin);
  const prevItem = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_21__["default"])(currentItem);
  const prevBestImageData = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_21__["default"])(bestImageData);
  const textParts = message ? (0,_common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_11__.renderMessageText)({
    message,
    forcePlayback: true,
    isForMediaViewer: true
  }) : undefined;
  const hasFooter = Boolean(textParts);
  const shouldAnimateOpening = prevIsHidden && prevItem !== currentItem;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isGhostAnimation && isOpen && (shouldAnimateOpening || !prevItem)) {
      (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.beginHeavyAnimation)(ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_3__.ANIMATION_END_DELAY);
      (0,_helpers_ghostAnimation__WEBPACK_IMPORTED_MODULE_13__.animateOpening)(hasFooter, origin, bestImageData, dimensions, isVideo, message, mediaIndex);
    }
    if (isGhostAnimation && !isOpen && prevItem) {
      (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.beginHeavyAnimation)(ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_3__.ANIMATION_END_DELAY);
      (0,_helpers_ghostAnimation__WEBPACK_IMPORTED_MODULE_13__.animateClosing)(prevOrigin, prevBestImageData, prevMessage, prevItem?.mediaIndex);
    }
  }, [bestImageData, dimensions, hasFooter, isGhostAnimation, isOpen, isVideo, message, origin, prevBestImageData, prevItem, prevMessage, prevOrigin, shouldAnimateOpening, mediaIndex]);
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_18__["default"])(() => closeMediaViewer());
  const handleFooterClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_18__["default"])(() => {
    handleClose();
    if (!chatId || !messageId) return;
    if (isMobile) {
      setTimeout(() => {
        toggleChatInfo({
          force: false
        }, {
          forceSyncOnIOs: true
        });
        focusMessage({
          chatId,
          threadId,
          messageId
        });
      }, ANIMATION_DURATION);
    } else {
      focusMessage({
        chatId,
        threadId,
        messageId
      });
    }
  });
  const handleSponsoredClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_18__["default"])(isFromMedia => {
    if (!sponsoredMessage || !chatId) return;
    clickSponsoredMessage({
      isMedia: isFromMedia,
      isFullscreen: true,
      peerId: chatId
    });
    openUrl({
      url: sponsoredMessage.url
    });
    closeMediaViewer();
  });
  const handleForward = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_18__["default"])(() => {
    openForwardMenu({
      fromChatId: chatId,
      messageIds: [messageId]
    });
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => isOpen ? (0,_util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    handleClose();
  }) : undefined, [handleClose, isOpen]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isVideo && !isGif) {
      (0,_util_audioPlayer__WEBPACK_IMPORTED_MODULE_7__.stopCurrentAudio)();
    }
  }, [isGif, isVideo]);
  const loadMoreItemsIfNeeded = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_18__["default"])(item => {
    if (!item || isLoadingMoreMedia) return;
    if (item.type === 'avatar') {
      const isNearEnd = item.mediaIndex >= item.profilePhotos.photos.length - AVATAR_LOAD_TRIGGER;
      if (!isNearEnd) return;
      loadMoreProfilePhotos({
        peerId: item.avatarOwner.id
      });
    }
    if (item.type === 'message' && withDynamicLoading) {
      searchChatMediaMessages({
        chatId,
        threadId,
        currentMediaMessageId: item.message.id
      });
    }
  });
  const getNextItem = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_18__["default"])((from, direction) => {
    if (direction === 0 || isSingle) return undefined;
    if (from.type === 'standalone') {
      const {
        media: fromMedia,
        mediaIndex: fromMediaIndex
      } = from;
      const nextIndex = fromMediaIndex + direction;
      if (nextIndex >= 0 && nextIndex < fromMedia.length) {
        return {
          type: 'standalone',
          media: fromMedia,
          mediaIndex: nextIndex
        };
      }
      return undefined;
    }
    if (from.type === 'avatar') {
      const {
        avatarOwner: fromAvatarOwner,
        profilePhotos: fromProfilePhotos,
        mediaIndex: fromMediaIndex
      } = from;
      const nextIndex = fromMediaIndex + direction;
      if (nextIndex >= 0 && fromProfilePhotos && nextIndex < fromProfilePhotos.photos.length) {
        return {
          type: 'avatar',
          avatarOwner: fromAvatarOwner,
          profilePhotos: fromProfilePhotos,
          mediaIndex: nextIndex
        };
      }
      return undefined;
    }
    if (from.type === 'sponsoredMessage') {
      const {
        message: fromSponsoredMessage,
        mediaIndex: fromSponsoredMessageIndex
      } = from;
      const nextIndex = fromSponsoredMessageIndex + direction;
      if (nextIndex >= 0 && fromSponsoredMessage) {
        return {
          type: 'sponsoredMessage',
          message: fromSponsoredMessage,
          mediaIndex: nextIndex
        };
      }
      return undefined;
    }
    const {
      message: fromMessage,
      mediaIndex: fromMediaIndex
    } = from;
    const paidMedia = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_5__.getMessagePaidMedia)(fromMessage);
    if (paidMedia) {
      const nextIndex = fromMediaIndex + direction;
      if (nextIndex >= 0 && nextIndex < paidMedia.extendedMedia.length) {
        return {
          type: 'message',
          message: fromMessage,
          mediaIndex: nextIndex
        };
      }
    }
    const index = messageMediaIds?.indexOf(fromMessage.id);
    if (index === undefined) return undefined;
    const nextIndex = index + direction;
    const nextMessageId = messageMediaIds[nextIndex];
    const nextMessage = chatMessages?.[nextMessageId];
    if (nextMessage) {
      return {
        type: 'message',
        message: nextMessage
      };
    }
    return undefined;
  });
  const openMediaViewerItem = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_18__["default"])(item => {
    if (!item) {
      handleClose();
      return;
    }
    const itemChatId = item.type === 'avatar' ? item.avatarOwner.id : item.type === 'message' ? item.message.chatId : undefined;
    const itemMessageId = item.type === 'message' ? item.message.id : undefined;
    const itemStandaloneMedia = item.type === 'standalone' ? item.media : undefined;
    openMediaViewer({
      origin: origin,
      chatId: itemChatId,
      messageId: itemMessageId,
      standaloneMedia: itemStandaloneMedia,
      mediaIndex: item.mediaIndex,
      isAvatarView: item.type === 'avatar',
      withDynamicLoading
    }, {
      forceOnHeavyAnimation: true
    });
  });
  const handleBeforeDelete = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_18__["default"])(() => {
    const mediaCount = profilePhotos?.photos.length || standaloneMedia?.length || messageMediaIds?.length || 0;
    if (mediaCount <= 1 || !currentItem) {
      handleClose();
      return;
    }
    // Before deleting, select previous media
    const prevMedia = getNextItem(currentItem, -1);
    if (prevMedia) {
      openMediaViewerItem(prevMedia);
      return;
    }
    if (currentItem.type === 'avatar' && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_5__.isUserId)(currentItem.avatarOwner.id) || currentItem.type === 'standalone') {
      // Keep current item, it'll update when indexes shift
      return;
    }
    handleClose();
  });
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_19__["default"])();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ShowTransition__WEBPACK_IMPORTED_MODULE_27__["default"], {
    id: "MediaViewer",
    isOpen: isOpen,
    isHidden: isHidden,
    shouldAnimateFirstRender: true,
    noCloseTransition: shouldSkipHistoryAnimations
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "media-viewer-head",
    dir: lang.isRtl ? 'rtl' : undefined,
    ref: headerRef
  }, isMobile && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_26__["default"], {
    className: "media-viewer-close",
    round: true,
    size: "smaller",
    color: "translucent-white",
    ariaLabel: lang('Close'),
    onClick: handleClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_24__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_28__["default"], {
    activeKey: animationKey.current,
    name: headerAnimation
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SenderInfo__WEBPACK_IMPORTED_MODULE_31__["default"], {
    key: media?.id,
    item: currentItem
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MediaViewerActions__WEBPACK_IMPORTED_MODULE_29__["default"], {
    mediaData: bestData,
    isVideo: isVideo,
    item: currentItem,
    canUpdateMedia: canUpdateMedia,
    canReportAvatar: canReportAvatar,
    onBeforeDelete: handleBeforeDelete,
    onReportAvatar: openReportAvatarModal,
    onCloseMediaViewer: handleClose,
    onForward: handleForward
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_ReportAvatarModal__WEBPACK_IMPORTED_MODULE_25__["default"], {
    isOpen: isReportAvatarModalOpen,
    onClose: closeReportAvatarModal,
    photo: avatar,
    peerId: avatarOwner?.id
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MediaViewerSlides__WEBPACK_IMPORTED_MODULE_30__["default"], {
    item: currentItem,
    loadMoreItemsIfNeeded: loadMoreItemsIfNeeded,
    isLoadingMoreMedia: isLoadingMoreMedia,
    isSynced: isSynced,
    getNextItem: getNextItem,
    chatId: chatId,
    isPhoto: isPhoto,
    isGif: isGif,
    threadId: threadId,
    avatarOwnerId: avatarOwner?.id,
    origin: origin,
    isOpen: isOpen,
    hasFooter: hasFooter,
    isVideo: isVideo,
    withAnimation: withAnimation,
    onClose: handleClose,
    selectItem: openMediaViewerItem,
    isHidden: isHidden,
    onFooterClick: handleFooterClick,
    handleSponsoredClick: handleSponsoredClick
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    mediaViewer,
    shouldSkipHistoryAnimations
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectTabState)(global);
  const {
    chatId,
    threadId,
    messageId,
    origin,
    isHidden,
    withDynamicLoading,
    standaloneMedia,
    mediaIndex,
    isAvatarView,
    isSponsoredMessage
  } = mediaViewer;
  const withAnimation = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectPerformanceSettingsValue)(global, 'mediaViewerAnimations');
  const {
    currentUserId,
    isSynced
  } = global;
  const isChatWithSelf = Boolean(chatId) && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectIsChatWithSelf)(global, chatId);
  if (isAvatarView) {
    const peer = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectPeer)(global, chatId);
    let canUpdateMedia = false;
    if (peer) {
      canUpdateMedia = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_5__.isUserId)(peer.id) ? peer.id === currentUserId : (0,_global_helpers__WEBPACK_IMPORTED_MODULE_5__.isChatAdmin)(peer);
    }
    const profilePhotos = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectPeerPhotos)(global, chatId);
    return {
      profilePhotos,
      avatar: profilePhotos?.photos[mediaIndex],
      avatarOwner: peer,
      isLoadingMoreMedia: profilePhotos?.isLoading,
      isChatWithSelf,
      canUpdateMedia,
      withAnimation,
      origin,
      shouldSkipHistoryAnimations,
      isHidden,
      standaloneMedia,
      mediaIndex,
      isSynced
    };
  }
  let message;
  if (chatId && messageId) {
    if (origin && [_types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.ScheduledAlbum, _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.ScheduledInline].includes(origin)) {
      message = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectScheduledMessage)(global, chatId, messageId);
    } else {
      message = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectChatMessage)(global, chatId, messageId);
    }
  }
  let sponsoredMessage;
  if (isSponsoredMessage && chatId) {
    if (origin === _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.SponsoredMessage) {
      sponsoredMessage = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectSponsoredMessage)(global, chatId);
    }
  }
  let chatMessages;
  if (chatId) {
    if (origin && [_types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.ScheduledAlbum, _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.ScheduledInline].includes(origin)) {
      chatMessages = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectChatScheduledMessages)(global, chatId);
    } else {
      chatMessages = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectChatMessages)(global, chatId);
    }
  }
  let isLoadingMoreMedia = false;
  const isOriginInline = origin === _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.Inline;
  const isOriginAlbum = origin === _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.Album;
  let collectedMessageIds;
  if (chatId && threadId && messageId) {
    if (withDynamicLoading && (isOriginInline || isOriginAlbum)) {
      const currentSearch = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectCurrentChatMediaSearch)(global);
      isLoadingMoreMedia = Boolean(currentSearch?.isLoading);
      const {
        foundIds
      } = currentSearch?.currentSegment || {};
      collectedMessageIds = foundIds;
    } else if (origin === _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.SharedMedia) {
      const currentSearch = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectCurrentSharedMediaSearch)(global);
      const {
        foundIds
      } = currentSearch && currentSearch.resultsByType && currentSearch.resultsByType.media || {};
      collectedMessageIds = foundIds;
    } else if (isOriginInline || isOriginAlbum) {
      const outlyingList = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectOutlyingListByMessageId)(global, chatId, threadId, messageId);
      collectedMessageIds = outlyingList || (0,_global_selectors__WEBPACK_IMPORTED_MODULE_6__.selectListedIds)(global, chatId, threadId);
    }
  }
  return {
    chatId,
    threadId,
    messageId,
    isChatWithSelf,
    origin,
    message,
    chatMessages,
    sponsoredMessage,
    collectedMessageIds,
    withAnimation,
    isHidden,
    shouldSkipHistoryAnimations,
    withDynamicLoading,
    standaloneMedia,
    mediaIndex,
    isLoadingMoreMedia,
    isSynced
  };
})(MediaViewer)));

/***/ }),

/***/ "./src/components/mediaViewer/MediaViewerActions.tsx":
/*!***********************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewerActions.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _helpers_getViewableMedia__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./helpers/getViewableMedia */ "./src/components/mediaViewer/helpers/getViewableMedia.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMediaWithLoadProgress__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useMediaWithLoadProgress */ "./src/hooks/useMediaWithLoadProgress.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useZoomChangeSignal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./hooks/useZoomChangeSignal */ "./src/components/mediaViewer/hooks/useZoomChangeSignal.ts");
/* harmony import */ var _common_DeleteProfilePhotoModal__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common/DeleteProfilePhotoModal */ "./src/components/common/DeleteProfilePhotoModal.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/DropdownMenu */ "./src/components/ui/DropdownMenu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_ProgressSpinner__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/ProgressSpinner */ "./src/components/ui/ProgressSpinner.tsx");
/* harmony import */ var _MediaViewerActions_scss__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./MediaViewerActions.scss */ "./src/components/mediaViewer/MediaViewerActions.scss");


















const MediaViewerActions = ({
  item,
  mediaData,
  isVideo,
  isChatProtected,
  isProtected,
  canReportAvatar,
  canDelete,
  canUpdate,
  messageListType,
  activeDownloads,
  origin,
  onReportAvatar: onReport,
  onCloseMediaViewer,
  onBeforeDelete,
  onForward
}) => {
  const [isDeleteModalOpen, openDeleteModal, closeDeleteModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])(false);
  const [getZoomChange, setZoomChange] = (0,_hooks_useZoomChangeSignal__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const {
    downloadMedia,
    cancelMediaDownload,
    updateProfilePhoto,
    updateChatPhoto,
    openMediaViewer,
    openDeleteMessageModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const isMessage = item?.type === 'message';
  const {
    media
  } = (0,_helpers_getViewableMedia__WEBPACK_IMPORTED_MODULE_4__["default"])(item) || {};
  const fileName = media && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMediaFilename)(media);
  const isDownloading = media && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getIsDownloading)(activeDownloads, media);
  const {
    loadProgress: downloadProgress
  } = (0,_hooks_useMediaWithLoadProgress__WEBPACK_IMPORTED_MODULE_8__["default"])(media && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMediaHash)(media, 'download'), !isDownloading, media && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMediaFormat)(media, 'download'));
  const handleDownloadClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!media) return;
    if (isDownloading) {
      cancelMediaDownload({
        media
      });
    } else {
      const message = item?.type === 'message' ? item.message : undefined;
      downloadMedia({
        media,
        originMessage: message
      });
    }
  });
  const handleZoomOut = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    const zoomChange = getZoomChange();
    const change = zoomChange < 0 ? zoomChange : 0;
    setZoomChange(change - 1);
  });
  const handleZoomIn = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    const zoomChange = getZoomChange();
    const change = zoomChange > 0 ? zoomChange : 0;
    setZoomChange(change + 1);
  });
  const handleUpdate = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (item?.type !== 'avatar') return;
    const {
      avatarOwner,
      profilePhotos,
      mediaIndex
    } = item;
    const avatarPhoto = profilePhotos?.photos[mediaIndex];
    if ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(avatarOwner.id)) {
      updateProfilePhoto({
        photo: avatarPhoto
      });
    } else {
      updateChatPhoto({
        chatId: avatarOwner.id,
        photo: avatarPhoto
      });
    }
    openMediaViewer({
      origin: origin,
      chatId: avatarOwner.id,
      mediaIndex: 0,
      isAvatarView: true
    }, {
      forceOnHeavyAnimation: true
    });
  });
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const MenuButton = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return ({
      onTrigger,
      isOpen
    }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
      round: true,
      size: "smaller",
      color: "translucent",
      className: isOpen ? 'active' : undefined,
      onClick: onTrigger,
      ariaLabel: "More actions"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
      name: "more"
    }));
  }, []);
  function renderDeleteModal() {
    return item?.type === 'avatar' ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_DeleteProfilePhotoModal__WEBPACK_IMPORTED_MODULE_11__["default"], {
      isOpen: isDeleteModalOpen,
      onClose: closeDeleteModal,
      onConfirm: onBeforeDelete,
      profileId: item.avatarOwner.id,
      photo: item.profilePhotos.photos[item.mediaIndex]
    }) : undefined;
  }
  function renderDownloadButton() {
    if (isProtected || item?.type === 'standalone') {
      return undefined;
    }
    return item?.type !== 'sponsoredMessage' && (isVideo ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
      round: true,
      size: "smaller",
      color: "translucent-white",
      ariaLabel: lang('AccActionDownload'),
      onClick: handleDownloadClick
    }, isDownloading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ProgressSpinner__WEBPACK_IMPORTED_MODULE_16__["default"], {
      progress: downloadProgress,
      size: "s",
      onClick: handleDownloadClick
    }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
      name: "download"
    })) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
      href: mediaData,
      download: fileName,
      round: true,
      size: "smaller",
      color: "translucent-white",
      ariaLabel: lang('AccActionDownload')
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
      name: "download"
    })));
  }
  const openDeleteModalHandler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (item?.type === 'message') {
      openDeleteMessageModal({
        isSchedule: messageListType === 'scheduled',
        message: item.message,
        onConfirm: onBeforeDelete
      });
    } else {
      openDeleteModal();
    }
  });
  if (isMobile) {
    const menuItems = [];
    if (isMessage && item.message.isForwardingAllowed && !item.message.content.action && !isChatProtected) {
      menuItems.push({
        icon: 'forward',
        onClick: onForward,
        children: lang('Forward')
      });
    }
    if (!isProtected) {
      if (isVideo) {
        menuItems.push({
          icon: isDownloading ? 'close' : 'download',
          onClick: handleDownloadClick,
          children: isDownloading ? `${Math.round(downloadProgress * 100)}% Downloading...` : 'Download'
        });
      } else {
        menuItems.push({
          icon: 'download',
          href: mediaData,
          download: fileName,
          children: lang('AccActionDownload')
        });
      }
    }
    if (canReportAvatar) {
      menuItems.push({
        icon: 'flag',
        onClick: onReport,
        children: lang('ReportPeer.Report')
      });
    }
    if (canUpdate) {
      menuItems.push({
        icon: 'copy-media',
        onClick: handleUpdate,
        children: lang('ProfilePhoto.SetMainPhoto')
      });
    }
    if (canDelete) {
      menuItems.push({
        icon: 'delete',
        onClick: openDeleteModalHandler,
        children: lang('Delete'),
        destructive: true
      });
    }
    if (menuItems.length === 0) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "MediaViewerActions-mobile"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_14__["default"], {
      trigger: MenuButton,
      positionX: "right"
    }, menuItems.map(({
      icon,
      onClick,
      href,
      download,
      children,
      destructive
    }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
      key: icon,
      icon: icon,
      href: href,
      download: download,
      onClick: onClick,
      destructive: destructive
    }, children))), isDownloading && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ProgressSpinner__WEBPACK_IMPORTED_MODULE_16__["default"], {
      progress: downloadProgress,
      size: "s",
      noCross: true
    }), canDelete && renderDeleteModal());
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "MediaViewerActions"
  }, isMessage && item.message.isForwardingAllowed && !isChatProtected && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    round: true,
    size: "smaller",
    color: "translucent-white",
    ariaLabel: lang('Forward'),
    onClick: onForward
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "forward"
  })), renderDownloadButton(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    round: true,
    size: "smaller",
    color: "translucent-white",
    ariaLabel: lang('MediaZoomOut'),
    onClick: handleZoomOut
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "zoom-out"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    round: true,
    size: "smaller",
    color: "translucent-white",
    ariaLabel: lang('MediaZoomIn'),
    onClick: handleZoomIn
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "zoom-in"
  })), canReportAvatar && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    round: true,
    size: "smaller",
    color: "translucent-white",
    ariaLabel: lang(isVideo ? 'PeerInfo.ReportProfileVideo' : 'PeerInfo.ReportProfilePhoto'),
    onClick: onReport
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "flag"
  })), canUpdate && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    round: true,
    size: "smaller",
    color: "translucent-white",
    ariaLabel: lang('ProfilePhoto.SetMainPhoto'),
    onClick: handleUpdate
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "copy-media"
  })), canDelete && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    round: true,
    size: "smaller",
    color: "translucent-white",
    ariaLabel: lang('Delete'),
    onClick: openDeleteModalHandler
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "delete"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    round: true,
    size: "smaller",
    color: "translucent-white",
    ariaLabel: lang('Close'),
    onClick: onCloseMediaViewer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "close"
  })), canDelete && renderDeleteModal());
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  item,
  canUpdateMedia
}) => {
  const tabState = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global);
  const {
    origin
  } = tabState.mediaViewer;
  const message = item?.type === 'message' ? item.message : undefined;
  const avatarOwner = item?.type === 'avatar' ? item.avatarOwner : undefined;
  const avatarPhoto = item?.type === 'avatar' && item.profilePhotos.photos[item.mediaIndex];
  const currentMessageList = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentMessageList)(global);
  const {
    threadId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentMessageList)(global) || {};
  const isProtected = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsMessageProtected)(global, message);
  const activeDownloads = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectActiveDownloads)(global);
  const isChatProtected = message && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsChatProtected)(global, message?.chatId);
  const {
    canDelete: canDeleteMessage
  } = threadId && message && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectAllowedMessageActionsSlow)(global, message, threadId) || {};
  const isCurrentAvatar = avatarPhoto && avatarPhoto.id === avatarOwner?.avatarPhotoId;
  const canDeleteAvatar = canUpdateMedia && Boolean(avatarPhoto);
  const canDelete = canDeleteMessage || canDeleteAvatar;
  const canUpdate = canUpdateMedia && Boolean(avatarPhoto) && !isCurrentAvatar;
  const messageListType = currentMessageList?.type;
  return {
    activeDownloads,
    isProtected,
    isChatProtected,
    canDelete,
    canUpdate,
    messageListType,
    origin
  };
})(MediaViewerActions)));

/***/ }),

/***/ "./src/components/mediaViewer/MediaViewerContent.tsx":
/*!***********************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewerContent.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_stopEvent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/stopEvent */ "./src/util/stopEvent.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/helpers/renderMessageText */ "./src/components/common/helpers/renderMessageText.ts");
/* harmony import */ var _helpers_getViewableMedia__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./helpers/getViewableMedia */ "./src/components/mediaViewer/helpers/getViewableMedia.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./hooks/useControlsSignal */ "./src/components/mediaViewer/hooks/useControlsSignal.ts");
/* harmony import */ var _hooks_useMediaProps__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./hooks/useMediaProps */ "./src/components/mediaViewer/hooks/useMediaProps.ts");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _MediaViewerFooter__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./MediaViewerFooter */ "./src/components/mediaViewer/MediaViewerFooter.tsx");
/* harmony import */ var _VideoPlayer__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./VideoPlayer */ "./src/components/mediaViewer/VideoPlayer.tsx");
/* harmony import */ var _MediaViewerContent_scss__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./MediaViewerContent.scss */ "./src/components/mediaViewer/MediaViewerContent.scss");


















const ANIMATION_DURATION = 350;
const MOBILE_VERSION_CONTROL_WIDTH = 350;
const MediaViewerContent = ({
  item,
  isActive,
  textMessage,
  origin,
  withAnimation,
  isProtected,
  volume,
  playbackRate,
  isMuted,
  isHidden,
  isMoving,
  onClose,
  onFooterClick,
  handleSponsoredClick
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const isAvatar = item.type === 'avatar';
  const isSponsoredMessage = item.type === 'sponsoredMessage';
  const {
    media
  } = (0,_helpers_getViewableMedia__WEBPACK_IMPORTED_MODULE_8__["default"])(item) || {};
  const {
    isVideo,
    isPhoto,
    bestImageData,
    bestData,
    dimensions,
    isGif,
    isLocal,
    isVideoAvatar,
    mediaSize,
    loadProgress
  } = (0,_hooks_useMediaProps__WEBPACK_IMPORTED_MODULE_13__.useMediaProps)({
    media,
    isAvatar,
    origin,
    delay: withAnimation ? ANIMATION_DURATION : false
  });
  const [, toggleControls] = (0,_hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const isOpen = Boolean(media);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const toggleControlsOnMove = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    toggleControls(true);
  });
  if (!media) return undefined;
  if (item.type === 'avatar') {
    if (!isVideoAvatar) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        key: media.id,
        className: "MediaViewerContent"
      }, renderPhoto(bestData, (0,_common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_6__.calculateMediaViewerDimensions)(dimensions, false), !isMobile && !isProtected, isProtected));
    } else {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        key: media.id,
        className: "MediaViewerContent"
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_VideoPlayer__WEBPACK_IMPORTED_MODULE_16__["default"], {
        key: media.id,
        url: bestData,
        isGif: true,
        posterData: bestImageData,
        posterSize: (0,_common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_6__.calculateMediaViewerDimensions)(dimensions, false, true),
        loadProgress: loadProgress,
        fileSize: mediaSize,
        isMediaViewerOpen: isOpen && isActive,
        isProtected: isProtected,
        isPreviewDisabled: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.ARE_WEBCODECS_SUPPORTED || isLocal,
        noPlay: !isActive,
        onClose: onClose,
        isMuted: true,
        shouldCloseOnClick: true,
        volume: 0,
        isClickDisabled: isMoving,
        playbackRate: 1,
        isSponsoredMessage: isSponsoredMessage,
        handleSponsoredClick: handleSponsoredClick
      }));
    }
  }
  const textParts = textMessage && (textMessage.content.action?.type === 'suggestProfilePhoto' ? lang('Conversation.SuggestedPhotoTitle') : (0,_common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_7__.renderMessageText)({
    message: textMessage,
    forcePlayback: true,
    isForMediaViewer: true
  }));
  const buttonText = textMessage && 'buttonText' in textMessage ? textMessage.buttonText : undefined;
  const hasFooter = Boolean(textParts);
  const posterSize = (0,_common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_6__.calculateMediaViewerDimensions)(dimensions, hasFooter, isVideo);
  const isForceMobileVersion = isMobile || shouldForceMobileVersion(posterSize);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('MediaViewerContent', hasFooter && 'has-footer'),
    onMouseMove: isForceMobileVersion && !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV ? toggleControlsOnMove : undefined
  }, isPhoto && renderPhoto(bestData, posterSize, !isMobile && !isProtected, isProtected), isVideo && (!isActive ? renderVideoPreview(bestImageData, posterSize, !isMobile && !isProtected, isProtected) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_VideoPlayer__WEBPACK_IMPORTED_MODULE_16__["default"], {
    key: media.id,
    url: bestData,
    isGif: isGif,
    posterData: bestImageData,
    posterSize: posterSize,
    loadProgress: loadProgress,
    fileSize: mediaSize,
    isMediaViewerOpen: isOpen && isActive,
    noPlay: !isActive,
    isPreviewDisabled: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.ARE_WEBCODECS_SUPPORTED || isLocal,
    onClose: onClose,
    isMuted: isMuted,
    isHidden: isHidden,
    isForceMobileVersion: isForceMobileVersion,
    isProtected: isProtected,
    volume: volume,
    isClickDisabled: isMoving,
    playbackRate: playbackRate,
    isSponsoredMessage: isSponsoredMessage,
    handleSponsoredClick: handleSponsoredClick
  })), textParts && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MediaViewerFooter__WEBPACK_IMPORTED_MODULE_15__["default"], {
    text: textParts,
    buttonText: buttonText,
    onClick: onFooterClick,
    isProtected: isProtected,
    isForceMobileVersion: isForceMobileVersion,
    isForVideo: isVideo && !isGif,
    handleSponsoredClick: handleSponsoredClick
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  item
}) => {
  const {
    volume,
    isMuted,
    playbackRate,
    isHidden,
    origin
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global).mediaViewer;
  const message = item.type === 'message' ? item.message : undefined;
  const sponsoredMessage = item.type === 'sponsoredMessage' ? item.message : undefined;
  const textMessage = message || sponsoredMessage;
  return {
    origin,
    textMessage,
    isProtected: message && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectIsMessageProtected)(global, message),
    volume,
    isMuted,
    isHidden,
    playbackRate
  };
})(MediaViewerContent)));
function renderPhoto(blobUrl, imageSize, canDrag, isProtected) {
  return blobUrl ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    style: "position: relative;"
  }, isProtected && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    onContextMenu: _util_stopEvent__WEBPACK_IMPORTED_MODULE_4__["default"],
    className: "protector"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: blobUrl,
    alt: "",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(isProtected && 'is-protected'),
    style: imageSize ? `width: ${imageSize.width}px` : '',
    draggable: Boolean(canDrag)
  })) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "spinner-wrapper",
    style: imageSize ? `width: ${imageSize.width}px` : ''
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_14__["default"], {
    color: "white"
  }));
}
function renderVideoPreview(blobUrl, imageSize, canDrag, isProtected) {
  const wrapperStyle = imageSize && `width: ${imageSize.width}px; height: ${imageSize.height}px`;
  const videoStyle = `background-image: url(${blobUrl})`;
  return blobUrl ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "VideoPlayer"
  }, isProtected && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    onContextMenu: _util_stopEvent__WEBPACK_IMPORTED_MODULE_4__["default"],
    className: "protector"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    style: wrapperStyle
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("video", {
    style: videoStyle,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(isProtected && 'is-protected'),
    draggable: Boolean(canDrag)
  }))) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "spinner-wrapper",
    style: imageSize ? `width: ${imageSize.width}px` : ''
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_14__["default"], {
    color: "white"
  }));
}
function shouldForceMobileVersion(posterSize) {
  if (!posterSize) return false;
  return posterSize.width < MOBILE_VERSION_CONTROL_WIDTH;
}

/***/ }),

/***/ "./src/components/mediaViewer/MediaViewerFooter.tsx":
/*!**********************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewerFooter.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useDerivedState */ "./src/hooks/useDerivedState.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./hooks/useControlsSignal */ "./src/components/mediaViewer/hooks/useControlsSignal.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _MediaViewerFooter_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./MediaViewerFooter.scss */ "./src/components/mediaViewer/MediaViewerFooter.scss");











const RESIZE_THROTTLE_MS = 500;
const MediaViewerFooter = ({
  text = '',
  buttonText,
  isForVideo,
  onClick,
  handleSponsoredClick,
  isProtected,
  isForceMobileVersion
}) => {
  const [isMultiline, setIsMultiline] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const [getIsVisible] = (0,_hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const isHidden = (0,_hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_6__["default"])(() => _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__.IS_TOUCH_ENV ? !getIsVisible() : false, [getIsVisible]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const footerContent = document.querySelector('.MediaViewerFooter .media-text');
    const checkIsMultiline = () => {
      const height = footerContent ? footerContent.clientHeight : 0;
      setIsMultiline(height > _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.REM * 2);
    };

    // First run for initial detection of multiline footer text
    checkIsMultiline();
    const handleResize = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_2__.throttle)(checkIsMultiline, RESIZE_THROTTLE_MS, true);
    window.addEventListener('resize', handleResize, false);
    return () => {
      window.removeEventListener('resize', handleResize, false);
    };
  }, []);
  function stopEvent(e) {
    if (text) {
      e.stopPropagation();
    }
  }
  const onButtonClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    handleSponsoredClick();
  });
  const classNames = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])('MediaViewerFooter', isForVideo && 'is-for-video', isHidden && 'is-hidden', isProtected && 'is-protected', isForceMobileVersion && 'mobile');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: classNames,
    onClick: stopEvent
  }, Boolean(text) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "media-viewer-footer-content",
    onClick: !isMobile ? onClick : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: `media-text custom-scroll allow-selection ${isMultiline ? 'multiline' : ''}`,
    dir: "auto"
  }, text)), Boolean(buttonText) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])('media-viewer-footer-content', 'media-viewer-button'),
    size: "default",
    color: "primary",
    isRectangular: true,
    onClick: onButtonClick
  }, buttonText));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MediaViewerFooter);

/***/ }),

/***/ "./src/components/mediaViewer/MediaViewerSlides.tsx":
/*!**********************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewerSlides.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_animation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/animation */ "./src/util/animation.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureEvents__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/captureEvents */ "./src/util/captureEvents.ts");
/* harmony import */ var _util_math__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/math */ "./src/util/math.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_schedulers_useTimeout__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/schedulers/useTimeout */ "./src/hooks/schedulers/useTimeout.ts");
/* harmony import */ var _hooks_useDebouncedCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useDebouncedCallback */ "./src/hooks/useDebouncedCallback.ts");
/* harmony import */ var _hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useDerivedState */ "./src/hooks/useDerivedState.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useSignalRef__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../hooks/useSignalRef */ "./src/hooks/useSignalRef.ts");
/* harmony import */ var _hooks_window_useFullscreen__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../hooks/window/useFullscreen */ "./src/hooks/window/useFullscreen.ts");
/* harmony import */ var _hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../hooks/window/useWindowSize */ "./src/hooks/window/useWindowSize.ts");
/* harmony import */ var _hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./hooks/useControlsSignal */ "./src/components/mediaViewer/hooks/useControlsSignal.ts");
/* harmony import */ var _hooks_useZoomChangeSignal__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./hooks/useZoomChangeSignal */ "./src/components/mediaViewer/hooks/useZoomChangeSignal.ts");
/* harmony import */ var _MediaViewerContent__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./MediaViewerContent */ "./src/components/mediaViewer/MediaViewerContent.tsx");
/* harmony import */ var _MediaViewerSlides_scss__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./MediaViewerSlides.scss */ "./src/components/mediaViewer/MediaViewerSlides.scss");




















const {
  easeOutCubic,
  easeOutQuart
} = _util_animation__WEBPACK_IMPORTED_MODULE_1__.timingFunctions;
const SWIPE_X_THRESHOLD = 50;
const SWIPE_Y_THRESHOLD = 50;
const SLIDES_GAP = _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_TOUCH_ENV ? 40 : 0;
const ANIMATION_DURATION = 350;
const DEBOUNCE_SELECT_MEDIA = 350;
const DEBOUNCE_SWIPE = 500;
const DEBOUNCE_ACTIVE = 800;
const DOUBLE_TAP_ZOOM = 3;
const CLICK_Y_THRESHOLD = 80;
const HEADER_HEIGHT = 60;
const MAX_ZOOM = 4;
const MIN_ZOOM = 1;
let cancelAnimation;
let cancelZoomAnimation;
var SwipeDirection = /*#__PURE__*/function (SwipeDirection) {
  SwipeDirection[SwipeDirection["Horizontal"] = 0] = "Horizontal";
  SwipeDirection[SwipeDirection["Vertical"] = 1] = "Vertical";
  return SwipeDirection;
}(SwipeDirection || {});
const MediaViewerSlides = ({
  item,
  isVideo,
  isGif,
  isOpen,
  withAnimation,
  isHidden,
  isLoadingMoreMedia,
  isSynced,
  loadMoreItemsIfNeeded,
  getNextItem,
  selectItem,
  onClose,
  onFooterClick,
  handleSponsoredClick
}) => {
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const activeSlideRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const leftSlideRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const rightSlideRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lastTransformRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)({
    x: 0,
    y: 0,
    scale: 1
  });
  const swipeDirectionRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(undefined);
  const initialContentRectRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(undefined);
  const isReleasedRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);
  const [isActive, setIsActive] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [getZoomChange] = (0,_hooks_useZoomChangeSignal__WEBPACK_IMPORTED_MODULE_17__["default"])();
  const prevZoomChangeRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(getZoomChange());
  const isFullscreen = (0,_hooks_window_useFullscreen__WEBPACK_IMPORTED_MODULE_14__.useFullscreenStatus)();
  const [isMouseDown, setIsMouseDown] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [getTransform, setTransform] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)({
    x: 0,
    y: 0,
    scale: 1
  });
  const transformRef = (0,_hooks_useSignalRef__WEBPACK_IMPORTED_MODULE_13__.useSignalRef)(getTransform);
  const [getActiveItem, setActiveItem] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)(item);
  const activeItemRef = (0,_hooks_useSignalRef__WEBPACK_IMPORTED_MODULE_13__.useSignalRef)(getActiveItem);
  const isScaled = (0,_hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_9__["default"])(() => getTransform().scale !== 1, [getTransform]);
  const activeItem = (0,_hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_9__["default"])(getActiveItem);
  const {
    height: windowHeight,
    width: windowWidth,
    isResizing
  } = (0,_hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_15__["default"])();
  const [getControlsVisible, setControlsVisible, lockControls] = (0,_hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_16__["default"])();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_10__["default"])({
    isActive: isOpen,
    onBack: onClose,
    shouldBeReplaced: true
  });
  const selectItemDebounced = (0,_hooks_useDebouncedCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(selectItem, [selectItem], DEBOUNCE_SELECT_MEDIA, true);
  const clearSwipeDirectionDebounced = (0,_hooks_useDebouncedCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    swipeDirectionRef.current = undefined;
  }, [], DEBOUNCE_SWIPE, true);
  const setIsActiveDebounced = (0,_hooks_useDebouncedCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(value => setIsActive(value), [], DEBOUNCE_ACTIVE, true);
  const shouldCloseOnVideo = Boolean(isGif && !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_IOS);
  const clickXThreshold = _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_TOUCH_ENV ? 40 : windowWidth / 10;
  const handleControlsVisibility = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(e => {
    if (!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_TOUCH_ENV) return;
    const isFooter = windowHeight - e.pageY < CLICK_Y_THRESHOLD;
    if (!isFooter && e.pageX < clickXThreshold) return;
    if (!isFooter && e.pageX > windowWidth - clickXThreshold) return;
    setControlsVisible(!getControlsVisible());
  });
  (0,_hooks_schedulers_useTimeout__WEBPACK_IMPORTED_MODULE_7__["default"])(() => setControlsVisible(true), ANIMATION_DURATION);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const {
      scale,
      x,
      y
    } = transformRef.current;
    // Only update active media if slide is in default position
    if (x === 0 && y === 0 && scale === 1) {
      setActiveItem(item);
    }
  }, [item, setActiveItem, transformRef]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isSynced || !activeItem || isLoadingMoreMedia) return;
    loadMoreItemsIfNeeded(activeItem);
  }, [activeItem, loadMoreItemsIfNeeded, isSynced, isLoadingMoreMedia]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    const {
      x,
      y,
      scale
    } = getTransform();
    lockControls(scale !== 1);
    if (leftSlideRef.current) {
      leftSlideRef.current.style.transform = getTransformStyle(-windowWidth + x - SLIDES_GAP);
    }
    if (activeSlideRef.current) {
      activeSlideRef.current.style.transform = getTransformStyle(x, y, scale);
    }
    if (rightSlideRef.current) {
      rightSlideRef.current.style.transform = getTransformStyle(windowWidth + x + SLIDES_GAP);
    }
  }, [getTransform, lockControls, windowWidth]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!containerRef.current || activeItemRef.current === undefined || isHidden || isFullscreen) {
      return undefined;
    }
    let lastTransform = lastTransformRef.current;
    const lastDragOffset = {
      x: 0,
      y: 0
    };
    const lastZoomCenter = {
      x: 0,
      y: 0
    };
    const panDelta = {
      x: 0,
      y: 0
    };
    let lastGestureTime = Date.now();
    let content;
    const setLastGestureTime = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_5__.debounce)(() => {
      lastGestureTime = Date.now();
    }, 500, false, true);
    const changeSlide = direction => {
      const cActiveItem = activeItemRef.current;
      if (cActiveItem === undefined) return false;
      const nextItem = getNextItem(cActiveItem, direction);
      if (nextItem !== undefined) {
        const offset = (windowWidth + SLIDES_GAP) * direction;
        const transform = transformRef.current;
        const x = transform.x + offset;
        setIsActive(false);
        setActiveItem(nextItem);
        selectItemDebounced(nextItem);
        setIsActiveDebounced(true);
        lastTransform = {
          x: 0,
          y: 0,
          scale: 1
        };
        if (!withAnimation) {
          setTransform(lastTransform);
          return true;
        }
        cancelAnimation = (0,_util_animation__WEBPACK_IMPORTED_MODULE_1__.animateNumber)({
          from: x,
          to: 0,
          duration: ANIMATION_DURATION,
          timing: easeOutCubic,
          onUpdate: value => setTransform({
            y: 0,
            x: value,
            scale: 1
          })
        });
        return true;
      }
      return false;
    };
    const changeSlideOnClick = e => {
      const {
        scale
      } = transformRef.current;
      if (scale !== 1) return [false, false];
      if (e.target.closest('div.VideoPlayerControls')) {
        return [false, false];
      }
      let direction = 0;
      if (windowHeight - e.pageY < CLICK_Y_THRESHOLD) {
        return [false, false];
      }
      if (e.pageX < clickXThreshold) {
        direction = -1;
      } else if (e.pageX > windowWidth - clickXThreshold) {
        direction = 1;
      }
      const hasNextSlide = changeSlide(direction);
      const isInThreshold = direction !== 0;
      return [isInThreshold, hasNextSlide];
    };
    const handleKeyDown = e => {
      const {
        scale
      } = transformRef.current;
      if (scale !== 1) return;
      switch (e.key) {
        case 'Left': // IE/Edge specific value
        case 'ArrowLeft':
          changeSlide(-1);
          break;
        case 'Right': // IE/Edge specific value
        case 'ArrowRight':
          changeSlide(1);
          break;
      }
    };
    const calculateOffsetBoundaries = ({
      x,
      y,
      scale
    }, offsetTop = 0) => {
      const initialContentRect = initialContentRectRef.current;
      if (!initialContentRect) return [{
        x,
        y,
        scale
      }, true, true];
      // Get current content boundaries
      let inBoundsX = true;
      let inBoundsY = true;
      const centerX = (windowWidth - windowWidth * scale) / 2;
      const centerY = (windowHeight - windowHeight * scale) / 2;

      // If content is outside window we calculate offset boundaries
      // based on initial content rect and current scale
      const minOffsetX = Math.max(-initialContentRect.left * scale, centerX);
      const maxOffsetX = windowWidth - initialContentRect.right * scale;
      inBoundsX = (0,_util_math__WEBPACK_IMPORTED_MODULE_4__.isBetween)(x, maxOffsetX, minOffsetX);
      x = (0,_util_math__WEBPACK_IMPORTED_MODULE_4__.clamp)(x, maxOffsetX, minOffsetX);
      const minOffsetY = Math.max(-initialContentRect.top * scale + offsetTop, centerY);
      const maxOffsetY = windowHeight - initialContentRect.bottom * scale;
      inBoundsY = (0,_util_math__WEBPACK_IMPORTED_MODULE_4__.isBetween)(y, maxOffsetY, minOffsetY);
      y = (0,_util_math__WEBPACK_IMPORTED_MODULE_4__.clamp)(y, maxOffsetY, minOffsetY);
      return [{
        x,
        y,
        scale
      }, inBoundsX, inBoundsY];
    };
    const onRelease = e => {
      // This allows to prevent onRelease triggered by debounced wheel event
      // after onRelease was triggered manually in onDrag
      if (isReleasedRef.current) {
        isReleasedRef.current = false;
        return;
      }
      if (e.type === 'mouseup') {
        setIsMouseDown(false);
      }
      const transform = transformRef.current;
      const {
        y,
        scale
      } = transform;
      let x = transform.x;
      const absX = Math.abs(x);
      const absY = Math.abs(y);
      clearSwipeDirectionDebounced();
      setIsActiveDebounced(true);

      // If scale is less than 1 we need to bounce back
      if (scale < 1) {
        lastTransform = {
          x: 0,
          y: 0,
          scale: 1
        };
        cancelAnimation = (0,_util_animation__WEBPACK_IMPORTED_MODULE_1__.animateNumber)({
          from: [x, y, scale],
          to: [0, 0, 1],
          duration: ANIMATION_DURATION,
          timing: easeOutCubic,
          onUpdate: value => setTransform({
            x: value[0],
            y: value[1],
            scale: value[2]
          })
        });
        return;
      }
      if (scale > 1) {
        // Get current content boundaries
        const s1 = Math.min(scale, MAX_ZOOM);
        const scaleFactor = s1 / scale;

        // Calculate new position based on the last zoom center to keep the zoom center
        // at the same position when bouncing back from max zoom
        let x1 = x * scaleFactor + (lastZoomCenter.x - scaleFactor * lastZoomCenter.x);
        let y1 = y * scaleFactor + (lastZoomCenter.y - scaleFactor * lastZoomCenter.y);

        // Arbitrary pan velocity coefficient
        const k = 0.15;

        // If scale didn't change, we need to add inertia to pan gesture
        if (e.type !== 'wheel' && lastTransform.scale === scale) {
          // Calculate user gesture velocity
          const Vx = Math.abs(lastDragOffset.x) / (Date.now() - lastGestureTime);
          const Vy = Math.abs(lastDragOffset.y) / (Date.now() - lastGestureTime);

          // Add extra distance based on gesture velocity and last pan delta
          x1 -= Math.abs(lastDragOffset.x) * Vx * k * panDelta.x;
          y1 -= Math.abs(lastDragOffset.y) * Vy * k * panDelta.y;
        }
        [lastTransform] = calculateOffsetBoundaries({
          x: x1,
          y: y1,
          scale: s1
        }, HEADER_HEIGHT);
        cancelAnimation = (0,_util_animation__WEBPACK_IMPORTED_MODULE_1__.animateNumber)({
          from: [x, y, scale],
          to: [lastTransform.x, lastTransform.y, lastTransform.scale],
          duration: ANIMATION_DURATION,
          timing: easeOutCubic,
          onUpdate: value => setTransform({
            x: value[0],
            y: value[1],
            scale: value[2]
          })
        });
        return;
      }
      lastTransform = {
        x,
        y,
        scale
      };
      if (absY >= SWIPE_Y_THRESHOLD) {
        onClose();
        return;
      }
      // Bounce back if vertical swipe is below threshold
      if (absY > 0) {
        cancelAnimation = (0,_util_animation__WEBPACK_IMPORTED_MODULE_1__.animateNumber)({
          from: y,
          to: 0,
          duration: ANIMATION_DURATION,
          timing: easeOutCubic,
          onUpdate: value => setTransform({
            x: 0,
            y: value,
            scale
          })
        });
        return;
      }
      // Get horizontal swipe direction
      const direction = x < 0 ? 1 : -1;
      const cActiveItem = activeItemRef.current;
      const nextItem = cActiveItem && getNextItem(cActiveItem, x < 0 ? 1 : -1);
      // Get the direction of the last pan gesture.
      // Could be different from the total horizontal swipe direction
      // if user starts a swipe in one direction and then changes the direction
      // we need to cancel slide transition
      const dirX = panDelta.x < 0 ? -1 : 1;
      if (nextItem !== undefined && absX >= SWIPE_X_THRESHOLD && direction === dirX) {
        const offset = (windowWidth + SLIDES_GAP) * direction;
        // If image is shifted by more than SWIPE_X_THRESHOLD,
        // We shift everything by one screen width and then set new active message id
        x += offset;
        setActiveItem(nextItem);
        selectItemDebounced(nextItem);
      }
      // Then we always return to the original position
      cancelAnimation = (0,_util_animation__WEBPACK_IMPORTED_MODULE_1__.animateNumber)({
        from: x,
        to: 0,
        duration: ANIMATION_DURATION,
        timing: easeOutCubic,
        onUpdate: value => setTransform({
          y: 0,
          x: value,
          scale: scale ?? 1
        })
      });
    };
    const cleanup = (0,_util_captureEvents__WEBPACK_IMPORTED_MODULE_3__.captureEvents)(containerRef.current, {
      isNotPassive: true,
      withNativeDrag: true,
      excludedClosestSelector: '.MediaViewerFooter, .ZoomControls, .VideoPlayerControls',
      minZoom: MIN_ZOOM,
      maxZoom: MAX_ZOOM,
      doubleTapZoom: DOUBLE_TAP_ZOOM,
      withWheelDrag: true,
      onCapture: e => {
        if (checkIfControlTarget(e)) return;
        const {
          x,
          y,
          scale
        } = transformRef.current;
        if (e.type === 'mousedown') {
          setIsMouseDown(true);
          if (scale !== 1) {
            e.preventDefault();
            return;
          }
        }
        lastGestureTime = Date.now();
        if (x === 0 && y === 0 && scale === 1) {
          if (!activeSlideRef.current) return;
          content = activeSlideRef.current.querySelector('img, video');
          if (!content) return;
          // Store initial content rect, without transformations
          initialContentRectRef.current = content.getBoundingClientRect();
        }
      },
      onDrag: (event, captureEvent, {
        dragOffsetX,
        dragOffsetY
      }, cancelDrag) => {
        if (isReleasedRef.current || checkIfControlTarget(event)) return;
        // Avoid conflicts with swipe-to-back gestures
        if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_IOS && captureEvent.type === 'touchstart') {
          const {
            pageX
          } = captureEvent.touches[0];
          if (pageX <= _util_captureEvents__WEBPACK_IMPORTED_MODULE_3__.IOS_SCREEN_EDGE_THRESHOLD || pageX >= windowWidth - _util_captureEvents__WEBPACK_IMPORTED_MODULE_3__.IOS_SCREEN_EDGE_THRESHOLD) {
            return;
          }
        }
        if (cancelAnimation) {
          cancelAnimation();
          cancelAnimation = undefined;
        }
        panDelta.x = lastDragOffset.x - dragOffsetX;
        panDelta.y = lastDragOffset.y - dragOffsetY;
        lastDragOffset.x = dragOffsetX;
        lastDragOffset.y = dragOffsetY;
        const absOffsetX = Math.abs(dragOffsetX);
        const absOffsetY = Math.abs(dragOffsetY);
        const {
          x,
          y,
          scale
        } = transformRef.current;

        // If user is inactive but is still touching the screen
        // we reset last gesture time
        setLastGestureTime();

        // If image is scaled we just need to pan it
        if (scale !== 1) {
          const x1 = lastTransform.x + dragOffsetX;
          const y1 = lastTransform.y + dragOffsetY;
          if (['wheel', 'mousemove'].includes(event.type)) {
            const [transform, inBoundsX, inBoundsY] = calculateOffsetBoundaries({
              x: x1,
              y: y1,
              scale
            }, HEADER_HEIGHT);
            if (cancelDrag) cancelDrag(!inBoundsX, !inBoundsY);
            setTransform(transform);
            return;
          }
          if ('touches' in event && event.touches.length === 1) {
            setTransform({
              x: x1,
              y: y1,
              scale
            });
          }
          return;
        }
        if (event.type === 'mousemove') return;
        if (swipeDirectionRef.current !== SwipeDirection.Vertical) {
          // If user is swiping horizontally or horizontal shift is dominant
          // we change only horizontal position
          if (swipeDirectionRef.current === SwipeDirection.Horizontal || Math.abs(x) > _util_captureEvents__WEBPACK_IMPORTED_MODULE_3__.SWIPE_DIRECTION_THRESHOLD || absOffsetX / absOffsetY > _util_captureEvents__WEBPACK_IMPORTED_MODULE_3__.SWIPE_DIRECTION_TOLERANCE) {
            swipeDirectionRef.current = SwipeDirection.Horizontal;
            setIsActive(false);
            const limit = windowWidth + SLIDES_GAP;
            const x1 = (0,_util_math__WEBPACK_IMPORTED_MODULE_4__.clamp)(dragOffsetX, -limit, limit);
            setTransform({
              x: x1,
              y: 0,
              scale
            });
            // We know that at this point onRelease will trigger slide change,
            // We can trigger onRelease directly instead of waiting for the debounced callback
            // to avoid a delay
            if (event.type === 'wheel' && Math.abs(x1) > SWIPE_X_THRESHOLD * 2) {
              onRelease(event);
              isReleasedRef.current = true;
            }
            return;
          }
        }
        // If vertical shift is dominant we change only vertical position
        if (swipeDirectionRef.current === SwipeDirection.Vertical || Math.abs(y) > _util_captureEvents__WEBPACK_IMPORTED_MODULE_3__.SWIPE_DIRECTION_THRESHOLD || absOffsetY / absOffsetX > _util_captureEvents__WEBPACK_IMPORTED_MODULE_3__.SWIPE_DIRECTION_TOLERANCE) {
          swipeDirectionRef.current = SwipeDirection.Vertical;
          const limit = windowHeight;
          const y1 = (0,_util_math__WEBPACK_IMPORTED_MODULE_4__.clamp)(dragOffsetY, -limit, limit);
          setTransform({
            x: 0,
            y: y1,
            scale
          });
          if (event.type === 'wheel' && Math.abs(y1) > SWIPE_Y_THRESHOLD * 2) {
            onRelease(event);
            isReleasedRef.current = true;
          }
        }
      },
      onZoom: (e, {
        zoom,
        zoomFactor,
        initialCenterX,
        initialCenterY,
        dragOffsetX,
        dragOffsetY,
        currentCenterX,
        currentCenterY
      }) => {
        if (cancelAnimation) cancelAnimation();
        initialCenterX = initialCenterX || windowWidth / 2;
        initialCenterY = initialCenterY || windowHeight / 2;
        currentCenterX = currentCenterX || windowWidth / 2;
        currentCenterY = currentCenterY || windowHeight / 2;

        // Calculate current scale based on zoom factor and limits, add zoom margin for bounce back effect
        const scale = zoom ?? (0,_util_math__WEBPACK_IMPORTED_MODULE_4__.clamp)(lastTransform.scale * zoomFactor, MIN_ZOOM * 0.5, MAX_ZOOM * 3);
        const scaleFactor = scale / lastTransform.scale;
        const offsetX = Math.abs(Math.min(lastTransform.x, 0));
        const offsetY = Math.abs(Math.min(lastTransform.y, 0));

        // Save last zoom center for bounce back effect
        lastZoomCenter.x = currentCenterX;
        lastZoomCenter.y = currentCenterY;

        // Calculate new center relative to the shifted image
        const scaledCenterX = offsetX + initialCenterX;
        const scaledCenterY = offsetY + initialCenterY;

        // Calculate how much we need to shift the image to keep the zoom center at the same position
        const scaleOffsetX = scaledCenterX - scaleFactor * scaledCenterX;
        const scaleOffsetY = scaledCenterY - scaleFactor * scaledCenterY;
        const [transform] = calculateOffsetBoundaries({
          x: lastTransform.x + scaleOffsetX + dragOffsetX,
          y: lastTransform.y + scaleOffsetY + dragOffsetY,
          scale
        });
        setTransform(transform);
      },
      onClick(e) {
        setIsMouseDown(false);
        const [isInThreshold, hasNextSlide] = changeSlideOnClick(e);
        if (isInThreshold) {
          e.preventDefault();
          e.stopPropagation();
          if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_TOUCH_ENV) return;
          if (!hasNextSlide) onClose();
          return;
        }
        if (lastTransform.scale !== 1 || _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_TOUCH_ENV) return;
        if (shouldCloseOnVideo || !checkIfInsideSelector(e.target, '.VideoPlayer')) {
          onClose();
        }
      },
      onDoubleClick(e, {
        centerX,
        centerY
      }) {
        const [isInThreshold] = changeSlideOnClick(e);
        if (isInThreshold) {
          e.preventDefault();
          e.stopPropagation();
          return;
        }
        if (!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_TOUCH_ENV && e.type !== 'wheel') return;
        const {
          x,
          y,
          scale
        } = transformRef.current;
        // Calculate how much we need to shift the image to keep the zoom center at the same position
        const scaleOffsetX = centerX - DOUBLE_TAP_ZOOM * centerX;
        const scaleOffsetY = centerY - DOUBLE_TAP_ZOOM * centerY;
        if (scale === 1) {
          if (x !== 0 || y !== 0) return;
          lastTransform = calculateOffsetBoundaries({
            x: scaleOffsetX,
            y: scaleOffsetY,
            scale: DOUBLE_TAP_ZOOM
          })[0];
        } else {
          lastTransform = {
            x: 0,
            y: 0,
            scale: 1
          };
        }
        cancelAnimation = (0,_util_animation__WEBPACK_IMPORTED_MODULE_1__.animateNumber)({
          from: [x, y, scale],
          to: [lastTransform.x, lastTransform.y, lastTransform.scale],
          duration: ANIMATION_DURATION,
          timing: easeOutCubic,
          onUpdate: value => {
            const transform = {
              x: value[0],
              y: value[1],
              scale: value[2]
            };
            setTransform(transform);
          }
        });
      },
      onRelease
    });
    document.addEventListener('keydown', handleKeyDown, false);
    return () => {
      cleanup();
      document.removeEventListener('keydown', handleKeyDown, false);
    };
  }, [activeItemRef, clearSwipeDirectionDebounced, clickXThreshold, getNextItem, isFullscreen, isHidden, onClose, selectItemDebounced, setActiveItem, setIsActiveDebounced, setTransform, shouldCloseOnVideo, transformRef, windowHeight, windowWidth, withAnimation]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const zoomChange = getZoomChange();
    const hasZoomChanged = prevZoomChangeRef.current !== undefined && prevZoomChangeRef.current !== zoomChange;
    if (!containerRef.current || !hasZoomChanged || isHidden || isFullscreen) return;
    prevZoomChangeRef.current = zoomChange;
    const {
      scale
    } = transformRef.current;
    const dir = zoomChange > 0 ? -1 : +1;
    const minZoom = MIN_ZOOM * 0.6;
    const maxZoom = MAX_ZOOM * 3;
    let steps = 100;
    let prevValue = 0;
    if (scale <= minZoom && dir > 0) return;
    if (scale >= maxZoom && dir < 0) return;
    if (scale === 1 && dir > 0) steps = 20;
    if (cancelZoomAnimation) cancelZoomAnimation();
    cancelZoomAnimation = (0,_util_animation__WEBPACK_IMPORTED_MODULE_1__.animateNumber)({
      from: dir,
      to: dir * steps,
      duration: ANIMATION_DURATION,
      timing: easeOutQuart,
      onUpdate: value => {
        if (!containerRef.current) return;
        const delta = (0,_util_math__WEBPACK_IMPORTED_MODULE_4__.round)(value - prevValue, 2);
        prevValue = value;
        // To reuse existing logic we trigger wheel event for zoom buttons
        const wheelEvent = new WheelEvent('wheel', {
          deltaY: delta,
          ctrlKey: true
        });
        containerRef.current.dispatchEvent(wheelEvent);
      }
    });
  }, [getZoomChange, isHidden, isFullscreen, transformRef]);
  const [prevItem, nextItem] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (activeItem === undefined) return [undefined, undefined];
    return [getNextItem(activeItem, -1), getNextItem(activeItem, 1)];
  }, [activeItem, getNextItem]);
  if (activeItem === undefined) return undefined;
  const hasPrev = prevItem !== undefined;
  const hasNext = nextItem !== undefined;
  const isMoving = isMouseDown && isScaled;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "MediaViewerSlides",
    ref: containerRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "MediaViewerSlide",
    ref: leftSlideRef
  }, hasPrev && !isScaled && !isResizing && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MediaViewerContent__WEBPACK_IMPORTED_MODULE_18__["default"], {
    withAnimation: withAnimation,
    isMoving: isMoving,
    item: prevItem,
    onClose: onClose,
    onFooterClick: onFooterClick,
    handleSponsoredClick: handleSponsoredClick
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('MediaViewerSlide', 'MediaViewerSlide--active', isMoving && 'MediaViewerSlide--moving'),
    onClick: handleControlsVisibility,
    ref: activeSlideRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MediaViewerContent__WEBPACK_IMPORTED_MODULE_18__["default"], {
    item: activeItem,
    withAnimation: withAnimation,
    isActive: isActive,
    isMoving: isMoving,
    onClose: onClose,
    onFooterClick: onFooterClick,
    handleSponsoredClick: handleSponsoredClick
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "MediaViewerSlide",
    ref: rightSlideRef
  }, hasNext && !isScaled && !isResizing && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MediaViewerContent__WEBPACK_IMPORTED_MODULE_18__["default"], {
    withAnimation: withAnimation,
    isMoving: isMoving,
    item: nextItem,
    onClose: onClose,
    onFooterClick: onFooterClick,
    handleSponsoredClick: handleSponsoredClick
  })), hasPrev && !isScaled && !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_TOUCH_ENV && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("button", {
    type: "button",
    className: `navigation prev ${isVideo && !isGif && 'inline'}`,
    "aria-label": lang('AccDescrPrevious'),
    dir: lang.isRtl ? 'rtl' : undefined
  }), hasNext && !isScaled && !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_TOUCH_ENV && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("button", {
    type: "button",
    className: `navigation next ${isVideo && !isGif && 'inline'}`,
    "aria-label": lang('Next'),
    dir: lang.isRtl ? 'rtl' : undefined
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(MediaViewerSlides));
function getTransformStyle(x = 0, y = 0, scale = 1) {
  return `translate3d(${x.toFixed(3)}px, ${y.toFixed(3)}px, 0px) scale(${scale.toFixed(3)})`;
}
function checkIfInsideSelector(element, selector) {
  if (!element) return false;
  if (element.matches(selector)) return true;
  return Boolean(element.closest(selector));
}
function checkIfControlTarget(e) {
  const target = e.target;
  if (checkIfInsideSelector(target, '.VideoPlayerControls')) {
    if (checkIfInsideSelector(target, '.play, .fullscreen, .volume, .volume-slider, .playback-rate, .playback-rate-menu, .SeekLine')) {
      return true;
    }
    e.preventDefault();
    return true;
  }
  return false;
}

/***/ }),

/***/ "./src/components/mediaViewer/SeekLine.tsx":
/*!*************************************************!*\
  !*** ./src/components/mediaViewer/SeekLine.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _lib_video_preview_VideoPreview__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/video-preview/VideoPreview */ "./src/lib/video-preview/VideoPreview.ts");
/* harmony import */ var _util_animation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/animation */ "./src/util/animation.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureEvents__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/captureEvents */ "./src/util/captureEvents.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_math__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/math */ "./src/util/math.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useAsyncResolvers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useAsyncResolvers */ "./src/hooks/useAsyncResolvers.ts");
/* harmony import */ var _hooks_useCurrentTimeSignal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useCurrentTimeSignal */ "./src/hooks/useCurrentTimeSignal.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useVideoWaitingSignal__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./hooks/useVideoWaitingSignal */ "./src/components/mediaViewer/hooks/useVideoWaitingSignal.ts");
/* harmony import */ var _ui_ShowTransition__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/ShowTransition */ "./src/components/ui/ShowTransition.tsx");
/* harmony import */ var _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SeekLine.module.scss */ "./src/components/mediaViewer/SeekLine.module.scss");














const LOCK_TIMEOUT = 250;
let cancelAnimation;
const SeekLine = ({
  duration,
  bufferedRanges,
  isReady,
  posterSize,
  playbackRate,
  url,
  isActive,
  isPlaying,
  isPreviewDisabled,
  onSeek,
  onSeekStart
}) => {
  // eslint-disable-next-line no-null/no-null
  const seekerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [getCurrentTimeSignal] = (0,_hooks_useCurrentTimeSignal__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [getIsWaiting] = (0,_hooks_useVideoWaitingSignal__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const getCurrentTime = (0,_hooks_useAsyncResolvers__WEBPACK_IMPORTED_MODULE_8__.useThrottledSignal)(getCurrentTimeSignal, LOCK_TIMEOUT);
  const [getSelectedTime, setSelectedTime] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)(getCurrentTime());
  const [getPreviewOffset, setPreviewOffset] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)(0);
  const [getPreviewTime, setPreviewTime] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)(0);
  const isLockedRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);
  const [isPreviewVisible, setPreviewVisible] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isSeeking, setIsSeeking] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  // eslint-disable-next-line no-null/no-null
  const previewCanvasRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const previewRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const progressRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const previewTimeRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const previewSize = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return (0,_lib_video_preview_VideoPreview__WEBPACK_IMPORTED_MODULE_1__.getPreviewDimensions)(posterSize?.width || 0, posterSize?.height || 0);
  }, [posterSize]);
  const setPreview = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(time => {
    time = Math.floor(time);
    setPreviewTime(time);
    (0,_lib_video_preview_VideoPreview__WEBPACK_IMPORTED_MODULE_1__.renderVideoPreview)(time);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isPreviewDisabled || !url || !isReady) return undefined;
    return (0,_lib_video_preview_VideoPreview__WEBPACK_IMPORTED_MODULE_1__.createVideoPreviews)(url, previewCanvasRef.current);
  }, [url, isReady, isPreviewDisabled]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setPreviewVisible(false);
  }, [isActive]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (cancelAnimation) cancelAnimation();
    cancelAnimation = undefined;
    if (!isLockedRef.current && !isSeeking) {
      const time = getCurrentTime();
      const remaining = duration - time;
      cancelAnimation = (0,_util_animation__WEBPACK_IMPORTED_MODULE_2__.animateNumber)({
        from: time,
        to: duration,
        duration: remaining * 1000 / playbackRate,
        onUpdate: setSelectedTime
      });
    }
  }, [getCurrentTime, isSeeking, setSelectedTime, playbackRate, duration]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isPlaying || getIsWaiting()) {
      if (cancelAnimation) cancelAnimation();
      cancelAnimation = undefined;
    }
  }, [isPlaying, getSelectedTime, getIsWaiting]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isPlaying) {
      if (cancelAnimation) cancelAnimation();
      cancelAnimation = undefined;
      const time = getCurrentTime();
      const remaining = duration - time;
      cancelAnimation = (0,_util_animation__WEBPACK_IMPORTED_MODULE_2__.animateNumber)({
        from: time,
        to: duration,
        duration: remaining * 1000 / playbackRate,
        onUpdate: setSelectedTime
      });
    }
    // eslint-disable-next-line
  }, [isPlaying, playbackRate, duration]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    if (!progressRef.current) return;
    const progress = (0,_util_math__WEBPACK_IMPORTED_MODULE_6__.round)(getSelectedTime() / duration * 100, 2);
    progressRef.current.style.width = `${progress}%`;
  }, [getSelectedTime, duration]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    if (!previewRef.current) return;
    previewRef.current.style.left = `${getPreviewOffset()}px`;
  }, [getPreviewOffset]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    if (!previewTimeRef.current) return;
    previewTimeRef.current.innerText = (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatMediaDuration)(getPreviewTime());
  }, [getPreviewTime]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!seekerRef.current || !isActive) return undefined;
    const seeker = seekerRef.current;
    let seekerSize = seeker.getBoundingClientRect();
    let time = 0;
    let offset = 0;
    const getPreviewProps = e => {
      const pageX = e instanceof MouseEvent ? e.pageX : e.touches[0].pageX;
      const t = (0,_util_math__WEBPACK_IMPORTED_MODULE_6__.clamp)(duration * ((pageX - seekerSize.left) / seekerSize.width), 0, duration);
      if (isPreviewDisabled) return [t, 0];
      if (!seekerSize.width) seekerSize = seeker.getBoundingClientRect();
      const preview = previewRef.current;
      const o = (0,_util_math__WEBPACK_IMPORTED_MODULE_6__.clamp)(pageX - seekerSize.left - preview.clientWidth / 2, -4, seekerSize.width - preview.clientWidth + 4);
      return [t, o];
    };
    const stopAnimation = () => {
      if (cancelAnimation) cancelAnimation();
      cancelAnimation = undefined;
    };
    const handleSeek = e => {
      stopAnimation();
      setPreviewVisible(true);
      [time, offset] = getPreviewProps(e);
      void setPreview(time);
      setPreviewOffset(offset);
      setSelectedTime(time);
    };
    const handleStartSeek = () => {
      stopAnimation();
      setPreviewVisible(true);
      setIsSeeking(true);
      onSeekStart();
    };
    const handleStopSeek = () => {
      stopAnimation();
      isLockedRef.current = true;
      setPreviewVisible(false);
      setIsSeeking(false);
      setSelectedTime(time);
      onSeek(time);
      // Prevent current time updates from overriding the selected time
      setTimeout(() => {
        isLockedRef.current = false;
      }, LOCK_TIMEOUT);
    };
    const cleanup = (0,_util_captureEvents__WEBPACK_IMPORTED_MODULE_4__.captureEvents)(seeker, {
      onCapture: handleStartSeek,
      onRelease: handleStopSeek,
      onClick: handleStopSeek,
      onDrag: handleSeek
    });
    if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_7__.IS_TOUCH_ENV || isPreviewDisabled) {
      return cleanup;
    }
    const handleSeekMouseMove = e => {
      setPreviewVisible(true);
      [time, offset] = getPreviewProps(e);
      setPreviewOffset(offset);
      void setPreview(time);
    };
    const handleSeekMouseLeave = () => {
      setPreviewVisible(false);
    };
    seeker.addEventListener('mousemove', handleSeekMouseMove);
    seeker.addEventListener('mouseenter', handleSeekMouseMove);
    seeker.addEventListener('mouseleave', handleSeekMouseLeave);
    return () => {
      cleanup();
      seeker.removeEventListener('mousemove', handleSeekMouseMove);
      seeker.removeEventListener('mouseenter', handleSeekMouseMove);
      seeker.removeEventListener('mouseleave', handleSeekMouseLeave);
    };
  }, [duration, setPreview, isActive, onSeek, onSeekStart, setPreviewOffset, setSelectedTime, setIsSeeking, isPreviewDisabled, playbackRate]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].container,
    ref: seekerRef
  }, !isPreviewDisabled && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ShowTransition__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isOpen: true,
    isHidden: !isPreviewVisible,
    className: _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].preview,
    style: `width: ${previewSize.width}px; height: ${previewSize.height}px`,
    ref: previewRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    className: _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].previewCanvas,
    ref: previewCanvasRef
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].previewTime
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].previewTimeText,
    ref: previewTimeRef
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].track
  }, bufferedRanges.map(({
    start,
    end
  }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    key: `${start}-${end}`,
    className: _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].buffered
    // @ts-ignore
    ,
    style: `left: ${start * 100}%; right: ${100 - end * 100}%`
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].track
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: progressRef,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].played, isSeeking && _SeekLine_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].seeking)
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SeekLine));

/***/ }),

/***/ "./src/components/mediaViewer/SenderInfo.tsx":
/*!***************************************************!*\
  !*** ./src/components/mediaViewer/SenderInfo.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _SenderInfo_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./SenderInfo.scss */ "./src/components/mediaViewer/SenderInfo.scss");











const BULLET = '\u2022';
const ANIMATION_DURATION = 350;
const SenderInfo = ({
  owner,
  item
}) => {
  const {
    closeMediaViewer,
    focusMessage,
    toggleChatInfo
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const handleFocusMessage = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    closeMediaViewer();
    if (item?.type !== 'message') return;
    const message = item.message;
    if (isMobile) {
      setTimeout(() => {
        toggleChatInfo({
          force: false
        }, {
          forceSyncOnIOs: true
        });
        focusMessage({
          chatId: message.chatId,
          messageId: message.id
        });
      }, ANIMATION_DURATION);
    } else {
      focusMessage({
        chatId: message.chatId,
        messageId: message.id
      });
    }
  });
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const subtitle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!item || item.type === 'standalone') return undefined;
    const avatarOwner = item.type === 'avatar' ? item.avatarOwner : undefined;
    const profilePhotos = item.type === 'avatar' ? item.profilePhotos : undefined;
    const avatar = profilePhotos?.photos[item.mediaIndex];
    const isFallbackAvatar = avatar?.id === profilePhotos?.fallbackPhoto?.id;
    const isPersonalAvatar = avatar?.id === profilePhotos?.personalPhoto?.id;
    const date = item.type === 'message' ? item.message.date : avatar?.date;
    if (!date) return undefined;
    const formattedDate = (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.formatMediaDateTime)(lang, date * 1000, true);
    const count = profilePhotos?.count && profilePhotos.count + (profilePhotos?.fallbackPhoto ? 1 : 0);
    const currentIndex = item.mediaIndex + 1 + (profilePhotos?.personalPhoto ? -1 : 0);
    const countText = count && lang('Of', [currentIndex, count]);
    const parts = [];
    if (avatar) {
      const chat = !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(avatarOwner.id) ? avatarOwner : undefined;
      const isChannel = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatChannel)(chat);
      const isGroup = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatGroup)(chat);
      parts.push(lang(isPersonalAvatar ? 'lng_mediaview_profile_photo_by_you' : isFallbackAvatar ? 'lng_mediaview_profile_public_photo' : isChannel ? 'lng_mediaview_channel_photo' : isGroup ? 'lng_mediaview_group_photo' : 'lng_mediaview_profile_photo'));
    }
    if (countText && !isPersonalAvatar && !isFallbackAvatar) {
      parts.push(countText);
    }
    parts.push(formattedDate);
    return parts.join(` ${BULLET} `);
  }, [item, lang]);
  if (!owner) {
    return undefined;
  }
  const senderTitle = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getPeerTitle)(lang, owner);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "SenderInfo",
    onClick: handleFocusMessage
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_9__["default"], {
    key: owner.id,
    size: "medium",
    peer: owner
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "meta"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "title",
    dir: "auto"
  }, senderTitle && (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__["default"])(senderTitle)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "date",
    dir: "auto"
  }, subtitle)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  item
}) => {
  const message = item?.type === 'message' ? item.message : undefined;
  const messageSender = message && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSender)(global, message);
  const owner = item?.type === 'avatar' ? item.avatarOwner : messageSender;
  return {
    owner
  };
})(SenderInfo));

/***/ }),

/***/ "./src/components/mediaViewer/VideoPlayer.tsx":
/*!****************************************************!*\
  !*** ./src/components/mediaViewer/VideoPlayer.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _util_math__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/math */ "./src/util/math.ts");
/* harmony import */ var _util_safePlay__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/safePlay */ "./src/util/safePlay.ts");
/* harmony import */ var _util_stopEvent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/stopEvent */ "./src/util/stopEvent.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_media_useUnsupportedMedia__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/media/useUnsupportedMedia */ "./src/hooks/media/useUnsupportedMedia.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useBuffering__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useBuffering */ "./src/hooks/useBuffering.ts");
/* harmony import */ var _hooks_useCurrentTimeSignal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useCurrentTimeSignal */ "./src/hooks/useCurrentTimeSignal.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_usePictureInPicture__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/usePictureInPicture */ "./src/hooks/usePictureInPicture.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _hooks_useVideoCleanup__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../hooks/useVideoCleanup */ "./src/hooks/useVideoCleanup.ts");
/* harmony import */ var _hooks_window_useFullscreen__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../hooks/window/useFullscreen */ "./src/hooks/window/useFullscreen.ts");
/* harmony import */ var _hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./hooks/useControlsSignal */ "./src/components/mediaViewer/hooks/useControlsSignal.ts");
/* harmony import */ var _hooks_useVideoWaitingSignal__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./hooks/useVideoWaitingSignal */ "./src/components/mediaViewer/hooks/useVideoWaitingSignal.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ProgressSpinner__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../ui/ProgressSpinner */ "./src/components/ui/ProgressSpinner.tsx");
/* harmony import */ var _VideoPlayerControls__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./VideoPlayerControls */ "./src/components/mediaViewer/VideoPlayerControls.tsx");
/* harmony import */ var _VideoPlayer_scss__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./VideoPlayer.scss */ "./src/components/mediaViewer/VideoPlayer.scss");
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }






















const MAX_LOOP_DURATION = 30; // Seconds
const MIN_READY_STATE = 4;
const REWIND_STEP = 5; // Seconds

const VideoPlayer = ({
  url,
  isGif,
  posterData,
  posterSize,
  loadProgress,
  fileSize,
  isMediaViewerOpen,
  noPlay,
  volume,
  isMuted,
  playbackRate,
  onClose,
  isForceMobileVersion,
  shouldCloseOnClick,
  isProtected,
  isClickDisabled,
  isPreviewDisabled,
  isSponsoredMessage,
  handleSponsoredClick
}) => {
  const {
    setMediaViewerVolume,
    setMediaViewerMuted,
    setMediaViewerPlaybackRate,
    setMediaViewerHidden
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  // eslint-disable-next-line no-null/no-null
  const videoRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [isPlaying, setIsPlaying] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV || !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_IOS);
  const [isFullscreen, setFullscreen, exitFullscreen] = (0,_hooks_window_useFullscreen__WEBPACK_IMPORTED_MODULE_14__["default"])(videoRef, setIsPlaying);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const duration = videoRef.current?.duration || 0;
  const isLooped = isGif || duration <= MAX_LOOP_DURATION;
  const handleEnterFullscreen = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    // Yandex browser doesn't support PIP when video is hidden
    if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_YA_BROWSER) return;
    setMediaViewerHidden({
      isHidden: true
    });
  });
  const handleLeaveFullscreen = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_YA_BROWSER) return;
    setMediaViewerHidden({
      isHidden: false
    });
  });
  const [isPictureInPictureSupported, enterPictureInPicture, isInPictureInPicture] = (0,_hooks_usePictureInPicture__WEBPACK_IMPORTED_MODULE_11__["default"])(videoRef, handleEnterFullscreen, handleLeaveFullscreen);
  const [, toggleControls, lockControls] = (0,_hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_15__["default"])();
  const handleVideoMove = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    toggleControls(true);
  });
  const handleVideoLeave = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    const bounds = videoRef.current?.getBoundingClientRect();
    if (!bounds) return;
    if (e.clientX < bounds.left || e.clientX > bounds.right || e.clientY < bounds.top || e.clientY > bounds.bottom) {
      toggleControls(false);
    }
  });
  const {
    isReady,
    isBuffered,
    bufferedRanges,
    bufferingHandlers,
    bufferedProgress
  } = (0,_hooks_useBuffering__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const isUnsupported = (0,_hooks_media_useUnsupportedMedia__WEBPACK_IMPORTED_MODULE_6__["default"])(videoRef, undefined, !url);
  const {
    shouldRender: shouldRenderSpinner,
    transitionClassNames: spinnerClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_12__["default"])(!isBuffered && !isUnsupported, undefined, undefined, 'slow');
  const {
    shouldRender: shouldRenderPlayButton,
    transitionClassNames: playButtonClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_12__["default"])(_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_IOS && !isPlaying && !shouldRenderSpinner && !isUnsupported, undefined, undefined, 'slow');
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    lockControls(shouldRenderSpinner);
  }, [lockControls, shouldRenderSpinner]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (noPlay || !isMediaViewerOpen || isUnsupported) {
      videoRef.current.pause();
    } else if (url && !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV) {
      // Chrome does not automatically start playing when `url` becomes available (even with `autoPlay`),
      // so we force it here. Contrary, iOS does not allow to call `play` without mouse event,
      // so we need to use `autoPlay` instead to allow pre-buffering.
      (0,_util_safePlay__WEBPACK_IMPORTED_MODULE_3__["default"])(videoRef.current);
    }
  }, [noPlay, isMediaViewerOpen, url, setMediaViewerMuted, isUnsupported]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    videoRef.current.volume = volume;
  }, [volume]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    videoRef.current.playbackRate = playbackRate;
  }, [playbackRate]);
  const togglePlayState = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    e.stopPropagation();
    if (isPlaying) {
      videoRef.current.pause();
      setIsPlaying(false);
    } else {
      (0,_util_safePlay__WEBPACK_IMPORTED_MODULE_3__["default"])(videoRef.current);
      setIsPlaying(true);
    }
  });
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    if (isSponsoredMessage) {
      handleSponsoredClick?.(true);
      onClose(e);
    }
    if (isClickDisabled) {
      return;
    }
    if (shouldCloseOnClick) {
      onClose(e);
    } else {
      togglePlayState(e);
    }
  });
  (0,_hooks_useVideoCleanup__WEBPACK_IMPORTED_MODULE_13__["default"])(videoRef, bufferingHandlers);
  const [, setCurrentTime] = (0,_hooks_useCurrentTimeSignal__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [, setIsVideoWaiting] = (0,_hooks_useVideoWaitingSignal__WEBPACK_IMPORTED_MODULE_16__["default"])();
  const handleTimeUpdate = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    const video = e.currentTarget;
    if (video.readyState >= MIN_READY_STATE) {
      setIsVideoWaiting(false);
      setCurrentTime(video.currentTime);
    }
    if (!isLooped && video.currentTime === video.duration) {
      setCurrentTime(0);
      setIsPlaying(false);
    }
  });
  const handleEnded = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (isLooped) return;
    setCurrentTime(0);
    setIsPlaying(false);
    toggleControls(true);
  });
  const handleFullscreenChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (isFullscreen && exitFullscreen) {
      exitFullscreen();
    } else if (!isFullscreen && setFullscreen) {
      setFullscreen();
    }
  });
  const handleSeek = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(position => {
    videoRef.current.currentTime = position;
  });
  const handleVolumeChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(newVolume => {
    setMediaViewerVolume({
      volume: newVolume / 100
    });
  });
  const handleVolumeMuted = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    // Browser requires explicit user interaction to keep video playing after unmuting
    videoRef.current.muted = !videoRef.current.muted;
    setMediaViewerMuted({
      isMuted: !isMuted
    });
  });
  const handlePlaybackRateChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(newPlaybackRate => {
    setMediaViewerPlaybackRate({
      playbackRate: newPlaybackRate
    });
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isMediaViewerOpen) return undefined;
    const rewind = dir => {
      if (!isFullscreen) return;
      const video = videoRef.current;
      const newTime = (0,_util_math__WEBPACK_IMPORTED_MODULE_2__.clamp)(video.currentTime + dir * REWIND_STEP, 0, video.duration);
      if (Number.isFinite(newTime)) {
        video.currentTime = newTime;
      }
    };
    const handleKeyDown = e => {
      if (isInPictureInPicture) return;
      switch (e.key) {
        case ' ':
        case 'Enter':
          e.preventDefault();
          togglePlayState(e);
          break;
        case 'Left': // IE/Edge specific value
        case 'ArrowLeft':
          e.preventDefault();
          rewind(-1);
          break;
        case 'Right': // IE/Edge specific value
        case 'ArrowRight':
          e.preventDefault();
          rewind(1);
          break;
      }
    };
    document.addEventListener('keydown', handleKeyDown, false);
    return () => {
      document.removeEventListener('keydown', handleKeyDown, false);
    };
  }, [togglePlayState, isMediaViewerOpen, isFullscreen, isInPictureInPicture]);
  const wrapperStyle = posterSize && `width: ${posterSize.width}px; height: ${posterSize.height}px`;
  const videoStyle = `background-image: url(${posterData})`;
  const shouldToggleControls = !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV && !isForceMobileVersion;
  return (
    /*#__PURE__*/
    // eslint-disable-next-line jsx-a11y/mouse-events-have-key-events
    _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "VideoPlayer",
      onMouseMove: shouldToggleControls ? handleVideoMove : undefined,
      onMouseOut: shouldToggleControls ? handleVideoLeave : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      style: wrapperStyle
    }, isProtected && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      onContextMenu: _util_stopEvent__WEBPACK_IMPORTED_MODULE_4__["default"],
      onDoubleClick: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV ? handleFullscreenChange : undefined,
      onClick: !isMobile ? togglePlayState : undefined,
      className: "protector"
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("video", _extends({
      ref: videoRef,
      autoPlay: _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV,
      controlsList: "nodownload",
      playsInline: true,
      loop: isLooped
      // This is to force autoplaying on mobiles
      ,
      muted: isGif || isMuted,
      id: "media-viewer-video",
      style: videoStyle,
      onWaiting: () => setIsVideoWaiting(true),
      onPlay: () => setIsPlaying(true),
      onEnded: handleEnded,
      onClick: !isMobile && !isFullscreen ? handleClick : undefined,
      onDoubleClick: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV ? handleFullscreenChange : undefined
      // eslint-disable-next-line react/jsx-props-no-spreading
    }, bufferingHandlers, {
      onPause: e => {
        setIsPlaying(false);
        bufferingHandlers.onPause(e);
      },
      onTimeUpdate: handleTimeUpdate,
      src: url
    }))), shouldRenderPlayButton && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_18__["default"], {
      round: true,
      className: `play-button ${playButtonClassNames}`,
      onClick: togglePlayState
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_17__["default"], {
      name: "play"
    })), shouldRenderSpinner && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: ['spinner-container', spinnerClassNames].join(' ')
    }, !isBuffered && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "buffering"
    }, "Buffering..."), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ProgressSpinner__WEBPACK_IMPORTED_MODULE_19__["default"], {
      size: "xl",
      progress: isBuffered ? 1 : loadProgress,
      onClick: onClose
    })), !isGif && !isSponsoredMessage && !isUnsupported && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_VideoPlayerControls__WEBPACK_IMPORTED_MODULE_20__["default"], {
      url: url,
      isPlaying: isPlaying,
      bufferedRanges: bufferedRanges,
      bufferedProgress: bufferedProgress,
      isBuffered: isBuffered,
      isFullscreenSupported: Boolean(setFullscreen),
      isPictureInPictureSupported: isPictureInPictureSupported,
      isFullscreen: isFullscreen,
      isPreviewDisabled: isPreviewDisabled,
      fileSize: fileSize,
      duration: duration,
      isReady: isReady,
      posterSize: posterSize,
      isForceMobileVersion: isForceMobileVersion,
      onSeek: handleSeek,
      onChangeFullscreen: handleFullscreenChange,
      onPictureInPictureChange: enterPictureInPicture,
      onPlayPause: togglePlayState,
      volume: volume,
      playbackRate: playbackRate,
      isMuted: isMuted,
      onVolumeClick: handleVolumeMuted,
      onVolumeChange: handleVolumeChange,
      onPlaybackRateChange: handlePlaybackRateChange
    }))
  );
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(VideoPlayer));

/***/ }),

/***/ "./src/components/mediaViewer/VideoPlayerControls.tsx":
/*!************************************************************!*\
  !*** ./src/components/mediaViewer/VideoPlayerControls.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_textFormat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/textFormat */ "./src/util/textFormat.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useCurrentTimeSignal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useCurrentTimeSignal */ "./src/hooks/useCurrentTimeSignal.ts");
/* harmony import */ var _hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useDerivedState */ "./src/hooks/useDerivedState.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./hooks/useControlsSignal */ "./src/components/mediaViewer/hooks/useControlsSignal.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_RangeSlider__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/RangeSlider */ "./src/components/ui/RangeSlider.tsx");
/* harmony import */ var _SeekLine__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./SeekLine */ "./src/components/mediaViewer/SeekLine.tsx");
/* harmony import */ var _VideoPlayerControls_scss__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./VideoPlayerControls.scss */ "./src/components/mediaViewer/VideoPlayerControls.scss");



















const stopEvent = e => {
  e.stopPropagation();
};
const PLAYBACK_RATES = [0.5, 1, 1.5, 2];
const HIDE_CONTROLS_TIMEOUT_MS = 3000;
const VideoPlayerControls = ({
  url,
  bufferedRanges,
  bufferedProgress,
  duration,
  isReady,
  fileSize,
  isForceMobileVersion,
  isPlaying,
  isFullscreenSupported,
  isFullscreen,
  isBuffered,
  isPreviewDisabled,
  volume,
  isMuted,
  playbackRate,
  posterSize,
  onChangeFullscreen,
  onVolumeClick,
  onVolumeChange,
  onPlaybackRateChange,
  isPictureInPictureSupported,
  onPictureInPictureChange,
  onPlayPause,
  onSeek
}) => {
  const [isPlaybackMenuOpen, openPlaybackMenu, closePlaybackMenu] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [getCurrentTime] = (0,_hooks_useCurrentTimeSignal__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const currentTime = (0,_hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_7__["default"])(() => Math.trunc(getCurrentTime()), [getCurrentTime]);
  const [getIsSeeking, setIsSeeking] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)(false);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const [getIsVisible, setVisibility] = (0,_hooks_useControlsSignal__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const isVisible = (0,_hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_7__["default"])(getIsVisible);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_TOUCH_ENV && !isForceMobileVersion) return undefined;
    let timeout;
    if (!isVisible || !isPlaying || isPlaybackMenuOpen || getIsSeeking()) {
      if (timeout) window.clearTimeout(timeout);
      return undefined;
    }
    timeout = window.setTimeout(() => {
      setVisibility(false);
    }, HIDE_CONTROLS_TIMEOUT_MS);
    return () => {
      if (timeout) window.clearTimeout(timeout);
    };
  }, [isPlaying, isVisible, setVisibility, isPlaybackMenuOpen, getIsSeeking, isForceMobileVersion]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    if (isVisible) {
      document.body.classList.add('video-controls-visible');
    } else {
      document.body.classList.remove('video-controls-visible');
    }
    return () => {
      document.body.classList.remove('video-controls-visible');
    };
  }, [isVisible]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isVisible) {
      closePlaybackMenu();
    }
  }, [closePlaybackMenu, isVisible]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const handleSeek = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(position => {
    setIsSeeking(false);
    onSeek(position);
  });
  const handleSeekStart = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    setIsSeeking(true);
  });
  const volumeIcon = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (volume === 0 || isMuted) return 'muted';
    if (volume < 0.3) return 'volume-1';
    if (volume < 0.6) return 'volume-2';
    return 'volume-3';
  }, [volume, isMuted]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])('VideoPlayerControls', isForceMobileVersion && 'mobile', isVisible && 'active'),
    onClick: stopEvent
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SeekLine__WEBPACK_IMPORTED_MODULE_17__["default"], {
    url: url,
    duration: duration,
    isReady: isReady,
    isPlaying: isPlaying,
    isPreviewDisabled: isPreviewDisabled,
    posterSize: posterSize,
    bufferedRanges: bufferedRanges,
    playbackRate: playbackRate,
    onSeek: handleSeek,
    onSeekStart: handleSeekStart,
    isActive: isVisible
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    ariaLabel: lang('AccActionPlay'),
    size: "tiny",
    ripple: !isMobile,
    color: "translucent-white",
    className: "play",
    round: true,
    onClick: onPlayPause
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: isPlaying ? 'pause' : 'play'
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    ariaLabel: "Volume",
    size: "tiny",
    color: "translucent-white",
    className: "volume",
    round: true,
    onClick: onVolumeClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: volumeIcon
  })), !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_IOS && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RangeSlider__WEBPACK_IMPORTED_MODULE_16__["default"], {
    bold: true,
    className: "volume-slider",
    value: isMuted ? 0 : volume * 100,
    onChange: onVolumeChange
  }), renderTime(currentTime, duration), !isBuffered && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "player-file-size"
  }, `${(0,_util_textFormat__WEBPACK_IMPORTED_MODULE_3__.formatFileSize)(lang, fileSize * bufferedProgress)} / ${(0,_util_textFormat__WEBPACK_IMPORTED_MODULE_3__.formatFileSize)(lang, fileSize)}`), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "spacer"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    ariaLabel: "Playback rate",
    size: "tiny",
    color: "translucent-white",
    className: "playback-rate",
    round: true,
    onClick: openPlaybackMenu
  }, `${playbackRate}x`), isPictureInPictureSupported && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    ariaLabel: "Picture in picture",
    size: "tiny",
    color: "translucent-white",
    className: "fullscreen",
    round: true,
    onClick: onPictureInPictureChange
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "pip"
  })), isFullscreenSupported && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    ariaLabel: "Fullscreen",
    size: "tiny",
    color: "translucent-white",
    className: "fullscreen",
    round: true,
    onClick: onChangeFullscreen
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: isFullscreen ? 'smallscreen' : 'fullscreen'
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isOpen: isPlaybackMenuOpen,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])('playback-rate-menu', !isFullscreenSupported && 'no-fullscreen', !isPictureInPictureSupported && 'no-pip'),
    positionX: "right",
    positionY: "bottom",
    autoClose: true,
    onClose: closePlaybackMenu
  }, PLAYBACK_RATES.map(rate =>
  /*#__PURE__*/
  // eslint-disable-next-line react/jsx-no-bind
  _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    disabled: playbackRate === rate,
    onClick: () => onPlaybackRateChange(rate)
  }, `${rate}x`))));
};
function renderTime(currentTime, duration) {
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "player-time"
  }, `${(0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_2__.formatMediaDuration)(currentTime)} / ${(0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_2__.formatMediaDuration)(duration)}`);
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(VideoPlayerControls));

/***/ }),

/***/ "./src/components/mediaViewer/helpers/getViewableMedia.ts":
/*!****************************************************************!*\
  !*** ./src/components/mediaViewer/helpers/getViewableMedia.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ getViewableMedia),
/* harmony export */   getMediaViewerItem: () => (/* binding */ getMediaViewerItem)
/* harmony export */ });
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");

function getMediaViewerItem({
  message,
  avatarOwner,
  profilePhotos,
  standaloneMedia,
  mediaIndex,
  sponsoredMessage
}) {
  if (avatarOwner && profilePhotos) {
    return {
      type: 'avatar',
      avatarOwner,
      profilePhotos,
      mediaIndex: mediaIndex
    };
  }
  if (standaloneMedia) {
    return {
      type: 'standalone',
      media: standaloneMedia,
      mediaIndex: mediaIndex
    };
  }
  if (message) {
    return {
      type: 'message',
      message,
      mediaIndex
    };
  }
  if (sponsoredMessage) {
    return {
      type: 'sponsoredMessage',
      message: sponsoredMessage,
      mediaIndex
    };
  }
  return undefined;
}
function getViewableMedia(params) {
  if (!params) return undefined;
  if (params.type === 'standalone') {
    return {
      media: params.media[params.mediaIndex],
      isSingle: params.media.length === 1
    };
  }
  if (params.type === 'avatar') {
    const avatar = params.profilePhotos?.photos[params.mediaIndex];
    if (avatar) {
      return {
        media: avatar
      };
    }
    return undefined;
  }
  const {
    action,
    document,
    photo,
    video,
    webPage,
    paidMedia
  } = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_0__.getMessageContent)(params.message);
  if (action?.photo) {
    return {
      media: action.photo,
      isSingle: true
    };
  }
  if (document && ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_0__.isDocumentPhoto)(document) || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_0__.isDocumentVideo)(document))) {
    return {
      media: document
    };
  }
  if (webPage) {
    const {
      photo: webPagePhoto,
      video: webPageVideo,
      document: webPageDocument
    } = webPage;
    const isDocumentMedia = webPageDocument && ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_0__.isDocumentPhoto)(webPageDocument) || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_0__.isDocumentVideo)(webPageDocument));
    const mediaDocument = isDocumentMedia ? webPageDocument : undefined;
    const media = webPageVideo || mediaDocument || webPagePhoto;
    if (media) {
      return {
        media,
        isSingle: true
      };
    }
  }
  if (paidMedia) {
    const extendedMedia = paidMedia.extendedMedia[params.mediaIndex || 0];
    if (!('mediaType' in extendedMedia)) {
      const {
        photo: extendedPhoto,
        video: extendedVideo
      } = extendedMedia;
      return {
        media: extendedPhoto || extendedVideo
      };
    }
  }
  const media = video || photo;
  if (media) {
    return {
      media,
      isSingle: video?.isGif
    };
  }
  return undefined;
}

/***/ }),

/***/ "./src/components/mediaViewer/helpers/ghostAnimation.ts":
/*!**************************************************************!*\
  !*** ./src/components/mediaViewer/helpers/ghostAnimation.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   animateClosing: () => (/* binding */ animateClosing),
/* harmony export */   animateOpening: () => (/* binding */ animateOpening)
/* harmony export */ });
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_animation__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/animation */ "./src/util/animation.ts");
/* harmony import */ var _util_stopEvent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/stopEvent */ "./src/util/stopEvent.ts");
/* harmony import */ var _util_visibility_getOffsetToContainer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/visibility/getOffsetToContainer */ "./src/util/visibility/getOffsetToContainer.ts");
/* harmony import */ var _util_visibility_isElementInViewport__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/visibility/isElementInViewport */ "./src/util/visibility/isElementInViewport.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _util_windowSize__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../util/windowSize */ "./src/util/windowSize.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");











const ANIMATION_DURATION = 200;
function animateOpening(hasFooter, origin, bestImageData, dimensions, isVideo, message, mediaIndex) {
  const {
    mediaEl: fromImage
  } = getNodes(origin, message, mediaIndex);
  if (!fromImage) {
    return;
  }
  const {
    width: windowWidth
  } = _util_windowSize__WEBPACK_IMPORTED_MODULE_9__["default"].get();
  const {
    width: availableWidth,
    height: availableHeight
  } = (0,_common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__.getMediaViewerAvailableDimensions)(hasFooter, isVideo);
  const {
    width: toWidth,
    height: toHeight
  } = (0,_common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__.calculateDimensions)(availableWidth, availableHeight, dimensions.width, dimensions.height);
  const toLeft = (windowWidth - toWidth) / 2;
  const toTop = getTopOffset(hasFooter) + (availableHeight - toHeight) / 2;
  let {
    top: fromTop,
    left: fromLeft,
    width: fromWidth,
    height: fromHeight
  } = fromImage.getBoundingClientRect();
  if ([_types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SharedMedia, _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.Album, _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ScheduledAlbum, _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SearchResult].includes(origin)) {
    const uncovered = uncover(toWidth, toHeight, fromTop, fromLeft, fromWidth, fromHeight);
    fromTop = uncovered.top;
    fromLeft = uncovered.left;
    fromWidth = uncovered.width;
    fromHeight = uncovered.height;
  }
  const fromTranslateX = fromLeft + fromWidth / 2 - (toLeft + toWidth / 2);
  const fromTranslateY = fromTop + fromHeight / 2 - (toTop + toHeight / 2);
  const fromScaleX = fromWidth / toWidth;
  const fromScaleY = fromHeight / toHeight;
  (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
    const ghost = createGhost(bestImageData || fromImage);
    (0,_util_animation__WEBPACK_IMPORTED_MODULE_4__.applyStyles)(ghost, {
      top: `${toTop}px`,
      left: `${toLeft}px`,
      width: `${toWidth}px`,
      height: `${toHeight}px`,
      transform: `translate3d(${fromTranslateX}px, ${fromTranslateY}px, 0) scale(${fromScaleX}, ${fromScaleY})`
    });
    applyShape(ghost, origin);
    document.body.appendChild(ghost);
    document.body.classList.add('ghost-animating');
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
      ghost.style.transform = '';
      clearShape(ghost);
      setTimeout(() => {
        (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
          if (document.body.contains(ghost)) {
            document.body.removeChild(ghost);
          }
          document.body.classList.remove('ghost-animating');
        });
      }, ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_1__.ANIMATION_END_DELAY);
    });
  });
}
function animateClosing(origin, bestImageData, message, mediaIndex) {
  const {
    container,
    mediaEl: toImage
  } = getNodes(origin, message, mediaIndex);
  if (!toImage) {
    return;
  }
  const fromImage = document.getElementById('MediaViewer').querySelector('.MediaViewerSlide--active img, .MediaViewerSlide--active video');
  if (!fromImage) {
    return;
  }
  const {
    top: fromTop,
    left: fromLeft,
    width: fromWidth,
    height: fromHeight
  } = fromImage.getBoundingClientRect();
  const {
    top: targetTop,
    left: toLeft,
    width: toWidth,
    height: toHeight
  } = toImage.getBoundingClientRect();
  let toTop = targetTop;
  if (!(0,_util_visibility_isElementInViewport__WEBPACK_IMPORTED_MODULE_7__.isElementInViewport)(container)) {
    const {
      height: windowHeight
    } = _util_windowSize__WEBPACK_IMPORTED_MODULE_9__["default"].get();
    toTop = targetTop < fromTop ? -toHeight : windowHeight;
  }
  const fromTranslateX = fromLeft + fromWidth / 2 - (toLeft + toWidth / 2);
  const fromTranslateY = fromTop + fromHeight / 2 - (toTop + toHeight / 2);
  let fromScaleX = fromWidth / toWidth;
  let fromScaleY = fromHeight / toHeight;
  const shouldFadeOut = [_types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.Inline, _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ScheduledInline, _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.Album, _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ScheduledAlbum].includes(origin) && !isMessageImageFullyVisible(toImage);
  if ([_types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SharedMedia, _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.Album, _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ScheduledAlbum, _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SearchResult].includes(origin)) {
    if (fromScaleX > fromScaleY) {
      fromScaleX = fromScaleY;
    } else if (fromScaleY > fromScaleX) {
      fromScaleY = fromScaleX;
    }
  }
  const existingGhost = document.getElementsByClassName('ghost')[0];
  const ghost = existingGhost || createGhost(bestImageData || toImage, origin);
  let styles;
  if (existingGhost) {
    const {
      top,
      left,
      width,
      height
    } = existingGhost.getBoundingClientRect();
    const scaleX = width / toWidth;
    const scaleY = height / toHeight;
    styles = {
      transition: 'none',
      top: `${toTop}px`,
      left: `${toLeft}px`,
      transformOrigin: 'top left',
      transform: `translate3d(${left - toLeft}px, ${top - toTop}px, 0) scale(${scaleX}, ${scaleY})`,
      width: `${toWidth}px`,
      height: `${toHeight}px`
    };
  } else {
    styles = {
      top: `${toTop}px`,
      left: `${toLeft}px`,
      width: `${toWidth}px`,
      height: `${toHeight}px`,
      transform: `translate3d(${fromTranslateX}px, ${fromTranslateY}px, 0) scale(${fromScaleX}, ${fromScaleY})`
    };
  }
  (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
    (0,_util_animation__WEBPACK_IMPORTED_MODULE_4__.applyStyles)(ghost, styles);
    if (!existingGhost) document.body.appendChild(ghost);
    document.body.classList.add('ghost-animating');
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
      if (existingGhost) {
        existingGhost.style.transition = '';
      }
      ghost.style.transform = '';
      if (shouldFadeOut) {
        ghost.style.opacity = '0';
      }
      applyShape(ghost, origin);
      setTimeout(() => {
        (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
          if (document.body.contains(ghost)) {
            document.body.removeChild(ghost);
          }
          document.body.classList.remove('ghost-animating');
        });
      }, ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_1__.ANIMATION_END_DELAY);
    });
  });
}
function createGhost(source, origin) {
  const ghost = document.createElement('div');
  ghost.classList.add('ghost');
  const img = new Image();
  img.draggable = false;
  img.oncontextmenu = _util_stopEvent__WEBPACK_IMPORTED_MODULE_5__["default"];
  if (typeof source === 'string') {
    img.src = source;
  } else if (source instanceof HTMLVideoElement) {
    img.src = source.poster;
  } else {
    img.src = source.src;
  }
  ghost.appendChild(img);
  if (origin === _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ProfileAvatar || origin === _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SettingsAvatar) {
    ghost.classList.add('ProfileInfo');
    if (origin === _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SettingsAvatar) {
      ghost.classList.add('self');
    }
    const profileInfo = document.querySelector(origin === _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ProfileAvatar ? '#RightColumn .ProfileInfo .info' : '#Settings .ProfileInfo .info');
    if (profileInfo) {
      ghost.appendChild(profileInfo.cloneNode(true));
    }
  }
  return ghost;
}
function uncover(realWidth, realHeight, top, left, width, height) {
  if (realWidth === realHeight) {
    const size = Math.max(width, height) * (realWidth / realHeight);
    left -= (size - width) / 2;
    top -= (size - height) / 2;
    width = size;
    height = size;
  } else if (realWidth > realHeight) {
    const srcWidth = width;
    width = height * (realWidth / realHeight);
    left -= (width - srcWidth) / 2;
  } else if (realHeight > realWidth) {
    const srcHeight = height;
    height = width * (realHeight / realWidth);
    top -= (height - srcHeight) / 2;
  }
  return {
    top,
    left,
    width,
    height
  };
}
function isMessageImageFullyVisible(imageEl) {
  const messageListElement = document.querySelector('.Transition_slide-active > .MessageList');
  const {
    top
  } = (0,_util_visibility_getOffsetToContainer__WEBPACK_IMPORTED_MODULE_6__["default"])(imageEl, messageListElement);
  return top > messageListElement.scrollTop && top + imageEl.offsetHeight < messageListElement.scrollTop + messageListElement.offsetHeight;
}
function getTopOffset(hasFooter) {
  const mql = window.matchMedia(_common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__.MEDIA_VIEWER_MEDIA_QUERY);
  let topOffsetRem = 4.125;
  if (hasFooter && !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_8__.IS_TOUCH_ENV) {
    topOffsetRem += mql.matches ? 0.875 : 2.125;
  }
  return topOffsetRem * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__.REM;
}
function getNodes(origin, message, index) {
  let containerSelector;
  let mediaSelector;
  switch (origin) {
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.Album:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ScheduledAlbum:
      // eslint-disable-next-line max-len
      containerSelector = `.Transition_slide-active > .MessageList #album-media-${(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMessageHtmlId)(message.id, index)}`;
      mediaSelector = '.full-media';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.PreviewMedia:
      containerSelector = `#preview-media${index}`;
      mediaSelector = 'img';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SharedMedia:
      containerSelector = `#shared-media${(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMessageHtmlId)(message.id, index)}`;
      mediaSelector = 'img';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SearchResult:
      containerSelector = `#search-media${(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMessageHtmlId)(message.id, index)}`;
      mediaSelector = 'img';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.MiddleHeaderAvatar:
      containerSelector = '.MiddleHeader .Transition_slide-active .ChatInfo .Avatar';
      mediaSelector = '.avatar-media';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SettingsAvatar:
      containerSelector = '#Settings .ProfileInfo .Transition_slide-active .ProfilePhoto';
      mediaSelector = '.avatar-media';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ProfileAvatar:
      containerSelector = '#RightColumn .ProfileInfo .Transition_slide-active .ProfilePhoto';
      mediaSelector = '.avatar-media';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SuggestedAvatar:
      containerSelector = `.Transition_slide-active > .MessageList #${(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMessageHtmlId)(message.id, index)}`;
      mediaSelector = '.Avatar img';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.StarsTransaction:
      containerSelector = '.transaction-media-preview';
      mediaSelector = index === 0 ? `.stars-transaction-media-${index} :is(img, video)` : undefined;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SponsoredMessage:
      containerSelector = '.Transition_slide-active > .MessageList .sponsored-media-preview';
      mediaSelector = `${_config__WEBPACK_IMPORTED_MODULE_1__.MESSAGE_CONTENT_SELECTOR} .full-media,${_config__WEBPACK_IMPORTED_MODULE_1__.MESSAGE_CONTENT_SELECTOR} .thumbnail:not(.blurred-bg)`;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ScheduledInline:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.Inline:
    default:
      containerSelector = `.Transition_slide-active > .MessageList #${(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMessageHtmlId)(message.id, index)}`;
      mediaSelector = `${_config__WEBPACK_IMPORTED_MODULE_1__.MESSAGE_CONTENT_SELECTOR} .full-media,${_config__WEBPACK_IMPORTED_MODULE_1__.MESSAGE_CONTENT_SELECTOR} .thumbnail:not(.blurred-bg)`;
  }
  const container = document.querySelector(containerSelector);
  const mediaEls = mediaSelector ? container?.querySelectorAll(mediaSelector) : undefined;
  return {
    container,
    mediaEl: mediaEls?.[0]
  };
}
function applyShape(ghost, origin) {
  switch (origin) {
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.Album:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ScheduledAlbum:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.Inline:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ScheduledInline:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.StarsTransaction:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.PreviewMedia:
      ghost.classList.add('rounded-corners');
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SharedMedia:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SettingsAvatar:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.ProfileAvatar:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SearchResult:
      ghost.firstChild.style.objectFit = 'cover';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.MiddleHeaderAvatar:
    case _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SuggestedAvatar:
      ghost.classList.add('circle');
      if (origin === _types__WEBPACK_IMPORTED_MODULE_0__.MediaViewerOrigin.SuggestedAvatar) {
        ghost.classList.add('transition-circle');
      }
      break;
  }
}
function clearShape(ghost) {
  ghost.firstChild.style.objectFit = 'default';
  ghost.classList.remove('rounded-corners', 'circle');
}

/***/ }),

/***/ "./src/components/mediaViewer/hooks/useControlsSignal.ts":
/*!***************************************************************!*\
  !*** ./src/components/mediaViewer/hooks/useControlsSignal.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useControlsSignal)
/* harmony export */ });
/* harmony import */ var _util_signals__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../util/signals */ "./src/util/signals.ts");
/* harmony import */ var _hooks_useDerivedSignal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../hooks/useDerivedSignal */ "./src/hooks/useDerivedSignal.ts");


const [getControlsVisible, setControlsVisible] = (0,_util_signals__WEBPACK_IMPORTED_MODULE_0__.createSignal)(false);
const [getIsLocked, setIsLocked] = (0,_util_signals__WEBPACK_IMPORTED_MODULE_0__.createSignal)(false);
function useControlsSignal() {
  const getVisible = (0,_hooks_useDerivedSignal__WEBPACK_IMPORTED_MODULE_1__["default"])(() => getControlsVisible() && !getIsLocked(),
  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps
  [getControlsVisible, getIsLocked]);
  return [getVisible, setControlsVisible, setIsLocked];
}

/***/ }),

/***/ "./src/components/mediaViewer/hooks/useMediaProps.ts":
/*!***********************************************************!*\
  !*** ./src/components/mediaViewer/hooks/useMediaProps.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   useMediaProps: () => (/* binding */ useMediaProps)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useBlurSync__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useBlurSync */ "./src/hooks/useBlurSync.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useMediaWithLoadProgress__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useMediaWithLoadProgress */ "./src/hooks/useMediaWithLoadProgress.ts");








const FALLBACK_DIMENSIONS = _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.AVATAR_FULL_DIMENSIONS;
const useMediaProps = ({
  media,
  isAvatar,
  origin,
  delay
}) => {
  const isPhotoAvatar = isAvatar && media?.mediaType === 'photo' && !media.isVideo;
  const isVideoAvatar = isAvatar && media?.mediaType === 'photo' && media.isVideo;
  const isDocument = media?.mediaType === 'document';
  const isVideo = media?.mediaType === 'video' && !media.isRound || isDocument && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isDocumentVideo)(media);
  const isPhoto = media?.mediaType === 'photo' || isDocument && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isDocumentPhoto)(media);
  const isGif = media?.mediaType === 'video' && media.isGif;
  const isFromSharedMedia = origin === _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.SharedMedia;
  const isFromSearch = origin === _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.SearchResult;
  const getMediaOrAvatarHash = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => isFull => {
    if (!media) return undefined;
    if ((isPhotoAvatar || isVideoAvatar) && !isFull) {
      return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getProfilePhotoMediaHash)(media);
    }
    if (isVideoAvatar && isFull) {
      return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getVideoProfilePhotoMediaHash)(media);
    }
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMediaHash)(media, isFull ? 'full' : 'preview');
  }, [isVideoAvatar, isPhotoAvatar, media]);
  const pictogramBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_6__["default"])(media
  // Only use pictogram if it's already loaded
  && (isFromSharedMedia || isFromSearch || isDocument) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMediaHash)(media, 'pictogram'), undefined, _api_types__WEBPACK_IMPORTED_MODULE_1__.ApiMediaFormat.BlobUrl, delay);
  const previewMediaHash = getMediaOrAvatarHash();
  const previewBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_6__["default"])(previewMediaHash, undefined, _api_types__WEBPACK_IMPORTED_MODULE_1__.ApiMediaFormat.BlobUrl, delay);
  const {
    mediaData: fullMediaBlobUrl,
    loadProgress
  } = (0,_hooks_useMediaWithLoadProgress__WEBPACK_IMPORTED_MODULE_7__["default"])(getMediaOrAvatarHash(true), undefined, media && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMediaFormat)(media, 'full'), delay);
  const localBlobUrl = media && 'blobUrl' in media ? media.blobUrl : undefined;
  let bestImageData = !isVideo && (localBlobUrl || fullMediaBlobUrl) || previewBlobUrl || pictogramBlobUrl;
  const thumbDataUri = (0,_hooks_useBlurSync__WEBPACK_IMPORTED_MODULE_5__["default"])(!bestImageData && media && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMediaThumbUri)(media));
  if (!bestImageData && origin !== _types__WEBPACK_IMPORTED_MODULE_2__.MediaViewerOrigin.SearchResult) {
    bestImageData = thumbDataUri;
  }
  if (isVideoAvatar && previewBlobUrl) {
    bestImageData = previewBlobUrl;
  }
  const bestData = localBlobUrl || fullMediaBlobUrl || (!isVideoAvatar && !isVideo ? previewBlobUrl || pictogramBlobUrl || bestImageData : undefined);
  const mediaSize = media && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getMediaFileSize)(media);
  const isLocal = Boolean(localBlobUrl);
  const dimensions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (isAvatar) {
      return isVideoAvatar ? _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.VIDEO_AVATAR_FULL_DIMENSIONS : _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.AVATAR_FULL_DIMENSIONS;
    }
    if (isDocument) {
      return media.mediaSize;
    }
    if (isPhoto) {
      return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getPhotoFullDimensions)(media);
    }
    if (isVideo) {
      return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getVideoDimensions)(media);
    }
    return FALLBACK_DIMENSIONS;
  }, [isAvatar, isDocument, isPhoto, isVideo, isVideoAvatar, media]);
  return {
    getMediaHash: getMediaOrAvatarHash,
    media,
    isVideo,
    isPhoto,
    isGif,
    isDocument,
    bestImageData,
    bestData,
    dimensions,
    isFromSharedMedia,
    isVideoAvatar,
    isLocal,
    loadProgress,
    mediaSize
  };
};

/***/ }),

/***/ "./src/components/mediaViewer/hooks/useVideoWaitingSignal.ts":
/*!*******************************************************************!*\
  !*** ./src/components/mediaViewer/hooks/useVideoWaitingSignal.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useVideoWaitingSignal),
/* harmony export */   getIsVideoWaiting: () => (/* binding */ getIsVideoWaiting),
/* harmony export */   setIsVideoWaiting: () => (/* binding */ setIsVideoWaiting)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_signals__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/signals */ "./src/util/signals.ts");


const [getIsVideoWaiting, setIsVideoWaiting] = (0,_util_signals__WEBPACK_IMPORTED_MODULE_1__.createSignal)(false);
function useVideoWaitingSignal() {
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useUnmountCleanup)(() => {
    setIsVideoWaiting(false);
  });
  return [getIsVideoWaiting, setIsVideoWaiting];
}

/***/ }),

/***/ "./src/components/mediaViewer/hooks/useZoomChangeSignal.ts":
/*!*****************************************************************!*\
  !*** ./src/components/mediaViewer/hooks/useZoomChangeSignal.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useZoomChange)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_signals__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/signals */ "./src/util/signals.ts");


const [getZoomChange, setZoomChange] = (0,_util_signals__WEBPACK_IMPORTED_MODULE_1__.createSignal)(1);
function useZoomChange() {
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useUnmountCleanup)(() => {
    setZoomChange(1);
  });
  return [getZoomChange, setZoomChange];
}

/***/ }),

/***/ "./src/components/middle/ChatLanguageModal.tsx":
/*!*****************************************************!*\
  !*** ./src/components/middle/ChatLanguageModal.tsx ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ChatLanguageModal_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./ChatLanguageModal.module.scss */ "./src/components/middle/ChatLanguageModal.module.scss");












const ChatLanguageModal = ({
  isOpen,
  chatId,
  messageId,
  activeTranslationLanguage,
  currentLanguageCode
}) => {
  const {
    requestMessageTranslation,
    closeChatLanguageModal,
    setSettingOption,
    requestChatTranslation
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [search, setSearch] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const handleSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(langCode => {
    if (!chatId) return;
    if (messageId) {
      requestMessageTranslation({
        chatId,
        id: messageId,
        toLanguageCode: langCode
      });
    } else {
      setSettingOption({
        translationLanguage: langCode
      });
      requestChatTranslation({
        chatId,
        toLanguageCode: langCode
      });
    }
    closeChatLanguageModal();
  });
  const handleSearch = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(e => {
    setSearch(e.target.value);
  });
  const translateLanguages = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => _config__WEBPACK_IMPORTED_MODULE_2__.SUPPORTED_TRANSLATION_LANGUAGES.map(langCode => {
    const translatedNames = new Intl.DisplayNames([currentLanguageCode], {
      type: 'language'
    });
    const translatedName = translatedNames.of(langCode);
    const originalNames = new Intl.DisplayNames([langCode], {
      type: 'language'
    });
    const originalName = originalNames.of(langCode);
    return {
      langCode,
      translatedName,
      originalName
    };
  }), [currentLanguageCode]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) setSearch('');
  }, [isOpen]);
  const filteredDisplayedLanguages = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!search.trim()) {
      return translateLanguages;
    }
    return translateLanguages.filter(({
      langCode,
      translatedName,
      originalName
    }) => translatedName.toLowerCase().includes(search.toLowerCase()) || originalName.toLowerCase().includes(search.toLowerCase()) || langCode.toLowerCase().includes(search.toLowerCase()));
  }, [translateLanguages, search]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: _ChatLanguageModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].root,
    isSlim: true,
    isOpen: isOpen,
    hasCloseButton: true,
    title: lang('Language'),
    onClose: closeChatLanguageModal
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_8__["default"], {
    key: "search",
    value: search,
    onChange: handleSearch,
    placeholder: lang('Search'),
    teactExperimentControlled: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ChatLanguageModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].languages, 'custom-scroll')
  }, filteredDisplayedLanguages.map(({
    langCode,
    originalName,
    translatedName
  }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    key: langCode,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ChatLanguageModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].listItem, 'no-icon'),
    secondaryIcon: activeTranslationLanguage === langCode ? 'check' : undefined,
    disabled: activeTranslationLanguage === langCode,
    multiline: true,
    narrow: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleSelect(langCode)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('title', _ChatLanguageModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].title)
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__["default"])(originalName, ['highlight'], {
    highlight: search
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('subtitle', _ChatLanguageModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].subtitle)
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__["default"])(translatedName, ['highlight'], {
    highlight: search
  }))))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    chatId,
    messageId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).chatLanguageModal || {};
  const currentLanguageCode = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectLanguageCode)(global);
  const activeTranslationLanguage = chatId ? messageId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectRequestedMessageTranslationLanguage)(global, chatId, messageId) : (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectRequestedChatTranslationLanguage)(global, chatId) : undefined;
  return {
    chatId,
    messageId,
    activeTranslationLanguage,
    currentLanguageCode
  };
})(ChatLanguageModal)));

/***/ }),

/***/ "./src/components/middle/DeleteSelectedMessageModal.tsx":
/*!**************************************************************!*\
  !*** ./src/components/middle/DeleteSelectedMessageModal.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _right_hooks_useManagePermissions__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../right/hooks/useManagePermissions */ "./src/components/right/hooks/useManagePermissions.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_AvatarList__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../common/AvatarList */ "./src/components/common/AvatarList.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _main_PermissionCheckboxList__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../main/PermissionCheckboxList */ "./src/components/main/PermissionCheckboxList.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../ui/CheckboxGroup */ "./src/components/ui/CheckboxGroup.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./DeleteSelectedMessageModal.module.scss */ "./src/components/middle/DeleteSelectedMessageModal.module.scss");






















const DeleteSelectedMessageModal = ({
  chat,
  isChannel,
  isGroup,
  isSuperGroup,
  isOpen,
  isSchedule,
  currentUserId,
  selectedMessageIds,
  canDeleteForAll,
  contactName,
  willDeleteForCurrentUserOnly,
  willDeleteForAll,
  messageIds,
  onClose,
  adminMembersById,
  canBanUsers
}) => {
  const {
    deleteMessages,
    reportChannelSpam,
    deleteChatMember,
    deleteScheduledMessages,
    exitMessageSelectMode,
    updateChatMemberBannedRights
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const prevIsOpen = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_11__["default"])(isOpen);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const {
    permissions,
    havePermissionChanged,
    handlePermissionChange,
    resetPermissions
  } = (0,_right_hooks_useManagePermissions__WEBPACK_IMPORTED_MODULE_12__["default"])(chat?.defaultBannedRights);
  const [chosenDeleteOption, setChosenDeleteOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [chosenBanOption, setChosenBanOptions] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [chosenSpanOption, setChosenSpanOptions] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [isMediaDropdownOpen, setIsMediaDropdownOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isAdditionalOptionsVisible, setIsAdditionalOptionsVisible] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const senderList = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (isChannel) {
      return undefined;
    }
    const senderArray = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.getSendersFromSelectedMessages)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), chat);
    return senderArray?.filter(Boolean);
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps
  }, [chat, isChannel, isOpen]);
  const isSenderOwner = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!senderList) {
      return undefined;
    }
    return senderList.some(sender => sender && adminMembersById && adminMembersById[sender.id] && adminMembersById[sender.id].isOwner);
  }, [senderList, adminMembersById]);
  const userList = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    if (!senderList || isSchedule) return [];
    const uniqueUserIds = new Set(senderList.map(user => user.id));
    return Array.from(uniqueUserIds).map(id => usersById[id]).filter(Boolean);
  }, [isSchedule, senderList]);
  const nestedOptionsWithAvatarList = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    return userList.map(user => ({
      value: `${user.id}`,
      label: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(user) || '',
      leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_13__["default"], {
        size: "small",
        peer: user
      })
    }));
  });
  const showAdditionalOptions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return !userList.some(user => user.id === currentUserId);
  }, [userList, currentUserId]);
  const shouldShowOptions = showAdditionalOptions && !canDeleteForAll && !isSchedule && (isGroup || isSuperGroup);
  const userNames = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    if (!senderList || isSchedule) return {};
    const uniqueUserIds = new Set(senderList.map(user => user.id));
    const userIds = Array.from(uniqueUserIds).map(userId => usersById[userId]);
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_5__.buildCollectionByCallback)(userIds, user => [user?.id, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(user)]);
  }, [isSchedule, senderList]);
  const ACTION_SPAM_OPTION = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return [{
      value: selectedMessageIds && userList.length >= 2 ? 'spam' : userList?.[0]?.id,
      label: oldLang('ReportSpamTitle'),
      nestedOptions: selectedMessageIds && userList.length >= 2 ? [...nestedOptionsWithAvatarList()] : undefined
    }];
  }, [oldLang, selectedMessageIds, userList]);
  const ACTION_DELETE_OPTION = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return [{
      value: selectedMessageIds && userList.length >= 2 ? 'delete_all' : userList?.[0]?.id,
      label: selectedMessageIds && userList.length >= 2 ? oldLang('DeleteAllFromUsers') : oldLang('DeleteAllFrom', Object.values(userNames)[0]),
      nestedOptions: selectedMessageIds && userList.length >= 2 ? [...nestedOptionsWithAvatarList()] : undefined
    }];
  }, [oldLang, selectedMessageIds, userList, userNames]);
  const ACTION_BAN_OPTION = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return [{
      value: selectedMessageIds && userList.length >= 2 ? 'ban' : userList?.[0]?.id,
      label: selectedMessageIds && userList.length >= 2 ? isAdditionalOptionsVisible ? oldLang('DeleteRestrictUsers') : oldLang('DeleteBanUsers') : isAdditionalOptionsVisible ? oldLang('KickFromSupergroup') : oldLang('DeleteBan', Object.values(userNames)[0]),
      nestedOptions: selectedMessageIds && userList.length >= 2 ? [...nestedOptionsWithAvatarList()] : undefined
    }];
  }, [isAdditionalOptionsVisible, oldLang, selectedMessageIds, userList, userNames]);
  const toggleAdditionalOptions = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    setIsAdditionalOptionsVisible(prev => !prev);
  });
  const handleDeleteMessageForAll = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onClose();
    deleteMessages({
      messageIds: selectedMessageIds,
      shouldDeleteForAll: true
    });
  });
  const filterMessageIdByUserId = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])((userIds, selectedMessageIdList) => {
    if (!chat) return _util_memo__WEBPACK_IMPORTED_MODULE_6__.MEMO_EMPTY_ARRAY;
    return selectedMessageIdList.filter(msgId => {
      const sender = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSenderFromMessage)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), chat.id, msgId);
      return sender && userIds.includes(sender.id);
    });
  });
  const handleReportSpam = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(userMessagesMap => {
    Object.entries(userMessagesMap).forEach(([userId, messageIdList]) => {
      if (messageIdList.length) {
        reportChannelSpam({
          participantId: userId,
          chatId: chat.id,
          messageIds: messageIdList
        });
      }
    });
  });
  const handleDeleteMessages = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(filteredMessageIdList => {
    if (filteredMessageIdList && filteredMessageIdList.length) {
      deleteMessages({
        messageIds: filteredMessageIdList,
        shouldDeleteForAll: true
      });
    }
  });
  const handleDeleteMember = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(filteredUserIdList => {
    filteredUserIdList.forEach(userId => {
      deleteChatMember({
        chatId: chat.id,
        userId
      });
    });
  });
  const handleUpdateChatMemberBannedRights = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(filteredUserIdList => {
    filteredUserIdList.forEach(userId => {
      updateChatMemberBannedRights({
        chatId: chat.id,
        userId,
        bannedRights: permissions
      });
    });
  });
  const handleDeleteMessageForSelf = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    if (!chat) return;
    if (isSchedule) {
      deleteScheduledMessages({
        messageIds: selectedMessageIds
      });
    } else if (!isSenderOwner && shouldShowOptions) {
      if (chosenSpanOption) {
        const userIdList = chosenSpanOption.filter(option => !Number.isNaN(Number(option)));
        const userMessagesMap = selectedMessageIds.reduce((acc, msgId) => {
          const sender = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSenderFromMessage)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), chat.id, msgId);
          if (sender && userIdList.includes(sender.id)) {
            if (!acc[sender.id]) {
              acc[sender.id] = [];
            }
            acc[sender.id].push(Number(msgId));
          }
          return acc;
        }, {});
        handleReportSpam(userMessagesMap);
      }
      if (chosenDeleteOption) {
        const userIdList = chosenDeleteOption.filter(option => !Number.isNaN(Number(option)));
        const filteredMessageIdList = filterMessageIdByUserId(userIdList, messageIds);
        handleDeleteMessages(filteredMessageIdList);
      }
      if (chosenBanOption && !havePermissionChanged) {
        const userIdList = chosenBanOption.filter(option => !Number.isNaN(Number(option)));
        const filteredUserIdList = userIdList.filter(userId => selectedMessageIds?.some(msgId => {
          const sender = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSenderFromMessage)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), chat.id, msgId);
          return sender && sender.id === userId;
        }));
        handleDeleteMember(filteredUserIdList);
        const filteredMessageIdList = filterMessageIdByUserId(userIdList, selectedMessageIds);
        handleDeleteMessages(filteredMessageIdList);
      }
      if (chosenBanOption && havePermissionChanged) {
        const userIdList = chosenBanOption.filter(option => !Number.isNaN(Number(option)));
        const filteredUserIdList = userIdList.filter(userId => selectedMessageIds?.some(msgId => {
          const sender = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSenderFromMessage)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), chat.id, msgId);
          return sender && sender.id === userId;
        }));
        handleUpdateChatMemberBannedRights(filteredUserIdList);
      }
    } else {
      deleteMessages({
        messageIds: selectedMessageIds,
        shouldDeleteForAll: false
      });
    }
    onClose();
  });
  const onCloseHandler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    onClose();
  });
  const handleDeleteOptionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(options => {
    setChosenDeleteOption(options);
  });
  const handleBanOptionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(options => {
    setChosenBanOptions(options);
  });
  const handleSpanOptionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(options => {
    setChosenSpanOptions(options);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen && prevIsOpen) {
      exitMessageSelectMode();
      setChosenSpanOptions(undefined);
      setChosenDeleteOption(undefined);
      setChosenBanOptions(undefined);
      setIsMediaDropdownOpen(false);
      setIsAdditionalOptionsVisible(false);
      resetPermissions();
    }
  }, [exitMessageSelectMode, isOpen, prevIsOpen, resetPermissions]);
  function renderHeader() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: shouldShowOptions && _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].container,
      dir: oldLang.isRtl ? 'rtl' : undefined
    }, shouldShowOptions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AvatarList__WEBPACK_IMPORTED_MODULE_14__["default"], {
      size: "small",
      peers: userList
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(shouldShowOptions ? _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].title : _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].singleTitle)
    }, oldLang('Chat.DeleteMessagesConfirmation', selectedMessageIds?.length)));
  }
  function renderAdditionalActionOptions() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].options
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_18__["default"], {
      options: ACTION_SPAM_OPTION,
      onChange: handleSpanOptionChange,
      selected: chosenSpanOption,
      nestedCheckbox: selectedMessageIds && userList.length >= 2
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_18__["default"], {
      options: ACTION_DELETE_OPTION,
      onChange: handleDeleteOptionChange,
      selected: chosenDeleteOption,
      nestedCheckbox: selectedMessageIds && userList.length >= 2
    }), !isSenderOwner && canBanUsers && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_CheckboxGroup__WEBPACK_IMPORTED_MODULE_18__["default"], {
      options: ACTION_BAN_OPTION,
      onChange: handleBanOptionChange,
      selected: chosenBanOption,
      nestedCheckbox: selectedMessageIds && userList.length >= 2
    }));
  }
  function renderPartiallyRestrictedUser() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].restrictionContainer, isAdditionalOptionsVisible && _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].restrictionContainerOpen)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].actionTitle, _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].restrictionTitle)
    }, oldLang('UserRestrictionsCanDoUsers', userList.length)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_main_PermissionCheckboxList__WEBPACK_IMPORTED_MODULE_16__["default"], {
      withCheckbox: true,
      permissionGroup: true,
      chatId: chat?.id,
      isMediaDropdownOpen: isMediaDropdownOpen,
      setIsMediaDropdownOpen: setIsMediaDropdownOpen,
      handlePermissionChange: handlePermissionChange,
      permissions: permissions,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].dropdownList, isMediaDropdownOpen && _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].dropdownListOpen)
    }));
  }
  if (!selectedMessageIds) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_20__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    onEnter: canDeleteForAll ? undefined : handleDeleteMessageForSelf,
    className: "delete"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].main
  }, renderHeader(), !showAdditionalOptions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, lang('AreYouSureDeleteFewMessages')), shouldShowOptions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].actionTitle
  }, oldLang('DeleteAdditionalActions')), renderAdditionalActionOptions(), renderPartiallyRestrictedUser(), chosenBanOption && canBanUsers && chosenBanOption?.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_19__["default"], {
    narrow: true,
    className: _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].listItemButton,
    buttonClassName: _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].button,
    onClick: toggleAdditionalOptions
  }, oldLang(isAdditionalOptionsVisible ? 'DeleteToggleBanUsers' : 'DeleteToggleRestrictUsers'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: isAdditionalOptionsVisible ? 'up' : 'down',
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].button, 'ml-2')
  })) : setIsAdditionalOptionsVisible(false)), willDeleteForCurrentUserOnly && lang('DeleteForMeDescription'), willDeleteForAll && !showAdditionalOptions && lang('DeleteForEveryoneDescription'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: canDeleteForAll ? 'dialog-buttons-column' : (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('dialog-buttons', isAdditionalOptionsVisible && _DeleteSelectedMessageModal_module_scss__WEBPACK_IMPORTED_MODULE_21__["default"].dialogButtons)
  }, canDeleteForAll && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_17__["default"], {
    color: "danger",
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleDeleteMessageForAll
  }, contactName ? (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__["default"])(oldLang('ChatList.DeleteForEveryone', contactName)) : oldLang('Conversation.DeleteMessagesForEveryone')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_17__["default"], {
    color: "danger",
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleDeleteMessageForSelf
  }, oldLang(canDeleteForAll ? 'ChatList.DeleteForCurrentUser' : 'Delete')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_17__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onCloseHandler
  }, oldLang('Cancel')))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  isSchedule
}) => {
  const {
    messageIds: selectedMessageIds
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).selectedMessages || {};
  const {
    canDeleteForAll
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCanDeleteSelectedMessages)(global);
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentChat)(global);
  const chatFullInfo = chat && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chat.id);
  const {
    threadId,
    type
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentMessageList)(global) || {};
  const messageIds = chat && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentMessageIds)(global, chat.id, threadId, type);
  const isChannel = Boolean(chat) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatChannel)(chat);
  const isGroup = Boolean(chat) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatBasicGroup)(chat);
  const isSuperGroup = Boolean(chat) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatSuperGroup)(chat);
  const contactName = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(chat.id) ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFirstOrLastName)((0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getPrivateChatUserId)(chat))) : undefined;
  const adminMembersById = chatFullInfo?.adminMembersById;
  const canBanUsers = chat && (chat.isCreator || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getHasAdminRight)(chat, 'banUsers'));
  const willDeleteForCurrentUserOnly = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatBasicGroup)(chat) && !canDeleteForAll;
  const willDeleteForAll = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatSuperGroup)(chat);
  return {
    chat,
    isGroup,
    isChannel,
    isSuperGroup,
    selectedMessageIds,
    currentUserId: global.currentUserId,
    canDeleteForAll: !isSchedule && canDeleteForAll,
    contactName,
    willDeleteForCurrentUserOnly,
    willDeleteForAll,
    messageIds,
    adminMembersById,
    canBanUsers
  };
})(DeleteSelectedMessageModal)));

/***/ }),

/***/ "./src/components/middle/EmojiInteractionAnimation.tsx":
/*!*************************************************************!*\
  !*** ./src/components/middle/EmojiInteractionAnimation.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _common_AnimatedSticker__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common/AnimatedSticker */ "./src/components/common/AnimatedSticker.tsx");
/* harmony import */ var _EmojiInteractionAnimation_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./EmojiInteractionAnimation.scss */ "./src/components/middle/EmojiInteractionAnimation.scss");










const HIDE_ANIMATION_DURATION = 250;
const PLAYING_DURATION = 3000;
const EFFECT_SIZE = 309;
const EmojiInteractionAnimation = ({
  effectAnimationId,
  activeEmojiInteraction
}) => {
  const {
    stopActiveEmojiInteraction
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isHiding, startHiding] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])(false);
  const [isPlaying, startPlaying] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])(false);
  const timeoutRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const stop = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    startHiding();
    if (timeoutRef.current) {
      clearTimeout(timeoutRef.current);
    }
    setTimeout(() => {
      stopActiveEmojiInteraction({
        id: activeEmojiInteraction.id
      });
    }, HIDE_ANIMATION_DURATION);
  });
  const handleCancelAnimation = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(e => {
    if (!e.target?.closest('.AnimatedEmoji')) {
      stop();
    }
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    document.addEventListener('touchstart', handleCancelAnimation);
    document.addEventListener('touchmove', handleCancelAnimation);
    document.addEventListener('mousedown', handleCancelAnimation);
    document.addEventListener('wheel', handleCancelAnimation);
    return () => {
      document.removeEventListener('touchstart', handleCancelAnimation);
      document.removeEventListener('touchmove', handleCancelAnimation);
      document.removeEventListener('mousedown', handleCancelAnimation);
      document.removeEventListener('wheel', handleCancelAnimation);
    };
  }, [handleCancelAnimation]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    const endHeavyAnimation = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.beginHeavyAnimation)();
    timeoutRef.current = setTimeout(() => {
      stop();
      endHeavyAnimation();
    }, PLAYING_DURATION);
  }, [stop]);
  const effectHash = effectAnimationId && `sticker${effectAnimationId}`;
  const effectTgsUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_7__["default"])(effectHash, !effectAnimationId);
  if (!activeEmojiInteraction.startSize) {
    return undefined;
  }
  const scale = (activeEmojiInteraction.startSize || 0) / EFFECT_SIZE;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('EmojiInteractionAnimation', isHiding && 'hiding', isPlaying && 'playing', activeEmojiInteraction.isReversed && 'reversed'),
    style: `--scale: ${scale}; --start-x: ${activeEmojiInteraction.x}px; --start-y: ${activeEmojiInteraction.y}px;`
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedSticker__WEBPACK_IMPORTED_MODULE_8__["default"], {
    key: `effect_${effectAnimationId}`,
    size: EFFECT_SIZE,
    tgsUrl: effectTgsUrl,
    play: true,
    quality: _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_ANDROID ? 0.5 : undefined,
    forceAlways: true,
    noLoop: true,
    onLoad: startPlaying
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  activeEmojiInteraction
}) => {
  const animatedEffect = activeEmojiInteraction.animatedEffect !== undefined && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectAnimatedEmojiEffect)(global, activeEmojiInteraction.animatedEffect);
  return {
    effectAnimationId: animatedEffect ? animatedEffect.id : undefined
  };
})(EmojiInteractionAnimation)));

/***/ }),

/***/ "./src/components/middle/HeaderMenuContainer.tsx":
/*!*******************************************************!*\
  !*** ./src/components/middle/HeaderMenuContainer.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_scrollLock__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/scrollLock */ "./src/util/scrollLock.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePrevDuringAnimation__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/usePrevDuringAnimation */ "./src/hooks/usePrevDuringAnimation.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _common_DeleteChatModal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../common/DeleteChatModal */ "./src/components/common/DeleteChatModal.tsx");
/* harmony import */ var _left_MuteChatModal_async__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../left/MuteChatModal.async */ "./src/components/left/MuteChatModal.async.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_MenuSeparator__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/MenuSeparator */ "./src/components/ui/MenuSeparator.tsx");
/* harmony import */ var _ui_Portal__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../ui/Portal */ "./src/components/ui/Portal.ts");
/* harmony import */ var _HeaderMenuContainer_scss__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./HeaderMenuContainer.scss */ "./src/components/middle/HeaderMenuContainer.scss");



















const BOT_BUTTONS = {
  settings: {
    icon: 'bots',
    label: 'BotSettings'
  },
  help: {
    icon: 'help',
    label: 'BotHelp'
  }
};
const CLOSE_MENU_ANIMATION_DURATION = 200;
const HeaderMenuContainer = ({
  chatId,
  threadId,
  isOpen,
  withExtraActions,
  anchor,
  isChannel,
  botCommands,
  botPrivacyPolicyUrl,
  withForumActions,
  isTopic,
  isForum,
  isForumAsMessages,
  isChatInfoShown,
  canStartBot,
  canSubscribe,
  canReportChat,
  canSearch,
  canCall,
  canMute,
  canViewStatistics,
  canViewMonetization,
  canViewBoosts,
  pendingJoinRequests,
  canLeave,
  canEnterVoiceChat,
  canCreateVoiceChat,
  chat,
  isPrivate,
  isMuted,
  canDeleteChat,
  canGift,
  hasLinkedChat,
  canAddContact,
  canCreateTopic,
  canEditTopic,
  canManage,
  isRightColumnShown,
  canTranslate,
  isBlocked,
  isBot,
  isChatWithSelf,
  savedDialog,
  canShowBoostModal,
  onJoinRequestsClick,
  onSubscribeChannel,
  onSearchClick,
  onAsMessagesClick,
  onClose,
  onCloseAnimationEnd
}) => {
  const {
    updateChatMutedState,
    enterMessageSelectMode,
    sendBotCommand,
    restartBot,
    requestMasterAndJoinGroupCall,
    createGroupCall,
    openLinkedChat,
    openAddContactDialog,
    requestMasterAndRequestCall,
    toggleStatistics,
    openMonetizationStatistics,
    openBoostStatistics,
    openGiftModal,
    openThreadWithInfo,
    openCreateTopicPanel,
    openEditTopicPanel,
    openChat,
    openUrl,
    toggleManagement,
    togglePeerTranslations,
    blockUser,
    unblockUser,
    setViewForumAsMessages,
    openBoostModal,
    reportMessages
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [isMenuOpen, setIsMenuOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [shouldCloseFast, setShouldCloseFast] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isDeleteModalOpen, setIsDeleteModalOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isMuteModalOpen, setIsMuteModalOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [shouldRenderMuteModal, markRenderMuteModal, unmarkRenderMuteModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const {
    x,
    y
  } = anchor;
  (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_11__["default"])(isOpen, onCloseAnimationEnd, undefined, false);
  const isViewGroupInfoShown = (0,_hooks_usePrevDuringAnimation__WEBPACK_IMPORTED_MODULE_10__["default"])(!isChatInfoShown && isForum ? true : undefined, CLOSE_MENU_ANIMATION_DURATION);
  const closeMuteModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    setIsMuteModalOpen(false);
    onClose();
  });
  const handleReport = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    setIsMenuOpen(false);
    reportMessages({
      chatId,
      messageIds: []
    });
    onClose();
  });
  const handleDelete = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    setIsMenuOpen(false);
    setIsDeleteModalOpen(true);
  });
  const closeMenu = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    setIsMenuOpen(false);
    onClose();
  });
  const handleViewGroupInfo = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    openThreadWithInfo({
      chatId,
      threadId
    });
    setShouldCloseFast(!isRightColumnShown);
    closeMenu();
  });
  const closeDeleteModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    setIsDeleteModalOpen(false);
    onClose();
  });
  const handleStartBot = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    sendBotCommand({
      command: '/start'
    });
  });
  const handleRestartBot = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    restartBot({
      chatId
    });
  });
  const handleUnmuteClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    updateChatMutedState({
      chatId,
      isMuted: false
    });
    closeMenu();
  });
  const handleMuteClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    markRenderMuteModal();
    setIsMuteModalOpen(true);
    setIsMenuOpen(false);
  });
  const handleCreateTopicClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    openCreateTopicPanel({
      chatId
    });
    setShouldCloseFast(!isRightColumnShown);
    closeMenu();
  });
  const handleEditClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    toggleManagement({
      force: true
    });
    setShouldCloseFast(!isRightColumnShown);
    closeMenu();
  });
  const handleEditTopicClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    openEditTopicPanel({
      chatId,
      topicId: Number(threadId)
    });
    setShouldCloseFast(!isRightColumnShown);
    closeMenu();
  });
  const handleViewAsTopicsClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    openChat({
      id: undefined
    });
    setViewForumAsMessages({
      chatId,
      isEnabled: false
    });
    closeMenu();
  });
  const handleEnterVoiceChatClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    if (canCreateVoiceChat) {
      // TODO Show popup to schedule
      createGroupCall({
        chatId
      });
    } else {
      requestMasterAndJoinGroupCall({
        chatId
      });
    }
    closeMenu();
  });
  const handleLinkedChatClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    openLinkedChat({
      id: chatId
    });
    closeMenu();
  });
  const handleGiftClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    openGiftModal({
      forUserId: chatId
    });
    closeMenu();
  });
  const handleAddContactClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    openAddContactDialog({
      userId: chatId
    });
    closeMenu();
  });
  const handleSubscribe = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    onSubscribeChannel();
    closeMenu();
  });
  const handleVideoCall = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    requestMasterAndRequestCall({
      userId: chatId,
      isVideo: true
    });
    closeMenu();
  });
  const handleCall = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    requestMasterAndRequestCall({
      userId: chatId
    });
    closeMenu();
  });
  const handleSearch = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    onSearchClick();
    closeMenu();
  });
  const handleStatisticsClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    toggleStatistics();
    setShouldCloseFast(!isRightColumnShown);
    closeMenu();
  });
  const handleMonetizationClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    openMonetizationStatistics({
      chatId
    });
    setShouldCloseFast(!isRightColumnShown);
    closeMenu();
  });
  const handleBoostClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    if (canViewBoosts) {
      openBoostStatistics({
        chatId
      });
      setShouldCloseFast(!isRightColumnShown);
    } else {
      openBoostModal({
        chatId
      });
    }
    closeMenu();
  });
  const handleEnableTranslations = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    togglePeerTranslations({
      chatId,
      isEnabled: true
    });
    closeMenu();
  });
  const handleSelectMessages = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    enterMessageSelectMode();
    closeMenu();
  });
  const handleOpenAsMessages = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    onAsMessagesClick();
    closeMenu();
  });
  const handleBlock = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    blockUser({
      userId: chatId
    });
    closeMenu();
  });
  const handleUnblock = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    unblockUser({
      userId: chatId
    });
    closeMenu();
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(_util_scrollLock__WEBPACK_IMPORTED_MODULE_5__.disableScrolling, []);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const botButtons = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const commandButtons = botCommands?.map(({
      command
    }) => {
      const cmd = BOT_BUTTONS[command];
      if (!cmd) return undefined;
      const handleClick = () => {
        sendBotCommand({
          command: `/${command}`
        });
        closeMenu();
      };
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
        key: command,
        icon: cmd.icon
        // eslint-disable-next-line react/jsx-no-bind
        ,
        onClick: handleClick
      }, lang(cmd.label));
    });
    const hasPrivacyCommand = botCommands?.some(({
      command
    }) => command === 'privacy');
    const privacyButton = isBot && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
      icon: "privacy-policy"
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => {
        if (hasPrivacyCommand && !botPrivacyPolicyUrl) {
          sendBotCommand({
            command: '/privacy'
          });
        } else {
          openUrl({
            url: botPrivacyPolicyUrl || lang('BotDefaultPrivacyPolicy')
          });
        }
        closeMenu();
      }
    }, lang('BotPrivacyPolicy'));
    return [...(commandButtons || []), privacyButton].filter(Boolean);
  }, [botCommands, lang, botPrivacyPolicyUrl, isBot]);
  const deleteTitle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!chat) return undefined;
    if (savedDialog) {
      return lang('Delete');
    }
    if (isPrivate) {
      return lang('DeleteChatUser');
    }
    if (canDeleteChat) {
      return lang('GroupInfo.DeleteAndExit');
    }
    if (isChannel) {
      return lang('LeaveChannel');
    }
    return lang('Group.LeaveGroup');
  }, [canDeleteChat, chat, isChannel, isPrivate, savedDialog, lang]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Portal__WEBPACK_IMPORTED_MODULE_17__["default"], null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "HeaderMenuContainer"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isOpen: isMenuOpen,
    positionX: "right",
    style: `left: ${x}px;top: ${y}px;`,
    onClose: closeMenu,
    shouldCloseFast: shouldCloseFast
  }, isMobile && canSearch && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "search",
    onClick: handleSearch
  }, lang('Search')), withForumActions && canCreateTopic && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "comments",
    onClick: handleCreateTopicClick
  }, lang('lng_forum_create_topic')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuSeparator__WEBPACK_IMPORTED_MODULE_16__["default"], null)), isViewGroupInfoShown && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "info",
    onClick: handleViewGroupInfo
  }, isTopic ? lang('lng_context_view_topic') : lang('lng_context_view_group')), canManage && !canEditTopic && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "edit",
    onClick: handleEditClick
  }, lang('Edit')), canEditTopic && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "edit",
    onClick: handleEditTopicClick
  }, lang('lng_forum_topic_edit')), isMobile && !withForumActions && isForum && !isTopic && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "forums",
    onClick: handleViewAsTopicsClick
  }, lang('Chat.ContextViewAsTopics')), withForumActions && Boolean(pendingJoinRequests) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "user",
    onClick: onJoinRequestsClick
  }, isChannel ? lang('SubscribeRequests') : lang('MemberRequests'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "right-badge"
  }, pendingJoinRequests)), withForumActions && !isTopic && !isForumAsMessages && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "message",
    onClick: handleOpenAsMessages
  }, lang('lng_forum_view_as_messages')), withExtraActions && canStartBot && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "bots",
    onClick: handleStartBot
  }, lang('BotStart')), withExtraActions && canSubscribe && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: isChannel ? 'channel' : 'group',
    onClick: handleSubscribe
  }, lang(isChannel ? 'ProfileJoinChannel' : 'ProfileJoinGroup')), canShowBoostModal && !canViewBoosts && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "boost-outline",
    onClick: handleBoostClick
  }, lang(isChannel ? 'BoostingBoostChannelMenu' : 'BoostingBoostGroupMenu')), canAddContact && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "add-user",
    onClick: handleAddContactClick
  }, lang('AddContact')), isMobile && canCall && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "phone",
    onClick: handleCall
  }, lang('Call')), canCall && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "video-outlined",
    onClick: handleVideoCall
  }, lang('VideoCall')), canMute && (isMuted ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "unmute",
    onClick: handleUnmuteClick
  }, lang('ChatsUnmute')) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "mute",
    onClick: handleMuteClick
  }, lang('ChatsMute'), "...")), (canEnterVoiceChat || canCreateVoiceChat) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "voice-chat",
    onClick: handleEnterVoiceChatClick
  }, lang(canCreateVoiceChat ? 'StartVoipChat' : 'VoipGroupJoinCall')), hasLinkedChat && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: isChannel ? 'comments' : 'channel',
    onClick: handleLinkedChatClick
  }, lang(isChannel ? 'ViewDiscussion' : 'lng_profile_view_channel')), !withForumActions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "select",
    onClick: handleSelectMessages
  }, lang('ReportSelectMessages')), canViewBoosts && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "boost-outline",
    onClick: handleBoostClick
  }, lang('Boosts')), canViewStatistics && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "stats",
    onClick: handleStatisticsClick
  }, lang('Statistics')), isChannel && canViewMonetization && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "cash-circle",
    onClick: handleMonetizationClick
  }, lang('lng_channel_earn_title')), canTranslate && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "language",
    onClick: handleEnableTranslations
  }, lang('lng_context_translate')), canReportChat && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "flag",
    onClick: handleReport
  }, lang('ReportPeer.Report')), botButtons, canGift && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "gift",
    onClick: handleGiftClick
  }, lang('ProfileSendAGift')), isBot && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: isBlocked ? 'bots' : 'hand-stop',
    onClick: isBlocked ? handleRestartBot : handleBlock
  }, isBlocked ? lang('BotRestart') : lang('Bot.Stop')), isPrivate && !isChatWithSelf && !isBot && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: isBlocked ? 'user' : 'hand-stop',
    onClick: isBlocked ? handleUnblock : handleBlock
  }, isBlocked ? lang('Unblock') : lang('BlockUser')), canLeave && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuSeparator__WEBPACK_IMPORTED_MODULE_16__["default"], null), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    destructive: true,
    icon: "delete",
    onClick: handleDelete
  }, deleteTitle))), chat && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_DeleteChatModal__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isOpen: isDeleteModalOpen,
    onClose: closeDeleteModal,
    chat: savedDialog || chat,
    isSavedDialog: Boolean(savedDialog)
  }), canMute && shouldRenderMuteModal && chat?.id && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_left_MuteChatModal_async__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isMuteModalOpen,
    onClose: closeMuteModal,
    onCloseAnimationEnd: unmarkRenderMuteModal,
    chatId: chat.id
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId,
  threadId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  if (!chat || chat.isRestricted) {
    return {};
  }
  const isPrivate = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserId)(chat.id);
  const user = isPrivate ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectUser)(global, chatId) : undefined;
  const canAddContact = user && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getCanAddContact)(user);
  const isMainThread = threadId === _api_types__WEBPACK_IMPORTED_MODULE_2__.MAIN_THREAD_ID;
  const isChatWithSelf = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsChatWithSelf)(global, chatId);
  const {
    chatId: currentChatId,
    threadId: currentThreadId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCurrentMessageList)(global) || {};
  const canReportChat = isMainThread && !user && ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatChannel)(chat) || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatGroup)(chat));
  const chatBot = !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSystemBot)(chatId) ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectBot)(global, chatId) : undefined;
  const userFullInfo = isPrivate ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectUserFullInfo)(global, chatId) : undefined;
  const chatFullInfo = !isPrivate ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId) : undefined;
  const fullInfo = userFullInfo || chatFullInfo;
  const canGift = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCanGift)(global, chatId);
  const topic = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTopic)(global, chatId, threadId);
  const canCreateTopic = chat.isForum && (chat.isCreator || !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserRightBanned)(chat, 'manageTopics') || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getHasAdminRight)(chat, 'manageTopics'));
  const canEditTopic = topic && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getCanManageTopic)(chat, topic);
  const canManage = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCanManage)(global, chatId);
  // Context menu item should only be displayed if user hid translation panel
  const canTranslate = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCanTranslateChat)(global, chatId) && fullInfo?.isTranslationDisabled;
  const isSavedDialog = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getIsSavedDialog)(chatId, threadId, global.currentUserId);
  const savedDialog = isSavedDialog ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, String(threadId)) : undefined;
  return {
    chat,
    isMuted: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.selectIsChatMuted)(chat, (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectNotifySettings)(global), (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectNotifyExceptions)(global)),
    isPrivate,
    isTopic: chat?.isForum && !isMainThread,
    isForum: chat?.isForum,
    isForumAsMessages: chat?.isForumAsMessages,
    canAddContact,
    canDeleteChat: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getCanDeleteChat)(chat),
    canReportChat,
    canGift,
    hasLinkedChat: Boolean(chatFullInfo?.linkedChatId),
    botCommands: chatBot ? userFullInfo?.botInfo?.commands : undefined,
    botPrivacyPolicyUrl: chatBot ? userFullInfo?.botInfo?.privacyPolicyUrl : undefined,
    isChatInfoShown: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global).isChatInfoShown && currentChatId === chatId && currentThreadId === threadId,
    canCreateTopic,
    canEditTopic,
    canManage,
    isRightColumnShown: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsRightColumnShown)(global),
    canTranslate,
    isBlocked: userFullInfo?.isBlocked,
    isBot: Boolean(chatBot),
    isChatWithSelf,
    savedDialog
  };
})(HeaderMenuContainer)));

/***/ }),

/***/ "./src/components/middle/MessageSelectToolbar.tsx":
/*!********************************************************!*\
  !*** ./src/components/middle/MessageSelectToolbar.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureKeyboardListeners__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/captureKeyboardListeners */ "./src/util/captureKeyboardListeners.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_useCopySelectedMessages__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./hooks/useCopySelectedMessages */ "./src/components/middle/hooks/useCopySelectedMessages.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _DeleteSelectedMessageModal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./DeleteSelectedMessageModal */ "./src/components/middle/DeleteSelectedMessageModal.tsx");
/* harmony import */ var _MessageSelectToolbar_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./MessageSelectToolbar.scss */ "./src/components/middle/MessageSelectToolbar.scss");














const MessageSelectToolbar = ({
  chat,
  canPost,
  isActive,
  messageListType,
  isSchedule,
  selectedMessagesCount,
  canDeleteMessages,
  canReportMessages,
  canDownloadMessages,
  canForwardMessages,
  hasProtectedMessage,
  isAnyModalOpen,
  selectedMessageIds
}) => {
  const {
    exitMessageSelectMode,
    openForwardMenuForSelectedMessages,
    downloadSelectedMessages,
    copySelectedMessages,
    showNotification,
    reportMessages
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [isDeleteModalOpen, openDeleteModal, closeDeleteModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])();
  (0,_hooks_useCopySelectedMessages__WEBPACK_IMPORTED_MODULE_9__["default"])(isActive);
  const handleExitMessageSelectMode = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    exitMessageSelectMode();
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    return isActive && !isDeleteModalOpen && !isAnyModalOpen ? (0,_util_captureKeyboardListeners__WEBPACK_IMPORTED_MODULE_4__["default"])({
      onBackspace: canDeleteMessages ? openDeleteModal : undefined,
      onDelete: canDeleteMessages ? openDeleteModal : undefined,
      onEsc: handleExitMessageSelectMode
    }) : undefined;
  }, [isActive, isDeleteModalOpen, openDeleteModal, handleExitMessageSelectMode, isAnyModalOpen, canDeleteMessages]);
  const handleCopy = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    copySelectedMessages();
    showNotification({
      message: lang('Share.Link.Copied')
    });
    exitMessageSelectMode();
  });
  const handleDownload = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    downloadSelectedMessages();
    exitMessageSelectMode();
  });
  const prevSelectedMessagesCount = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_8__["default"])(selectedMessagesCount || undefined, true);
  const renderingSelectedMessagesCount = isActive ? selectedMessagesCount : prevSelectedMessagesCount;
  const formattedMessagesCount = lang('VoiceOver.Chat.MessagesSelected', renderingSelectedMessagesCount, 'i');
  const openMessageReport = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    if (!selectedMessageIds || !chat) return;
    reportMessages({
      chatId: chat.id,
      messageIds: selectedMessageIds
    });
    exitMessageSelectMode();
  });
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('MessageSelectToolbar', canPost && 'with-composer', isActive && 'shown');
  const renderButton = (icon, label, onClick, destructive) => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      role: "button",
      tabIndex: 0,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('div-button', 'item', destructive && 'destructive'),
      onClick: onClick,
      title: label,
      "aria-label": label
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__["default"], {
      name: icon
    }));
  };
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: className
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "MessageSelectToolbar-inner"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_11__["default"], {
    color: "translucent",
    round: true,
    onClick: handleExitMessageSelectMode,
    ariaLabel: "Exit select mode"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "MessageSelectToolbar-count",
    title: formattedMessagesCount
  }, formattedMessagesCount), Boolean(selectedMessagesCount) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "MessageSelectToolbar-actions"
  }, messageListType !== 'scheduled' && canForwardMessages && renderButton('forward', lang('Chat.ForwardActionHeader'), openForwardMenuForSelectedMessages), canReportMessages && renderButton('flag', lang('Conversation.ReportMessages'), openMessageReport), canDownloadMessages && !hasProtectedMessage && renderButton('download', lang('lng_media_download'), handleDownload), !hasProtectedMessage && renderButton('copy', lang('lng_context_copy_selected_items'), handleCopy), canDeleteMessages && renderButton('delete', lang('EditAdminGroupDeleteMessages'), openDeleteModal, true))), canDeleteMessages && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_DeleteSelectedMessageModal__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isOpen: isDeleteModalOpen,
    isSchedule: isSchedule,
    onClose: closeDeleteModal
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const tabState = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global);
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCurrentChat)(global);
  const {
    type: messageListType,
    chatId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCurrentMessageList)(global) || {};
  const isSchedule = messageListType === 'scheduled';
  const {
    canDelete
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCanDeleteSelectedMessages)(global);
  const canReport = Boolean(!isSchedule && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCanReportSelectedMessages)(global));
  const canDownload = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCanDownloadSelectedMessages)(global);
  const {
    messageIds: selectedMessageIds
  } = tabState.selectedMessages || {};
  const hasProtectedMessage = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectHasProtectedMessage)(global, chatId, selectedMessageIds) : false;
  const canForward = !isSchedule && chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCanForwardMessages)(global, chatId, selectedMessageIds) : false;
  const isShareMessageModalOpen = tabState.isShareMessageModalShown;
  const isAnyModalOpen = Boolean(isShareMessageModalOpen || tabState.requestedDraft || tabState.requestedAttachBotInChat || tabState.requestedAttachBotInstall || tabState.reportModal);
  return {
    chat,
    isSchedule,
    selectedMessagesCount: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectSelectedMessagesCount)(global),
    canDeleteMessages: canDelete,
    canReportMessages: canReport,
    canDownloadMessages: canDownload,
    canForwardMessages: canForward,
    selectedMessageIds,
    hasProtectedMessage,
    isAnyModalOpen
  };
})(MessageSelectToolbar)));

/***/ }),

/***/ "./src/components/middle/ReactorListModal.tsx":
/*!****************************************************!*\
  !*** ./src/components/middle/ReactorListModal.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_textFormat__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../util/textFormat */ "./src/util/textFormat.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useInfiniteScroll */ "./src/hooks/useInfiniteScroll.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_FullNameTitle__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../common/FullNameTitle */ "./src/components/common/FullNameTitle.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../common/reactions/ReactionStaticEmoji */ "./src/components/common/reactions/ReactionStaticEmoji.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ReactorListModal_scss__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./ReactorListModal.scss */ "./src/components/middle/ReactorListModal.scss");
























const MIN_REACTIONS_COUNT_FOR_FILTERS = 10;
const ReactorListModal = ({
  isOpen,
  reactors,
  reactions,
  chatId,
  messageId,
  seenByDates,
  availableReactions
}) => {
  const {
    loadReactors,
    closeReactorListModal,
    openChat
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // No need for expensive global updates on chats or users, so we avoid them
  const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
  const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const [isClosing, startClosing, stopClosing] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])(false);
  const [chosenTab, setChosenTab] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const canShowFilters = reactors && reactions && reactors.count >= MIN_REACTIONS_COUNT_FOR_FILTERS && reactions.results.length > 1;
  const chatIdRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && !isClosing) {
      chatIdRef.current = undefined;
    }
    if (isClosing && !isOpen) {
      stopClosing();
      setChosenTab(undefined);
    }
  }, [isClosing, isOpen, stopClosing]);
  const handleCloseAnimationEnd = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    if (chatIdRef.current) {
      openChat({
        id: chatIdRef.current
      });
    }
    closeReactorListModal();
  });
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    startClosing();
  });
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(userId => {
    chatIdRef.current = userId;
    handleClose();
  });
  const handleLoadMore = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    loadReactors({
      chatId: chatId,
      messageId: messageId
    });
  });
  const allReactions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const uniqueReactions = [];
    reactors?.reactions?.forEach(({
      reaction
    }) => {
      if (!uniqueReactions.some(r => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(r, reaction))) {
        uniqueReactions.push(reaction);
      }
    });
    return uniqueReactions;
  }, [reactors]);
  const peerIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (chosenTab) {
      return reactors?.reactions.filter(({
        reaction
      }) => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(reaction, chosenTab)).map(({
        peerId
      }) => peerId);
    }
    const seenByUserIds = Object.keys(seenByDates || {});
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_7__.unique)(reactors?.reactions.map(({
      peerId
    }) => peerId).concat(seenByUserIds || []) || []);
  }, [chosenTab, reactors, seenByDates]);
  const [viewportIds, getMore] = (0,_hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_10__["default"])(handleLoadMore, peerIds, reactors && reactors.nextOffset === undefined);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    getMore?.({
      direction: _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards
    });
  }, [getMore]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_22__["default"], {
    isOpen: isOpen && !isClosing,
    onClose: handleClose,
    className: "ReactorListModal narrow",
    title: lang('Reactions'),
    onCloseAnimationEnd: handleCloseAnimationEnd
  }, canShowFilters && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Reactions",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_18__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(!chosenTab && 'chosen'),
    size: "tiny",
    ripple: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => setChosenTab(undefined)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: "heart"
  }), Boolean(reactors?.count) && (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_8__.formatIntegerCompact)(reactors.count)), allReactions.map(reaction => {
    const count = reactions?.results.find(reactionsCount => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(reactionsCount.reaction, reaction))?.count;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_18__["default"], {
      key: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getReactionKey)(reaction),
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(chosenTab, reaction) && 'chosen'),
      size: "tiny",
      ripple: true
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => setChosenTab(reaction)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_17__["default"], {
      reaction: reaction,
      className: "reaction-filter-emoji",
      availableReactions: availableReactions
    }), Boolean(count) && (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_8__.formatIntegerCompact)(count));
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    dir: lang.isRtl ? 'rtl' : undefined,
    className: "reactor-list-wrapper"
  }, viewportIds?.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_19__["default"], {
    className: "reactor-list custom-scroll",
    items: viewportIds,
    onLoadMore: getMore
  }, viewportIds?.flatMap(peerId => {
    const peer = usersById[peerId] || chatsById[peerId];
    const peerReactions = reactors?.reactions.filter(reactor => reactor.peerId === peerId);
    const items = [];
    const seenByUser = seenByDates?.[peerId];
    peerReactions?.forEach(r => {
      if (chosenTab && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(r.reaction, chosenTab)) return;
      items.push( /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
        key: `${peerId}-${(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getReactionKey)(r.reaction)}`,
        className: "chat-item-clickable reactors-list-item"
        // eslint-disable-next-line react/jsx-no-bind
        ,
        onClick: () => handleClick(peerId)
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_13__["default"], {
        peer: peer,
        size: "medium"
      }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: "info"
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_FullNameTitle__WEBPACK_IMPORTED_MODULE_14__["default"], {
        peer: peer,
        withEmojiStatus: true
      }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
        className: "status",
        dir: "auto"
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
        name: "heart-outline",
        className: "status-icon"
      }), (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_6__.formatDateAtTime)(lang, r.addedDate * 1000))), r.reaction && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_17__["default"], {
        className: "reactors-list-emoji",
        reaction: r.reaction,
        availableReactions: availableReactions
      })));
    });
    if (!chosenTab && !peerReactions?.length) {
      items.push( /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
        key: `${peerId}-seen-by`,
        className: "chat-item-clickable scroll-item small-icon"
        // eslint-disable-next-line react/jsx-no-bind
        ,
        onClick: () => handleClick(peerId)
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_16__["default"], {
        userId: peerId,
        noStatusOrTyping: true,
        avatarSize: "medium",
        status: seenByUser ? (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_6__.formatDateAtTime)(lang, seenByUser * 1000) : undefined,
        statusIcon: "message-read"
      })));
    }
    return items;
  })) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_21__["default"], null)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_18__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleClose
  }, lang('Close')));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    chatId,
    messageId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global).reactorModal || {};
  const message = chatId && messageId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatMessage)(global, chatId, messageId) : undefined;
  return {
    chatId,
    messageId,
    reactions: message?.reactions,
    reactors: message?.reactors,
    seenByDates: message?.seenByDates,
    availableReactions: global.reactions.availableReactions
  };
})(ReactorListModal)));

/***/ }),

/***/ "./src/components/middle/composer/AttachmentModal.tsx":
/*!************************************************************!*\
  !*** ./src/components/middle/composer/AttachmentModal.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _global_selectors_limits__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../global/selectors/limits */ "./src/global/selectors/limits.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/captureEscKeyListener */ "./src/util/captureEscKeyListener.ts");
/* harmony import */ var _util_files__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../util/files */ "./src/util/files.ts");
/* harmony import */ var _util_selection__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../util/selection */ "./src/util/selection.ts");
/* harmony import */ var _util_systemFilesDialog__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../util/systemFilesDialog */ "./src/util/systemFilesDialog.ts");
/* harmony import */ var _helpers_getFilesFromDataTransferItems__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./helpers/getFilesFromDataTransferItems */ "./src/components/middle/composer/helpers/getFilesFromDataTransferItems.ts");
/* harmony import */ var _helpers_getHtmlTextLength__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./helpers/getHtmlTextLength */ "./src/components/middle/composer/helpers/getHtmlTextLength.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../hooks/useContextMenuHandlers */ "./src/hooks/useContextMenuHandlers.ts");
/* harmony import */ var _hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../hooks/useDerivedState */ "./src/hooks/useDerivedState.ts");
/* harmony import */ var _hooks_useEffectOnce__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../hooks/useEffectOnce */ "./src/hooks/useEffectOnce.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useGetSelectionRange__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../hooks/useGetSelectionRange */ "./src/hooks/useGetSelectionRange.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_useResizeObserver__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../../hooks/useResizeObserver */ "./src/hooks/useResizeObserver.ts");
/* harmony import */ var _hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../../hooks/useScrolledState */ "./src/hooks/useScrolledState.ts");
/* harmony import */ var _hooks_useCustomEmojiTooltip__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./hooks/useCustomEmojiTooltip */ "./src/components/middle/composer/hooks/useCustomEmojiTooltip.ts");
/* harmony import */ var _hooks_useEmojiTooltip__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./hooks/useEmojiTooltip */ "./src/components/middle/composer/hooks/useEmojiTooltip.ts");
/* harmony import */ var _hooks_useMentionTooltip__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./hooks/useMentionTooltip */ "./src/components/middle/composer/hooks/useMentionTooltip.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../../ui/DropdownMenu */ "./src/components/ui/DropdownMenu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _AttachmentModalItem__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./AttachmentModalItem */ "./src/components/middle/composer/AttachmentModalItem.tsx");
/* harmony import */ var _CustomEmojiTooltip_async__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./CustomEmojiTooltip.async */ "./src/components/middle/composer/CustomEmojiTooltip.async.tsx");
/* harmony import */ var _CustomSendMenu_async__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./CustomSendMenu.async */ "./src/components/middle/composer/CustomSendMenu.async.tsx");
/* harmony import */ var _EmojiTooltip_async__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./EmojiTooltip.async */ "./src/components/middle/composer/EmojiTooltip.async.tsx");
/* harmony import */ var _MentionTooltip__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./MentionTooltip */ "./src/components/middle/composer/MentionTooltip.tsx");
/* harmony import */ var _MessageInput__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./MessageInput */ "./src/components/middle/composer/MessageInput.tsx");
/* harmony import */ var _SymbolMenuButton__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./SymbolMenuButton */ "./src/components/middle/composer/SymbolMenuButton.tsx");
/* harmony import */ var _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./AttachmentModal.module.scss */ "./src/components/middle/composer/AttachmentModal.module.scss");









































const ATTACHMENT_MODAL_INPUT_ID = 'caption-input-text';
const DROP_LEAVE_TIMEOUT_MS = 150;
const MAX_LEFT_CHARS_TO_SHOW = 100;
const AttachmentModal = ({
  chatId,
  threadId,
  attachments,
  getHtml,
  editingMessage,
  canShowCustomSendMenu,
  captionLimit,
  isReady,
  isChatWithSelf,
  currentUserId,
  groupChatMembers,
  recentEmojis,
  baseEmojiKeywords,
  emojiKeywords,
  isForMessage,
  shouldSchedule,
  shouldSuggestCustomEmoji,
  customEmojiForEmoji,
  attachmentSettings,
  shouldSuggestCompression,
  shouldForceCompression,
  shouldForceAsFile,
  isForCurrentMessageList,
  forceDarkTheme,
  onAttachmentsUpdate,
  onCaptionUpdate,
  onSend,
  onFileAppend,
  onClear,
  onSendSilent,
  onSendScheduled,
  onCustomEmojiSelect,
  onRemoveSymbol,
  onEmojiSelect,
  canScheduleUntilOnline,
  onSendWhenOnline
}) => {
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const svgRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    addRecentCustomEmoji,
    addRecentEmoji,
    updateAttachmentSettings
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_21__["default"])();

  // eslint-disable-next-line no-null/no-null
  const mainButtonRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const hideTimeoutRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const prevAttachments = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_22__["default"])(attachments);
  const renderingAttachments = attachments.length ? attachments : prevAttachments;
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_14__["default"])();
  const isEditing = editingMessage && Boolean(editingMessage);
  const isInAlbum = editingMessage && editingMessage?.groupedId;
  const isEditingMessageFile = isEditing && attachments?.length && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getAttachmentMediaType)(attachments[0]);
  const notEditingFile = isEditingMessageFile !== 'file';
  const [isSymbolMenuOpen, openSymbolMenu, closeSymbolMenu] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_18__["default"])();
  const [shouldSendCompressed, setShouldSendCompressed] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(shouldSuggestCompression ?? attachmentSettings.shouldCompress);
  const isSendingCompressed = Boolean((shouldSendCompressed || shouldForceCompression || isInAlbum) && !shouldForceAsFile);
  const [shouldSendGrouped, setShouldSendGrouped] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(attachmentSettings.shouldSendGrouped);
  const isInvertedMedia = attachmentSettings.isInvertedMedia;
  const {
    handleScroll: handleAttachmentsScroll,
    isAtBeginning: areAttachmentsNotScrolled,
    isAtEnd: areAttachmentsScrolledToBottom
  } = (0,_hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_24__["default"])();
  const {
    handleScroll: handleCaptionScroll,
    isAtBeginning: isCaptionNotScrolled
  } = (0,_hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_24__["default"])();
  const isOpen = Boolean(attachments.length);
  const renderingIsOpen = Boolean(renderingAttachments?.length);
  const [isHovered, markHovered, unmarkHovered] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_18__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      closeSymbolMenu();
      updateAttachmentSettings({
        isInvertedMedia: undefined
      });
    }
  }, [closeSymbolMenu, isOpen]);
  const [hasMedia, hasOnlyMedia] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const onlyMedia = Boolean(renderingAttachments?.every(a => a.quick || a.audio));
    if (onlyMedia) return [true, true];
    const oneMedia = Boolean(renderingAttachments?.some(a => a.quick || a.audio));
    return [oneMedia, false];
  }, [renderingAttachments]);
  const [hasSpoiler, isEverySpoiler] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const areAllSpoilers = Boolean(renderingAttachments?.every(a => a.shouldSendAsSpoiler));
    if (areAllSpoilers) return [true, true];
    const hasOneSpoiler = Boolean(renderingAttachments?.some(a => a.shouldSendAsSpoiler));
    return [hasOneSpoiler, false];
  }, [renderingAttachments]);
  const getSelectionRange = (0,_hooks_useGetSelectionRange__WEBPACK_IMPORTED_MODULE_19__["default"])(`#${_config__WEBPACK_IMPORTED_MODULE_2__.EDITABLE_INPUT_MODAL_ID}`);
  const {
    isEmojiTooltipOpen,
    filteredEmojis,
    filteredCustomEmojis,
    insertEmoji,
    closeEmojiTooltip
  } = (0,_hooks_useEmojiTooltip__WEBPACK_IMPORTED_MODULE_26__["default"])(Boolean(isReady && (isForCurrentMessageList || !isForMessage) && renderingIsOpen), getHtml, onCaptionUpdate, _config__WEBPACK_IMPORTED_MODULE_2__.EDITABLE_INPUT_MODAL_ID, recentEmojis, baseEmojiKeywords, emojiKeywords);
  const {
    isCustomEmojiTooltipOpen,
    insertCustomEmoji,
    closeCustomEmojiTooltip
  } = (0,_hooks_useCustomEmojiTooltip__WEBPACK_IMPORTED_MODULE_25__["default"])(Boolean(isReady && (isForCurrentMessageList || !isForMessage) && renderingIsOpen && shouldSuggestCustomEmoji), getHtml, onCaptionUpdate, getSelectionRange, inputRef, customEmojiForEmoji);
  const {
    isMentionTooltipOpen,
    closeMentionTooltip,
    insertMention,
    mentionFilteredUsers
  } = (0,_hooks_useMentionTooltip__WEBPACK_IMPORTED_MODULE_27__["default"])(Boolean(isReady && isForCurrentMessageList && renderingIsOpen), getHtml, onCaptionUpdate, getSelectionRange, inputRef, groupChatMembers, undefined, currentUserId);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => isOpen ? (0,_util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_8__["default"])(onClear) : undefined, [isOpen, onClear]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      setShouldSendCompressed(shouldSuggestCompression ?? attachmentSettings.shouldCompress);
      setShouldSendGrouped(attachmentSettings.shouldSendGrouped);
    }
  }, [attachmentSettings, isOpen, shouldSuggestCompression]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      updateAttachmentSettings({
        isInvertedMedia: undefined
      });
    }
  }, [updateAttachmentSettings, isOpen, shouldSuggestCompression]);
  function setIsInvertedMedia(value) {
    updateAttachmentSettings({
      isInvertedMedia: value
    });
  }
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && isMobile) {
      (0,_util_selection__WEBPACK_IMPORTED_MODULE_10__.removeAllSelections)();
    }
  }, [isMobile, isOpen]);
  const {
    isContextMenuOpen: isCustomSendMenuOpen,
    handleContextMenu,
    handleContextMenuClose,
    handleContextMenuHide
  } = (0,_hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_15__["default"])(mainButtonRef, !canShowCustomSendMenu || !isOpen);
  const sendAttachments = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])((isSilent, shouldSendScheduled) => {
    if (isOpen) {
      const send = (shouldSchedule || shouldSendScheduled) && isForMessage && !editingMessage ? onSendScheduled : isSilent ? onSendSilent : onSend;
      send(isSendingCompressed, shouldSendGrouped, isInvertedMedia);
      updateAttachmentSettings({
        shouldCompress: shouldSuggestCompression === undefined ? isSendingCompressed : undefined,
        shouldSendGrouped,
        isInvertedMedia
      });
    }
  });
  const handleSendSilent = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(() => {
    sendAttachments(true);
  });
  const handleSendClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(() => {
    sendAttachments();
  });
  const handleScheduleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(() => {
    sendAttachments(false, true);
  });
  const handleDragLeave = e => {
    const {
      relatedTarget: toTarget,
      target: fromTarget
    } = e;

    // Esc button pressed during drag event
    if (fromTarget.matches(`.${_AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].dropTarget}`) && !toTarget) {
      hideTimeoutRef.current = window.setTimeout(unmarkHovered, DROP_LEAVE_TIMEOUT_MS);
    }

    // Prevent DragLeave event from firing when the pointer moves inside the AttachmentModal drop target
    if (fromTarget && fromTarget.closest(`.${_AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].hovered}`)) {
      return;
    }
    if (toTarget) {
      e.stopPropagation();
    }
    unmarkHovered();
  };
  const handleFilesDrop = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(async e => {
    e.preventDefault();
    unmarkHovered();
    const {
      dataTransfer
    } = e;
    const files = await (0,_helpers_getFilesFromDataTransferItems__WEBPACK_IMPORTED_MODULE_12__["default"])(dataTransfer.items);
    if (files?.length) {
      onFileAppend(files, isEverySpoiler);
    }
  });
  function handleDragOver(e) {
    e.preventDefault();
    if (hideTimeoutRef.current) {
      window.clearTimeout(hideTimeoutRef.current);
      hideTimeoutRef.current = undefined;
    }
  }
  const handleFileSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(e => {
    const {
      files
    } = e.target;
    const validatedFiles = (0,_util_files__WEBPACK_IMPORTED_MODULE_9__.validateFiles)(files);
    if (validatedFiles?.length) {
      onFileAppend(validatedFiles, isEverySpoiler);
    }
  });
  const handleDocumentSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(() => {
    (0,_util_systemFilesDialog__WEBPACK_IMPORTED_MODULE_11__.openSystemFilesDialog)('*', e => handleFileSelect(e));
  });
  const handleDelete = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(index => {
    onAttachmentsUpdate(attachments.filter((a, i) => i !== index));
  });
  const handleEnableSpoilers = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(() => {
    onAttachmentsUpdate(attachments.map(a => ({
      ...a,
      shouldSendAsSpoiler: true
    })));
  });
  const handleDisableSpoilers = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(() => {
    onAttachmentsUpdate(attachments.map(a => ({
      ...a,
      shouldSendAsSpoiler: undefined
    })));
  });
  const handleToggleSpoiler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(index => {
    onAttachmentsUpdate(attachments.map((attachment, i) => {
      if (i === index) {
        return {
          ...attachment,
          shouldSendAsSpoiler: !attachment.shouldSendAsSpoiler || undefined
        };
      }
      return attachment;
    }));
  });
  const handleResize = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_20__["default"])(() => {
    const svg = svgRef.current;
    if (!svg) {
      return;
    }
    const {
      width,
      height
    } = svg.getBoundingClientRect();
    svg.viewBox.baseVal.width = width;
    svg.viewBox.baseVal.height = height;
  });

  // Can't listen for SVG resize
  (0,_hooks_useResizeObserver__WEBPACK_IMPORTED_MODULE_23__["default"])(ref, handleResize);
  (0,_hooks_useEffectOnce__WEBPACK_IMPORTED_MODULE_17__["default"])(handleResize);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const mainButton = mainButtonRef.current;
    const input = document.getElementById(ATTACHMENT_MODAL_INPUT_ID);
    if (!mainButton || !input) return;
    const {
      width
    } = mainButton.getBoundingClientRect();
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
      input.style.setProperty('--margin-for-scrollbar', `${width}px`);
    });
  }, [lang, isOpen]);
  const MoreMenuButton = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return ({
      onTrigger,
      isOpen: isMenuOpen
    }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_29__["default"], {
      round: true,
      ripple: !isMobile,
      size: "smaller",
      color: "translucent",
      className: isMenuOpen ? 'active' : '',
      onClick: onTrigger,
      ariaLabel: "More actions"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_28__["default"], {
      name: "more"
    }));
  }, [isMobile]);
  const leftChars = (0,_hooks_useDerivedState__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    if (!renderingIsOpen) return undefined;
    const leftCharsBeforeLimit = captionLimit - (0,_helpers_getHtmlTextLength__WEBPACK_IMPORTED_MODULE_13__.getHtmlTextLength)(getHtml());
    return leftCharsBeforeLimit <= MAX_LEFT_CHARS_TO_SHOW ? leftCharsBeforeLimit : undefined;
  }, [captionLimit, getHtml, renderingIsOpen]);
  const isQuickGallery = isSendingCompressed && hasOnlyMedia;
  const [areAllPhotos, areAllVideos, areAllAudios] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!isQuickGallery || !renderingAttachments) return [false, false, false];
    const everyPhoto = renderingAttachments.every(a => _config__WEBPACK_IMPORTED_MODULE_2__.SUPPORTED_PHOTO_CONTENT_TYPES.has(a.mimeType));
    const everyVideo = renderingAttachments.every(a => _config__WEBPACK_IMPORTED_MODULE_2__.SUPPORTED_VIDEO_CONTENT_TYPES.has(a.mimeType));
    const everyAudio = renderingAttachments.every(a => _config__WEBPACK_IMPORTED_MODULE_2__.SUPPORTED_AUDIO_CONTENT_TYPES.has(a.mimeType));
    return [everyPhoto, everyVideo, everyAudio];
  }, [renderingAttachments, isQuickGallery]);
  const hasAnySpoilerable = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!renderingAttachments) return false;
    return renderingAttachments.some(a => !_config__WEBPACK_IMPORTED_MODULE_2__.SUPPORTED_AUDIO_CONTENT_TYPES.has(a.mimeType));
  }, [renderingAttachments]);
  if (!renderingAttachments) {
    return undefined;
  }
  const isMultiple = renderingAttachments.length > 1;
  const canInvertMedia = (() => {
    if (isEditing) return false;
    if (!hasMedia) return false;
    if (!shouldForceAsFile && !shouldForceCompression && !isSendingCompressed) return false;
    if (isMultiple && shouldSendGrouped) return false;
    return true;
  })();
  let title = '';
  if (areAllPhotos) {
    title = lang(isEditing ? 'EditMessageReplacePhoto' : 'PreviewSender.SendPhoto', renderingAttachments.length, 'i');
  } else if (areAllVideos) {
    title = lang(isEditing ? 'EditMessageReplaceVideo' : 'PreviewSender.SendVideo', renderingAttachments.length, 'i');
  } else if (areAllAudios) {
    title = lang(isEditing ? 'EditMessageReplaceAudio' : 'PreviewSender.SendAudio', renderingAttachments.length, 'i');
  } else {
    title = lang(isEditing ? 'EditMessageReplaceFile' : 'PreviewSender.SendFile', renderingAttachments.length, 'i');
  }
  function renderHeader() {
    if (!renderingAttachments) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header-condensed",
      dir: lang.isRtl ? 'rtl' : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_29__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: "Cancel attachments",
      onClick: onClear
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_28__["default"], {
      name: "close"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-title"
    }, title), notEditingFile && !isInAlbum && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_30__["default"], {
      className: "attachmeneditingMessaget-modal-more-menu with-menu-transitions",
      trigger: MoreMenuButton,
      positionX: "right"
    }, Boolean(!editingMessage) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__["default"], {
      icon: "add",
      onClick: handleDocumentSelect
    }, lang('Add')), hasMedia && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, canInvertMedia && (!isInvertedMedia ?
    /*#__PURE__*/
    // eslint-disable-next-line react/jsx-no-bind
    _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__["default"], {
      icon: "move-caption-up",
      onClick: () => setIsInvertedMedia(true)
    }, lang('PreviewSender.MoveTextUp')) :
    /*#__PURE__*/
    // eslint-disable-next-line react/jsx-no-bind
    _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__["default"], {
      icon: "move-caption-down",
      onClick: () => setIsInvertedMedia(undefined)
    }, lang('PreviewSender.MoveTextDown'))), !shouldForceAsFile && !shouldForceCompression && (isSendingCompressed ?
    /*#__PURE__*/
    // eslint-disable-next-line react/jsx-no-bind
    _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__["default"], {
      icon: "document",
      onClick: () => setShouldSendCompressed(false)
    }, lang(isMultiple ? 'Attachment.SendAsFiles' : 'Attachment.SendAsFile')) :
    /*#__PURE__*/
    // eslint-disable-next-line react/jsx-no-bind
    _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__["default"], {
      icon: "photo",
      onClick: () => setShouldSendCompressed(true)
    }, isMultiple ? 'Send All as Media' : 'Send as Media')), isSendingCompressed && hasAnySpoilerable && Boolean(!editingMessage) && (hasSpoiler ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__["default"], {
      icon: "spoiler-disable",
      onClick: handleDisableSpoilers
    }, lang('Attachment.DisableSpoiler')) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__["default"], {
      icon: "spoiler",
      onClick: handleEnableSpoilers
    }, lang('Attachment.EnableSpoiler')))), isMultiple && (shouldSendGrouped ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__["default"], {
      icon: "grouped-disable"
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => setShouldSendGrouped(false)
    }, "Ungroup All Media") :
    /*#__PURE__*/
    // eslint-disable-next-line react/jsx-no-bind
    _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_31__["default"], {
      icon: "grouped",
      onClick: () => setShouldSendGrouped(true)
    }, "Group All Media"))));
  }
  const isBottomDividerShown = !areAttachmentsScrolledToBottom || !isCaptionNotScrolled;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_32__["default"], {
    isOpen: isOpen,
    onClose: onClear,
    header: renderHeader(),
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_7__["default"])(_AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].root, isHovered && _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].hovered, !areAttachmentsNotScrolled && _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].headerBorder, isMobile && _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].mobile, isSymbolMenuOpen && _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].symbolMenuOpen, forceDarkTheme && 'component-theme-dark'),
    noBackdropClose: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].dropTarget,
    onDragEnter: markHovered,
    onDrop: handleFilesDrop,
    onDragOver: handleDragOver,
    onDragLeave: handleDragLeave,
    onClick: unmarkHovered,
    "data-attach-description": lang('Preview.Dragging.AddItems', 10),
    "data-dropzone": true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("svg", {
    className: _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].dropOutlineContainer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("rect", {
    className: _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].dropOutline,
    x: "0",
    y: "0",
    width: "100%",
    height: "100%",
    rx: "8"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_7__["default"])(_AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].attachments, 'custom-scroll', isBottomDividerShown && _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].attachmentsBottomPadding),
    onScroll: handleAttachmentsScroll
  }, renderingAttachments.map((attachment, i) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_AttachmentModalItem__WEBPACK_IMPORTED_MODULE_33__["default"], {
    attachment: attachment,
    shouldDisplayCompressed: isSendingCompressed,
    shouldDisplayGrouped: shouldSendGrouped,
    isSingle: renderingAttachments.length === 1,
    index: i,
    key: attachment.uniqueId || i,
    onDelete: handleDelete,
    onToggleSpoiler: handleToggleSpoiler
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_7__["default"])(_AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].captionWrapper, isBottomDividerShown && _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].captionTopBorder)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MentionTooltip__WEBPACK_IMPORTED_MODULE_37__["default"], {
    isOpen: isMentionTooltipOpen,
    filteredUsers: mentionFilteredUsers,
    onInsertUserName: insertMention,
    onClose: closeMentionTooltip
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_EmojiTooltip_async__WEBPACK_IMPORTED_MODULE_36__["default"], {
    isOpen: isEmojiTooltipOpen,
    emojis: filteredEmojis,
    customEmojis: filteredCustomEmojis,
    addRecentEmoji: addRecentEmoji,
    addRecentCustomEmoji: addRecentCustomEmoji,
    onEmojiSelect: insertEmoji,
    onCustomEmojiSelect: insertEmoji,
    onClose: closeEmojiTooltip
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_CustomEmojiTooltip_async__WEBPACK_IMPORTED_MODULE_34__["default"], {
    chatId: chatId,
    isOpen: isCustomEmojiTooltipOpen,
    addRecentCustomEmoji: addRecentCustomEmoji,
    onCustomEmojiSelect: insertCustomEmoji,
    onClose: closeCustomEmojiTooltip
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].caption
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SymbolMenuButton__WEBPACK_IMPORTED_MODULE_39__["default"], {
    chatId: chatId,
    threadId: threadId,
    isMobile: isMobile,
    isReady: isReady,
    isSymbolMenuOpen: isSymbolMenuOpen,
    openSymbolMenu: openSymbolMenu,
    closeSymbolMenu: closeSymbolMenu,
    onCustomEmojiSelect: onCustomEmojiSelect,
    onRemoveSymbol: onRemoveSymbol,
    onEmojiSelect: onEmojiSelect,
    isAttachmentModal: true,
    canSendPlainText: true,
    className: "attachment-modal-symbol-menu with-menu-transitions",
    idPrefix: "attachment",
    forceDarkTheme: forceDarkTheme
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MessageInput__WEBPACK_IMPORTED_MODULE_38__["default"], {
    ref: inputRef,
    id: ATTACHMENT_MODAL_INPUT_ID,
    chatId: chatId,
    threadId: threadId,
    isAttachmentModalInput: true,
    customEmojiPrefix: "attachment",
    isReady: isReady,
    isActive: isOpen,
    getHtml: getHtml,
    editableInputId: _config__WEBPACK_IMPORTED_MODULE_2__.EDITABLE_INPUT_MODAL_ID,
    placeholder: lang('AddCaption'),
    onUpdate: onCaptionUpdate,
    onSend: handleSendClick,
    onScroll: handleCaptionScroll,
    canAutoFocus: Boolean(isReady && isForCurrentMessageList && attachments.length),
    captionLimit: leftChars,
    shouldSuppressFocus: isMobile && isSymbolMenuOpen,
    onSuppressedFocus: closeSymbolMenu
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].sendWrapper
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_29__["default"], {
    ref: mainButtonRef,
    className: _AttachmentModal_module_scss__WEBPACK_IMPORTED_MODULE_40__["default"].send,
    onClick: handleSendClick,
    onContextMenu: canShowCustomSendMenu ? handleContextMenu : undefined
  }, shouldSchedule && !editingMessage ? lang('Next') : editingMessage ? lang('Save') : lang('Send')), canShowCustomSendMenu && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_CustomSendMenu_async__WEBPACK_IMPORTED_MODULE_35__["default"], {
    isOpen: isCustomSendMenuOpen,
    canSchedule: isForMessage,
    onSendSilent: !isChatWithSelf ? handleSendSilent : undefined,
    onSendSchedule: handleScheduleClick,
    onClose: handleContextMenuClose,
    onCloseAnimationEnd: handleContextMenuHide,
    isSavedMessages: isChatWithSelf,
    onSendWhenOnline: onSendWhenOnline,
    canScheduleUntilOnline: canScheduleUntilOnline
  }))))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const {
    currentUserId,
    recentEmojis,
    customEmojis,
    attachmentSettings
  } = global;
  const chatFullInfo = !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isUserId)(chatId) ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChatFullInfo)(global, chatId) : undefined;
  const isChatWithSelf = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsChatWithSelf)(global, chatId);
  const {
    language,
    shouldSuggestCustomEmoji
  } = global.settings.byKey;
  const baseEmojiKeywords = global.emojiKeywords[_config__WEBPACK_IMPORTED_MODULE_2__.BASE_EMOJI_KEYWORD_LANG];
  const emojiKeywords = language !== _config__WEBPACK_IMPORTED_MODULE_2__.BASE_EMOJI_KEYWORD_LANG ? global.emojiKeywords[language] : undefined;
  return {
    isChatWithSelf,
    currentUserId,
    groupChatMembers: chatFullInfo?.members,
    recentEmojis,
    baseEmojiKeywords: baseEmojiKeywords?.keywords,
    emojiKeywords: emojiKeywords?.keywords,
    shouldSuggestCustomEmoji,
    customEmojiForEmoji: customEmojis.forEmoji.stickers,
    captionLimit: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_6__.selectCurrentLimit)(global, 'captionLength'),
    attachmentSettings
  };
})(AttachmentModal)));

/***/ }),

/***/ "./src/components/middle/composer/AttachmentModalItem.tsx":
/*!****************************************************************!*\
  !*** ./src/components/middle/composer/AttachmentModalItem.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   getDisplayType: () => (/* binding */ getDisplayType)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _common_helpers_documentInfo__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/documentInfo */ "./src/components/common/helpers/documentInfo.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _common_File__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/File */ "./src/components/common/File.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_MediaSpoiler__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/MediaSpoiler */ "./src/components/common/MediaSpoiler.tsx");
/* harmony import */ var _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./AttachmentModalItem.module.scss */ "./src/components/middle/composer/AttachmentModalItem.module.scss");











const BLUR_CANVAS_SIZE = 15 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__.REM;
const AttachmentModalItem = ({
  attachment,
  className,
  isSingle,
  shouldDisplayCompressed,
  shouldDisplayGrouped,
  index,
  onDelete,
  onToggleSpoiler
}) => {
  const displayType = getDisplayType(attachment, shouldDisplayCompressed);
  const handleSpoilerClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    onToggleSpoiler?.(index);
  });
  const content = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    switch (displayType) {
      case 'photo':
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
          className: _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].preview,
          src: attachment.blobUrl,
          alt: "",
          draggable: false
        });
      case 'video':
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, Boolean(attachment.quick?.duration) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
          className: _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].duration
        }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.formatMediaDuration)(attachment.quick.duration)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("video", {
          className: _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].preview,
          src: attachment.blobUrl,
          autoPlay: true,
          muted: true,
          loop: true,
          disablePictureInPicture: true
        }));
      default:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_File__WEBPACK_IMPORTED_MODULE_7__["default"], {
          className: _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].file,
          name: attachment.filename,
          extension: (0,_common_helpers_documentInfo__WEBPACK_IMPORTED_MODULE_4__.getFileExtension)(attachment.filename, attachment.mimeType),
          previewData: attachment.previewBlobUrl,
          size: attachment.size,
          smaller: true
        }), onDelete && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
          name: "delete",
          className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].actionItem, _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].deleteFile)
          // eslint-disable-next-line react/jsx-no-bind
          ,
          onClick: () => onDelete(index)
        }));
    }
  }, [attachment, displayType, index, onDelete]);
  const shouldSkipGrouping = displayType === 'file' || !shouldDisplayGrouped;
  const shouldDisplaySpoiler = Boolean(displayType !== 'file' && attachment.shouldSendAsSpoiler);
  const shouldRenderOverlay = displayType !== 'file';
  const rootClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(className, _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].root, isSingle && _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].single, shouldSkipGrouping && _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].noGrouping);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: rootClassName
  }, content, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_MediaSpoiler__WEBPACK_IMPORTED_MODULE_9__["default"], {
    isVisible: shouldDisplaySpoiler,
    thumbDataUri: attachment.previewBlobUrl || attachment.blobUrl,
    width: BLUR_CANVAS_SIZE,
    height: BLUR_CANVAS_SIZE
  }), shouldRenderOverlay && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].overlay
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: attachment.shouldSendAsSpoiler ? 'spoiler-disable' : 'spoiler',
    className: _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].actionItem,
    onClick: handleSpoilerClick
  }), onDelete &&
  /*#__PURE__*/
  // eslint-disable-next-line react/jsx-no-bind
  _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "delete",
    className: _AttachmentModalItem_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].actionItem,
    onClick: () => onDelete(index)
  })));
};
function getDisplayType(attachment, shouldDisplayCompressed) {
  if (shouldDisplayCompressed && attachment.quick) {
    if (_config__WEBPACK_IMPORTED_MODULE_1__.SUPPORTED_PHOTO_CONTENT_TYPES.has(attachment.mimeType)) {
      return 'photo';
    }
    if (_config__WEBPACK_IMPORTED_MODULE_1__.SUPPORTED_VIDEO_CONTENT_TYPES.has(attachment.mimeType)) {
      return 'video';
    }
  }
  return 'file';
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(AttachmentModalItem));

/***/ }),

/***/ "./src/components/middle/composer/BotCommandMenu.tsx":
/*!***********************************************************!*\
  !*** ./src/components/middle/composer/BotCommandMenu.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMouseInside__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useMouseInside */ "./src/hooks/useMouseInside.ts");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ChatCommand__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ChatCommand */ "./src/components/middle/composer/ChatCommand.tsx");
/* harmony import */ var _BotCommandMenu_scss__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./BotCommandMenu.scss */ "./src/components/middle/composer/BotCommandMenu.scss");









const BotCommandMenu = ({
  isOpen,
  botCommands,
  onClose
}) => {
  const {
    sendBotCommand
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const [handleMouseEnter, handleMouseLeave] = (0,_hooks_useMouseInside__WEBPACK_IMPORTED_MODULE_5__["default"])(isOpen, onClose, undefined, isMobile);
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(command => {
    sendBotCommand({
      command: `/${command}`
    });
    onClose();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isOpen: isOpen,
    positionX: "left",
    positionY: "bottom",
    onClose: onClose,
    className: "BotCommandMenu",
    onCloseAnimationEnd: onClose,
    onMouseEnter: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_TOUCH_ENV ? handleMouseEnter : undefined,
    onMouseLeave: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_TOUCH_ENV ? handleMouseLeave : undefined,
    noCloseOnBackdrop: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_TOUCH_ENV,
    noCompact: true
  }, botCommands.map(botCommand => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatCommand__WEBPACK_IMPORTED_MODULE_7__["default"], {
    key: botCommand.command,
    command: botCommand.command,
    description: botCommand.description,
    clickArg: botCommand.command,
    onClick: handleClick
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(BotCommandMenu));

/***/ }),

/***/ "./src/components/middle/composer/ChatCommand.tsx":
/*!********************************************************!*\
  !*** ./src/components/middle/composer/ChatCommand.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ChatCommand_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ChatCommand.scss */ "./src/components/middle/composer/ChatCommand.scss");







// eslint-disable-next-line @typescript-eslint/comma-dangle
const ChatCommand = ({
  withAvatar,
  focus,
  command,
  description,
  peer,
  clickArg,
  onClick
}) => {
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__["default"])(() => {
    onClick(clickArg);
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_5__["default"], {
    key: command,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])('BotCommand chat-item-clickable scroll-item', withAvatar && 'with-avatar'),
    multiline: true,
    onClick: handleClick,
    focus: focus
  }, withAvatar && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_4__["default"], {
    size: "small",
    peer: peer
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "content-inner"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, "/", command), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_2__["default"])(description))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ChatCommand));

/***/ }),

/***/ "./src/components/middle/composer/ChatCommandTooltip.tsx":
/*!***************************************************************!*\
  !*** ./src/components/middle/composer/ChatCommandTooltip.tsx ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_hoc_freezeWhenClosed__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/hoc/freezeWhenClosed */ "./src/util/hoc/freezeWhenClosed.ts");
/* harmony import */ var _util_setTooltipItemVisible__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/setTooltipItemVisible */ "./src/util/setTooltipItemVisible.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./hooks/useKeyboardNavigation */ "./src/components/middle/composer/hooks/useKeyboardNavigation.ts");
/* harmony import */ var _ChatCommand__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ChatCommand */ "./src/components/middle/composer/ChatCommand.tsx");
/* harmony import */ var _ChatCommandTooltip_module_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ChatCommandTooltip.module.scss */ "./src/components/middle/composer/ChatCommandTooltip.module.scss");










const ChatCommandTooltip = ({
  isOpen,
  chatId,
  withUsername,
  botCommands,
  quickReplies,
  quickReplyMessages,
  self,
  getHtml,
  onClick,
  onClose
}) => {
  const {
    sendBotCommand,
    sendQuickReply
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    shouldRender,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_6__["default"])(isOpen, undefined, undefined, false);
  const handleSendCommand = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(({
    botId,
    command
  }) => {
    // No need for expensive global updates on users and chats, so we avoid them
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    const bot = usersById[botId];
    sendBotCommand({
      command: `/${command}${withUsername && bot ? `@${bot.usernames[0].username}` : ''}`
    });
    onClick();
  });
  const handleSendQuickReply = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(id => {
    sendQuickReply({
      chatId,
      quickReplyId: id
    });
    onClick();
  });
  const quickRepliesWithDescription = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!quickReplies?.length || !quickReplyMessages) return undefined;
    return quickReplies.map(reply => {
      const message = quickReplyMessages[reply.topMessageId];
      return {
        id: reply.id,
        command: reply.shortcut,
        description: message?.content.text?.text || ''
      };
    });
  }, [quickReplies, quickReplyMessages]);
  const handleKeyboardSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(item => {
    if (!item.command.startsWith(getHtml().slice(1))) {
      return false;
    }
    if ('id' in item) {
      handleSendQuickReply(item.id);
    } else {
      handleSendCommand(item);
    }
    return true;
  });
  const keyboardNavigationItems = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!botCommands && !quickRepliesWithDescription) return undefined;
    return [].concat(quickRepliesWithDescription || [], botCommands || []);
  }, [botCommands, quickRepliesWithDescription]);
  const selectedCommandIndex = (0,_hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_7__.useKeyboardNavigation)({
    isActive: isOpen,
    items: keyboardNavigationItems,
    onSelect: handleKeyboardSelect,
    onClose
  });
  const isEmpty = botCommands && !botCommands.length || quickReplies && !quickReplies.length;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isEmpty) {
      onClose();
    }
  }, [isEmpty, onClose]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    (0,_util_setTooltipItemVisible__WEBPACK_IMPORTED_MODULE_4__["default"])('.chat-item-clickable', selectedCommandIndex, containerRef);
  }, [selectedCommandIndex]);
  if (!shouldRender || isEmpty) {
    return undefined;
  }
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_ChatCommandTooltip_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].root, 'composer-tooltip custom-scroll', transitionClassNames);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: className,
    ref: containerRef
  }, quickRepliesWithDescription?.map((reply, index) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatCommand__WEBPACK_IMPORTED_MODULE_8__["default"], {
    key: `quickReply_${reply.id}`,
    command: reply.command,
    description: reply.description,
    peer: self,
    withAvatar: true,
    clickArg: reply.id,
    onClick: handleSendQuickReply,
    focus: selectedCommandIndex === index
  })), botCommands?.map((command, index) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatCommand__WEBPACK_IMPORTED_MODULE_8__["default"], {
    key: `${command.botId}_${command.command}`,
    command: command.command,
    description: command.description
    // No need for expensive global updates on users and chats, so we avoid them
    ,
    peer: (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId[command.botId],
    withAvatar: true,
    clickArg: command,
    onClick: handleSendCommand,
    focus: selectedCommandIndex + (quickRepliesWithDescription?.length || 0) === index
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_util_hoc_freezeWhenClosed__WEBPACK_IMPORTED_MODULE_3__["default"])(ChatCommandTooltip)));

/***/ }),

/***/ "./src/components/middle/composer/CustomEmojiButton.tsx":
/*!**************************************************************!*\
  !*** ./src/components/middle/composer/CustomEmojiButton.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _common_CustomEmoji__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/CustomEmoji */ "./src/components/common/CustomEmoji.tsx");
/* harmony import */ var _EmojiButton_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./EmojiButton.scss */ "./src/components/middle/composer/EmojiButton.scss");





const CUSTOM_EMOJI_SIZE = 32;
const CustomEmojiButton = ({
  emoji,
  focus,
  onClick,
  observeIntersection
}) => {
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__["default"])(e => {
    // Preventing safari from losing focus on Composer MessageInput
    e.preventDefault();
    onClick?.(emoji);
  });
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])('EmojiButton', focus && 'focus');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: className,
    onMouseDown: handleClick,
    title: emoji.emoji
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmoji__WEBPACK_IMPORTED_MODULE_3__["default"], {
    documentId: emoji.id,
    size: CUSTOM_EMOJI_SIZE,
    withSharedAnimation: true,
    shouldPreloadPreview: true,
    observeIntersectionForPlaying: observeIntersection
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(CustomEmojiButton));

/***/ }),

/***/ "./src/components/middle/composer/CustomEmojiTooltip.tsx":
/*!***************************************************************!*\
  !*** ./src/components/middle/composer/CustomEmojiTooltip.tsx ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/captureEscKeyListener */ "./src/util/captureEscKeyListener.ts");
/* harmony import */ var _hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useHorizontalScroll */ "./src/hooks/useHorizontalScroll.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _common_StickerButton__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/StickerButton */ "./src/components/common/StickerButton.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _CustomEmojiTooltip_module_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./CustomEmojiTooltip.module.scss */ "./src/components/middle/composer/CustomEmojiTooltip.module.scss");














const INTERSECTION_THROTTLE = 200;
const CustomEmojiTooltip = ({
  isOpen,
  addRecentCustomEmoji,
  onCustomEmojiSelect,
  onClose,
  customEmoji,
  isSavedMessages,
  isCurrentUserPremium,
  noPlay
}) => {
  const {
    clearCustomEmojiForEmoji
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    shouldRender,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(isOpen, undefined, undefined, false);
  const prevStickers = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_9__["default"])(customEmoji, true);
  const displayedStickers = customEmoji || prevStickers;
  (0,_hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_6__["default"])(containerRef);
  const {
    observe: observeIntersection
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_7__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: INTERSECTION_THROTTLE,
    isDisabled: !isOpen
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => isOpen ? (0,_util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_5__["default"])(onClose) : undefined, [isOpen, onClose]);
  const handleCustomEmojiSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(ce => {
    if (!isOpen) return;
    onCustomEmojiSelect(ce);
    addRecentCustomEmoji({
      documentId: ce.id
    });
    clearCustomEmojiForEmoji();
  });
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_CustomEmojiTooltip_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].root, 'composer-tooltip custom-scroll-x', transitionClassNames, !displayedStickers?.length && _CustomEmojiTooltip_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].hidden);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: className
  }, shouldRender && displayedStickers ? displayedStickers.map(sticker => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_StickerButton__WEBPACK_IMPORTED_MODULE_11__["default"], {
    key: sticker.id,
    sticker: sticker,
    className: _CustomEmojiTooltip_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].emojiButton,
    size: _config__WEBPACK_IMPORTED_MODULE_2__.COMPOSER_EMOJI_SIZE_PICKER,
    observeIntersection: observeIntersection,
    onClick: handleCustomEmojiSelect,
    clickArg: sticker,
    isSavedMessages: isSavedMessages,
    canViewSet: true,
    isCurrentUserPremium: isCurrentUserPremium,
    noPlay: noPlay
  })) : shouldRender ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_12__["default"], null) : undefined);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const {
    stickers: customEmoji
  } = global.customEmojis.forEmoji;
  const isSavedMessages = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsChatWithSelf)(global, chatId);
  const isCurrentUserPremium = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global);
  return {
    customEmoji,
    isSavedMessages,
    isCurrentUserPremium
  };
})(CustomEmojiTooltip)));

/***/ }),

/***/ "./src/components/middle/composer/CustomSendMenu.tsx":
/*!***********************************************************!*\
  !*** ./src/components/middle/composer/CustomSendMenu.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useEffectWithPrevDeps */ "./src/hooks/useEffectWithPrevDeps.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMouseInside__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useMouseInside */ "./src/hooks/useMouseInside.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _message_reactions_ReactionSelector__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../message/reactions/ReactionSelector */ "./src/components/middle/message/reactions/ReactionSelector.tsx");
/* harmony import */ var _CustomSendMenu_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./CustomSendMenu.scss */ "./src/components/middle/composer/CustomSendMenu.scss");














const ANIMATION_DURATION = 200;
const CustomSendMenu = ({
  isOpen,
  isOpenToBottom = false,
  isSavedMessages,
  canSchedule,
  canScheduleUntilOnline,
  onSendSilent,
  onSendSchedule,
  onSendWhenOnline,
  onRemoveEffect,
  onClose,
  onCloseAnimationEnd,
  chatId,
  withEffects,
  hasCurrentEffect,
  effectReactions,
  allAvailableReactions,
  onToggleReaction,
  canBuyPremium,
  isCurrentUserPremium,
  isInSavedMessages,
  isInStoryViewer,
  canPlayAnimatedEmojis
}) => {
  const {
    openEffectPicker
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [handleMouseEnter, handleMouseLeave] = (0,_hooks_useMouseInside__WEBPACK_IMPORTED_MODULE_8__["default"])(isOpen, onClose);
  const [displayScheduleUntilOnline, setDisplayScheduleUntilOnline] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [areItemsHidden, hideItems, showItems] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])();
  (0,_hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_4__["default"])(([prevIsOpen]) => {
    // Avoid context menu item shuffling when opened
    if (isOpen && !prevIsOpen) {
      showItems();
      setDisplayScheduleUntilOnline(Boolean(canScheduleUntilOnline));
    }
  }, [isOpen, canScheduleUntilOnline]);
  const [isReady, markIsReady, unmarkIsReady] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const handleOpenMessageEffectsPicker = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(position => {
    hideItems();
    if (chatId) openEffectPicker({
      chatId,
      position
    });
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      unmarkIsReady();
      return;
    }
    setTimeout(() => {
      markIsReady();
    }, ANIMATION_DURATION);
  }, [isOpen, markIsReady, unmarkIsReady]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isOpen: isOpen,
    autoClose: true,
    positionX: "right",
    positionY: isOpenToBottom ? 'top' : 'bottom',
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('CustomSendMenu', 'fluid', 'with-menu-transitions', withEffects && 'with-effects'),
    onClose: onClose,
    onCloseAnimationEnd: onCloseAnimationEnd,
    onMouseEnter: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__.IS_TOUCH_ENV ? handleMouseEnter : undefined,
    onMouseLeave: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__.IS_TOUCH_ENV ? handleMouseLeave : undefined,
    noCloseOnBackdrop: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__.IS_TOUCH_ENV
  }, withEffects && !isInStoryViewer && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_message_reactions_ReactionSelector__WEBPACK_IMPORTED_MODULE_12__["default"], {
    allAvailableReactions: allAvailableReactions,
    effectReactions: effectReactions,
    currentReactions: undefined,
    onToggleReaction: onToggleReaction,
    isPrivate: true,
    isReady: isReady,
    canBuyPremium: canBuyPremium,
    isCurrentUserPremium: isCurrentUserPremium,
    isInSavedMessages: isInSavedMessages,
    isForEffects: true,
    canPlayAnimatedEmojis: canPlayAnimatedEmojis,
    onShowMore: handleOpenMessageEffectsPicker,
    onClose: onClose,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(areItemsHidden && 'ReactionSelector-hidden')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('CustomSendMenu_items', areItemsHidden && 'CustomSendMenu_items-hidden'),
    dir: oldLang.isRtl ? 'rtl' : undefined
  }, onSendSilent && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
    icon: "mute",
    onClick: onSendSilent
  }, oldLang('SendWithoutSound')), canSchedule && onSendSchedule && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
    icon: "schedule",
    onClick: onSendSchedule
  }, oldLang(isSavedMessages ? 'SetReminder' : 'ScheduleMessage')), canSchedule && onSendSchedule && displayScheduleUntilOnline && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
    icon: "user-online",
    onClick: onSendWhenOnline
  }, oldLang('SendWhenOnline')), withEffects && hasCurrentEffect && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
    icon: "delete",
    onClick: onRemoveEffect
  }, lang('RemoveEffect'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(CustomSendMenu));

/***/ }),

/***/ "./src/components/middle/composer/EmojiButton.tsx":
/*!********************************************************!*\
  !*** ./src/components/middle/composer/EmojiButton.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_emoji_emoji__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/emoji/emoji */ "./src/util/emoji/emoji.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _EmojiButton_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./EmojiButton.scss */ "./src/components/middle/composer/EmojiButton.scss");







const EmojiButton = ({
  emoji,
  focus,
  onClick
}) => {
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(e => {
    // Preventing safari from losing focus on Composer MessageInput
    e.preventDefault();
    onClick(emoji.native, emoji.id);
  });
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('EmojiButton', focus && 'focus');
  const src = `${_config__WEBPACK_IMPORTED_MODULE_1__.IS_PACKAGED_ELECTRON ? _config__WEBPACK_IMPORTED_MODULE_1__.BASE_URL : '.'}/img-apple-64/${emoji.image}.png`;
  const isLoaded = _util_emoji_emoji__WEBPACK_IMPORTED_MODULE_3__.LOADED_EMOJIS.has(src);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: className,
    onMouseDown: handleClick,
    title: `:${emoji.names[0]}:`
  }, _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_EMOJI_SUPPORTED ? emoji.native : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: src,
    className: !isLoaded ? 'opacity-transition shown' : undefined,
    alt: emoji.native,
    loading: "lazy",
    "data-path": src,
    onLoad: !isLoaded ? _util_emoji_emoji__WEBPACK_IMPORTED_MODULE_3__.handleEmojiLoad : undefined,
    draggable: false
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(EmojiButton));

/***/ }),

/***/ "./src/components/middle/composer/EmojiCategory.tsx":
/*!**********************************************************!*\
  !*** ./src/components/middle/composer/EmojiCategory.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_windowSize__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/windowSize */ "./src/util/windowSize.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useMediaTransitionDeprecated */ "./src/hooks/useMediaTransitionDeprecated.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _EmojiButton__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./EmojiButton */ "./src/components/middle/composer/EmojiButton.tsx");










const EMOJIS_PER_ROW_ON_DESKTOP = 8;
const EMOJI_MARGIN = 0.625 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.REM;
const EMOJI_VERTICAL_MARGIN = 0.25 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.REM;
const EMOJI_VERTICAL_MARGIN_MOBILE = 0.5 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.REM;
const MOBILE_CONTAINER_PADDING = 0.5 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.REM;
const EmojiCategory = ({
  category,
  index,
  allEmojis,
  observeIntersection,
  shouldRender,
  onEmojiSelect
}) => {
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_6__.useOnIntersect)(ref, observeIntersection);
  const transitionClassNames = (0,_hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_7__["default"])(shouldRender);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const emojisPerRow = isMobile ? Math.floor((_util_windowSize__WEBPACK_IMPORTED_MODULE_3__["default"].get().width - MOBILE_CONTAINER_PADDING + EMOJI_MARGIN) / (_config__WEBPACK_IMPORTED_MODULE_1__.EMOJI_SIZE_PICKER + EMOJI_MARGIN)) : EMOJIS_PER_ROW_ON_DESKTOP;
  const height = Math.ceil(category.emojis.length / emojisPerRow) * (_config__WEBPACK_IMPORTED_MODULE_1__.EMOJI_SIZE_PICKER + (isMobile ? EMOJI_VERTICAL_MARGIN_MOBILE : EMOJI_VERTICAL_MARGIN));
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: ref,
    key: category.id,
    id: `emoji-category-${index}`,
    className: "symbol-set"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "symbol-set-header"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "symbol-set-name",
    dir: "auto"
  }, lang(category.id === _config__WEBPACK_IMPORTED_MODULE_1__.RECENT_SYMBOL_SET_ID ? 'RecentStickers' : `Emoji${index}`))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('symbol-set-container', transitionClassNames),
    style: `height: ${height}px;`,
    dir: lang.isRtl ? 'rtl' : undefined
  }, shouldRender && category.emojis.map(name => {
    const emoji = allEmojis[name];
    // Recent emojis may contain emoticons that are no longer in the list
    if (!emoji) {
      return undefined;
    }
    // Some emojis have multiple skins and are represented as an Object with emojis for all skins.
    // For now, we select only the first emoji with 'neutral' skin.
    const displayedEmoji = 'id' in emoji ? emoji : emoji[1];
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_EmojiButton__WEBPACK_IMPORTED_MODULE_9__["default"], {
      key: displayedEmoji.id,
      emoji: displayedEmoji,
      onClick: onEmojiSelect
    });
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(EmojiCategory));

/***/ }),

/***/ "./src/components/middle/composer/EmojiPicker.tsx":
/*!********************************************************!*\
  !*** ./src/components/middle/composer/EmojiPicker.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/animateHorizontalScroll */ "./src/util/animateHorizontalScroll.ts");
/* harmony import */ var _util_animateScroll__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/animateScroll */ "./src/util/animateScroll.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_emoji_emoji__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/emoji/emoji */ "./src/util/emoji/emoji.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useHorizontalScroll */ "./src/hooks/useHorizontalScroll.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../hooks/useScrolledState */ "./src/hooks/useScrolledState.ts");
/* harmony import */ var _right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../right/hooks/useAsyncRendering */ "./src/components/right/hooks/useAsyncRendering.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _EmojiCategory__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./EmojiCategory */ "./src/components/middle/composer/EmojiCategory.tsx");
/* harmony import */ var _EmojiPicker_scss__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./EmojiPicker.scss */ "./src/components/middle/composer/EmojiPicker.scss");
/* harmony import */ var _left_settings_folders_IconSelector__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../left/settings/folders/IconSelector */ "./src/components/left/settings/folders/IconSelector.tsx");
























const ICONS_BY_CATEGORY = {
  recent: 'recent',
  people: 'smile',
  nature: 'animals',
  foods: 'eats',
  activity: 'sport',
  places: 'car',
  objects: 'lamp',
  symbols: 'language',
  flags: 'flag'
};
const OPEN_ANIMATION_DELAY = 200;
const SMOOTH_SCROLL_DISTANCE = 100;
const FOCUS_MARGIN = 3.25 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__.REM;
const HEADER_BUTTON_WIDTH = 2.625 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__.REM; // Includes margins
const INTERSECTION_THROTTLE = 200;
const categoryIntersections = [];
let emojiDataPromise;
let emojiRawData;
let emojiData;
const EmojiPicker = ({
  className,
  recentEmojis,
  onEmojiSelect,
  isFolderPicker
}) => {
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const headerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [categories, setCategories] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [emojis, setEmojis] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [activeCategoryIndex, setActiveCategoryIndex] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const {
    handleScroll: handleContentScroll,
    isAtBeginning: shouldHideTopBorder
  } = (0,_hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_16__["default"])();
  const {
    observe: observeIntersection
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_13__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: INTERSECTION_THROTTLE
  }, entries => {
    entries.forEach(entry => {
      const {
        id
      } = entry.target;
      if (!id || !id.startsWith('emoji-category-')) {
        return;
      }
      const index = Number(id.replace('emoji-category-', ''));
      categoryIntersections[index] = entry.isIntersecting;
    });
    const minIntersectingIndex = categoryIntersections.reduce((lowestIndex, isIntersecting, index) => {
      return isIntersecting && index < lowestIndex ? index : lowestIndex;
    }, Infinity);
    if (minIntersectingIndex === Infinity) {
      return;
    }
    setActiveCategoryIndex(minIntersectingIndex);
  });
  const canRenderContents = (0,_right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_17__["default"])([], _config__WEBPACK_IMPORTED_MODULE_2__.MENU_TRANSITION_DURATION);
  const shouldRenderContent = emojis && canRenderContents;
  (0,_hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_12__["default"])(headerRef, !(isMobile && shouldRenderContent));

  // Scroll header when active set updates
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!categories) {
      return;
    }
    const header = headerRef.current;
    if (!header) {
      return;
    }
    const newLeft = activeCategoryIndex * HEADER_BUTTON_WIDTH - header.offsetWidth / 2 + HEADER_BUTTON_WIDTH / 2;
    (0,_util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_3__["default"])(header, newLeft);
  }, [categories, activeCategoryIndex]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_15__["default"])();
  const allCategories = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!categories) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_8__.MEMO_EMPTY_ARRAY;
    }
    const themeCategories = [...categories];
    if (recentEmojis?.length) {
      themeCategories.unshift({
        id: _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID,
        name: lang('RecentStickers'),
        emojis: recentEmojis
      });
    }
    return themeCategories;
  }, [categories, lang, recentEmojis]);

  // Initialize data on first render.
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setTimeout(() => {
      const exec = () => {
        setCategories(emojiData.categories);
        setEmojis(emojiData.emojis);
      };
      if (emojiData) {
        exec();
      } else {
        ensureEmojiData().then(exec);
      }
    }, OPEN_ANIMATION_DELAY);
  }, []);
  const selectCategory = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_14__["default"])(index => {
    setActiveCategoryIndex(index);
    const categoryEl = containerRef.current.closest('.SymbolMenu-main').querySelector(`#emoji-category-${index}`);
    (0,_util_animateScroll__WEBPACK_IMPORTED_MODULE_4__["default"])({
      container: containerRef.current,
      element: categoryEl,
      position: 'start',
      margin: FOCUS_MARGIN,
      maxDistance: SMOOTH_SCROLL_DISTANCE
    });
  });
  const handleEmojiSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_14__["default"])((emoji, name) => {
    onEmojiSelect(emoji, name);
  });
  function renderCategoryButton(category, index) {
    const icon = ICONS_BY_CATEGORY[category.id];
    return icon && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_19__["default"], {
      className: `symbol-set-button ${index === activeCategoryIndex ? 'activated' : ''}`,
      round: true,
      faded: true,
      color: "translucent"
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => selectCategory(index),
      ariaLabel: category.name
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
      name: icon
    }));
  }
  const containerClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('EmojiPicker', className);
  if (!shouldRenderContent) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: containerClassName
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_20__["default"], null));
  }
  const headerClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('EmojiPicker-header', !shouldHideTopBorder && 'with-top-border');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: containerClassName
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: headerRef,
    className: headerClassName,
    dir: lang.isRtl ? 'rtl' : undefined
  }, allCategories.map(renderCategoryButton)), isFolderPicker && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_left_settings_folders_IconSelector__WEBPACK_IMPORTED_MODULE_23__["default"], {
    onEmojiSelect: handleEmojiSelect
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    onScroll: handleContentScroll,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('EmojiPicker-main', _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_9__.IS_TOUCH_ENV ? 'no-scrollbar' : 'custom-scroll')
  }, allCategories.map((category, i) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_EmojiCategory__WEBPACK_IMPORTED_MODULE_21__["default"], {
    category: category,
    index: i,
    allEmojis: emojis,
    observeIntersection: observeIntersection,
    shouldRender: activeCategoryIndex >= i - 1 && activeCategoryIndex <= i + 1,
    onEmojiSelect: handleEmojiSelect
  }))));
};
async function ensureEmojiData() {
  if (!emojiDataPromise) {
    emojiDataPromise = __webpack_require__.e(/*! import() */ "vendors-node_modules_emoji-data-ios_emoji-data_json").then(__webpack_require__.t.bind(__webpack_require__, /*! emoji-data-ios/emoji-data.json */ "./node_modules/emoji-data-ios/emoji-data.json", 19));
    emojiRawData = (await emojiDataPromise).default;
    emojiData = (0,_util_emoji_emoji__WEBPACK_IMPORTED_MODULE_6__.uncompressEmoji)(emojiRawData);
  }
  return emojiDataPromise;
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_7__.pick)(global, ['recentEmojis']))(EmojiPicker)));

/***/ }),

/***/ "./src/components/middle/composer/EmojiTooltip.tsx":
/*!*********************************************************!*\
  !*** ./src/components/middle/composer/EmojiTooltip.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/animateHorizontalScroll */ "./src/util/animateHorizontalScroll.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_findInViewport__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/findInViewport */ "./src/util/findInViewport.ts");
/* harmony import */ var _util_visibility_isFullyVisible__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/visibility/isFullyVisible */ "./src/util/visibility/isFullyVisible.ts");
/* harmony import */ var _hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useEffectWithPrevDeps */ "./src/hooks/useEffectWithPrevDeps.ts");
/* harmony import */ var _hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useHorizontalScroll */ "./src/hooks/useHorizontalScroll.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_usePrevDuringAnimation__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/usePrevDuringAnimation */ "./src/hooks/usePrevDuringAnimation.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./hooks/useKeyboardNavigation */ "./src/components/middle/composer/hooks/useKeyboardNavigation.ts");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _CustomEmojiButton__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./CustomEmojiButton */ "./src/components/middle/composer/CustomEmojiButton.tsx");
/* harmony import */ var _EmojiButton__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./EmojiButton */ "./src/components/middle/composer/EmojiButton.tsx");
/* harmony import */ var _EmojiTooltip_scss__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./EmojiTooltip.scss */ "./src/components/middle/composer/EmojiTooltip.scss");
















const VIEWPORT_MARGIN = 8;
const EMOJI_BUTTON_WIDTH = 44;
const CLOSE_DURATION = 350;
function setItemVisible(index, containerRef) {
  const container = containerRef.current;
  if (!container) {
    return;
  }
  const {
    visibleIndexes,
    allElements
  } = (0,_util_findInViewport__WEBPACK_IMPORTED_MODULE_3__["default"])(container, '.EmojiButton', VIEWPORT_MARGIN, true, true, true);
  if (!allElements.length || !allElements[index]) {
    return;
  }
  const first = visibleIndexes[0];
  if (!visibleIndexes.includes(index) || index === first && !(0,_util_visibility_isFullyVisible__WEBPACK_IMPORTED_MODULE_4__["default"])(container, allElements[first], true)) {
    const position = index > visibleIndexes[visibleIndexes.length - 1] ? 'start' : 'end';
    const newLeft = position === 'start' ? index * EMOJI_BUTTON_WIDTH : 0;
    (0,_util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_1__["default"])(container, newLeft);
  }
}
const INTERSECTION_THROTTLE = 200;
const EmojiTooltip = ({
  isOpen,
  emojis,
  customEmojis,
  onClose,
  onEmojiSelect,
  onCustomEmojiSelect,
  addRecentEmoji,
  addRecentCustomEmoji
}) => {
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    shouldRender,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(isOpen, undefined, undefined, false);
  const listEmojis = (0,_hooks_usePrevDuringAnimation__WEBPACK_IMPORTED_MODULE_9__["default"])(emojis.length ? [...customEmojis, ...emojis] : undefined, CLOSE_DURATION) || [];
  (0,_hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_6__["default"])(containerRef);
  const {
    observe: observeIntersection
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_7__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: INTERSECTION_THROTTLE,
    isDisabled: !isOpen
  });
  const handleSelectEmoji = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(emoji => {
    onEmojiSelect(emoji.native);
    addRecentEmoji({
      emoji: emoji.id
    });
  });
  const handleCustomEmojiSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(emoji => {
    onCustomEmojiSelect(emoji);
    addRecentCustomEmoji({
      documentId: emoji.id
    });
  });
  const handleSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(emoji => {
    if ('native' in emoji) {
      handleSelectEmoji(emoji);
    } else {
      handleCustomEmojiSelect(emoji);
    }
  });
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])((native, id) => {
    onEmojiSelect(native);
    addRecentEmoji({
      emoji: id
    });
  });
  const handleCustomEmojiClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(emoji => {
    onCustomEmojiSelect(emoji);
    addRecentCustomEmoji({
      documentId: emoji.id
    });
  });
  const selectedIndex = (0,_hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_11__.useKeyboardNavigation)({
    isActive: isOpen,
    isHorizontal: true,
    items: listEmojis,
    shouldRemoveSelectionOnReset: true,
    onSelect: handleSelect,
    onClose
  });
  (0,_hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_5__["default"])(([prevSelectedIndex]) => {
    if (prevSelectedIndex === undefined || prevSelectedIndex === -1) {
      return;
    }
    setItemVisible(selectedIndex, containerRef);
  }, [selectedIndex]);
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('EmojiTooltip composer-tooltip custom-scroll-x', transitionClassNames);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: className
  }, shouldRender && listEmojis ? listEmojis.map((emoji, index) => 'native' in emoji ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_EmojiButton__WEBPACK_IMPORTED_MODULE_14__["default"], {
    key: emoji.id,
    emoji: emoji,
    focus: selectedIndex === index,
    onClick: handleClick
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_CustomEmojiButton__WEBPACK_IMPORTED_MODULE_13__["default"], {
    key: emoji.id,
    emoji: emoji,
    focus: selectedIndex === index,
    onClick: handleCustomEmojiClick,
    observeIntersection: observeIntersection
  })) : shouldRender ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_12__["default"], null) : undefined);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(EmojiTooltip));

/***/ }),

/***/ "./src/components/middle/composer/GifPicker.tsx":
/*!******************************************************!*\
  !*** ./src/components/middle/composer/GifPicker.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../right/hooks/useAsyncRendering */ "./src/components/right/hooks/useAsyncRendering.ts");
/* harmony import */ var _common_GifButton__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/GifButton */ "./src/components/common/GifButton.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _GifPicker_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./GifPicker.scss */ "./src/components/middle/composer/GifPicker.scss");












const INTERSECTION_DEBOUNCE = 300;
const GifPicker = ({
  className,
  loadAndPlay,
  canSendGifs,
  savedGifs,
  isSavedMessages,
  onGifSelect
}) => {
  const {
    loadSavedGifs,
    saveGif
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    observe: observeIntersection
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_6__.useIntersectionObserver)({
    rootRef: containerRef,
    debounceMs: INTERSECTION_DEBOUNCE
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (loadAndPlay) {
      loadSavedGifs();
    }
  }, [loadAndPlay, loadSavedGifs]);
  const handleUnsaveClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(gif => {
    saveGif({
      gif,
      shouldUnsave: true
    });
  });
  const canRenderContents = (0,_right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_8__["default"])([], _config__WEBPACK_IMPORTED_MODULE_2__.SLIDE_TRANSITION_DURATION);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('GifPicker', className, _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV ? 'no-scrollbar' : 'custom-scroll')
  }, !canSendGifs ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "picker-disabled"
  }, "Sending GIFs is not allowed in this chat.") : canRenderContents && savedGifs && savedGifs.length ? savedGifs.map(gif => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GifButton__WEBPACK_IMPORTED_MODULE_9__["default"], {
    key: gif.id,
    gif: gif,
    observeIntersection: observeIntersection,
    isDisabled: !loadAndPlay,
    onClick: canSendGifs ? onGifSelect : undefined,
    onUnsaveClick: handleUnsaveClick,
    isSavedMessages: isSavedMessages
  })) : canRenderContents && savedGifs ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "picker-disabled"
  }, "No saved GIFs.") : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_10__["default"], null)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    chatId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentMessageList)(global) || {};
  const isSavedMessages = Boolean(chatId) && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsChatWithSelf)(global, chatId);
  return {
    savedGifs: global.gifs.saved.gifs,
    isSavedMessages
  };
})(GifPicker)));

/***/ }),

/***/ "./src/components/middle/composer/InlineBotTooltip.tsx":
/*!*************************************************************!*\
  !*** ./src/components/middle/composer/InlineBotTooltip.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _util_setTooltipItemVisible__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/setTooltipItemVisible */ "./src/util/setTooltipItemVisible.ts");
/* harmony import */ var _util_themeStyle__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/themeStyle */ "./src/util/themeStyle.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./hooks/useKeyboardNavigation */ "./src/components/middle/composer/hooks/useKeyboardNavigation.ts");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _inlineResults_ArticleResult__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./inlineResults/ArticleResult */ "./src/components/middle/composer/inlineResults/ArticleResult.tsx");
/* harmony import */ var _inlineResults_GifResult__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./inlineResults/GifResult */ "./src/components/middle/composer/inlineResults/GifResult.tsx");
/* harmony import */ var _inlineResults_MediaResult__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./inlineResults/MediaResult */ "./src/components/middle/composer/inlineResults/MediaResult.tsx");
/* harmony import */ var _inlineResults_StickerResult__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./inlineResults/StickerResult */ "./src/components/middle/composer/inlineResults/StickerResult.tsx");
/* harmony import */ var _InlineBotTooltip_scss__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./InlineBotTooltip.scss */ "./src/components/middle/composer/InlineBotTooltip.scss");





















const INTERSECTION_DEBOUNCE_MS = 200;
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_4__.throttle)(cb => cb(), 500, true);
const InlineBotTooltip = ({
  isOpen,
  botId,
  isGallery,
  inlineBotResults,
  switchPm,
  switchWebview,
  isSavedMessages,
  canSendGifs,
  loadMore,
  onClose,
  onSelectResult,
  isCurrentUserPremium
}) => {
  const {
    openChat,
    startBot,
    requestSimpleWebView
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    shouldRender,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_12__["default"])(isOpen, undefined, undefined, false);
  const renderedIsGallery = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_8__["default"])(isGallery, shouldRender);
  const {
    observe: observeIntersection
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_9__.useIntersectionObserver)({
    rootRef: containerRef,
    debounceMs: INTERSECTION_DEBOUNCE_MS,
    isDisabled: !isOpen
  });
  const handleLoadMore = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards) {
      runThrottled(loadMore);
    }
  });
  const selectedIndex = (0,_hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_13__.useKeyboardNavigation)({
    isActive: isOpen,
    shouldRemoveSelectionOnReset: renderedIsGallery,
    noArrowNavigation: renderedIsGallery,
    items: inlineBotResults,
    onSelect: onSelectResult,
    onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    (0,_util_setTooltipItemVisible__WEBPACK_IMPORTED_MODULE_5__["default"])('.chat-item-clickable', selectedIndex, containerRef);
  }, [selectedIndex]);
  const handleSendPm = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    openChat({
      id: botId
    });
    startBot({
      botId: botId,
      param: switchPm.startParam
    });
  });
  const handleOpenWebview = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    const theme = (0,_util_themeStyle__WEBPACK_IMPORTED_MODULE_6__.extractCurrentThemeParams)();
    requestSimpleWebView({
      botId: botId,
      url: switchWebview.url,
      buttonText: switchWebview.text,
      theme,
      isFromSwitchWebView: true
    });
  });
  const prevInlineBotResults = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_11__["default"])(inlineBotResults?.length ? inlineBotResults : undefined, shouldRender);
  const renderedInlineBotResults = inlineBotResults?.length ? inlineBotResults : prevInlineBotResults;
  if (!shouldRender || !(renderedInlineBotResults?.length || switchPm)) {
    return undefined;
  }
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('InlineBotTooltip composer-tooltip', _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_7__.IS_TOUCH_ENV ? 'no-scrollbar' : 'custom-scroll', renderedIsGallery && 'gallery', transitionClassNames);
  function renderSwitchPm() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
      ripple: true,
      className: "switch-pm scroll-item",
      onClick: handleSendPm
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "title"
    }, switchPm.text));
  }
  function renderSwitchWebview() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
      ripple: true,
      className: "switch-pm scroll-item",
      onClick: handleOpenWebview
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "title"
    }, switchWebview.text));
  }
  function renderContent() {
    return renderedInlineBotResults.map((inlineBotResult, index) => {
      switch (inlineBotResult.type) {
        case 'gif':
          return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_inlineResults_GifResult__WEBPACK_IMPORTED_MODULE_17__["default"], {
            key: inlineBotResult.id,
            inlineResult: inlineBotResult,
            observeIntersection: observeIntersection,
            onClick: onSelectResult,
            isSavedMessages: isSavedMessages,
            canSendGifs: canSendGifs
          });
        case 'photo':
          return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_inlineResults_MediaResult__WEBPACK_IMPORTED_MODULE_18__["default"], {
            key: inlineBotResult.id,
            isForGallery: renderedIsGallery,
            inlineResult: inlineBotResult,
            onClick: onSelectResult
          });
        case 'sticker':
          return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_inlineResults_StickerResult__WEBPACK_IMPORTED_MODULE_19__["default"], {
            key: inlineBotResult.id,
            inlineResult: inlineBotResult,
            observeIntersection: observeIntersection,
            onClick: onSelectResult,
            isSavedMessages: isSavedMessages,
            isCurrentUserPremium: isCurrentUserPremium
          });
        case 'video':
        case 'file':
        case 'game':
          return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_inlineResults_MediaResult__WEBPACK_IMPORTED_MODULE_18__["default"], {
            key: inlineBotResult.id,
            focus: selectedIndex === index,
            inlineResult: inlineBotResult,
            onClick: onSelectResult
          });
        case 'article':
        case 'audio':
        case 'voice':
          return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_inlineResults_ArticleResult__WEBPACK_IMPORTED_MODULE_16__["default"], {
            key: inlineBotResult.id,
            focus: selectedIndex === index,
            inlineResult: inlineBotResult,
            onClick: onSelectResult
          });
        default:
          return undefined;
      }
    });
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_14__["default"], {
    ref: containerRef,
    className: className,
    items: renderedInlineBotResults,
    itemSelector: ".chat-item-clickable",
    noFastList: true,
    onLoadMore: handleLoadMore,
    sensitiveArea: 160
  }, switchPm && renderSwitchPm(), switchWebview && renderSwitchWebview(), Boolean(renderedInlineBotResults?.length) && renderContent());
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(InlineBotTooltip));

/***/ }),

/***/ "./src/components/middle/composer/MentionTooltip.tsx":
/*!***********************************************************!*\
  !*** ./src/components/middle/composer/MentionTooltip.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_setTooltipItemVisible__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/setTooltipItemVisible */ "./src/util/setTooltipItemVisible.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./hooks/useKeyboardNavigation */ "./src/components/middle/composer/hooks/useKeyboardNavigation.ts");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _MentionTooltip_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./MentionTooltip.scss */ "./src/components/middle/composer/MentionTooltip.scss");











const MentionTooltip = ({
  isOpen,
  onClose,
  onInsertUserName,
  filteredUsers
}) => {
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    shouldRender,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_6__["default"])(isOpen, undefined, undefined, false);
  const handleUserSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])((userId, forceFocus = false) => {
    // No need for expensive global updates on users, so we avoid them
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    const user = usersById[userId];
    if (!user) {
      return;
    }
    onInsertUserName(user, forceFocus);
  });
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])((e, id) => {
    e.preventDefault();
    handleUserSelect(id);
  });
  const handleSelectMention = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(member => {
    handleUserSelect(member.id, true);
  });
  const selectedMentionIndex = (0,_hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_7__.useKeyboardNavigation)({
    isActive: isOpen,
    items: filteredUsers,
    onSelect: handleSelectMention,
    shouldSelectOnTab: true,
    shouldSaveSelectionOnUpdateItems: true,
    onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    (0,_util_setTooltipItemVisible__WEBPACK_IMPORTED_MODULE_3__["default"])('.chat-item-clickable', selectedMentionIndex, containerRef);
  }, [selectedMentionIndex]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (filteredUsers && !filteredUsers.length) {
      onClose();
    }
  }, [filteredUsers, onClose]);
  const prevChatMembers = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_5__["default"])(filteredUsers?.length ? filteredUsers : undefined, shouldRender);
  const renderedChatMembers = filteredUsers && !filteredUsers.length ? prevChatMembers : filteredUsers;
  if (!shouldRender || renderedChatMembers && !renderedChatMembers.length) {
    return undefined;
  }
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('MentionTooltip composer-tooltip custom-scroll', transitionClassNames);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: className,
    ref: containerRef
  }, renderedChatMembers?.map(({
    id
  }, index) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    key: id,
    className: "chat-item-clickable scroll-item smaller-icon",
    onClick: handleClick,
    clickArg: id,
    focus: selectedMentionIndex === index
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_8__["default"], {
    userId: id,
    avatarSize: "small",
    withUsername: true
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(MentionTooltip));

/***/ }),

/***/ "./src/components/middle/composer/PollModal.tsx":
/*!******************************************************!*\
  !*** ./src/components/middle/composer/PollModal.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/captureEscKeyListener */ "./src/util/captureEscKeyListener.ts");
/* harmony import */ var _util_parseHtmlAsFormattedText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/parseHtmlAsFormattedText */ "./src/util/parseHtmlAsFormattedText.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");
/* harmony import */ var _ui_TextArea__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/TextArea */ "./src/components/ui/TextArea.tsx");
/* harmony import */ var _PollModal_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./PollModal.scss */ "./src/components/middle/composer/PollModal.scss");














const MAX_LIST_HEIGHT = 320;
const MAX_OPTIONS_COUNT = 10;
const MAX_OPTION_LENGTH = 100;
const MAX_QUESTION_LENGTH = 255;
const MAX_SOLUTION_LENGTH = 200;
const PollModal = ({
  isOpen,
  isQuiz,
  shouldBeAnonymous,
  onSend,
  onClear
}) => {
  // eslint-disable-next-line no-null/no-null
  const questionInputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const optionsListRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [question, setQuestion] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [options, setOptions] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(['']);
  const [isAnonymous, setIsAnonymous] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [isMultipleAnswers, setIsMultipleAnswers] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isQuizMode, setIsQuizMode] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(isQuiz || false);
  const [solution, setSolution] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [correctOption, setCorrectOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [hasErrors, setHasErrors] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const handleSolutionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(e => {
    setSolution(e.target.value);
  });
  const focusInput = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(ref => {
    if (isOpen && ref.current) {
      ref.current.focus();
    }
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => isOpen ? (0,_util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_2__["default"])(onClear) : undefined, [isOpen, onClear]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      setQuestion('');
      setOptions(['']);
      setIsAnonymous(true);
      setIsMultipleAnswers(false);
      setIsQuizMode(isQuiz || false);
      setSolution('');
      setCorrectOption(undefined);
      setHasErrors(false);
    }
  }, [isQuiz, isOpen]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => focusInput(questionInputRef), [focusInput, isOpen]);
  const addNewOption = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])((newOptions = []) => {
    setOptions([...newOptions, '']);
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_1__.requestNextMutation)(() => {
      const list = optionsListRef.current;
      if (!list) {
        return;
      }
      (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_1__.requestMeasure)(() => {
        list.scrollTo({
          top: list.scrollHeight,
          behavior: 'smooth'
        });
      });
    });
  });
  const handleCreate = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    setHasErrors(false);
    if (!isOpen) {
      return;
    }
    const isNoCorrectOptionError = isQuizMode && (correctOption === undefined || !options[correctOption].trim());
    const answers = options.map((text, index) => {
      text = text.trim();
      if (!text) return undefined;
      return {
        text: {
          text
        },
        option: String(index),
        ...(index === correctOption && {
          correct: true
        })
      };
    }).filter(Boolean);
    const questionTrimmed = question.trim().substring(0, MAX_QUESTION_LENGTH);
    if (!questionTrimmed || answers.length < 2) {
      setQuestion(questionTrimmed);
      if (answers.length) {
        const optionsTrimmed = options.map(o => o.trim().substring(0, MAX_OPTION_LENGTH)).filter(Boolean);
        if (optionsTrimmed.length < 2) {
          addNewOption(optionsTrimmed);
        } else {
          setOptions(optionsTrimmed);
        }
      } else {
        addNewOption();
      }
      setHasErrors(true);
      return;
    }
    if (isNoCorrectOptionError) {
      setHasErrors(true);
      return;
    }
    const payload = {
      summary: {
        question: {
          text: questionTrimmed
        },
        answers,
        ...(!isAnonymous && {
          isPublic: true
        }),
        ...(isMultipleAnswers && {
          multipleChoice: true
        }),
        ...(isQuizMode && {
          quiz: true
        })
      }
    };
    if (isQuizMode) {
      const {
        text,
        entities
      } = solution && (0,_util_parseHtmlAsFormattedText__WEBPACK_IMPORTED_MODULE_3__["default"])(solution.substring(0, MAX_SOLUTION_LENGTH)) || {};
      payload.quiz = {
        correctAnswers: [String(correctOption)],
        ...(text && {
          solution: text
        }),
        ...(entities && {
          solutionEntities: entities
        })
      };
    }
    onSend(payload);
  });
  const updateOption = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])((index, text) => {
    const newOptions = [...options];
    newOptions[index] = text;
    if (newOptions[newOptions.length - 1].trim().length && newOptions.length < MAX_OPTIONS_COUNT) {
      addNewOption(newOptions);
    } else {
      setOptions(newOptions);
    }
  });
  const removeOption = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(index => {
    const newOptions = [...options];
    newOptions.splice(index, 1);
    setOptions(newOptions);
    if (correctOption !== undefined) {
      if (correctOption === index) {
        setCorrectOption(undefined);
      } else if (index < correctOption) {
        setCorrectOption(correctOption - 1);
      }
    }
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_1__.requestNextMutation)(() => {
      if (!optionsListRef.current) {
        return;
      }
      optionsListRef.current.classList.toggle('overflown', optionsListRef.current.scrollHeight > MAX_LIST_HEIGHT);
    });
  });
  const handleCorrectOptionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(newValue => {
    setCorrectOption(Number(newValue));
  });
  const handleIsAnonymousChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(e => {
    setIsAnonymous(e.target.checked);
  });
  const handleMultipleAnswersChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(e => {
    setIsMultipleAnswers(e.target.checked);
  });
  const handleQuizModeChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(e => {
    setIsQuizMode(e.target.checked);
  });
  const handleKeyPress = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(e => {
    if (e.keyCode === 13) {
      handleCreate();
    }
  });
  const handleQuestionChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(e => {
    setQuestion(e.target.value);
  });
  const getQuestionError = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    if (hasErrors && !question.trim().length) {
      return lang('lng_polls_choose_question');
    }
    return undefined;
  });
  const getOptionsError = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(index => {
    const optionsTrimmed = options.map(o => o.trim()).filter(o => o.length);
    if (hasErrors && optionsTrimmed.length < 2 && !options[index].trim().length) {
      return lang('lng_polls_choose_answers');
    }
    return undefined;
  });
  function renderHeader() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header-condensed"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: "Cancel poll creation",
      onClick: onClear
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_6__["default"], {
      name: "close"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-title"
    }, lang('NewPoll')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
      color: "primary",
      size: "smaller",
      className: "modal-action-button",
      onClick: handleCreate
    }, lang('Create')));
  }
  function renderOptions() {
    return options.map((option, index) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "option-wrapper"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_9__["default"], {
      label: index !== options.length - 1 || options.length === MAX_OPTIONS_COUNT ? lang('OptionHint') : lang('CreatePoll.AddOption'),
      error: getOptionsError(index),
      value: option
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onChange: e => updateOption(index, e.currentTarget.value),
      onKeyPress: handleKeyPress
    }), index !== options.length - 1 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
      className: "option-remove-button",
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: lang('Delete')
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => removeOption(index)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_6__["default"], {
      name: "close"
    }))));
  }
  function renderRadioOptions() {
    return renderOptions().map((label, index) => ({
      value: String(index),
      label,
      hidden: !options[index].trim()
    }));
  }
  function renderQuizNoOptionError() {
    const optionsTrimmed = options.map(o => o.trim()).filter(o => o.length);
    return isQuizMode && (correctOption === undefined || !optionsTrimmed[correctOption]) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "poll-error"
    }, lang('lng_polls_choose_correct'));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isOpen: isOpen,
    onClose: onClear,
    header: renderHeader(),
    className: "PollModal"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_9__["default"], {
    ref: questionInputRef,
    label: lang('AskAQuestion'),
    value: question,
    error: getQuestionError(),
    onChange: handleQuestionChange,
    onKeyPress: handleKeyPress
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "options-divider"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "options-list custom-scroll",
    ref: optionsListRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "options-header"
  }, lang('PollOptions')), hasErrors && renderQuizNoOptionError(), isQuizMode ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_11__["default"], {
    name: "correctOption",
    options: renderRadioOptions(),
    selected: String(correctOption),
    onChange: handleCorrectOptionChange
  }) : renderOptions()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "options-divider"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "quiz-mode"
  }, !shouldBeAnonymous && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    label: lang('PollAnonymous'),
    checked: isAnonymous,
    onChange: handleIsAnonymousChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    label: lang('PollMultiple'),
    checked: isMultipleAnswers,
    disabled: isQuizMode,
    onChange: handleMultipleAnswersChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    label: lang('PollQuiz'),
    checked: isQuizMode,
    disabled: isMultipleAnswers || isQuiz !== undefined,
    onChange: handleQuizModeChange
  }), isQuizMode && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "options-header"
  }, lang('lng_polls_solution_title')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_TextArea__WEBPACK_IMPORTED_MODULE_12__["default"], {
    value: solution,
    onChange: handleSolutionChange,
    noReplaceNewlines: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "note"
  }, lang('CreatePoll.ExplanationInfo')))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PollModal));

/***/ }),

/***/ "./src/components/middle/composer/SendAsMenu.tsx":
/*!*******************************************************!*\
  !*** ./src/components/middle/composer/SendAsMenu.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_setTooltipItemVisible__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/setTooltipItemVisible */ "./src/util/setTooltipItemVisible.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMouseInside__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useMouseInside */ "./src/hooks/useMouseInside.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./hooks/useKeyboardNavigation */ "./src/components/middle/composer/hooks/useKeyboardNavigation.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_FullNameTitle__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/FullNameTitle */ "./src/components/common/FullNameTitle.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _SendAsMenu_scss__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./SendAsMenu.scss */ "./src/components/middle/composer/SendAsMenu.scss");















const SendAsMenu = ({
  isOpen,
  chatId,
  selectedSendAsId,
  sendAsPeerIds,
  isCurrentUserPremium,
  onClose
}) => {
  const {
    saveDefaultSendAs,
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // No need for expensive global updates on users and chats, so we avoid them
  const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
  const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [handleMouseEnter, handleMouseLeave, markMouseInside] = (0,_hooks_useMouseInside__WEBPACK_IMPORTED_MODULE_6__["default"])(isOpen, onClose, undefined);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      markMouseInside();
    }
  }, [isOpen, markMouseInside]);
  const handleUserSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(id => {
    onClose();
    saveDefaultSendAs({
      chatId: chatId,
      sendAsId: id
    });
  });
  const selectedSendAsIndex = (0,_hooks_useKeyboardNavigation__WEBPACK_IMPORTED_MODULE_8__.useKeyboardNavigation)({
    isActive: isOpen,
    items: sendAsPeerIds,
    onSelect: handleUserSelect,
    shouldSelectOnTab: true,
    shouldSaveSelectionOnUpdateItems: true,
    onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    (0,_util_setTooltipItemVisible__WEBPACK_IMPORTED_MODULE_3__["default"])('.chat-item-clickable', selectedSendAsIndex, containerRef);
  }, [selectedSendAsIndex]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (sendAsPeerIds && !sendAsPeerIds.length) {
      onClose();
    }
  }, [sendAsPeerIds, onClose]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isOpen,
    positionX: "left",
    positionY: "bottom",
    onClose: onClose,
    className: "SendAsMenu",
    onCloseAnimationEnd: onClose,
    onMouseEnter: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_TOUCH_ENV ? handleMouseEnter : undefined,
    onMouseLeave: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_TOUCH_ENV ? handleMouseLeave : undefined,
    noCloseOnBackdrop: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_TOUCH_ENV,
    noCompact: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "send-as-title",
    dir: "auto"
  }, lang('SendMessageAsTitle')), usersById && chatsById && sendAsPeerIds?.map(({
    id,
    isPremium
  }, index) => {
    const user = usersById[id];
    const chat = chatsById[id];
    const peer = user || chat;
    const handleClick = () => {
      if (!isPremium || isCurrentUserPremium) {
        handleUserSelect(id);
      } else {
        showNotification({
          message: lang('SelectSendAsPeerPremiumHint'),
          actionText: lang('Open'),
          action: {
            action: 'openPremiumModal',
            payload: {}
          }
        });
      }
    };
    const avatarClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(selectedSendAsId === id && 'selected');
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
      key: id,
      className: "SendAsItem chat-item-clickable scroll-item with-avatar"
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: handleClick,
      focus: selectedSendAsIndex === index,
      rightElement: !isCurrentUserPremium && isPremium && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
        name: "lock-badge",
        className: "send-as-icon-locked"
      })
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_9__["default"], {
      size: "small",
      peer: peer,
      className: avatarClassName
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "info"
    }, peer && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_FullNameTitle__WEBPACK_IMPORTED_MODULE_10__["default"], {
      peer: peer,
      noFake: true
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: "subtitle"
    }, user ? lang('VoipGroupPersonalAccount') : lang('Subscribers', chat?.membersCount, 'i'))));
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SendAsMenu));

/***/ }),

/***/ "./src/components/middle/composer/StickerPicker.tsx":
/*!**********************************************************!*\
  !*** ./src/components/middle/composer/StickerPicker.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/animateHorizontalScroll */ "./src/util/animateHorizontalScroll.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useHorizontalScroll */ "./src/hooks/useHorizontalScroll.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../hooks/useScrolledState */ "./src/hooks/useScrolledState.ts");
/* harmony import */ var _hooks_useSendMessageAction__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../hooks/useSendMessageAction */ "./src/hooks/useSendMessageAction.ts");
/* harmony import */ var _common_hooks_useStickerPickerObservers__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../common/hooks/useStickerPickerObservers */ "./src/components/common/hooks/useStickerPickerObservers.ts");
/* harmony import */ var _right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../right/hooks/useAsyncRendering */ "./src/components/right/hooks/useAsyncRendering.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_StickerButton__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../common/StickerButton */ "./src/components/common/StickerButton.tsx");
/* harmony import */ var _common_StickerSet__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../common/StickerSet */ "./src/components/common/StickerSet.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _StickerSetCover__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./StickerSetCover */ "./src/components/middle/composer/StickerSetCover.tsx");
/* harmony import */ var _StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./StickerPicker.module.scss */ "./src/components/middle/composer/StickerPicker.module.scss");


























const HEADER_BUTTON_WIDTH = 2.5 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_10__.REM; // px (including margin)

const StickerPicker = ({
  chat,
  threadId,
  className,
  isHidden,
  isTranslucent,
  loadAndPlay,
  canSendStickers,
  recentStickers,
  favoriteStickers,
  effectStickers,
  effectEmojis,
  addedSetIds,
  stickerSetsById,
  chatStickerSetId,
  canAnimate,
  isSavedMessages,
  isCurrentUserPremium,
  noContextMenus,
  idPrefix,
  onStickerSelect,
  isForEffects
}) => {
  const {
    loadRecentStickers,
    addRecentSticker,
    unfaveSticker,
    faveSticker,
    removeRecentSticker
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const headerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const sharedCanvasRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    handleScroll: handleContentScroll,
    isAtBeginning: shouldHideTopBorder
  } = (0,_hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_14__["default"])();
  const sendMessageAction = (0,_hooks_useSendMessageAction__WEBPACK_IMPORTED_MODULE_15__["default"])(chat?.id, threadId);
  const prefix = `${idPrefix}-sticker-set`;
  const {
    activeSetIndex,
    observeIntersectionForSet,
    observeIntersectionForPlayingItems,
    observeIntersectionForShowingItems,
    observeIntersectionForCovers,
    selectStickerSet
  } = (0,_common_hooks_useStickerPickerObservers__WEBPACK_IMPORTED_MODULE_16__.useStickerPickerObservers)(containerRef, headerRef, prefix, isHidden);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__["default"])();
  const areAddedLoaded = Boolean(addedSetIds);
  const allSets = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (isForEffects && effectStickers) {
      const effectSets = [];
      if (effectEmojis?.length) {
        effectSets.push({
          id: _config__WEBPACK_IMPORTED_MODULE_2__.EFFECT_EMOJIS_SET_ID,
          accessHash: '0',
          title: '',
          stickers: effectEmojis,
          count: effectEmojis.length,
          isEmoji: true
        });
      }
      if (effectStickers?.length) {
        effectSets.push({
          id: _config__WEBPACK_IMPORTED_MODULE_2__.EFFECT_STICKERS_SET_ID,
          accessHash: '0',
          title: lang('StickerEffects'),
          stickers: effectStickers,
          count: effectStickers.length
        });
      }
      return effectSets;
    }
    if (!addedSetIds) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_8__.MEMO_EMPTY_ARRAY;
    }
    const defaultSets = [];
    if (favoriteStickers.length) {
      defaultSets.push({
        id: _config__WEBPACK_IMPORTED_MODULE_2__.FAVORITE_SYMBOL_SET_ID,
        accessHash: '0',
        title: lang('FavoriteStickers'),
        stickers: favoriteStickers,
        count: favoriteStickers.length
      });
    }
    if (recentStickers.length) {
      defaultSets.push({
        id: _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID,
        accessHash: '0',
        title: lang('RecentStickers'),
        stickers: recentStickers,
        count: recentStickers.length
      });
    }
    const userSetIds = [...(addedSetIds || [])];
    if (chatStickerSetId) {
      userSetIds.unshift(chatStickerSetId);
    }
    const existingAddedSetIds = Object.values((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_7__.pickTruthy)(stickerSetsById, userSetIds));
    return [...defaultSets, ...existingAddedSetIds];
  }, [addedSetIds, stickerSetsById, favoriteStickers, recentStickers, chatStickerSetId, lang, effectStickers, isForEffects, effectEmojis]);
  const noPopulatedSets = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => areAddedLoaded && allSets.filter(set => set.stickers?.length).length === 0, [allSets, areAddedLoaded]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!loadAndPlay) return;
    loadRecentStickers();
    if (!canSendStickers) return;
    sendMessageAction({
      type: 'chooseSticker'
    });
  }, [canSendStickers, loadAndPlay, loadRecentStickers, sendMessageAction]);
  const canRenderContents = (0,_right_hooks_useAsyncRendering__WEBPACK_IMPORTED_MODULE_17__["default"])([], _config__WEBPACK_IMPORTED_MODULE_2__.SLIDE_TRANSITION_DURATION);
  const shouldRenderContents = areAddedLoaded && canRenderContents && !noPopulatedSets && (canSendStickers || isForEffects);
  (0,_hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_11__["default"])(headerRef, !shouldRenderContents || !headerRef.current);

  // Scroll container and header when active set changes
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!areAddedLoaded) {
      return;
    }
    const header = headerRef.current;
    if (!header) {
      return;
    }
    const newLeft = activeSetIndex * HEADER_BUTTON_WIDTH - (header.offsetWidth / 2 - HEADER_BUTTON_WIDTH / 2);
    (0,_util_animateHorizontalScroll__WEBPACK_IMPORTED_MODULE_5__["default"])(header, newLeft);
  }, [areAddedLoaded, activeSetIndex]);
  const handleStickerSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__["default"])((sticker, isSilent, shouldSchedule) => {
    onStickerSelect(sticker, isSilent, shouldSchedule, true);
    addRecentSticker({
      sticker
    });
  });
  const handleStickerUnfave = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__["default"])(sticker => {
    unfaveSticker({
      sticker
    });
  });
  const handleStickerFave = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__["default"])(sticker => {
    faveSticker({
      sticker
    });
  });
  const handleMouseMove = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__["default"])(() => {
    if (!canSendStickers) return;
    sendMessageAction({
      type: 'chooseSticker'
    });
  });
  const handleRemoveRecentSticker = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__["default"])(sticker => {
    removeRecentSticker({
      sticker
    });
  });
  if (!chat) return undefined;
  function renderCover(stickerSet, index) {
    const firstSticker = stickerSet.stickers?.[0];
    const buttonClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].stickerCover, index === activeSetIndex && _StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].activated);
    const withSharedCanvas = index < _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_PICKER_MAX_SHARED_COVERS;
    if (stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID || stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.FAVORITE_SYMBOL_SET_ID || stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.CHAT_STICKER_SET_ID || stickerSet.hasThumbnail || !firstSticker) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_22__["default"], {
        key: stickerSet.id,
        className: buttonClassName,
        ariaLabel: stickerSet.title,
        round: true,
        faded: stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID || stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.FAVORITE_SYMBOL_SET_ID,
        color: "translucent"
        // eslint-disable-next-line react/jsx-no-bind
        ,
        onClick: () => selectStickerSet(index)
      }, stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.RECENT_SYMBOL_SET_ID ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
        name: "recent"
      }) : stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.FAVORITE_SYMBOL_SET_ID ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
        name: "favorite"
      }) : stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.CHAT_STICKER_SET_ID ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_18__["default"], {
        peer: chat,
        size: "small"
      }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerSetCover__WEBPACK_IMPORTED_MODULE_24__["default"], {
        stickerSet: stickerSet,
        noPlay: !canAnimate || !loadAndPlay,
        observeIntersection: observeIntersectionForCovers,
        sharedCanvasRef: withSharedCanvas ? sharedCanvasRef : undefined,
        forcePlayback: true
      }));
    } else {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_StickerButton__WEBPACK_IMPORTED_MODULE_20__["default"], {
        key: stickerSet.id,
        sticker: firstSticker,
        size: _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_PICKER_HEADER,
        title: stickerSet.title,
        className: buttonClassName,
        noPlay: !canAnimate || !loadAndPlay,
        observeIntersection: observeIntersectionForCovers,
        noContextMenu: true,
        isCurrentUserPremium: true,
        sharedCanvasRef: withSharedCanvas ? sharedCanvasRef : undefined,
        withTranslucentThumb: isTranslucent,
        onClick: selectStickerSet,
        clickArg: index,
        forcePlayback: true
      });
    }
  }
  const fullClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].root, className);
  if (!shouldRenderContents) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: fullClassName
    }, !canSendStickers && !isForEffects ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].pickerDisabled
    }, lang('ErrorSendRestrictedStickersAll')) : noPopulatedSets ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].pickerDisabled
    }, lang('NoStickers')) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_23__["default"], null));
  }
  const headerClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].header, 'no-scrollbar', !shouldHideTopBorder && _StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].headerWithBorder);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: fullClassName
  }, !isForEffects && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: headerRef,
    className: headerClassName
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "shared-canvas-container"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: sharedCanvasRef,
    className: "shared-canvas"
  }), allSets.map(renderCover))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    onMouseMove: handleMouseMove,
    onScroll: handleContentScroll,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].main, _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_9__.IS_TOUCH_ENV ? 'no-scrollbar' : 'custom-scroll', !isForEffects && _StickerPicker_module_scss__WEBPACK_IMPORTED_MODULE_25__["default"].hasHeader)
  }, allSets.map((stickerSet, i) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_StickerSet__WEBPACK_IMPORTED_MODULE_21__["default"], {
    key: stickerSet.id,
    stickerSet: stickerSet,
    loadAndPlay: Boolean(canAnimate && loadAndPlay),
    noContextMenus: noContextMenus,
    index: i,
    idPrefix: prefix,
    observeIntersection: observeIntersectionForSet,
    observeIntersectionForPlayingItems: observeIntersectionForPlayingItems,
    observeIntersectionForShowingItems: observeIntersectionForShowingItems,
    isNearActive: activeSetIndex >= i - 1 && activeSetIndex <= i + 1,
    favoriteStickers: favoriteStickers,
    isSavedMessages: isSavedMessages,
    isCurrentUserPremium: isCurrentUserPremium,
    isTranslucent: isTranslucent,
    isChatStickerSet: stickerSet.id === chatStickerSetId,
    onStickerSelect: handleStickerSelect,
    onStickerUnfave: handleStickerUnfave,
    onStickerFave: handleStickerFave,
    onStickerRemoveRecent: handleRemoveRecentSticker,
    forcePlayback: true,
    shouldHideHeader: stickerSet.id === _config__WEBPACK_IMPORTED_MODULE_2__.EFFECT_EMOJIS_SET_ID
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const {
    setsById,
    added,
    recent,
    favorite,
    effect
  } = global.stickers;
  const isSavedMessages = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsChatWithSelf)(global, chatId);
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  const chatStickerSetId = !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserId)(chatId) ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId)?.stickerSet?.id : undefined;
  return {
    chat,
    effectStickers: effect?.stickers,
    effectEmojis: effect?.emojis,
    recentStickers: recent.stickers,
    favoriteStickers: favorite.stickers,
    stickerSetsById: setsById,
    addedSetIds: added.setIds,
    canAnimate: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectShouldLoopStickers)(global),
    isSavedMessages,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsCurrentUserPremium)(global),
    chatStickerSetId
  };
})(StickerPicker)));

/***/ }),

/***/ "./src/components/middle/composer/StickerSetCover.tsx":
/*!************************************************************!*\
  !*** ./src/components/middle/composer/StickerSetCover.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_textFormat__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/textFormat */ "./src/util/textFormat.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_stickers_useColorFilter__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/stickers/useColorFilter */ "./src/hooks/stickers/useColorFilter.tsx");
/* harmony import */ var _hooks_stickers_useDynamicColorListener__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/stickers/useDynamicColorListener */ "./src/hooks/stickers/useDynamicColorListener.ts");
/* harmony import */ var _hooks_useCoordsInSharedCanvas__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useCoordsInSharedCanvas */ "./src/hooks/useCoordsInSharedCanvas.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useMediaTransitionDeprecated */ "./src/hooks/useMediaTransitionDeprecated.ts");
/* harmony import */ var _common_hooks_useCustomEmoji__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/hooks/useCustomEmoji */ "./src/components/common/hooks/useCustomEmoji.ts");
/* harmony import */ var _common_AnimatedSticker__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/AnimatedSticker */ "./src/components/common/AnimatedSticker.tsx");
/* harmony import */ var _common_CustomEmoji__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../common/CustomEmoji */ "./src/components/common/CustomEmoji.tsx");
/* harmony import */ var _ui_OptimizedVideo__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/OptimizedVideo */ "./src/components/ui/OptimizedVideo.tsx");
/* harmony import */ var _StickerSetCover_module_scss__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./StickerSetCover.module.scss */ "./src/components/middle/composer/StickerSetCover.module.scss");



















const StickerSetCover = ({
  stickerSet,
  size = _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_PICKER_HEADER,
  noPlay,
  forcePlayback,
  observeIntersection,
  sharedCanvasRef
}) => {
  const {
    loadStickers
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    hasThumbnail,
    hasVideoThumb,
    hasAnimatedThumb,
    hasStaticThumb,
    thumbCustomEmojiId
  } = stickerSet;
  const {
    customEmoji
  } = (0,_common_hooks_useCustomEmoji__WEBPACK_IMPORTED_MODULE_14__["default"])(thumbCustomEmojiId);
  const hasCustomColor = customEmoji?.shouldUseTextColor;
  const customColor = (0,_hooks_stickers_useDynamicColorListener__WEBPACK_IMPORTED_MODULE_9__["default"])(containerRef, !hasCustomColor);
  const colorFilter = (0,_hooks_stickers_useColorFilter__WEBPACK_IMPORTED_MODULE_8__["default"])(customColor);
  const isIntersecting = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_11__.useIsIntersecting)(containerRef, observeIntersection);
  const shouldPlay = isIntersecting && !noPlay;
  const hasOnlyStaticThumb = hasStaticThumb && !hasVideoThumb && !hasAnimatedThumb && !thumbCustomEmojiId;
  const shouldFallbackToStatic = hasOnlyStaticThumb || hasVideoThumb && !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_7__.IS_WEBM_SUPPORTED && !hasAnimatedThumb;
  const staticHash = shouldFallbackToStatic && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getStickerMediaHash)(stickerSet.stickers[0], 'preview');
  const staticMediaData = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_12__["default"])(staticHash, !isIntersecting);
  const mediaHash = (hasThumbnail && !shouldFallbackToStatic || hasAnimatedThumb) && `stickerSet${stickerSet.id}`;
  const mediaData = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_12__["default"])(mediaHash, !isIntersecting);
  const isReady = thumbCustomEmojiId || mediaData || staticMediaData;
  const transitionClassNames = (0,_hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_13__["default"])(isReady);
  const coords = (0,_hooks_useCoordsInSharedCanvas__WEBPACK_IMPORTED_MODULE_10__["default"])(containerRef, sharedCanvasRef);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isIntersecting && !stickerSet.stickers?.length) {
      loadStickers({
        stickerSetInfo: stickerSet
      });
    }
  }, [isIntersecting, loadStickers, stickerSet]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_StickerSetCover_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].root, 'sticker-set-cover')
  }, isReady ? thumbCustomEmojiId ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmoji__WEBPACK_IMPORTED_MODULE_16__["default"], {
    documentId: thumbCustomEmojiId,
    size: size,
    observeIntersectionForPlaying: observeIntersection,
    noPlay: noPlay
  }) : hasAnimatedThumb ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedSticker__WEBPACK_IMPORTED_MODULE_15__["default"], {
    className: transitionClassNames,
    tgsUrl: mediaData,
    size: size,
    play: shouldPlay,
    isLowPriority: !(0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsAlwaysHighPriorityEmoji)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), stickerSet),
    sharedCanvas: sharedCanvasRef?.current || undefined,
    sharedCanvasCoords: coords,
    forceAlways: forcePlayback
  }) : hasVideoThumb && !shouldFallbackToStatic ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_OptimizedVideo__WEBPACK_IMPORTED_MODULE_17__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_StickerSetCover_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].video, transitionClassNames),
    src: mediaData,
    canPlay: shouldPlay,
    style: colorFilter,
    isPriority: forcePlayback,
    loop: true,
    disablePictureInPicture: true
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: mediaData || staticMediaData,
    style: colorFilter,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_StickerSetCover_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].image, transitionClassNames),
    alt: "",
    draggable: false
  }) : (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_6__.getFirstLetters)(stickerSet.title, 2));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StickerSetCover));

/***/ }),

/***/ "./src/components/middle/composer/StickerTooltip.tsx":
/*!***********************************************************!*\
  !*** ./src/components/middle/composer/StickerTooltip.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/captureEscKeyListener */ "./src/util/captureEscKeyListener.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_useSendMessageAction__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useSendMessageAction */ "./src/hooks/useSendMessageAction.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _common_StickerButton__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/StickerButton */ "./src/components/common/StickerButton.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _StickerTooltip_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./StickerTooltip.scss */ "./src/components/middle/composer/StickerTooltip.scss");













const INTERSECTION_THROTTLE = 200;
const StickerTooltip = ({
  chatId,
  threadId,
  isOpen,
  onStickerSelect,
  onClose,
  stickers,
  isSavedMessages,
  isCurrentUserPremium
}) => {
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    shouldRender,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_9__["default"])(isOpen, undefined, undefined, false);
  const prevStickers = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_7__["default"])(stickers, true);
  const displayedStickers = stickers || prevStickers;
  const sendMessageAction = (0,_hooks_useSendMessageAction__WEBPACK_IMPORTED_MODULE_8__["default"])(chatId, threadId);
  const {
    observe: observeIntersection
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_6__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: INTERSECTION_THROTTLE
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => isOpen ? (0,_util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_5__["default"])(onClose) : undefined, [isOpen, onClose]);
  const handleMouseMove = () => {
    sendMessageAction({
      type: 'chooseSticker'
    });
  };
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('StickerTooltip composer-tooltip custom-scroll', transitionClassNames, !displayedStickers?.length && 'hidden');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: className,
    onMouseMove: handleMouseMove
  }, shouldRender && displayedStickers ? displayedStickers.map(sticker => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_StickerButton__WEBPACK_IMPORTED_MODULE_10__["default"], {
    key: sticker.id,
    sticker: sticker,
    size: _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_PICKER,
    observeIntersection: observeIntersection,
    onClick: isOpen ? onStickerSelect : undefined,
    clickArg: sticker,
    isSavedMessages: isSavedMessages,
    canViewSet: true,
    isCurrentUserPremium: isCurrentUserPremium
  })) : shouldRender ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_11__["default"], null) : undefined);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const {
    stickers
  } = global.stickers.forEmoji;
  const isSavedMessages = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsChatWithSelf)(global, chatId);
  const isCurrentUserPremium = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global);
  return {
    stickers,
    isSavedMessages,
    isCurrentUserPremium
  };
})(StickerTooltip)));

/***/ }),

/***/ "./src/components/middle/composer/SymbolMenu.tsx":
/*!*******************************************************!*\
  !*** ./src/components/middle/composer/SymbolMenu.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMouseInside__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useMouseInside */ "./src/hooks/useMouseInside.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/CustomEmojiPicker */ "./src/components/common/CustomEmojiPicker.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_Portal__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/Portal */ "./src/components/ui/Portal.ts");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _EmojiPicker__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./EmojiPicker */ "./src/components/middle/composer/EmojiPicker.tsx");
/* harmony import */ var _GifPicker__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./GifPicker */ "./src/components/middle/composer/GifPicker.tsx");
/* harmony import */ var _StickerPicker__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./StickerPicker */ "./src/components/middle/composer/StickerPicker.tsx");
/* harmony import */ var _SymbolMenuFooter__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./SymbolMenuFooter */ "./src/components/middle/composer/SymbolMenuFooter.tsx");
/* harmony import */ var _SymbolMenu_scss__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./SymbolMenu.scss */ "./src/components/middle/composer/SymbolMenu.scss");
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }






















const ANIMATION_DURATION = 350;
const STICKERS_TAB_INDEX = 2;
let isActivated = false;
const SymbolMenu = ({
  chatId,
  threadId,
  isOpen,
  canSendStickers,
  canSendGifs,
  isMessageComposer,
  isLeftColumnShown,
  idPrefix,
  isAttachmentModal,
  canSendPlainText,
  className,
  isBackgroundTranslucent,
  onLoad,
  onClose,
  onEmojiSelect,
  onCustomEmojiSelect,
  onStickerSelect,
  onGifSelect,
  onRemoveSymbol,
  onSearchOpen,
  addRecentEmoji,
  addRecentCustomEmoji,
  ...menuPositionOptions
}) => {
  const [activeTab, setActiveTab] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  const [recentEmojis, setRecentEmojis] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const [recentCustomEmojis, setRecentCustomEmojis] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [handleMouseEnter, handleMouseLeave] = (0,_hooks_useMouseInside__WEBPACK_IMPORTED_MODULE_8__["default"])(isOpen, onClose, undefined, isMobile);
  const {
    shouldRender,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(isOpen, onClose, false, false);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  if (!isActivated && isOpen) {
    isActivated = true;
  }
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    onLoad();
  }, [onLoad]);

  // If we can't send plain text, we should always show the stickers tab
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (canSendPlainText) return;
    setActiveTab(STICKERS_TAB_INDEX);
  }, [canSendPlainText]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    if (!isMobile || !isOpen || isAttachmentModal) {
      return undefined;
    }
    document.body.classList.add('enable-symbol-menu-transforms');
    document.body.classList.add('is-symbol-menu-open');
    return () => {
      document.body.classList.remove('is-symbol-menu-open');
      setTimeout(() => {
        (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
          document.body.classList.remove('enable-symbol-menu-transforms');
        });
      }, ANIMATION_DURATION);
    };
  }, [isAttachmentModal, isMobile, isOpen]);
  const recentEmojisRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(recentEmojis);
  recentEmojisRef.current = recentEmojis;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!recentEmojisRef.current.length || isOpen) {
      return;
    }
    recentEmojisRef.current.forEach(name => {
      addRecentEmoji({
        emoji: name
      });
    });
    setRecentEmojis([]);
  }, [isOpen, addRecentEmoji]);
  const handleEmojiSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])((emoji, name) => {
    setRecentEmojis(emojis => [...emojis, name]);
    onEmojiSelect(emoji);
  });
  const recentCustomEmojisRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(recentCustomEmojis);
  recentCustomEmojisRef.current = recentCustomEmojis;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!recentCustomEmojisRef.current.length || isOpen) {
      return;
    }
    recentCustomEmojisRef.current.forEach(documentId => {
      addRecentCustomEmoji({
        documentId
      });
    });
    setRecentEmojis([]);
  }, [isOpen, addRecentCustomEmoji]);
  const handleCustomEmojiSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(emoji => {
    setRecentCustomEmojis(ids => [...ids, emoji.id]);
    onCustomEmojiSelect(emoji);
  });
  const handleSearch = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(type => {
    onClose();
    onSearchOpen(type);
  });
  const handleStickerSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])((sticker, isSilent, shouldSchedule, canUpdateStickerSetsOrder) => {
    onStickerSelect?.(sticker, isSilent, shouldSchedule, true, canUpdateStickerSetsOrder);
  });
  function renderContent(isActive, isFrom) {
    switch (activeTab) {
      case _SymbolMenuFooter__WEBPACK_IMPORTED_MODULE_20__.SymbolMenuTabs.Emoji:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_EmojiPicker__WEBPACK_IMPORTED_MODULE_17__["default"], {
          className: "picker-tab",
          onEmojiSelect: handleEmojiSelect
        });
      case _SymbolMenuFooter__WEBPACK_IMPORTED_MODULE_20__.SymbolMenuTabs.CustomEmoji:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_11__["default"], {
          className: "picker-tab",
          isHidden: !isOpen || !isActive,
          idPrefix: idPrefix,
          loadAndPlay: isOpen && (isActive || isFrom),
          chatId: chatId,
          isTranslucent: !isMobile && isBackgroundTranslucent,
          onCustomEmojiSelect: handleCustomEmojiSelect
        });
      case _SymbolMenuFooter__WEBPACK_IMPORTED_MODULE_20__.SymbolMenuTabs.Stickers:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerPicker__WEBPACK_IMPORTED_MODULE_19__["default"], {
          className: "picker-tab",
          isHidden: !isOpen || !isActive,
          loadAndPlay: canSendStickers ? isOpen && (isActive || isFrom) : false,
          idPrefix: idPrefix,
          canSendStickers: canSendStickers,
          noContextMenus: !isMessageComposer,
          chatId: chatId,
          threadId: threadId,
          isTranslucent: !isMobile && isBackgroundTranslucent,
          onStickerSelect: handleStickerSelect
        });
      case _SymbolMenuFooter__WEBPACK_IMPORTED_MODULE_20__.SymbolMenuTabs.GIFs:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_GifPicker__WEBPACK_IMPORTED_MODULE_18__["default"], {
          className: "picker-tab",
          loadAndPlay: canSendGifs ? isOpen && (isActive || isFrom) : false,
          canSendGifs: canSendGifs,
          onGifSelect: onGifSelect
        });
    }
    return undefined;
  }
  function stopPropagation(event) {
    event.stopPropagation();
  }
  const content = /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "SymbolMenu-main",
    onClick: stopPropagation
  }, isActivated && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_16__["default"], {
    name: "slide",
    activeKey: activeTab,
    renderCount: Object.values(_SymbolMenuFooter__WEBPACK_IMPORTED_MODULE_20__.SYMBOL_MENU_TAB_TITLES).length
  }, renderContent)), isMobile && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    round: true,
    faded: true,
    color: "translucent",
    ariaLabel: lang('Close'),
    className: "symbol-close-button",
    size: "tiny",
    onClick: onClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SymbolMenuFooter__WEBPACK_IMPORTED_MODULE_20__["default"], {
    activeTab: activeTab,
    onSwitchTab: setActiveTab,
    onRemoveSymbol: onRemoveSymbol,
    canSearch: isMessageComposer,
    onSearchOpen: handleSearch,
    isAttachmentModal: isAttachmentModal,
    canSendPlainText: canSendPlainText
  }));
  if (isMobile) {
    if (!shouldRender) {
      return undefined;
    }
    const mobileClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('SymbolMenu mobile-menu', transitionClassNames, isLeftColumnShown && 'left-column-open', isAttachmentModal && 'in-attachment-modal', isMessageComposer && 'in-middle-column');
    if (isAttachmentModal) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
        className: mobileClassName
      }, content);
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Portal__WEBPACK_IMPORTED_MODULE_15__["default"], null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: mobileClassName
    }, content));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_14__["default"], _extends({
    isOpen: isOpen,
    onClose: onClose,
    withPortal: isAttachmentModal,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('SymbolMenu', className),
    onCloseAnimationEnd: onClose,
    onMouseEnter: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV ? handleMouseEnter : undefined,
    onMouseLeave: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV ? handleMouseLeave : undefined,
    noCloseOnBackdrop: !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV,
    noCompact: true
    // eslint-disable-next-line react/jsx-props-no-spreading
  }, isAttachmentModal ? menuPositionOptions : {
    positionX: 'left',
    positionY: 'bottom'
  }), content);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  return {
    isLeftColumnShown: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).isLeftColumnShown,
    isBackgroundTranslucent: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsContextMenuTranslucent)(global)
  };
})(SymbolMenu)));

/***/ }),

/***/ "./src/components/middle/composer/SymbolMenuFooter.tsx":
/*!*************************************************************!*\
  !*** ./src/components/middle/composer/SymbolMenuFooter.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SYMBOL_MENU_TAB_TITLES: () => (/* binding */ SYMBOL_MENU_TAB_TITLES),
/* harmony export */   SymbolMenuTabs: () => (/* binding */ SymbolMenuTabs),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");






let SymbolMenuTabs = /*#__PURE__*/function (SymbolMenuTabs) {
  SymbolMenuTabs[SymbolMenuTabs["Emoji"] = 0] = "Emoji";
  SymbolMenuTabs[SymbolMenuTabs["CustomEmoji"] = 1] = "CustomEmoji";
  SymbolMenuTabs[SymbolMenuTabs["Stickers"] = 2] = "Stickers";
  SymbolMenuTabs[SymbolMenuTabs["GIFs"] = 3] = "GIFs";
  return SymbolMenuTabs;
}({});
const SYMBOL_MENU_TAB_TITLES = {
  [SymbolMenuTabs.Emoji]: 'Emoji',
  [SymbolMenuTabs.CustomEmoji]: 'StickersList.EmojiItem',
  [SymbolMenuTabs.Stickers]: 'AccDescrStickers',
  [SymbolMenuTabs.GIFs]: 'GifsTab'
};
const SYMBOL_MENU_TAB_ICONS = {
  [SymbolMenuTabs.Emoji]: 'icon-smile',
  [SymbolMenuTabs.CustomEmoji]: 'icon-favorite',
  [SymbolMenuTabs.Stickers]: 'icon-stickers',
  [SymbolMenuTabs.GIFs]: 'icon-gifs'
};
const SymbolMenuFooter = ({
  activeTab,
  onSwitchTab,
  onRemoveSymbol,
  onSearchOpen,
  isAttachmentModal,
  canSendPlainText,
  canSearch
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  function renderTabButton(tab) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_5__["default"], {
      className: `symbol-tab-button ${activeTab === tab ? 'activated' : ''}`
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => onSwitchTab(tab),
      ariaLabel: lang(SYMBOL_MENU_TAB_TITLES[tab]),
      round: true,
      faded: true,
      color: "translucent"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("i", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])('icon', SYMBOL_MENU_TAB_ICONS[tab])
    }));
  }
  const handleSearchOpen = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__["default"])(() => {
    onSearchOpen(activeTab === SymbolMenuTabs.Stickers ? 'stickers' : 'gifs');
  });
  function stopPropagation(event) {
    event.stopPropagation();
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "SymbolMenu-footer",
    onClick: stopPropagation,
    dir: lang.isRtl ? 'rtl' : undefined
  }, activeTab !== SymbolMenuTabs.Emoji && activeTab !== SymbolMenuTabs.CustomEmoji && canSearch && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_5__["default"], {
    className: "symbol-search-button",
    ariaLabel: activeTab === SymbolMenuTabs.Stickers ? 'Search Stickers' : 'Search GIFs',
    round: true,
    faded: true,
    color: "translucent",
    onClick: handleSearchOpen
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_4__["default"], {
    name: "search"
  })), canSendPlainText && renderTabButton(SymbolMenuTabs.Emoji), canSendPlainText && renderTabButton(SymbolMenuTabs.CustomEmoji), !isAttachmentModal && renderTabButton(SymbolMenuTabs.Stickers), !isAttachmentModal && renderTabButton(SymbolMenuTabs.GIFs), (activeTab === SymbolMenuTabs.Emoji || activeTab === SymbolMenuTabs.CustomEmoji) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_5__["default"], {
    className: "symbol-delete-button",
    onClick: onRemoveSymbol,
    ariaLabel: "Remove Symbol",
    round: true,
    faded: true,
    color: "translucent"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_4__["default"], {
    name: "delete-left"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SymbolMenuFooter));

/***/ }),

/***/ "./src/components/middle/composer/TextFormatter.tsx":
/*!**********************************************************!*\
  !*** ./src/components/middle/composer/TextFormatter.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/captureEscKeyListener */ "./src/util/captureEscKeyListener.ts");
/* harmony import */ var _util_ensureProtocol__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/ensureProtocol */ "./src/util/ensureProtocol.ts");
/* harmony import */ var _util_getKeyFromEvent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/getKeyFromEvent */ "./src/util/getKeyFromEvent.ts");
/* harmony import */ var _util_stopEvent__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/stopEvent */ "./src/util/stopEvent.ts");
/* harmony import */ var _helpers_customEmoji__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./helpers/customEmoji */ "./src/components/middle/composer/helpers/customEmoji.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _hooks_useVirtualBackdrop__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useVirtualBackdrop */ "./src/hooks/useVirtualBackdrop.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _TextFormatter_scss__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./TextFormatter.scss */ "./src/components/middle/composer/TextFormatter.scss");

















const TEXT_FORMAT_BY_TAG_NAME = {
  B: 'bold',
  STRONG: 'bold',
  I: 'italic',
  EM: 'italic',
  U: 'underline',
  DEL: 'strikethrough',
  CODE: 'monospace',
  SPAN: 'spoiler',
  BLOCKQUOTE: 'quote'
};
const fragmentEl = document.createElement('div');
const TextFormatter = ({
  isOpen,
  anchorPosition,
  selectedRange,
  setSelectedRange,
  onClose
}) => {
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const linkUrlInputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    shouldRender,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_12__["default"])(isOpen);
  const [isLinkControlOpen, openLinkControl, closeLinkControl] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [linkUrl, setLinkUrl] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [isEditingLink, setIsEditingLink] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [inputClassName, setInputClassName] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [selectedTextFormats, setSelectedTextFormats] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)({});
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => isOpen ? (0,_util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_4__["default"])(onClose) : undefined, [isOpen, onClose]);
  (0,_hooks_useVirtualBackdrop__WEBPACK_IMPORTED_MODULE_13__["default"])(isOpen, containerRef, onClose, true);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isLinkControlOpen) {
      linkUrlInputRef.current.focus();
    } else {
      setLinkUrl('');
      setIsEditingLink(false);
    }
  }, [isLinkControlOpen]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!shouldRender) {
      closeLinkControl();
      setSelectedTextFormats({});
      setInputClassName(undefined);
    }
  }, [closeLinkControl, shouldRender]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen || !selectedRange) {
      return;
    }
    const selectedFormats = {};
    let {
      parentElement
    } = selectedRange.commonAncestorContainer;
    while (parentElement && parentElement.id !== _config__WEBPACK_IMPORTED_MODULE_2__.EDITABLE_INPUT_ID) {
      const textFormat = TEXT_FORMAT_BY_TAG_NAME[parentElement.tagName];
      if (textFormat) {
        selectedFormats[textFormat] = true;
      }
      parentElement = parentElement.parentElement;
    }
    setSelectedTextFormats(selectedFormats);
  }, [isOpen, selectedRange, openLinkControl]);
  const restoreSelection = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (!selectedRange) {
      return;
    }
    const selection = window.getSelection();
    if (selection) {
      selection.removeAllRanges();
      selection.addRange(selectedRange);
    }
  });
  const updateSelectedRange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    const selection = window.getSelection();
    if (selection) {
      setSelectedRange(selection.getRangeAt(0));
    }
  });
  const getSelectedText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(shouldDropCustomEmoji => {
    if (!selectedRange) {
      return undefined;
    }
    fragmentEl.replaceChildren(selectedRange.cloneContents());
    if (shouldDropCustomEmoji) {
      fragmentEl.querySelectorAll(_helpers_customEmoji__WEBPACK_IMPORTED_MODULE_8__.INPUT_CUSTOM_EMOJI_SELECTOR).forEach(el => {
        el.replaceWith(el.getAttribute('alt'));
      });
    }
    return fragmentEl.innerHTML;
  });
  const getSelectedElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (!selectedRange) {
      return undefined;
    }
    return selectedRange.commonAncestorContainer.parentElement;
  });
  function updateInputStyles() {
    const input = linkUrlInputRef.current;
    if (!input) {
      return;
    }
    const {
      offsetWidth,
      scrollWidth,
      scrollLeft
    } = input;
    if (scrollWidth <= offsetWidth) {
      setInputClassName(undefined);
      return;
    }
    let className = '';
    if (scrollLeft < scrollWidth - offsetWidth) {
      className = 'mask-right';
    }
    if (scrollLeft > 0) {
      className += ' mask-left';
    }
    setInputClassName(className);
  }
  function handleLinkUrlChange(e) {
    setLinkUrl(e.target.value);
    updateInputStyles();
  }
  function getFormatButtonClassName(key) {
    if (selectedTextFormats[key]) {
      return 'active';
    }
    if (key === 'monospace' || key === 'strikethrough') {
      if (Object.keys(selectedTextFormats).some(fKey => fKey !== key && Boolean(selectedTextFormats[fKey]))) {
        return 'disabled';
      }
    } else if (selectedTextFormats.monospace || selectedTextFormats.strikethrough) {
      return 'disabled';
    }
    return undefined;
  }
  const handleSpoilerText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (selectedTextFormats.spoiler) {
      const element = getSelectedElement();
      if (!selectedRange || !element || element.dataset.entityType !== _api_types__WEBPACK_IMPORTED_MODULE_1__.ApiMessageEntityTypes.Spoiler || !element.textContent) {
        return;
      }
      element.replaceWith(element.textContent);
      setSelectedTextFormats(selectedFormats => ({
        ...selectedFormats,
        spoiler: false
      }));
      return;
    }
    const text = getSelectedText();
    document.execCommand('insertHTML', false, `<span class="spoiler" data-entity-type="${_api_types__WEBPACK_IMPORTED_MODULE_1__.ApiMessageEntityTypes.Spoiler}">${text}</span>`);
    onClose();
  });
  const handleBoldText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    setSelectedTextFormats(selectedFormats => {
      // Somehow re-applying 'bold' command to already bold text doesn't work
      document.execCommand(selectedFormats.bold ? 'removeFormat' : 'bold');
      Object.keys(selectedFormats).forEach(key => {
        if ((key === 'italic' || key === 'underline') && Boolean(selectedFormats[key])) {
          document.execCommand(key);
        }
      });
      updateSelectedRange();
      return {
        ...selectedFormats,
        bold: !selectedFormats.bold
      };
    });
  });
  const handleItalicText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    document.execCommand('italic');
    updateSelectedRange();
    setSelectedTextFormats(selectedFormats => ({
      ...selectedFormats,
      italic: !selectedFormats.italic
    }));
  });
  const handleUnderlineText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    document.execCommand('underline');
    updateSelectedRange();
    setSelectedTextFormats(selectedFormats => ({
      ...selectedFormats,
      underline: !selectedFormats.underline
    }));
  });
  const handleStrikethroughText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (selectedTextFormats.strikethrough) {
      const element = getSelectedElement();
      if (!selectedRange || !element || element.tagName !== 'DEL' || !element.textContent) {
        return;
      }
      element.replaceWith(element.textContent);
      setSelectedTextFormats(selectedFormats => ({
        ...selectedFormats,
        strikethrough: false
      }));
      return;
    }
    const text = getSelectedText();
    document.execCommand('insertHTML', false, `<del>${text}</del>`);
    onClose();
  });
  const handleMonospaceText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (selectedTextFormats.monospace) {
      const element = getSelectedElement();
      if (!selectedRange || !element || element.tagName !== 'CODE' || !element.textContent) {
        return;
      }
      element.replaceWith(element.textContent);
      setSelectedTextFormats(selectedFormats => ({
        ...selectedFormats,
        monospace: false
      }));
      return;
    }
    const text = getSelectedText(true);
    document.execCommand('insertHTML', false, `<code class="text-entity-code" dir="auto">${text}</code>`);
    onClose();
  });
  const handleBlockquoteText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (selectedTextFormats.quote) {
      const element = getSelectedElement();
      if (!selectedRange || !element || element.tagName !== 'BLOCKQUOTE' || !element.textContent) {
        return;
      }
      element.replaceWith(element.textContent);
      setSelectedTextFormats(selectedFormats => ({
        ...selectedFormats,
        blockquote: false
      }));
      return;
    }
    const text = getSelectedText(true);
    document.execCommand('insertHTML', false, `<blockquote class="blockquote" dir="auto">${text}</blockquote>`);
    onClose();
  });
  const handleLinkUrlConfirm = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    const formattedLinkUrl = ((0,_util_ensureProtocol__WEBPACK_IMPORTED_MODULE_5__.ensureProtocol)(linkUrl) || '').split('%').map(encodeURI).join('%');
    if (isEditingLink) {
      const element = getSelectedElement();
      if (!element || element.tagName !== 'A') {
        return;
      }
      element.href = formattedLinkUrl;
      onClose();
      return;
    }
    const text = getSelectedText(true);
    restoreSelection();
    document.execCommand('insertHTML', false, `<a href=${formattedLinkUrl} class="text-entity-link" dir="auto">${text}</a>`);
    onClose();
  });
  const handleKeyDown = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    const HANDLERS_BY_KEY = {
      k: openLinkControl,
      b: handleBoldText,
      u: handleUnderlineText,
      i: handleItalicText,
      m: handleMonospaceText,
      s: handleStrikethroughText,
      p: handleSpoilerText,
      q: handleBlockquoteText
    };
    const handler = HANDLERS_BY_KEY[(0,_util_getKeyFromEvent__WEBPACK_IMPORTED_MODULE_6__["default"])(e)];
    if (e.altKey || !(e.ctrlKey || e.metaKey) || !handler) {
      return;
    }
    e.preventDefault();
    e.stopPropagation();
    handler();
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      document.addEventListener('keydown', handleKeyDown);
    }
    return () => document.removeEventListener('keydown', handleKeyDown);
  }, [isOpen, handleKeyDown]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  function handleContainerKeyDown(e) {
    if (e.key === 'Enter' && isLinkControlOpen) {
      handleLinkUrlConfirm();
      e.preventDefault();
    }
  }
  if (!shouldRender) {
    return undefined;
  }
  const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('TextFormatter', transitionClassNames, isLinkControlOpen && 'link-control-shown');
  const linkUrlConfirmClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('TextFormatter-link-url-confirm', Boolean(linkUrl.length) && 'shown');
  const style = anchorPosition ? `left: ${anchorPosition.x}px; top: ${anchorPosition.y}px;--text-formatter-left: ${anchorPosition.x}px;` : '';
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: className,
    style: style,
    onKeyDown: handleContainerKeyDown
    // Prevents focus loss when clicking on the toolbar
    ,
    onMouseDown: _util_stopEvent__WEBPACK_IMPORTED_MODULE_7__["default"]
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "TextFormatter-buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: "Spoiler text",
    className: getFormatButtonClassName('spoiler'),
    onClick: handleSpoilerText
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "eye-closed"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "TextFormatter-divider"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: "Bold text",
    className: getFormatButtonClassName('bold'),
    onClick: handleBoldText
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "bold"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: "Italic text",
    className: getFormatButtonClassName('italic'),
    onClick: handleItalicText
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "italic"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: "Underlined text",
    className: getFormatButtonClassName('underline'),
    onClick: handleUnderlineText
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "underlined"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: "Strikethrough text",
    className: getFormatButtonClassName('strikethrough'),
    onClick: handleStrikethroughText
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "strikethrough"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: "Monospace text",
    className: getFormatButtonClassName('monospace'),
    onClick: handleMonospaceText
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "monospace"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: "Monospace text",
    className: getFormatButtonClassName('monospace'),
    onClick: handleBlockquoteText
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "quote"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "TextFormatter-divider"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: lang('TextFormat.AddLinkTitle'),
    onClick: openLinkControl
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "link"
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "TextFormatter-link-control"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "TextFormatter-buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: lang('Cancel'),
    onClick: closeLinkControl
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "arrow-left"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "TextFormatter-divider"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('TextFormatter-link-url-input-wrapper', inputClassName)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    ref: linkUrlInputRef,
    className: "TextFormatter-link-url-input",
    type: "text",
    value: linkUrl,
    placeholder: "Enter URL...",
    autoComplete: "off",
    inputMode: "url",
    dir: "auto",
    onChange: handleLinkUrlChange,
    onScroll: updateInputStyles
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: linkUrlConfirmClassName
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "TextFormatter-divider"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "translucent",
    ariaLabel: lang('Save'),
    className: "color-primary",
    onClick: handleLinkUrlConfirm
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "check"
  }))))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(TextFormatter));

/***/ }),

/***/ "./src/components/middle/composer/helpers/getHtmlTextLength.ts":
/*!*********************************************************************!*\
  !*** ./src/components/middle/composer/helpers/getHtmlTextLength.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getHtmlTextLength: () => (/* binding */ getHtmlTextLength)
/* harmony export */ });
/* harmony import */ var _util_parseHtmlAsFormattedText__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../util/parseHtmlAsFormattedText */ "./src/util/parseHtmlAsFormattedText.ts");

const div = document.createElement('div');
function getHtmlTextLength(html) {
  div.innerHTML = html;
  (0,_util_parseHtmlAsFormattedText__WEBPACK_IMPORTED_MODULE_0__.fixImageContent)(div);
  div.querySelectorAll('br').forEach(br => {
    br.replaceWith('\n');
  });
  return div.textContent?.trim().length || 0;
}

/***/ }),

/***/ "./src/components/middle/composer/hooks/useKeyboardNavigation.ts":
/*!***********************************************************************!*\
  !*** ./src/components/middle/composer/hooks/useKeyboardNavigation.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   useKeyboardNavigation: () => (/* binding */ useKeyboardNavigation)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_captureKeyboardListeners__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../util/captureKeyboardListeners */ "./src/util/captureKeyboardListeners.ts");
/* harmony import */ var _util_cycleRestrict__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../util/cycleRestrict */ "./src/util/cycleRestrict.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");




function useKeyboardNavigation({
  isActive,
  isHorizontal,
  shouldSaveSelectionOnUpdateItems,
  shouldRemoveSelectionOnReset,
  noArrowNavigation,
  items,
  shouldSelectOnTab,
  onSelect,
  onClose
}) {
  const [selectedItemIndex, setSelectedItemIndex] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(-1);
  const getSelectedIndex = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__["default"])(newIndex => {
    if (!items) {
      return -1;
    }
    return (0,_util_cycleRestrict__WEBPACK_IMPORTED_MODULE_2__["default"])(items.length, newIndex);
  });
  const handleArrowKey = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__["default"])((value, e) => {
    e.preventDefault();
    setSelectedItemIndex(index => getSelectedIndex(index + value));
  });
  const handleItemSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__["default"])(e => {
    // Prevent action on key combinations
    if (e.altKey || e.ctrlKey || e.metaKey || e.shiftKey) return false;
    if (!isActive) return false;
    if (items && items.length && selectedItemIndex > -1) {
      const item = items[selectedItemIndex];
      if (item) {
        if (onSelect(item) === false) {
          return false;
        }
        e.preventDefault();
      }
    }
    return true;
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isActive) setSelectedItemIndex(shouldRemoveSelectionOnReset ? -1 : 0);
  }, [isActive, shouldRemoveSelectionOnReset]);
  const isSelectionOutOfRange = !items || selectedItemIndex > items.length - 1;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!shouldSaveSelectionOnUpdateItems || isSelectionOutOfRange) {
      setSelectedItemIndex(shouldRemoveSelectionOnReset ? -1 : 0);
    }
  }, [isSelectionOutOfRange, shouldRemoveSelectionOnReset, shouldSaveSelectionOnUpdateItems]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => isActive ? (0,_util_captureKeyboardListeners__WEBPACK_IMPORTED_MODULE_1__["default"])({
    onEsc: onClose,
    onUp: noArrowNavigation || isHorizontal ? undefined : e => handleArrowKey(-1, e),
    onDown: noArrowNavigation || isHorizontal ? undefined : e => handleArrowKey(1, e),
    onLeft: noArrowNavigation || !isHorizontal ? undefined : e => handleArrowKey(-1, e),
    onRight: noArrowNavigation || !isHorizontal ? undefined : e => handleArrowKey(1, e),
    onTab: shouldSelectOnTab ? handleItemSelect : undefined,
    onEnter: handleItemSelect
  }) : undefined, [noArrowNavigation, handleArrowKey, handleItemSelect, isActive, isHorizontal, onClose, shouldSelectOnTab]);
  return selectedItemIndex;
}

/***/ }),

/***/ "./src/components/middle/composer/inlineResults/ArticleResult.tsx":
/*!************************************************************************!*\
  !*** ./src/components/middle/composer/inlineResults/ArticleResult.tsx ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _BaseResult__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseResult */ "./src/components/middle/composer/inlineResults/BaseResult.tsx");



const ArticleResult = ({
  focus,
  inlineResult,
  onClick
}) => {
  const {
    title,
    url,
    description,
    webThumbnail
  } = inlineResult;
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_1__["default"])(() => {
    onClick(inlineResult);
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_BaseResult__WEBPACK_IMPORTED_MODULE_2__["default"], {
    focus: focus,
    thumbnail: webThumbnail,
    title: title || url,
    description: description,
    onClick: handleClick
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ArticleResult));

/***/ }),

/***/ "./src/components/middle/composer/inlineResults/BaseResult.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/middle/composer/inlineResults/BaseResult.tsx ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_textFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../util/textFormat */ "./src/util/textFormat.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _helpers_preventMessageInputBlur__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../helpers/preventMessageInputBlur */ "./src/components/middle/helpers/preventMessageInputBlur.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _BaseResult_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./BaseResult.scss */ "./src/components/middle/composer/inlineResults/BaseResult.scss");








const BaseResult = ({
  title,
  description,
  thumbnail,
  thumbUrl,
  focus,
  transitionClassNames = '',
  onClick
}) => {
  let content;
  const thumbnailDataUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_5__["default"])(thumbnail ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getWebDocumentHash)(thumbnail) : undefined);
  thumbUrl = thumbUrl || thumbnailDataUrl;
  if (thumbUrl) {
    content = /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
      src: thumbUrl,
      className: transitionClassNames,
      alt: "",
      decoding: "async",
      draggable: false
    });
  } else if (title) {
    content = (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_2__.getFirstLetters)(title, 1);
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_6__["default"], {
    focus: focus,
    className: "BaseResult chat-item-clickable",
    onMouseDown: _helpers_preventMessageInputBlur__WEBPACK_IMPORTED_MODULE_4__.preventMessageInputBlurWithBubbling,
    onClick: onClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "thumb"
  }, typeof content === 'string' ? (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(content) : content), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "content-inner"
  }, title && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "title"
  }, title), description && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "description"
  }, description)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(BaseResult));

/***/ }),

/***/ "./src/components/middle/composer/inlineResults/GifResult.tsx":
/*!********************************************************************!*\
  !*** ./src/components/middle/composer/inlineResults/GifResult.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _common_GifButton__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../common/GifButton */ "./src/components/common/GifButton.tsx");



const GifResult = ({
  inlineResult,
  isSavedMessages,
  canSendGifs,
  observeIntersection,
  onClick
}) => {
  const {
    gif
  } = inlineResult;
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_1__["default"])((_gif, isSilent, shouldSchedule) => {
    onClick(inlineResult, isSilent, shouldSchedule);
  });
  if (!gif) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GifButton__WEBPACK_IMPORTED_MODULE_2__["default"], {
    gif: gif,
    observeIntersection: observeIntersection,
    className: "chat-item-clickable",
    onClick: canSendGifs ? handleClick : undefined,
    isSavedMessages: isSavedMessages
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(GifResult));

/***/ }),

/***/ "./src/components/middle/composer/inlineResults/MediaResult.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/middle/composer/inlineResults/MediaResult.tsx ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../hooks/useMediaTransitionDeprecated */ "./src/hooks/useMediaTransitionDeprecated.ts");
/* harmony import */ var _BaseResult__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./BaseResult */ "./src/components/middle/composer/inlineResults/BaseResult.tsx");
/* harmony import */ var _MediaResult_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./MediaResult.scss */ "./src/components/middle/composer/inlineResults/MediaResult.scss");








const MediaResult = ({
  focus,
  isForGallery,
  inlineResult,
  onClick
}) => {
  let photo;
  let thumbnail;
  let webThumbnail;
  if ('photo' in inlineResult) {
    photo = inlineResult.photo;
  }
  // For results with type=video (for example @stikstokbot)
  if ('thumbnail' in inlineResult) {
    thumbnail = inlineResult.thumbnail;
  }
  if ('webThumbnail' in inlineResult) {
    webThumbnail = inlineResult.webThumbnail;
  }
  const thumbnailBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_4__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getWebDocumentHash)(webThumbnail));
  const mediaBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_4__["default"])(photo && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getPhotoMediaHash)(photo, 'pictogram'));
  const transitionClassNames = (0,_hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_5__["default"])(mediaBlobUrl || thumbnailBlobUrl);
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_3__["default"])(() => {
    onClick(inlineResult);
  });
  if (isForGallery) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "MediaResult chat-item-clickable",
      onClick: handleClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
      src: photo?.thumbnail?.dataUri || thumbnailBlobUrl,
      alt: "",
      draggable: false
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
      src: mediaBlobUrl,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])('full-media', transitionClassNames),
      alt: "",
      draggable: false
    }));
  }
  const {
    title,
    description
  } = inlineResult;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_BaseResult__WEBPACK_IMPORTED_MODULE_6__["default"], {
    focus: focus,
    thumbnail: webThumbnail,
    thumbUrl: mediaBlobUrl || thumbnail?.dataUri,
    transitionClassNames: transitionClassNames,
    title: title,
    description: description,
    onClick: handleClick
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(MediaResult));

/***/ }),

/***/ "./src/components/middle/composer/inlineResults/StickerResult.tsx":
/*!************************************************************************!*\
  !*** ./src/components/middle/composer/inlineResults/StickerResult.tsx ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../config */ "./src/config.ts");
/* harmony import */ var _common_StickerButton__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../common/StickerButton */ "./src/components/common/StickerButton.tsx");



const StickerResult = ({
  inlineResult,
  isSavedMessages,
  observeIntersection,
  onClick,
  isCurrentUserPremium
}) => {
  const {
    sticker
  } = inlineResult;
  if (!sticker) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_StickerButton__WEBPACK_IMPORTED_MODULE_2__["default"], {
    sticker: sticker,
    size: _config__WEBPACK_IMPORTED_MODULE_1__.STICKER_SIZE_INLINE_BOT_RESULT,
    observeIntersection: observeIntersection,
    title: sticker.emoji,
    className: "chat-item-clickable",
    onClick: onClick,
    clickArg: inlineResult,
    isSavedMessages: isSavedMessages,
    canViewSet: true,
    noShowPremium: true,
    isCurrentUserPremium: isCurrentUserPremium
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StickerResult));

/***/ }),

/***/ "./src/components/middle/helpers/inputFormatters.ts":
/*!**********************************************************!*\
  !*** ./src/components/middle/helpers/inputFormatters.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   formatCardExpiry: () => (/* binding */ formatCardExpiry),
/* harmony export */   formatCardNumber: () => (/* binding */ formatCardNumber)
/* harmony export */ });
function formatCardExpiry(input) {
  input = input.replace(/[^\d]/g, '').slice(0, 4);
  const parts = input.match(/.{1,2}/g);
  if (parts?.[0] && Number(parts[0]) > 12) {
    parts[0] = '12';
  }
  if (parts?.[0] && parts[0].length === 2 && !parts[1]) {
    parts[1] = '';
  }
  return parts ? parts.join('/') : '';
}
function formatCardNumber(input) {
  input = input.replace(/[^\d]/g, '');
  const parts = input.match(/.{1,4}/g);
  return parts ? parts.join(' ') : '';
}

/***/ }),

/***/ "./src/components/middle/hooks/useCopySelectedMessages.ts":
/*!****************************************************************!*\
  !*** ./src/components/middle/hooks/useCopySelectedMessages.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useHotkeys__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useHotkeys */ "./src/hooks/useHotkeys.ts");



const useCopySelectedMessages = isActive => {
  function handleCopy(e) {
    e.preventDefault();
    (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)().copySelectedMessages();
  }
  (0,_hooks_useHotkeys__WEBPACK_IMPORTED_MODULE_2__.useHotkeys)((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => isActive ? {
    'Mod+C': handleCopy
  } : undefined, [isActive]));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (useCopySelectedMessages);

/***/ }),

/***/ "./src/components/middle/message/ContextMenuContainer.tsx":
/*!****************************************************************!*\
  !*** ./src/components/middle/message/ContextMenuContainer.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_clipboard__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/clipboard */ "./src/util/clipboard.ts");
/* harmony import */ var _helpers_getSelectionAsFormattedText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./helpers/getSelectionAsFormattedText */ "./src/components/middle/message/helpers/getSelectionAsFormattedText.ts");
/* harmony import */ var _helpers_isSelectionRangeInsideMessage__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./helpers/isSelectionRangeInsideMessage */ "./src/components/middle/message/helpers/isSelectionRangeInsideMessage.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useSchedule__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useSchedule */ "./src/hooks/useSchedule.tsx");
/* harmony import */ var _hooks_useShowTransition__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useShowTransition */ "./src/hooks/useShowTransition.ts");
/* harmony import */ var _common_PinMessageModal_async__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/PinMessageModal.async */ "./src/components/common/PinMessageModal.async.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _MessageContextMenu__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./MessageContextMenu */ "./src/components/middle/message/MessageContextMenu.tsx");

















const selection = window.getSelection();
const ContextMenuContainer = ({
  threadId,
  availableReactions,
  topReactions,
  defaultTagReactions,
  isOpen,
  messageListType,
  message,
  customEmojiSetsInfo,
  customEmojiSets,
  album,
  poll,
  story,
  anchor,
  targetHref,
  noOptions,
  canSendNow,
  hasFullInfo,
  canReschedule,
  canReply,
  canPin,
  repliesThreadInfo,
  canUnpin,
  canDelete,
  canShowReactionsCount,
  chat,
  canReport,
  canShowReactionList,
  canEdit,
  enabledReactions,
  reactionsLimit,
  isPrivate,
  isCurrentUserPremium,
  canForward,
  canBuyPremium,
  canFaveSticker,
  canUnfaveSticker,
  canCopy,
  canCopyLink,
  canSelect,
  canDownload,
  canSaveGif,
  canRevote,
  canClosePoll,
  canPlayAnimatedEmojis,
  canLoadReadDate,
  shouldRenderShowWhen,
  activeDownloads,
  noReplies,
  canShowSeenBy,
  canScheduleUntilOnline,
  canTranslate,
  isMessageTranslated,
  canShowOriginal,
  canSelectLanguage,
  isReactionPickerOpen,
  isInSavedMessages,
  canReplyInChat,
  isWithPaidReaction,
  onClose,
  onCloseAnimationEnd,
  userFullName,
  canGift
}) => {
  const {
    openThread,
    updateDraftReplyInfo,
    setEditingId,
    pinMessage,
    openForwardMenu,
    openReplyMenu,
    faveSticker,
    unfaveSticker,
    toggleMessageSelection,
    sendScheduledMessages,
    rescheduleMessage,
    downloadMedia,
    cancelMediaDownload,
    loadSeenBy,
    openSeenByModal,
    openReactorListModal,
    loadFullChat,
    loadReactors,
    copyMessagesByIds,
    saveGif,
    loadStickers,
    cancelPollVote,
    closePoll,
    toggleReaction,
    requestMessageTranslation,
    showOriginalMessage,
    openChatLanguageModal,
    openMessageReactionPicker,
    openPremiumModal,
    loadOutboxReadDate,
    copyMessageLink,
    openDeleteMessageModal,
    addLocalPaidReaction,
    openPaidReactionModal,
    reportMessages
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const {
    ref: containerRef
  } = (0,_hooks_useShowTransition__WEBPACK_IMPORTED_MODULE_13__["default"])({
    isOpen,
    onCloseAnimationEnd,
    className: false
  });
  const [isMenuOpen, setIsMenuOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [isPinModalOpen, setIsPinModalOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isClosePollDialogOpen, openClosePollDialog, closeClosePollDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [canQuoteSelection, setCanQuoteSelection] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [requestCalendar, calendar] = (0,_hooks_useSchedule__WEBPACK_IMPORTED_MODULE_12__["default"])(canScheduleUntilOnline, onClose, message.date);

  // `undefined` indicates that emoji are present and loading
  const hasCustomEmoji = customEmojiSetsInfo === undefined || Boolean(customEmojiSetsInfo.length);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (canShowSeenBy && isOpen) {
      loadSeenBy({
        chatId: message.chatId,
        messageId: message.id
      });
    }
  }, [loadSeenBy, isOpen, message.chatId, message.id, canShowSeenBy]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (canLoadReadDate && isOpen) {
      loadOutboxReadDate({
        chatId: message.chatId,
        messageId: message.id
      });
    }
  }, [canLoadReadDate, isOpen, message.chatId, message.id, message.readDate]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (canShowReactionsCount && isOpen) {
      loadReactors({
        chatId: message.chatId,
        messageId: message.id
      });
    }
  }, [canShowReactionsCount, isOpen, loadReactors, message.chatId, message.id]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (customEmojiSetsInfo?.length && customEmojiSets?.length !== customEmojiSetsInfo.length) {
      customEmojiSetsInfo.forEach(set => {
        loadStickers({
          stickerSetInfo: set
        });
      });
    }
  }, [customEmojiSetsInfo, customEmojiSets, loadStickers]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!hasFullInfo && !isPrivate && isOpen) {
      loadFullChat({
        chatId: message.chatId
      });
    }
  }, [hasFullInfo, isOpen, isPrivate, loadFullChat, message.chatId]);
  const seenByRecentPeers = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    // No need for expensive global updates on chats or users, so we avoid them
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    if (message.reactions?.recentReactions?.length) {
      const uniqueReactors = new Set(message.reactions?.recentReactions?.map(({
        peerId
      }) => usersById[peerId] || chatsById[peerId]));
      return Array.from(uniqueReactors).filter(Boolean).slice(0, _config__WEBPACK_IMPORTED_MODULE_3__.PREVIEW_AVATAR_COUNT);
    }
    if (!message.seenByDates) {
      return undefined;
    }
    return Object.keys(message.seenByDates).slice(0, _config__WEBPACK_IMPORTED_MODULE_3__.PREVIEW_AVATAR_COUNT).map(id => usersById[id] || chatsById[id]).filter(Boolean);
  }, [message.reactions?.recentReactions, message.seenByDates]);
  const isDownloading = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (album) {
      return album.messages.some(msg => {
        const downloadableMedia = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getMessageDownloadableMedia)(msg);
        if (!downloadableMedia) return false;
        return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getIsDownloading)(activeDownloads, downloadableMedia);
      });
    }
    const downloadableMedia = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getMessageDownloadableMedia)(message);
    if (!downloadableMedia) return false;
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getIsDownloading)(activeDownloads, downloadableMedia);
  }, [activeDownloads, album, message]);
  const selectionRange = canReply && selection?.rangeCount ? selection.getRangeAt(0) : undefined;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isMessageTranslated) {
      setCanQuoteSelection(false);
      return;
    }
    const isMessageTextSelected = selectionRange && !selectionRange.collapsed && Boolean(message.content.text?.text) && (0,_helpers_isSelectionRangeInsideMessage__WEBPACK_IMPORTED_MODULE_8__.isSelectionRangeInsideMessage)(selectionRange);
    if (!isMessageTextSelected) {
      setCanQuoteSelection(false);
      return;
    }
    const selectionText = (0,_helpers_getSelectionAsFormattedText__WEBPACK_IMPORTED_MODULE_7__.getSelectionAsFormattedText)(selectionRange);
    setCanQuoteSelection(selectionText.text.trim().length > 0 && message.content.text.text.includes(selectionText.text));
  }, [selectionRange, selectionRange?.collapsed, selectionRange?.startOffset, selectionRange?.endOffset, isMessageTranslated, message.content.text]);
  const closeMenu = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    setIsMenuOpen(false);
    onClose();
  });
  const handleDelete = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    setIsMenuOpen(false);
    closeMenu();
    openDeleteMessageModal({
      isSchedule: messageListType === 'scheduled',
      album,
      message
    });
  });
  const closePinModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    setIsPinModalOpen(false);
    onClose();
  });
  const handleReply = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    const quoteText = canQuoteSelection && selectionRange ? (0,_helpers_getSelectionAsFormattedText__WEBPACK_IMPORTED_MODULE_7__.getSelectionAsFormattedText)(selectionRange) : undefined;
    if (!canReplyInChat) {
      openReplyMenu({
        fromChatId: message.chatId,
        messageId: message.id,
        quoteText
      });
    } else {
      updateDraftReplyInfo({
        replyToMsgId: message.id,
        quoteText,
        replyToPeerId: undefined
      });
    }
    closeMenu();
  });
  const handleOpenThread = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    openThread({
      chatId: message.chatId,
      threadId: message.id
    });
    closeMenu();
  });
  const handleEdit = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    setEditingId({
      messageId: message.id
    });
    closeMenu();
  });
  const handlePin = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    setIsMenuOpen(false);
    setIsPinModalOpen(true);
  });
  const handleUnpin = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    pinMessage({
      chatId: message.chatId,
      messageId: message.id,
      isUnpin: true
    });
    closeMenu();
  });
  const handleForward = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    closeMenu();
    if (album?.messages) {
      const messageIds = album.messages.map(({
        id
      }) => id);
      openForwardMenu({
        fromChatId: message.chatId,
        messageIds
      });
    } else {
      openForwardMenu({
        fromChatId: message.chatId,
        messageIds: [message.id]
      });
    }
  });
  const handleFaveSticker = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    closeMenu();
    faveSticker({
      sticker: message.content.sticker
    });
  });
  const handleUnfaveSticker = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    closeMenu();
    unfaveSticker({
      sticker: message.content.sticker
    });
  });
  const handleCancelVote = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    closeMenu();
    cancelPollVote({
      chatId: message.chatId,
      messageId: message.id
    });
  });
  const handlePollClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    closeMenu();
    closePoll({
      chatId: message.chatId,
      messageId: message.id
    });
  });
  const handleSelectMessage = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    const params = album?.messages ? {
      messageId: message.id,
      childMessageIds: album.messages.map(({
        id
      }) => id),
      withShift: false
    } : {
      messageId: message.id,
      withShift: false
    };
    toggleMessageSelection(params);
    closeMenu();
  });
  const handleScheduledMessageSend = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    sendScheduledMessages({
      chatId: message.chatId,
      id: message.id
    });
    closeMenu();
  });
  const handleRescheduleMessage = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(scheduledAt => {
    rescheduleMessage({
      chatId: message.chatId,
      messageId: message.id,
      scheduledAt
    });
    onClose();
  });
  const handleOpenCalendar = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    setIsMenuOpen(false);
    requestCalendar(handleRescheduleMessage);
  });
  const handleOpenSeenByModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    closeMenu();
    openSeenByModal({
      chatId: message.chatId,
      messageId: message.id
    });
  });
  const handleOpenReactorListModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    closeMenu();
    openReactorListModal({
      chatId: message.chatId,
      messageId: message.id
    });
  });
  const handleCopyMessages = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(messageIds => {
    copyMessagesByIds({
      messageIds
    });
    closeMenu();
  });
  const handleCopyLink = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    copyMessageLink({
      chatId: message.chatId,
      messageId: message.id,
      shouldIncludeThread: threadId !== _api_types__WEBPACK_IMPORTED_MODULE_2__.MAIN_THREAD_ID,
      shouldIncludeGrouped: true // TODO: Provide correct value when ability to target specific message is added
    });
    closeMenu();
  });
  const handleCopyNumber = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    (0,_util_clipboard__WEBPACK_IMPORTED_MODULE_6__.copyTextToClipboard)(message.content.contact.phoneNumber);
    closeMenu();
  });
  const handleDownloadClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    (album?.messages || [message]).forEach(msg => {
      const downloadableMedia = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getMessageDownloadableMedia)(msg);
      if (!downloadableMedia) return;
      if (isDownloading) {
        cancelMediaDownload({
          media: downloadableMedia
        });
      } else {
        downloadMedia({
          media: downloadableMedia,
          originMessage: msg
        });
      }
    });
    closeMenu();
  });
  const handleSaveGif = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    const video = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getMessageVideo)(message);
    saveGif({
      gif: video
    });
    closeMenu();
  });
  const handleToggleReaction = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(reaction => {
    if (isInSavedMessages && !isCurrentUserPremium) {
      openPremiumModal({
        initialSection: 'saved_tags'
      });
    } else {
      toggleReaction({
        chatId: message.chatId,
        messageId: message.id,
        reaction,
        shouldAddToRecent: true
      });
    }
    closeMenu();
  });
  const handleSendPaidReaction = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    addLocalPaidReaction({
      chatId: message.chatId,
      messageId: message.id,
      count: 1
    });
    closeMenu();
  });
  const handlePaidReactionModalOpen = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    openPaidReactionModal({
      chatId: message.chatId,
      messageId: message.id
    });
    closeMenu();
  });
  const handleReactionPickerOpen = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(position => {
    openMessageReactionPicker({
      chatId: message.chatId,
      messageId: message.id,
      position
    });
  });
  const handleTranslate = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    requestMessageTranslation({
      chatId: message.chatId,
      id: message.id
    });
    closeMenu();
  });
  const handleShowOriginal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    showOriginalMessage({
      chatId: message.chatId,
      id: message.id
    });
    closeMenu();
  });
  const handleSelectLanguage = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    openChatLanguageModal({
      chatId: message.chatId,
      messageId: message.id
    });
    closeMenu();
  });
  const reportMessageIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (album ? album.messages : [message]).map(({
    id
  }) => id), [album, message]);
  const handleReport = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (!chat) return;
    setIsMenuOpen(false);
    onClose();
    reportMessages({
      chatId: chat.id,
      messageIds: reportMessageIds
    });
  });
  if (noOptions) {
    closeMenu();
    return undefined;
  }
  const scheduledMaxDate = new Date();
  scheduledMaxDate.setFullYear(scheduledMaxDate.getFullYear() + 1);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: "ContextMenuContainer"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MessageContextMenu__WEBPACK_IMPORTED_MODULE_16__["default"], {
    isReactionPickerOpen: isReactionPickerOpen,
    availableReactions: availableReactions,
    topReactions: topReactions,
    defaultTagReactions: defaultTagReactions,
    isWithPaidReaction: isWithPaidReaction,
    message: message,
    isPrivate: isPrivate,
    isCurrentUserPremium: isCurrentUserPremium,
    canBuyPremium: canBuyPremium,
    isOpen: isMenuOpen,
    enabledReactions: enabledReactions,
    reactionsLimit: reactionsLimit,
    anchor: anchor,
    targetHref: targetHref,
    canShowReactionsCount: canShowReactionsCount,
    canShowReactionList: canShowReactionList,
    canSendNow: canSendNow,
    canReschedule: canReschedule,
    canReply: canReply,
    canQuote: canQuoteSelection,
    canDelete: canDelete,
    canPin: canPin,
    canReport: canReport,
    repliesThreadInfo: repliesThreadInfo,
    canUnpin: canUnpin,
    canEdit: canEdit,
    canForward: canForward,
    canFaveSticker: canFaveSticker,
    canUnfaveSticker: canUnfaveSticker,
    canCopy: canCopy,
    canCopyLink: canCopyLink,
    canSelect: canSelect,
    canDownload: canDownload,
    canSaveGif: canSaveGif,
    canRevote: canRevote,
    canClosePoll: canClosePoll,
    canShowSeenBy: canShowSeenBy,
    canTranslate: canTranslate,
    canShowOriginal: canShowOriginal,
    canSelectLanguage: canSelectLanguage,
    canPlayAnimatedEmojis: canPlayAnimatedEmojis,
    shouldRenderShowWhen: shouldRenderShowWhen,
    canLoadReadDate: canLoadReadDate,
    hasCustomEmoji: hasCustomEmoji,
    customEmojiSets: customEmojiSets,
    isDownloading: isDownloading,
    seenByRecentPeers: seenByRecentPeers,
    isInSavedMessages: isInSavedMessages,
    noReplies: noReplies,
    poll: poll,
    story: story,
    onOpenThread: handleOpenThread,
    onReply: handleReply,
    onEdit: handleEdit,
    onPin: handlePin,
    onUnpin: handleUnpin,
    onForward: handleForward,
    onDelete: handleDelete,
    onReport: handleReport,
    onFaveSticker: handleFaveSticker,
    onUnfaveSticker: handleUnfaveSticker,
    onSelect: handleSelectMessage,
    onSend: handleScheduledMessageSend,
    onReschedule: handleOpenCalendar,
    onClose: closeMenu,
    onCopyLink: handleCopyLink,
    onCopyMessages: handleCopyMessages,
    onCopyNumber: handleCopyNumber,
    onDownload: handleDownloadClick,
    onSaveGif: handleSaveGif,
    onCancelVote: handleCancelVote,
    onClosePoll: openClosePollDialog,
    onShowSeenBy: handleOpenSeenByModal,
    onToggleReaction: handleToggleReaction,
    onSendPaidReaction: handleSendPaidReaction,
    onShowPaidReactionModal: handlePaidReactionModalOpen,
    onShowReactors: handleOpenReactorListModal,
    onReactionPickerOpen: handleReactionPickerOpen,
    onTranslate: handleTranslate,
    onShowOriginal: handleShowOriginal,
    onSelectLanguage: handleSelectLanguage,
    userFullName: userFullName,
    canGift: canGift
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PinMessageModal_async__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isOpen: isPinModalOpen,
    messageId: message.id,
    chatId: message.chatId,
    onClose: closePinModal
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_15__["default"], {
    isOpen: isClosePollDialogOpen,
    onClose: closeClosePollDialog,
    text: lang('lng_polls_stop_warning'),
    confirmLabel: lang('lng_polls_stop_sure'),
    confirmHandler: handlePollClose
  }), canReschedule && calendar);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  message,
  messageListType,
  detectedLanguage
}) => {
  const {
    threadId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectCurrentMessageList)(global) || {};
  const {
    defaultTags,
    topReactions,
    availableReactions
  } = global.reactions;
  const activeDownloads = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectActiveDownloads)(global);
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, message.chatId);
  const isPrivate = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isUserId)(chat.id);
  const chatFullInfo = !isPrivate ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChatFullInfo)(global, message.chatId) : undefined;
  const user = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUser)(global, message.chatId);
  const userFullName = user && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getUserFullName)(user);
  const {
    seenByExpiresAt,
    seenByMaxChatMembers,
    maxUniqueReactions,
    readDateExpiresAt
  } = global.appConfig || {};
  const reactionsLimit = chatFullInfo?.reactionsLimit || maxUniqueReactions;
  const {
    noOptions,
    canReplyGlobally,
    canPin,
    canUnpin,
    canDelete,
    canReport,
    canEdit,
    canFaveSticker,
    canUnfaveSticker,
    canCopy,
    canCopyLink,
    canSelect,
    canDownload,
    canSaveGif,
    canRevote,
    canClosePoll
  } = threadId && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectAllowedMessageActionsSlow)(global, message, threadId) || {};
  const canForward = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectCanForwardMessage)(global, message);
  const userStatus = isPrivate ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUserStatus)(global, chat.id) : undefined;
  const isOwn = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isOwnMessage)(message);
  const chatBot = chat && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectBot)(global, chat.id);
  const isBot = Boolean(chatBot);
  const isMessageUnread = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsMessageUnread)(global, message);
  const canLoadReadDate = Boolean(isPrivate && isOwn && !isBot && !isMessageUnread && readDateExpiresAt && message.date > Date.now() / 1000 - readDateExpiresAt && !userStatus?.isReadDateRestricted && messageListType !== 'scheduled');
  const shouldRenderShowWhen = Boolean(canLoadReadDate && isPrivate && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUserStatus)(global, chat.id)?.isReadDateRestrictedByMe);
  const isPinned = messageListType === 'pinned';
  const isScheduled = messageListType === 'scheduled';
  const isChannel = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatChannel)(chat);
  const threadInfo = threadId && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectThreadInfo)(global, message.chatId, threadId);
  const isMessageThread = Boolean(threadInfo && !threadInfo?.isCommentsInfo && threadInfo?.fromChannelId);
  const topic = threadId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTopic)(global, message.chatId, threadId) : undefined;
  const canSendText = chat && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isUserRightBanned)(chat, 'sendPlain', chatFullInfo);
  const canReplyInChat = chat && threadId ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getCanPostInChat)(chat, topic, isMessageThread, chatFullInfo) && canSendText : false;
  const isLocal = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isMessageLocal)(message);
  const hasTtl = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.hasMessageTtl)(message);
  const canShowSeenBy = Boolean(!isLocal && chat && !isMessageUnread && seenByMaxChatMembers && seenByExpiresAt && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatGroup)(chat) && isOwn && !isScheduled && chat.membersCount && chat.membersCount <= seenByMaxChatMembers && message.date > Date.now() / 1000 - seenByExpiresAt);
  const isAction = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isActionMessage)(message);
  const canShowReactionsCount = !isLocal && !isChannel && !isScheduled && !isAction && !isPrivate && message.reactions && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.areReactionsEmpty)(message.reactions) && message.reactions.canSeeList;
  const isProtected = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsMessageProtected)(global, message);
  const canCopyNumber = Boolean(message.content.contact);
  const isCurrentUserPremium = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsCurrentUserPremium)(global);
  const customEmojiSetsInfo = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectMessageCustomEmojiSets)(global, message);
  const customEmojiSetsNotFiltered = customEmojiSetsInfo?.map(set => (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectStickerSet)(global, set));
  const customEmojiSets = customEmojiSetsNotFiltered?.every(Boolean) ? customEmojiSetsNotFiltered : undefined;
  const translationRequestLanguage = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectRequestedMessageTranslationLanguage)(global, message.chatId, message.id);
  const hasTranslation = translationRequestLanguage ? Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectMessageTranslations)(global, message.chatId, translationRequestLanguage)[message.id]?.text) : undefined;
  const canTranslate = !hasTranslation && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectCanTranslateMessage)(global, message, detectedLanguage);
  const isChatTranslated = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectRequestedChatTranslationLanguage)(global, message.chatId);
  const isInSavedMessages = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsChatWithSelf)(global, message.chatId);
  const poll = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectPollFromMessage)(global, message);
  const storyData = message.content.storyData;
  const story = storyData ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectPeerStory)(global, storyData.peerId, storyData.id) : undefined;
  const canGift = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectCanGift)(global, message.chatId);
  return {
    threadId,
    chat,
    availableReactions,
    topReactions,
    defaultTagReactions: defaultTags,
    noOptions,
    canReport,
    canSendNow: isScheduled,
    canReschedule: isScheduled,
    canReply: !isPinned && !isScheduled && canReplyGlobally,
    canPin: !isScheduled && canPin,
    canUnpin: !isScheduled && canUnpin,
    canDelete,
    canEdit: !isPinned && canEdit,
    canForward: !isScheduled && canForward,
    canFaveSticker: !isScheduled && canFaveSticker,
    canUnfaveSticker: !isScheduled && canUnfaveSticker,
    canCopy: canCopyNumber || !isProtected && canCopy,
    canCopyLink: !isScheduled && canCopyLink,
    canSelect,
    canDownload: !isProtected && canDownload,
    canSaveGif: !isProtected && canSaveGif,
    canRevote,
    canClosePoll: !isScheduled && canClosePoll,
    activeDownloads,
    canShowSeenBy,
    canLoadReadDate,
    shouldRenderShowWhen,
    enabledReactions: chat?.isForbidden ? undefined : chatFullInfo?.enabledReactions,
    reactionsLimit,
    isPrivate,
    isCurrentUserPremium,
    hasFullInfo: Boolean(chatFullInfo),
    canShowReactionsCount,
    canShowReactionList: !isLocal && !isAction && !isScheduled && chat?.id !== _config__WEBPACK_IMPORTED_MODULE_3__.SERVICE_NOTIFICATIONS_USER_ID && !hasTtl,
    canBuyPremium: !isCurrentUserPremium && !(0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsPremiumPurchaseBlocked)(global),
    customEmojiSetsInfo,
    customEmojiSets,
    canScheduleUntilOnline: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectCanScheduleUntilOnline)(global, message.chatId),
    canTranslate,
    canShowOriginal: hasTranslation && !isChatTranslated,
    canSelectLanguage: hasTranslation && !isChatTranslated,
    isMessageTranslated: hasTranslation,
    canPlayAnimatedEmojis: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectCanPlayAnimatedEmojis)(global),
    isReactionPickerOpen: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsReactionPickerOpen)(global),
    isInSavedMessages,
    isChannel,
    canReplyInChat,
    isWithPaidReaction: chatFullInfo?.isPaidReactionAvailable,
    poll,
    story,
    userFullName,
    canGift
  };
})(ContextMenuContainer)));

/***/ }),

/***/ "./src/components/middle/message/LastEditTimeMenuItem.tsx":
/*!****************************************************************!*\
  !*** ./src/components/middle/message/LastEditTimeMenuItem.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../ui/placeholder/Skeleton */ "./src/components/ui/placeholder/Skeleton.tsx");
/* harmony import */ var _TimeMenuItem_module_scss__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TimeMenuItem.module.scss */ "./src/components/middle/message/TimeMenuItem.module.scss");






function LastEditTimeMenuItem({
  message
}) {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const {
    editDate
  } = message;
  const shouldRenderSkeleton = !editDate;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_3__["default"], {
    icon: "clock-edit",
    className: _TimeMenuItem_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].item
  }, shouldRenderSkeleton ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_4__["default"], {
    className: _TimeMenuItem_module_scss__WEBPACK_IMPORTED_MODULE_5__["default"].skeleton
  }) : Boolean(editDate) && lang('Chat.PrivateMessageEditTimestamp.Date', (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_1__.formatDateAtTime)(lang, editDate * 1000)));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(LastEditTimeMenuItem));

/***/ }),

/***/ "./src/components/middle/message/MessageContextMenu.tsx":
/*!**************************************************************!*\
  !*** ./src/components/middle/message/MessageContextMenu.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_scrollLock__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/scrollLock */ "./src/util/scrollLock.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _helpers_copyOptions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./helpers/copyOptions */ "./src/components/middle/message/helpers/copyOptions.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AvatarList__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/AvatarList */ "./src/components/common/AvatarList.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_MenuSeparator__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/MenuSeparator */ "./src/components/ui/MenuSeparator.tsx");
/* harmony import */ var _ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/placeholder/Skeleton */ "./src/components/ui/placeholder/Skeleton.tsx");
/* harmony import */ var _LastEditTimeMenuItem__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./LastEditTimeMenuItem */ "./src/components/middle/message/LastEditTimeMenuItem.tsx");
/* harmony import */ var _reactions_ReactionSelector__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./reactions/ReactionSelector */ "./src/components/middle/message/reactions/ReactionSelector.tsx");
/* harmony import */ var _ReadTimeMenuItem__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./ReadTimeMenuItem */ "./src/components/middle/message/ReadTimeMenuItem.tsx");
/* harmony import */ var _MessageContextMenu_scss__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./MessageContextMenu.scss */ "./src/components/middle/message/MessageContextMenu.scss");





















const SCROLLBAR_WIDTH = 10;
const REACTION_SELECTOR_WIDTH_REM = 19.25;
const ANIMATION_DURATION = 200;
const MessageContextMenu = ({
  isReactionPickerOpen,
  availableReactions,
  topReactions,
  defaultTagReactions,
  isOpen,
  message,
  poll,
  story,
  isPrivate,
  isCurrentUserPremium,
  enabledReactions,
  isWithPaidReaction,
  reactionsLimit,
  anchor,
  targetHref,
  canSendNow,
  canReschedule,
  canBuyPremium,
  canReply,
  canQuote,
  canEdit,
  noReplies,
  canPin,
  canUnpin,
  canDelete,
  canForward,
  canReport,
  canFaveSticker,
  canUnfaveSticker,
  canCopy,
  canCopyLink,
  canSelect,
  canDownload,
  canSaveGif,
  canRevote,
  canClosePoll,
  canTranslate,
  canShowOriginal,
  canSelectLanguage,
  isDownloading,
  repliesThreadInfo,
  canShowSeenBy,
  canShowReactionsCount,
  canShowReactionList,
  seenByRecentPeers,
  hasCustomEmoji,
  customEmojiSets,
  canPlayAnimatedEmojis,
  isInSavedMessages,
  shouldRenderShowWhen,
  canLoadReadDate,
  onReply,
  onOpenThread,
  onEdit,
  onPin,
  onUnpin,
  onForward,
  onDelete,
  onFaveSticker,
  onReport,
  onUnfaveSticker,
  onSelect,
  onSend,
  onReschedule,
  onClose,
  onCloseAnimationEnd,
  onCopyLink,
  onCopyNumber,
  onDownload,
  onSaveGif,
  onCancelVote,
  onClosePoll,
  onShowSeenBy,
  onShowReactors,
  onToggleReaction,
  onSendPaidReaction,
  onShowPaidReactionModal,
  onCopyMessages,
  onReactionPickerOpen,
  onTranslate,
  onShowOriginal,
  onSelectLanguage,
  userFullName,
  canGift
}) => {
  const {
    showNotification,
    openStickerSet,
    openCustomEmojiSets,
    loadStickers,
    openGiftModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  // eslint-disable-next-line no-null/no-null
  const menuRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const scrollableRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const noReactions = !isPrivate && !enabledReactions;
  const areReactionsPossible = message.areReactionsPossible;
  const withReactions = canShowReactionList && !noReactions || areReactionsPossible;
  const isEdited = 'isEdited' in message && message.isEdited;
  const seenByDates = message.seenByDates;
  const isPremiumGift = message.content.action?.type === 'giftPremium';
  const isGiftCode = message.content.action?.type === 'giftCode';
  const isStarGift = message.content.action?.type === 'starGift';
  const isStarGiftUnique = message.content.action?.type === 'starGiftUnique';
  const shouldShowGiftButton = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(message.chatId) && canGift && (isPremiumGift || isGiftCode || isStarGift || isStarGiftUnique);
  const [areItemsHidden, hideItems] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isReady, markIsReady, unmarkIsReady] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const {
    isMobile,
    isDesktop
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const seenByDatesCount = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => seenByDates ? Object.keys(seenByDates).length : 0, [seenByDates]);
  const handleAfterCopy = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    showNotification({
      message: lang('Share.Link.Copied')
    });
    onClose();
  });
  const handleGiftClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    openGiftModal({
      forUserId: message.chatId
    });
    onClose();
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && areItemsHidden && !isReactionPickerOpen) {
      onClose();
    }
  }, [onClose, isOpen, isReactionPickerOpen, areItemsHidden]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (customEmojiSets?.length) {
      customEmojiSets.map(customEmojiSet => {
        return loadStickers({
          stickerSetInfo: {
            id: customEmojiSet.id,
            accessHash: customEmojiSet.accessHash
          }
        });
      });
    }
  }, [customEmojiSets, openCustomEmojiSets]);
  const handleOpenCustomEmojiSets = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (!customEmojiSets) return;
    if (customEmojiSets.length === 1) {
      openStickerSet({
        stickerSetInfo: {
          shortName: customEmojiSets[0].shortName
        }
      });
    } else {
      openCustomEmojiSets({
        setIds: customEmojiSets.map(set => set.id)
      });
    }
    onClose();
  });
  const copyOptions = (0,_helpers_copyOptions__WEBPACK_IMPORTED_MODULE_7__.getMessageCopyOptions)(message, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.groupStatetefulContent)({
    poll,
    story
  }), targetHref, canCopy, handleAfterCopy, canCopyLink ? onCopyLink : undefined, onCopyMessages, onCopyNumber);
  const getTriggerElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    return document.querySelector(`.Transition_slide-active > .MessageList div[data-message-id="${message.id}"]`);
  });
  const getRootElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => document.querySelector('.Transition_slide-active > .MessageList'));
  const getMenuElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => document.querySelector('.MessageContextMenu .bubble'));
  const getLayout = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    const extraHeightAudioPlayer = isMobile && document.querySelector('.AudioPlayer-content')?.offsetHeight || 0;
    const middleColumn = document.getElementById('MiddleColumn');
    const middleColumnComputedStyle = getComputedStyle(middleColumn);
    const headerToolsHeight = parseFloat(middleColumnComputedStyle.getPropertyValue('--middle-header-panes-height'));
    const extraHeightPinned = headerToolsHeight || 0;
    return {
      extraPaddingX: SCROLLBAR_WIDTH,
      extraTopPadding: document.querySelector('.MiddleHeader').offsetHeight,
      extraMarginTop: extraHeightPinned + extraHeightAudioPlayer,
      shouldAvoidNegativePosition: !isDesktop,
      menuElMinWidth: withReactions && isMobile ? REACTION_SELECTOR_WIDTH_REM * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__.REM : undefined
    };
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      unmarkIsReady();
      return;
    }
    setTimeout(() => {
      markIsReady();
    }, ANIMATION_DURATION);
  }, [isOpen, markIsReady, unmarkIsReady]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    return (0,_util_scrollLock__WEBPACK_IMPORTED_MODULE_4__.disableScrolling)(scrollableRef.current, '.ReactionPicker');
  }, [isOpen]);
  const handleOpenMessageReactionPicker = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(position => {
    onReactionPickerOpen(position);
    hideItems();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_13__["default"], {
    ref: menuRef,
    isOpen: isOpen,
    anchor: anchor,
    getTriggerElement: getTriggerElement,
    getRootElement: getRootElement,
    getMenuElement: getMenuElement,
    getLayout: getLayout,
    withMaxHeight: true,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('MessageContextMenu', 'fluid', withReactions && 'with-reactions'),
    onClose: onClose,
    onCloseAnimationEnd: onCloseAnimationEnd
  }, withReactions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_reactions_ReactionSelector__WEBPACK_IMPORTED_MODULE_18__["default"], {
    enabledReactions: enabledReactions,
    topReactions: topReactions,
    allAvailableReactions: availableReactions,
    defaultTagReactions: defaultTagReactions,
    currentReactions: message.reactions?.results,
    reactionsLimit: reactionsLimit,
    onToggleReaction: onToggleReaction,
    onSendPaidReaction: onSendPaidReaction,
    onShowPaidReactionModal: onShowPaidReactionModal,
    isWithPaidReaction: isWithPaidReaction,
    isPrivate: isPrivate,
    isReady: isReady,
    canBuyPremium: canBuyPremium,
    isCurrentUserPremium: isCurrentUserPremium,
    isInSavedMessages: isInSavedMessages,
    canPlayAnimatedEmojis: canPlayAnimatedEmojis,
    onShowMore: handleOpenMessageReactionPicker,
    onClose: onClose,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(areItemsHidden && 'ReactionSelector-hidden')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: scrollableRef,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('MessageContextMenu_items scrollable-content custom-scroll', areItemsHidden && 'MessageContextMenu_items-hidden'),
    dir: lang.isRtl ? 'rtl' : undefined
  }, shouldShowGiftButton && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "gift",
    onClick: handleGiftClick
  }, message?.isOutgoing ? lang('SendAnotherGift') : lang('Conversation.ContextMenuSendGiftTo', userFullName)), canSendNow && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "send-outline",
    onClick: onSend
  }, lang('MessageScheduleSend')), canReschedule && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "schedule",
    onClick: onReschedule
  }, lang('MessageScheduleEditTime')), canReply && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "reply",
    onClick: onReply
  }, lang(canQuote ? 'lng_context_quote_and_reply' : 'Reply')), !noReplies && Boolean(repliesThreadInfo?.messagesCount) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "replies",
    onClick: onOpenThread
  }, lang('Conversation.ContextViewReplies', repliesThreadInfo.messagesCount, 'i')), canEdit && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "edit",
    onClick: onEdit
  }, lang('Edit')), canFaveSticker && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "favorite",
    onClick: onFaveSticker
  }, lang('AddToFavorites')), canUnfaveSticker && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "favorite",
    onClick: onUnfaveSticker
  }, lang('Stickers.RemoveFromFavorites')), canTranslate && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "language",
    onClick: onTranslate
  }, lang('TranslateMessage')), canShowOriginal && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "language",
    onClick: onShowOriginal
  }, lang('ShowOriginalButton')), canSelectLanguage && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "web",
    onClick: onSelectLanguage
  }, lang('lng_settings_change_lang')), copyOptions.map(option => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    key: option.label,
    icon: option.icon,
    onClick: option.handler,
    withPreventDefaultOnMouseDown: true
  }, lang(option.label))), canPin && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "pin",
    onClick: onPin
  }, lang('DialogPin')), canUnpin && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "unpin",
    onClick: onUnpin
  }, lang('DialogUnpin')), canSaveGif && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "gifs",
    onClick: onSaveGif
  }, lang('lng_context_save_gif')), canRevote && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "revote",
    onClick: onCancelVote
  }, lang('lng_polls_retract')), canClosePoll && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "stop",
    onClick: onClosePoll
  }, lang('lng_polls_stop')), canDownload && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "download",
    onClick: onDownload
  }, isDownloading ? lang('lng_context_cancel_download') : lang('lng_media_download')), canForward && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "forward",
    onClick: onForward
  }, lang('Forward')), canSelect && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "select",
    onClick: onSelect
  }, lang('Common.Select')), canReport && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "flag",
    onClick: onReport
  }, lang('lng_context_report_msg')), canDelete && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    destructive: true,
    icon: "delete",
    onClick: onDelete
  }, lang('Delete')), hasCustomEmoji && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuSeparator__WEBPACK_IMPORTED_MODULE_15__["default"], {
    size: "thick"
  }), !customEmojiSets && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_16__["default"], {
    inline: true,
    className: "menu-loading-row"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_16__["default"], {
    inline: true,
    className: "menu-loading-row"
  })), customEmojiSets && customEmojiSets.length === 1 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    withWrap: true,
    onClick: handleOpenCustomEmojiSets,
    className: "menu-custom-emoji-sets"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang('MessageContainsEmojiPack', customEmojiSets[0].title), ['simple_markdown', 'emoji'])), customEmojiSets && customEmojiSets.length > 1 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    withWrap: true,
    onClick: handleOpenCustomEmojiSets,
    className: "menu-custom-emoji-sets"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang('MessageContainsEmojiPacks', customEmojiSets.length), ['simple_markdown']))), (canShowSeenBy || canShowReactionsCount) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuSeparator__WEBPACK_IMPORTED_MODULE_15__["default"], {
    size: hasCustomEmoji ? 'thin' : 'thick'
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: canShowReactionsCount ? 'heart-outline' : 'group',
    onClick: canShowReactionsCount ? onShowReactors : onShowSeenBy,
    disabled: !canShowReactionsCount && !seenByDatesCount
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "MessageContextMenu--seen-by-label-wrapper"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "MessageContextMenu--seen-by-label",
    dir: lang.isRtl ? 'rtl' : undefined
  }, canShowReactionsCount && message.reactors?.count ? canShowSeenBy && seenByDatesCount ? lang('Chat.OutgoingContextMixedReactionCount', [message.reactors.count, seenByDatesCount]) : lang('Chat.ContextReactionCount', message.reactors.count, 'i') : seenByDatesCount === 1 && seenByRecentPeers ? (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(seenByRecentPeers[0].id) ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(seenByRecentPeers[0]) : seenByRecentPeers[0].title) : seenByDatesCount ? lang('Conversation.ContextMenuSeen', seenByDatesCount, 'i') : lang('Conversation.ContextMenuNoViews'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AvatarList__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: "avatars",
    size: "micro",
    peers: seenByRecentPeers
  }))), (canLoadReadDate || shouldRenderShowWhen || isEdited) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuSeparator__WEBPACK_IMPORTED_MODULE_15__["default"], {
    size: hasCustomEmoji ? 'thin' : 'thick'
  }), (canLoadReadDate || shouldRenderShowWhen) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ReadTimeMenuItem__WEBPACK_IMPORTED_MODULE_19__["default"], {
    canLoadReadDate: canLoadReadDate,
    shouldRenderShowWhen: shouldRenderShowWhen,
    message: message,
    closeContextMenu: onClose
  }), isEdited && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_LastEditTimeMenuItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
    message: message
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(MessageContextMenu));

/***/ }),

/***/ "./src/components/middle/message/ReadTimeMenuItem.tsx":
/*!************************************************************!*\
  !*** ./src/components/middle/message/ReadTimeMenuItem.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../ui/placeholder/Skeleton */ "./src/components/ui/placeholder/Skeleton.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _TimeMenuItem_module_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./TimeMenuItem.module.scss */ "./src/components/middle/message/TimeMenuItem.module.scss");








function ReadTimeMenuItem({
  message,
  shouldRenderShowWhen,
  canLoadReadDate,
  closeContextMenu
}) {
  const {
    openPrivacySettingsNoticeModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const {
    readDate
  } = message;
  const shouldRenderSkeleton = canLoadReadDate && !readDate && !shouldRenderShowWhen;
  const handleOpenModal = () => {
    closeContextMenu();
    openPrivacySettingsNoticeModal({
      chatId: message.chatId,
      isReadDate: true
    });
  };
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_4__["default"], {
    icon: "message-read",
    className: _TimeMenuItem_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].item
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_6__["default"], {
    name: "fade",
    activeKey: shouldRenderSkeleton ? 1 : 2,
    className: _TimeMenuItem_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].transition
  }, shouldRenderSkeleton ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_5__["default"], {
    className: _TimeMenuItem_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].skeleton
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, Boolean(readDate) && lang('PmReadAt', (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_2__.formatDateAtTime)(lang, readDate * 1000)), !readDate && shouldRenderShowWhen && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, lang('PmRead'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _TimeMenuItem_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].get,
    onClick: handleOpenModal
  }, lang('PmReadShowWhen'))))));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ReadTimeMenuItem));

/***/ }),

/***/ "./src/components/middle/message/helpers/copyOptions.ts":
/*!**************************************************************!*\
  !*** ./src/components/middle/message/helpers/copyOptions.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getMessageCopyOptions: () => (/* binding */ getMessageCopyOptions)
/* harmony export */ });
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_helpers_messageSummary__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../global/helpers/messageSummary */ "./src/global/helpers/messageSummary.ts");
/* harmony import */ var _util_clipboard__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../util/clipboard */ "./src/util/clipboard.ts");
/* harmony import */ var _util_getMessageIdsForSelectedText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../util/getMessageIdsForSelectedText */ "./src/util/getMessageIdsForSelectedText.ts");
/* harmony import */ var _util_mediaLoader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../util/mediaLoader */ "./src/util/mediaLoader.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../common/helpers/renderMessageText */ "./src/components/common/helpers/renderMessageText.ts");








function getMessageCopyOptions(message, statefulContent, href, canCopy, afterEffect, onCopyLink, onCopyMessages, onCopyNumber) {
  const options = [];
  const text = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getMessageText)(message);
  const photo = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getMessagePhoto)(message) || (!(0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getMessageWebPageVideo)(message) ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getMessageWebPagePhoto)(message) : undefined);
  const contact = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getMessageContact)(message);
  const mediaHash = photo ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getPhotoMediaHash)(photo, 'full') : undefined;
  const canImageBeCopied = canCopy && photo && (mediaHash || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.hasMediaLocalBlobUrl)(photo)) && _util_clipboard__WEBPACK_IMPORTED_MODULE_3__.CLIPBOARD_ITEM_SUPPORTED && !_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_6__.IS_SAFARI;
  const selection = window.getSelection();
  if (canImageBeCopied) {
    options.push({
      label: 'lng_context_copy_image',
      icon: 'copy-media',
      handler: () => {
        Promise.resolve(mediaHash ? _util_mediaLoader__WEBPACK_IMPORTED_MODULE_5__.fetch(mediaHash, _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMediaFormat.BlobUrl) : photo.blobUrl).then(_util_clipboard__WEBPACK_IMPORTED_MODULE_3__.copyImageToClipboard);
        afterEffect?.();
      }
    });
  }
  if (canCopy && href) {
    options.push({
      label: 'lng_context_copy_link',
      icon: 'copy',
      handler: () => {
        (0,_util_clipboard__WEBPACK_IMPORTED_MODULE_3__.copyTextToClipboard)(href);
        afterEffect?.();
      }
    });
  } else if (canCopy && text) {
    // Detect if the user has selection in the current message
    const hasSelection = Boolean(selection?.anchorNode?.parentNode && selection.anchorNode.parentNode.closest('.Message .content-inner') && selection.toString().replace(/(?:\r\n|\r|\n)/g, '') !== '' && checkMessageHasSelection(message));
    options.push({
      label: getCopyLabel(hasSelection),
      icon: 'copy',
      handler: () => {
        const messageIds = (0,_util_getMessageIdsForSelectedText__WEBPACK_IMPORTED_MODULE_4__["default"])();
        if (messageIds?.length && onCopyMessages) {
          onCopyMessages(messageIds);
        } else if (hasSelection) {
          document.execCommand('copy');
        } else {
          const clipboardText = (0,_common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_7__.renderMessageText)({
            message,
            shouldRenderAsHtml: true
          });
          if (clipboardText) {
            (0,_util_clipboard__WEBPACK_IMPORTED_MODULE_3__.copyHtmlToClipboard)(clipboardText.join(''), (0,_global_helpers_messageSummary__WEBPACK_IMPORTED_MODULE_2__.getMessageTextWithSpoilers)(message, statefulContent));
          }
        }
        afterEffect?.();
      }
    });
  }
  if (onCopyLink) {
    options.push({
      label: 'lng_context_copy_message_link',
      icon: 'link',
      handler: onCopyLink
    });
  }
  if (contact && onCopyNumber) {
    options.push({
      label: 'lng_profile_copy_phone',
      icon: 'copy',
      handler: () => {
        onCopyNumber();
        afterEffect?.();
      }
    });
  }
  return options;
}
function checkMessageHasSelection(message) {
  const selection = window.getSelection();
  const selectionParentNode = selection?.anchorNode?.parentNode;
  const selectedMessageElement = selectionParentNode?.closest('.Message.message-list-item');
  return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getMessageHtmlId)(message.id) === selectedMessageElement?.id;
}
function getCopyLabel(hasSelection) {
  if (hasSelection) {
    return 'lng_context_copy_selected';
  }
  return 'lng_context_copy_text';
}

/***/ }),

/***/ "./src/components/middle/message/helpers/getSelectionAsFormattedText.ts":
/*!******************************************************************************!*\
  !*** ./src/components/middle/message/helpers/getSelectionAsFormattedText.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getSelectionAsFormattedText: () => (/* binding */ getSelectionAsFormattedText)
/* harmony export */ });
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _util_parseHtmlAsFormattedText__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../util/parseHtmlAsFormattedText */ "./src/util/parseHtmlAsFormattedText.ts");


const div = document.createElement('div');
const ALLOWED_QUOTE_ENTITIES = new Set([_api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMessageEntityTypes.Bold, _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMessageEntityTypes.Italic, _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMessageEntityTypes.Underline, _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMessageEntityTypes.Strike, _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMessageEntityTypes.Spoiler, _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMessageEntityTypes.CustomEmoji]);
function getSelectionAsFormattedText(range) {
  const html = getSelectionAsHtml(range);
  const formattedText = (0,_util_parseHtmlAsFormattedText__WEBPACK_IMPORTED_MODULE_1__["default"])(html, false, true);
  return stripEntitiesForQuote(formattedText);
}
function getSelectionAsHtml(range) {
  const clonedSelection = range.cloneContents();
  div.appendChild(clonedSelection);
  const html = wrapHtmlWithMarkupTags(range, div.innerHTML);
  div.innerHTML = '';
  return html.replace(/<br\s*\/?>/gi, '\n').replace(/&nbsp;/gi, ' ') // Convert nbsp's to spaces
  .replace(/\u00a0/gi, ' ');
}
function stripEntitiesForQuote(text) {
  if (!text.entities) return text;
  const entities = text.entities.filter(entity => ALLOWED_QUOTE_ENTITIES.has(entity.type));
  return {
    ...text,
    entities: entities.length ? entities : undefined
  };
}
function wrapHtmlWithMarkupTags(range, html) {
  const container = range.commonAncestorContainer;
  if (container.nodeType === Node.ELEMENT_NODE && container.classList.contains('text-content')) {
    return html;
  }
  let currentElement = range.commonAncestorContainer.parentElement;
  while (currentElement && !currentElement.classList.contains('text-content')) {
    const tag = currentElement.tagName.toLowerCase();
    const entityType = currentElement.dataset.entityType;
    html = `<${tag} ${entityType ? `data-entity-type="${entityType}"` : ''}>${html}</${tag}>`;
    currentElement = currentElement.parentElement;
  }
  return html;
}

/***/ }),

/***/ "./src/components/middle/message/helpers/isSelectionRangeInsideMessage.ts":
/*!********************************************************************************!*\
  !*** ./src/components/middle/message/helpers/isSelectionRangeInsideMessage.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isSelectionRangeInsideMessage: () => (/* binding */ isSelectionRangeInsideMessage)
/* harmony export */ });
function isSelectionRangeInsideMessage(range) {
  const ancestor = range.commonAncestorContainer;
  const el = ancestor.nodeType === Node.TEXT_NODE ? ancestor.parentNode : ancestor;
  return Boolean(el.closest('.message-content-wrapper .text-content')) && !(Boolean(el.closest('.EmbeddedMessage')) || Boolean(el.closest('.WebPage')));
}

/***/ }),

/***/ "./src/components/middle/message/reactions/ReactionPicker.tsx":
/*!********************************************************************!*\
  !*** ./src/components/middle/message/reactions/ReactionPicker.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_parseHtmlAsFormattedText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../util/parseHtmlAsFormattedText */ "./src/util/parseHtmlAsFormattedText.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _composer_helpers_customEmoji__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../composer/helpers/customEmoji */ "./src/components/middle/composer/helpers/customEmoji.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../common/CustomEmojiPicker */ "./src/components/common/CustomEmojiPicker.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _composer_StickerPicker__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../composer/StickerPicker */ "./src/components/middle/composer/StickerPicker.tsx");
/* harmony import */ var _ReactionPickerLimited__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./ReactionPickerLimited */ "./src/components/middle/message/reactions/ReactionPickerLimited.tsx");
/* harmony import */ var _ReactionPicker_module_scss__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./ReactionPicker.module.scss */ "./src/components/middle/message/reactions/ReactionPicker.module.scss");


















const FULL_PICKER_SHIFT_DELTA = {
  x: -23,
  y: -64
};
const LIMITED_PICKER_SHIFT_DELTA = {
  x: -21,
  y: -10
};
const REACTION_SELECTOR_WIDTH = 16.375 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_7__.REM;
const ReactionPicker = ({
  isOpen,
  message,
  story,
  position,
  isTranslucent,
  isCurrentUserPremium,
  shouldUseFullPicker,
  sendAsMessage,
  chatId,
  isForEffects,
  availableEffectById
}) => {
  const {
    toggleReaction,
    closeReactionPicker,
    sendMessage,
    showNotification,
    sendStoryReaction,
    saveEffectInDraft,
    requestEffectInComposer,
    addLocalPaidReaction,
    openPaidReactionModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const renderedMessageId = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_10__["default"])(message?.id, true);
  const renderedChatId = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_10__["default"])(message?.chatId, true);
  const renderedStoryPeerId = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_10__["default"])(story?.peerId, true);
  const renderedStoryId = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_10__["default"])(story?.id);
  const storedPosition = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_10__["default"])(position, true);
  // eslint-disable-next-line no-null/no-null
  const menuRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const renderingPosition = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!storedPosition) {
      return undefined;
    }
    if (renderedStoryId) {
      return storedPosition;
    }
    return {
      x: storedPosition.x + (shouldUseFullPicker ? FULL_PICKER_SHIFT_DELTA.x : LIMITED_PICKER_SHIFT_DELTA.x),
      y: storedPosition.y + (shouldUseFullPicker ? FULL_PICKER_SHIFT_DELTA.y : LIMITED_PICKER_SHIFT_DELTA.y)
    };
  }, [renderedStoryId, storedPosition, shouldUseFullPicker]);
  const getMenuElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => menuRef.current);
  const getLayout = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => ({
    withPortal: true,
    isDense: !renderedStoryPeerId,
    deltaX: !(0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_9__.getIsMobile)() && menuRef.current ? -(menuRef.current.offsetWidth - REACTION_SELECTOR_WIDTH) / 2 - FULL_PICKER_SHIFT_DELTA.x / 2 : 0
  }));
  const handleToggleCustomReaction = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(sticker => {
    if (!renderedChatId || !renderedMessageId) {
      return;
    }
    const reaction = sticker.isCustomEmoji ? {
      type: 'custom',
      documentId: sticker.id
    } : {
      type: 'emoji',
      emoticon: sticker.emoji
    };
    toggleReaction({
      chatId: renderedChatId,
      messageId: renderedMessageId,
      reaction,
      shouldAddToRecent: true
    });
    closeReactionPicker();
  });
  const handleToggleReaction = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(reaction => {
    if (!renderedChatId || !renderedMessageId) {
      return;
    }
    if (reaction.type === 'paid') {
      addLocalPaidReaction({
        chatId: renderedChatId,
        messageId: renderedMessageId,
        count: 1
      });
    } else {
      toggleReaction({
        chatId: renderedChatId,
        messageId: renderedMessageId,
        reaction,
        shouldAddToRecent: true
      });
    }
    closeReactionPicker();
  });
  const handleReactionContextMenu = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(reaction => {
    if (reaction.type !== 'paid') return;
    openPaidReactionModal({
      chatId: renderedChatId,
      messageId: renderedMessageId
    });
    closeReactionPicker();
  });
  const handleStoryReactionSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(item => {
    if ('type' in item && item.type === 'paid') return; // Not supported for stories

    const reaction = 'id' in item ? {
      type: 'custom',
      documentId: item.id
    } : item;
    const sticker = 'type' in item && item.type === 'custom' ? (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().customEmojis.byId[item.documentId] : 'id' in item ? item : undefined;
    if (sticker && !sticker.isFree && !isCurrentUserPremium) {
      showNotification({
        message: lang('UnlockPremiumEmojiHint'),
        action: {
          action: 'openPremiumModal',
          payload: {
            initialSection: 'animated_emoji'
          }
        },
        actionText: lang('PremiumMore')
      });
      closeReactionPicker();
      return;
    }
    if (!sendAsMessage) {
      sendStoryReaction({
        peerId: renderedStoryPeerId,
        storyId: renderedStoryId,
        containerId: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getStoryKey)(renderedStoryPeerId, renderedStoryId),
        reaction,
        shouldAddToRecent: true
      });
      closeReactionPicker();
      return;
    }
    let text;
    let entities;
    if ('type' in item && item.type === 'emoji') {
      text = item.emoticon;
    } else {
      const customEmojiMessage = (0,_util_parseHtmlAsFormattedText__WEBPACK_IMPORTED_MODULE_6__["default"])((0,_composer_helpers_customEmoji__WEBPACK_IMPORTED_MODULE_8__.buildCustomEmojiHtml)(sticker));
      text = customEmojiMessage.text;
      entities = customEmojiMessage.entities;
    }
    sendMessage({
      text,
      entities,
      isReaction: true
    });
    closeReactionPicker();
  });
  const handleStickerSelect = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(sticker => {
    const availableEffects = Object.values(availableEffectById);
    const effectId = availableEffects.find(effect => effect.effectStickerId === sticker.id)?.id;
    if (chatId) saveEffectInDraft({
      chatId,
      threadId: _api_types__WEBPACK_IMPORTED_MODULE_2__.MAIN_THREAD_ID,
      effectId
    });
    if (effectId) requestEffectInComposer({});
    closeReactionPicker();
  });
  const selectedReactionIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return (message?.reactions?.results || []).reduce((acc, {
      chosenOrder,
      reaction
    }) => {
      if (chosenOrder !== undefined) {
        acc.push((0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getReactionKey)(reaction));
      }
      return acc;
    }, []);
  }, [message?.reactions?.results]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isOpen: isOpen,
    ref: menuRef,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_ReactionPicker_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].menu, 'ReactionPicker'),
    bubbleClassName: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_ReactionPicker_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].menuContent, !shouldUseFullPicker && !renderedStoryId && _ReactionPicker_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].onlyReactions, renderedStoryId && _ReactionPicker_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].storyMenu),
    withPortal: true,
    noCompact: true,
    anchor: renderingPosition,
    positionY: story && 'bottom',
    getTriggerElement: getTriggerElement,
    getRootElement: getRootElement,
    getMenuElement: getMenuElement,
    getLayout: getLayout,
    backdropExcludedSelector: ".Modal.confirm",
    onClose: closeReactionPicker
  }, isForEffects && chatId ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_composer_StickerPicker__WEBPACK_IMPORTED_MODULE_15__["default"], {
    className: "",
    isHidden: !isOpen,
    loadAndPlay: Boolean(isOpen && shouldUseFullPicker),
    idPrefix: "message-effect",
    canSendStickers: false,
    noContextMenus: false,
    chatId: chatId,
    isTranslucent: isTranslucent,
    onStickerSelect: handleStickerSelect,
    isForEffects: isForEffects
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_13__["default"], {
    chatId: renderedChatId,
    idPrefix: "message-emoji-set-",
    isHidden: !isOpen || !(shouldUseFullPicker || renderedStoryId),
    loadAndPlay: Boolean(isOpen && shouldUseFullPicker),
    isReactionPicker: true,
    className: !shouldUseFullPicker && !renderedStoryId ? _ReactionPicker_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].hidden : undefined,
    selectedReactionIds: selectedReactionIds,
    isTranslucent: isTranslucent,
    onCustomEmojiSelect: renderedStoryId ? handleStoryReactionSelect : handleToggleCustomReaction,
    onReactionSelect: renderedStoryId ? handleStoryReactionSelect : handleToggleReaction,
    onReactionContext: handleReactionContextMenu
  }), !shouldUseFullPicker && Boolean(renderedChatId) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ReactionPickerLimited__WEBPACK_IMPORTED_MODULE_16__["default"], {
    chatId: renderedChatId,
    loadAndPlay: isOpen,
    onReactionSelect: renderedStoryId ? handleStoryReactionSelect : handleToggleReaction,
    onReactionContext: handleReactionContextMenu,
    selectedReactionIds: selectedReactionIds,
    message: message
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const state = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global);
  const availableEffectById = global.availableEffectById;
  const {
    chatId,
    messageId,
    storyPeerId,
    storyId,
    position,
    sendAsMessage,
    isForEffects
  } = state.reactionPicker || {};
  const story = storyPeerId && storyId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectPeerStory)(global, storyPeerId, storyId) : undefined;
  const chat = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId) : undefined;
  const chatFullInfo = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId) : undefined;
  const message = chatId && messageId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatMessage)(global, chatId, messageId) : undefined;
  const isPrivateChat = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserId)(chatId || storyPeerId || '');
  const areSomeReactionsAllowed = chatFullInfo?.enabledReactions?.type === 'some';
  const {
    maxUniqueReactions
  } = global.appConfig || {};
  const areAllReactionsAllowed = chatFullInfo?.enabledReactions?.type === 'all' && chatFullInfo?.enabledReactions?.areCustomAllowed;
  const currentReactions = message?.reactions?.results;
  const shouldUseCurrentReactions = Boolean(maxUniqueReactions && currentReactions && currentReactions.length >= maxUniqueReactions);
  return {
    message,
    story,
    position,
    shouldUseFullPicker: chat?.isForbidden || areSomeReactionsAllowed || shouldUseCurrentReactions ? false : areAllReactionsAllowed || isPrivateChat,
    isTranslucent: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsContextMenuTranslucent)(global),
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectIsCurrentUserPremium)(global),
    sendAsMessage,
    isForEffects,
    chatId,
    availableEffectById
  };
})(ReactionPicker)));
function getTriggerElement() {
  return document.querySelector('body');
}
function getRootElement() {
  return document.querySelector('body');
}

/***/ }),

/***/ "./src/components/middle/message/reactions/ReactionPickerLimited.tsx":
/*!***************************************************************************!*\
  !*** ./src/components/middle/message/reactions/ReactionPickerLimited.tsx ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../hooks/window/useWindowSize */ "./src/hooks/window/useWindowSize.ts");
/* harmony import */ var _common_reactions_ReactionEmoji__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../common/reactions/ReactionEmoji */ "./src/components/common/reactions/ReactionEmoji.tsx");
/* harmony import */ var _ReactionPickerLimited_module_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ReactionPickerLimited.module.scss */ "./src/components/middle/message/reactions/ReactionPickerLimited.module.scss");










const REACTION_SIZE = 36;
const GRID_GAP_THRESHOLD = 600;
const MODAL_PADDING_SIZE_REM = 0.5;
const MODAL_MAX_HEIGHT_REM = 18;
const MODAL_MAX_WIDTH_REM = 26.25;
const GRID_GAP_DESKTOP_REM = 0.625;
const GRID_GAP_MOBILE_REM = 0.5;
const ReactionPickerLimited = ({
  loadAndPlay,
  enabledReactions,
  availableReactions,
  topReactions,
  selectedReactionIds,
  isWithPaidReaction,
  message,
  reactionsLimit,
  onReactionSelect,
  onReactionContext
}) => {
  // eslint-disable-next-line no-null/no-null
  const sharedCanvasRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const sharedCanvasHqRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    width: windowWidth
  } = (0,_hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const {
    isTouchScreen
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const currentReactions = message?.reactions?.results;
  const shouldUseCurrentReactions = reactionsLimit && currentReactions && currentReactions.length >= reactionsLimit;
  const allAvailableReactions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (shouldUseCurrentReactions) {
      const reactions = currentReactions.map(({
        reaction
      }) => reaction);
      if (isWithPaidReaction) {
        reactions.unshift({
          type: 'paid'
        });
      }
      return reactions;
    }
    if (!enabledReactions) {
      return [];
    }
    if (enabledReactions.type === 'all') {
      const reactionsToSort = (availableReactions || []).map(({
        reaction
      }) => reaction);
      if (isWithPaidReaction) {
        reactionsToSort.unshift({
          type: 'paid'
        });
      }
      return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.sortReactions)(reactionsToSort, topReactions);
    }
    const reactionsToSort = enabledReactions.allowed;
    if (isWithPaidReaction) {
      reactionsToSort.unshift({
        type: 'paid'
      });
    }
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.sortReactions)(reactionsToSort, topReactions);
  }, [availableReactions, enabledReactions, topReactions, shouldUseCurrentReactions, currentReactions, isWithPaidReaction]);
  const pickerHeight = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const pickerWidth = Math.min(MODAL_MAX_WIDTH_REM * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__.REM, windowWidth);
    const gapWidth = (windowWidth > GRID_GAP_THRESHOLD ? GRID_GAP_DESKTOP_REM : GRID_GAP_MOBILE_REM) * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__.REM;
    const availableWidth = pickerWidth - MODAL_PADDING_SIZE_REM * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__.REM;
    const itemsInRow = Math.floor((availableWidth + gapWidth) / (REACTION_SIZE + gapWidth));
    const rowsCount = Math.ceil(allAvailableReactions.length / itemsInRow);
    const pickerMaxHeight = rowsCount * REACTION_SIZE + (rowsCount - 1) * gapWidth + MODAL_PADDING_SIZE_REM * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__.REM * 2;
    return Math.min(MODAL_MAX_HEIGHT_REM * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__.REM, pickerMaxHeight);
  }, [allAvailableReactions.length, windowWidth]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ReactionPickerLimited_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].root,
    style: `height: ${pickerHeight}px`
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ReactionPickerLimited_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].wrapper, isTouchScreen ? 'no-scrollbar' : 'custom-scroll')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "symbol-set-container shared-canvas-container"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: sharedCanvasRef,
    className: "shared-canvas"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: sharedCanvasHqRef,
    className: "shared-canvas"
  }), allAvailableReactions.map(reaction => {
    const reactionId = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getReactionKey)(reaction);
    const isSelected = reactionId ? selectedReactionIds?.includes(reactionId) : undefined;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_reactions_ReactionEmoji__WEBPACK_IMPORTED_MODULE_8__["default"], {
      key: reactionId,
      reaction: reaction,
      isSelected: isSelected,
      loadAndPlay: loadAndPlay,
      availableReactions: availableReactions,
      onClick: onReactionSelect,
      onContextMenu: onReactionContext,
      sharedCanvasRef: sharedCanvasRef,
      sharedCanvasHqRef: sharedCanvasHqRef
    });
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const {
    availableReactions,
    topReactions
  } = global.reactions;
  const {
    maxUniqueReactions
  } = global.appConfig || {};
  const {
    enabledReactions,
    isPaidReactionAvailable
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chatId) || {};
  return {
    enabledReactions,
    availableReactions,
    topReactions,
    reactionsLimit: maxUniqueReactions,
    isWithPaidReaction: isPaidReactionAvailable
  };
})(ReactionPickerLimited)));

/***/ }),

/***/ "./src/components/middle/search/MiddleSearch.tsx":
/*!*******************************************************!*\
  !*** ./src/components/middle/search/MiddleSearch.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/captureEscKeyListener */ "./src/util/captureEscKeyListener.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_focusEditableElement__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../util/focusEditableElement */ "./src/util/focusEditableElement.ts");
/* harmony import */ var _util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../util/keys/searchResultKey */ "./src/util/keys/searchResultKey.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_events_useOutsideClick__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../hooks/events/useOutsideClick */ "./src/hooks/events/useOutsideClick.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../hooks/useEffectWithPrevDeps */ "./src/hooks/useEffectWithPrevDeps.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../hooks/useInfiniteScroll */ "./src/hooks/useInfiniteScroll.ts");
/* harmony import */ var _hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../../hooks/useKeyboardListNavigation */ "./src/hooks/useKeyboardListNavigation.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PeerChip__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../../common/PeerChip */ "./src/components/common/PeerChip.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_SearchInput__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../../ui/SearchInput */ "./src/components/ui/SearchInput.tsx");
/* harmony import */ var _message_reactions_SavedTagButton__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../message/reactions/SavedTagButton */ "./src/components/middle/message/reactions/SavedTagButton.tsx");
/* harmony import */ var _MiddleSearchResult__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./MiddleSearchResult */ "./src/components/middle/search/MiddleSearchResult.tsx");
/* harmony import */ var _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./MiddleSearch.module.scss */ "./src/components/middle/search/MiddleSearch.module.scss");

































const CHANNELS_PEER = {
  isCustomPeer: true,
  avatarIcon: 'channel-filled',
  titleKey: 'SearchPublicPosts'
};
const FOCUSED_SEARCH_TRIGGER_OFFSET = 5;
const HIDE_TIMEOUT = 200;
const RESULT_ITEM_CLASS_NAME = 'MiddleSearchResult';
const runDebouncedForSearch = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_12__.debounce)(cb => cb(), 200, false);
const MiddleSearch = ({
  isActive,
  chat,
  threadId,
  requestedQuery,
  savedTags,
  savedTag,
  totalCount,
  lastSearchQuery,
  foundIds,
  isHistoryCalendarOpen,
  isCurrentUserPremium,
  isSavedMessages,
  fetchingQuery,
  isHashtagQuery,
  searchType = 'chat',
  currentUserId
}) => {
  const {
    updateMiddleSearch,
    resetMiddleSearch,
    performMiddleSearch,
    focusMessage,
    closeMiddleSearch,
    openHistoryCalendar,
    openPremiumModal,
    loadSavedReactionTags
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const shouldCancelSearchRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_15__["default"])();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_23__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_21__["default"])();
  const [query, setQuery] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(requestedQuery || '');
  const [focusedIndex, setFocusedIndex] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  const canFocusNewer = foundIds && focusedIndex > 0;
  const canFocusOlder = foundIds && focusedIndex < foundIds.length - 1;
  const [isFullyHidden, setIsFullyHidden] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(!isActive);
  const hiddenTimerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const maybeLongPressActiveRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(true);
  const [isFocused, markFocused, markBlurred] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_17__["default"])();
  const [isViewAsList, setIsViewAsList] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [isLoading, setIsLoading] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const handleClickOutside = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(event => {
    if (maybeLongPressActiveRef.current) return;
    // Ignore clicks inside modals
    if (event.target.closest('.Modal')) return;
    markBlurred();
  });
  (0,_hooks_events_useOutsideClick__WEBPACK_IMPORTED_MODULE_14__.useClickOutside)([ref], handleClickOutside);
  const hasResultsContainer = Boolean(query && foundIds || isHashtagQuery);
  const isOnlyHash = isHashtagQuery && !query;
  const areResultsEmpty = Boolean(query && foundIds && !foundIds.length && !isLoading && !isOnlyHash);
  const hasResultsPlaceholder = areResultsEmpty || isOnlyHash;
  const isNonFocusedDropdownForced = searchType === 'myChats' || searchType === 'channels';
  const hasResultsDropdown = isActive && (isViewAsList || !isMobile) && (isFocused || isNonFocusedDropdownForced) && Boolean(hasResultsContainer || hasResultsPlaceholder || savedTags);
  const hasQueryData = Boolean(query && !isOnlyHash || savedTag);
  const hasNavigationButtons = searchType === 'chat' && Boolean(foundIds?.length);
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    closeMiddleSearch();
  });
  const focusInput = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMeasure)(() => {
      inputRef.current?.focus();
    });
  });
  const blurInput = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    inputRef.current?.blur();
  });

  // Fix for iOS keyboard
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const {
      visualViewport
    } = window;
    if (!visualViewport) {
      return undefined;
    }
    const mainEl = document.getElementById('Main');
    const handleResize = () => {
      const {
        activeElement
      } = document;
      if (activeElement && activeElement === inputRef.current) {
        const {
          pageTop,
          height
        } = visualViewport;
        (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
          mainEl.style.transform = `translateY(${pageTop}px)`;
          mainEl.style.height = `${height}px`;
          document.documentElement.scrollTop = pageTop;
        });
      } else {
        (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
          mainEl.style.transform = '';
          mainEl.style.height = '';
        });
      }
    };
    visualViewport.addEventListener('resize', handleResize);
    return () => {
      visualViewport.removeEventListener('resize', handleResize);
    };
  }, []);

  // Reset focus on query result
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setFocusedIndex(-1);
  }, [lastSearchQuery]);

  // Disable native up/down buttons on iOS
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    if (!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_13__.IS_IOS) return;
    Array.from(document.querySelectorAll('input')).forEach(input => {
      input.disabled = Boolean(isActive && input !== inputRef.current);
    });
  }, [isActive]);

  // Blur on exit
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isActive) {
      inputRef.current.blur();
      setIsViewAsList(true);
      setFocusedIndex(0);
      setQuery('');
      hiddenTimerRef.current = window.setTimeout(() => setIsFullyHidden(true), HIDE_TIMEOUT);
    } else {
      setIsFullyHidden(false);
      clearTimeout(hiddenTimerRef.current);
    }
  }, [isActive]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!requestedQuery || !chat?.id) return;
    setQuery(requestedQuery);
    updateMiddleSearch({
      chatId: chat.id,
      threadId,
      update: {
        requestedQuery: undefined
      }
    });
    setIsLoading(true);
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestNextMutation)(() => {
      const input = inputRef.current;
      if (!input) return;
      (0,_util_focusEditableElement__WEBPACK_IMPORTED_MODULE_9__["default"])(input, true, true);
      markFocused();
    });
  }, [chat?.id, requestedQuery, threadId]);
  (0,_hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_16__["default"])(([prevIsActive]) => {
    if (isActive !== prevIsActive && !query && lastSearchQuery) {
      setQuery(lastSearchQuery); // Restore query when returning back
    }
  }, [isActive, lastSearchQuery, query]);
  (0,_hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_16__["default"])(([prevIsCalendarOpen]) => {
    if (!isActive || prevIsCalendarOpen === isHistoryCalendarOpen) return;
    if (isHistoryCalendarOpen) {
      blurInput();
      markBlurred();
    } else {
      focusInput();
    }
  }, [isHistoryCalendarOpen, isActive]);
  const handleReset = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    if (!query?.length && !savedTag) {
      handleClose();
      return;
    }
    setQuery('');
    setIsLoading(false);
    resetMiddleSearch();
    focusInput();
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => isActive ? (0,_util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_7__["default"])(handleReset) : undefined, [isActive, handleClose]);
  const savedTagsArray = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!savedTags) return undefined;
    return Object.values(savedTags);
  }, [savedTags]);
  const hasSavedTags = Boolean(savedTagsArray?.length);
  const areSavedTagsDisabled = hasSavedTags && !isCurrentUserPremium;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isSavedMessages && isActive) loadSavedReactionTags();
  }, [isSavedMessages, isActive]);
  const handleSearch = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    const chatId = chat?.id;
    if (!chatId) {
      return;
    }
    runDebouncedForSearch(() => {
      if (shouldCancelSearchRef.current) return;
      performMiddleSearch({
        chatId,
        threadId,
        query
      });
    });
  });
  const handleQueryChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(newQuery => {
    shouldCancelSearchRef.current = false;
    if (newQuery.startsWith('#') && !isHashtagQuery) {
      updateMiddleSearch({
        chatId: chat.id,
        threadId,
        update: {
          isHashtag: true
        }
      });
      setQuery(newQuery.slice(1));
      handleSearch();
      return;
    }
    setQuery(newQuery);
    if (!newQuery) {
      setIsLoading(false);
      resetMiddleSearch();
      shouldCancelSearchRef.current = true;
    }
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (query) {
      handleSearch();
    }
  }, [query]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setIsLoading(Boolean(fetchingQuery));
  }, [fetchingQuery]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!foundIds?.length) return;
    const isClose = foundIds.length - focusedIndex < FOCUSED_SEARCH_TRIGGER_OFFSET;
    if (isClose) {
      handleSearch();
    }
  }, [focusedIndex, foundIds?.length]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isActive) return undefined;
    maybeLongPressActiveRef.current = true;
    function focus() {
      inputRef.current?.focus();
      markFocused();
      (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_12__.fastRaf)(() => {
        maybeLongPressActiveRef.current = false;
      });
    }
    function removeListeners() {
      window.removeEventListener('touchend', focus);
      window.removeEventListener('mouseup', focus);
      (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_12__.fastRaf)(() => {
        maybeLongPressActiveRef.current = false;
      });
    }
    window.addEventListener('touchend', focus);
    window.addEventListener('mouseup', focus);
    window.addEventListener('touchstart', removeListeners);
    window.addEventListener('mousedown', removeListeners);
    return () => {
      removeListeners();
      window.removeEventListener('touchstart', removeListeners);
      window.removeEventListener('mousedown', removeListeners);
    };
  }, [isActive]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_18__["default"])({
    isActive,
    onBack: handleClose
  });
  const [viewportIds, getMore, viewportOffset = 0] = (0,_hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_19__["default"])(handleSearch, foundIds);
  const viewportResults = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!query && !savedTag || !viewportIds?.length) {
      return _util_memo__WEBPACK_IMPORTED_MODULE_11__.MEMO_EMPTY_ARRAY;
    }
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    return viewportIds.map(searchResultKey => {
      const [chatId, id] = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_10__.parseSearchResultKey)(searchResultKey);
      const message = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChatMessage)(global, chatId, id);
      if (!message) {
        return undefined;
      }
      const originalSender = isSavedMessages || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isSystemBot)(chatId) || chatId === _config__WEBPACK_IMPORTED_MODULE_2__.ANONYMOUS_USER_ID ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectForwardedSender)(global, message) : undefined;
      const messageSender = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectSender)(global, message);
      const messageChat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, message.chatId);
      const senderPeer = originalSender || messageSender;
      return {
        searchResultKey,
        message,
        messageChat,
        senderPeer
      };
    }).filter(Boolean);
  }, [query, savedTag, viewportIds, isSavedMessages]);
  const handleMessageClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(message => {
    const searchResultKey = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_10__.getSearchResultKey)(message);
    const index = foundIds?.indexOf(searchResultKey) || 0;
    const realIndex = index + viewportOffset;
    setFocusedIndex(realIndex);
    if (searchType === 'chat') {
      setIsViewAsList(false);
    }
    focusMessage({
      chatId: message.chatId,
      messageId: message.id,
      threadId: !isHashtagQuery ? threadId : undefined
    });
    markBlurred();
  });
  const handleTriggerViewStyle = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    setIsViewAsList(prev => !prev);
    markFocused();
  });
  const handleKeyDown = (0,_hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_20__["default"])(containerRef, hasResultsContainer, index => {
    const foundResult = viewportResults?.[index === -1 ? 0 : index];
    if (foundResult) {
      handleMessageClick(foundResult.message);
      setFocusedIndex(index + viewportOffset);
    }
  }, `.${RESULT_ITEM_CLASS_NAME}`, true);
  const updateSearchParams = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(update => {
    updateMiddleSearch({
      chatId: chat.id,
      threadId,
      update
    });
    handleSearch();
  });
  const activateSearchTag = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(tag => {
    if (areSavedTagsDisabled) {
      openPremiumModal({
        initialSection: 'saved_tags'
      });
      return;
    }
    updateSearchParams({
      savedTag: tag
    });
  });
  const removeSearchSavedTag = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    updateSearchParams({
      savedTag: undefined
    });
  });
  const handleDeleteTag = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    if (isHashtagQuery) {
      updateSearchParams({
        isHashtag: false
      });
      return;
    }
    if (savedTag) {
      removeSearchSavedTag();
    }
  });
  const handleChangeSearchType = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(type => {
    updateSearchParams({
      type
    });
    setIsViewAsList(true);
  });
  const handleFocusOlder = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    if (searchType !== 'chat') return;
    markBlurred();
    blurInput();
    if (foundIds) {
      const newFocusIndex = focusedIndex + 1;
      const [chatId, messageId] = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_10__.parseSearchResultKey)(foundIds[newFocusIndex]);
      focusMessage({
        chatId,
        messageId,
        threadId
      });
      setFocusedIndex(newFocusIndex);
    }
  });
  const handleFocusNewer = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    if (searchType !== 'chat') return;
    markBlurred();
    blurInput();
    if (foundIds) {
      const newFocusIndex = focusedIndex - 1;
      const [chatId, messageId] = (0,_util_keys_searchResultKey__WEBPACK_IMPORTED_MODULE_10__.parseSearchResultKey)(foundIds[newFocusIndex]);
      focusMessage({
        chatId,
        messageId,
        threadId
      });
      setFocusedIndex(newFocusIndex);
    }
  });
  function renderTypeTag(type, isForTag) {
    const isSelected = !isForTag && searchType === type;
    switch (type) {
      case 'chat':
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PeerChip__WEBPACK_IMPORTED_MODULE_26__["default"], {
          className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].searchType, isSelected && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].selectedType),
          peerId: chat?.id,
          title: oldLang('SearchThisChat'),
          clickArg: "chat",
          onClick: isForTag ? handleDeleteTag : handleChangeSearchType
        });
      case 'myChats':
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PeerChip__WEBPACK_IMPORTED_MODULE_26__["default"], {
          className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].searchType, isSelected && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].selectedType),
          peerId: currentUserId,
          forceShowSelf: true,
          title: oldLang('SearchMyMessages'),
          clickArg: "myChats",
          onClick: isForTag ? handleDeleteTag : handleChangeSearchType
        });
      case 'channels':
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PeerChip__WEBPACK_IMPORTED_MODULE_26__["default"], {
          className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].searchType, isSelected && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].selectedType),
          customPeer: CHANNELS_PEER,
          title: oldLang('SearchPublicPosts'),
          clickArg: "channels",
          onClick: isForTag ? handleDeleteTag : handleChangeSearchType
        });
    }
    return undefined;
  }
  function renderDropdown() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].dropdown, !hasResultsDropdown && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].dropdownHidden)
    }, !isMobile && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].separator
    }), hasSavedTags && !isHashtagQuery && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].savedTags, !isMobile && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].wrap, 'no-scrollbar')
    }, savedTagsArray.map(tag => {
      const isChosen = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isSameReaction)(tag.reaction, savedTag);
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_message_reactions_SavedTagButton__WEBPACK_IMPORTED_MODULE_30__["default"], {
        containerId: "local-search",
        key: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getReactionKey)(tag.reaction),
        reaction: tag.reaction,
        tag: tag,
        withCount: true,
        isDisabled: areSavedTagsDisabled,
        isChosen: isChosen,
        onClick: isChosen ? removeSearchSavedTag : activateSearchTag
      });
    })), isHashtagQuery && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].searchTypes, 'no-scrollbar')
    }, renderTypeTag('chat'), renderTypeTag('myChats'), renderTypeTag('channels')), hasResultsContainer && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_28__["default"], {
      ref: containerRef,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].results, 'custom-scroll'),
      items: viewportResults,
      preloadBackwards: 0,
      onLoadMore: getMore,
      onKeyDown: handleKeyDown
    }, areResultsEmpty && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      key: "nothing",
      className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].placeholder
    }, oldLang('NoResultFoundFor', query)), isOnlyHash && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      key: "enterhash",
      className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].placeholder
    }, oldLang('HashtagSearchPlaceholder')), viewportResults?.map(({
      message,
      senderPeer,
      messageChat,
      searchResultKey
    }, i) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MiddleSearchResult__WEBPACK_IMPORTED_MODULE_31__["default"], {
      key: searchResultKey,
      teactOrderKey: -message.date,
      className: RESULT_ITEM_CLASS_NAME,
      query: query,
      message: message,
      senderPeer: senderPeer,
      messageChat: messageChat,
      shouldShowChat: isHashtagQuery,
      isActive: focusedIndex - viewportOffset === i,
      onClick: handleMessageClick
    }))));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    id: "MiddleSearch",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].root, isActive && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].active, !isActive && isFullyHidden && 'visually-hidden',
    // `display: none` would prevent focus on iOS
    isFocused && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].focused, isMobile && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].mobile),
    ref: ref
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].header
  }, !isMobile && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_24__["default"], {
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].avatar,
    peer: chat,
    size: "medium",
    isSavedMessages: isSavedMessages
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_SearchInput__WEBPACK_IMPORTED_MODULE_29__["default"], {
    ref: inputRef,
    value: query,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].input, hasResultsDropdown && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].withDropdown, hasResultsDropdown && !isMobile && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].adaptSearchBorders),
    canClose: !isMobile,
    isLoading: isLoading,
    resultsItemSelector: `.${_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].results} .${RESULT_ITEM_CLASS_NAME}`,
    hasUpButton: hasNavigationButtons && !isMobile,
    hasDownButton: hasNavigationButtons && !isMobile,
    placeholder: isHashtagQuery ? oldLang('SearchHashtagsHint') : oldLang('Search'),
    teactExperimentControlled: true,
    onChange: handleQueryChange,
    onStartBackspace: handleDeleteTag,
    onReset: handleReset,
    withBackIcon: isMobile,
    onFocus: markFocused,
    focused: isFocused,
    onUpClick: canFocusOlder ? handleFocusOlder : undefined,
    onDownClick: canFocusNewer ? handleFocusNewer : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].searchTags
  }, savedTag && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_message_reactions_SavedTagButton__WEBPACK_IMPORTED_MODULE_30__["default"], {
    containerId: "local-search-tags",
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].savedSearchTag,
    reaction: savedTag,
    tag: savedTags[(0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getReactionKey)(savedTag)],
    onClick: removeSearchSavedTag
  }), isHashtagQuery && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].hash
  }, "#")), !isMobile && renderDropdown()), !isMobile && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].icons
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_27__["default"], {
    round: true,
    size: "smaller",
    color: "translucent"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => openHistoryCalendar({
      selectedAt: (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_8__.getDayStartAt)(Date.now())
    }),
    ariaLabel: oldLang('JumpToDate')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_25__["default"], {
    name: "calendar"
  })))), isMobile && renderDropdown(), isMobile && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].footer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_27__["default"], {
    round: true,
    size: "smaller",
    color: "translucent"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => openHistoryCalendar({
      selectedAt: (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_8__.getDayStartAt)(Date.now())
    }),
    ariaLabel: oldLang('JumpToDate')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_25__["default"], {
    name: "calendar"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].counter
  }, hasQueryData && (foundIds?.length ? oldLang('Of', [Math.max(focusedIndex + 1, 1), totalCount]) : foundIds && !foundIds.length && oldLang('NoResult'))), searchType === 'chat' && Boolean(foundIds?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_27__["default"], {
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].viewStyle,
    size: "smaller",
    isText: true,
    fluid: true,
    noForcedUpperCase: true,
    onClick: handleTriggerViewStyle
  }, isViewAsList ? oldLang('SearchAsChat') : oldLang('SearchAsList')), hasNavigationButtons && !hasResultsDropdown && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].mobileNavigation
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_27__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].navigationButton, !canFocusOlder && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].navigationDisabled),
    round: true,
    size: "smaller",
    color: "secondary",
    onClick: handleFocusOlder,
    nonInteractive: !canFocusOlder,
    ariaLabel: lang('AriaSearchOlderResult')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_25__["default"], {
    name: "up"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_27__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].navigationButton, !canFocusNewer && _MiddleSearch_module_scss__WEBPACK_IMPORTED_MODULE_32__["default"].navigationDisabled),
    round: true,
    size: "smaller",
    color: "secondary",
    onClick: handleFocusNewer,
    nonInteractive: !canFocusNewer,
    ariaLabel: lang('AriaSearchNewerResult')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_25__["default"], {
    name: "down"
  })))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const currentMessageList = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectCurrentMessageList)(global);
  if (!currentMessageList) {
    return {};
  }
  const {
    chatId,
    threadId
  } = currentMessageList;
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, chatId);
  if (!chat) {
    return {};
  }
  const {
    requestedQuery,
    savedTag,
    results,
    fetchingQuery,
    isHashtag,
    type
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectCurrentMiddleSearch)(global) || {};
  const {
    totalCount,
    foundIds,
    query: lastSearchQuery
  } = results || {};
  const currentUserId = global.currentUserId;
  const isSavedMessages = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsChatWithSelf)(global, chatId);
  const isSavedDialog = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getIsSavedDialog)(chatId, threadId, currentUserId);
  const savedTags = isSavedMessages && !isSavedDialog ? global.savedReactionTags?.byKey : undefined;
  return {
    chat,
    requestedQuery,
    totalCount,
    threadId,
    foundIds,
    isHistoryCalendarOpen: Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global).historyCalendarSelectedAt),
    savedTags,
    savedTag,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsCurrentUserPremium)(global),
    isSavedMessages,
    fetchingQuery,
    isHashtagQuery: isHashtag,
    currentUserId,
    searchType: type,
    lastSearchQuery
  };
})(MiddleSearch)));

/***/ }),

/***/ "./src/components/middle/search/MiddleSearchResult.tsx":
/*!*************************************************************!*\
  !*** ./src/components/middle/search/MiddleSearchResult.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_FullNameTitle__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/FullNameTitle */ "./src/components/common/FullNameTitle.tsx");
/* harmony import */ var _common_LastMessageMeta__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/LastMessageMeta */ "./src/components/common/LastMessageMeta.tsx");
/* harmony import */ var _common_MessageSummary__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/MessageSummary */ "./src/components/common/MessageSummary.tsx");
/* harmony import */ var _MiddleSearchResult_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./MiddleSearchResult.module.scss */ "./src/components/middle/search/MiddleSearchResult.module.scss");











const TRUNCATE_LENGTH = 200;
const MiddleSearchResult = ({
  isActive,
  message,
  senderPeer,
  messageChat,
  shouldShowChat,
  query,
  className,
  onClick
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const hiddenForwardTitle = message.forwardInfo?.hiddenUserName;
  const peer = shouldShowChat ? messageChat : senderPeer;
  const senderName = shouldShowChat ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getMessageSenderName)(lang, message.chatId, senderPeer) : undefined;
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    onClick(message);
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    role: "button",
    tabIndex: 0,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_MiddleSearchResult_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].root, isActive && _MiddleSearchResult_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].active, className),
    onClick: handleClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: _MiddleSearchResult_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].avatar,
    peer: peer,
    text: hiddenForwardTitle,
    size: "medium"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearchResult_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].info
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearchResult_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].topRow
  }, peer && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_FullNameTitle__WEBPACK_IMPORTED_MODULE_7__["default"], {
    peer: peer,
    withEmojiStatus: true
  }) || hiddenForwardTitle, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_LastMessageMeta__WEBPACK_IMPORTED_MODULE_8__["default"], {
    className: _MiddleSearchResult_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].meta,
    message: message
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MiddleSearchResult_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].subtitle,
    dir: "auto"
  }, senderName && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "sender-name"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(senderName)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "colon"
  }, ":")), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_MessageSummary__WEBPACK_IMPORTED_MODULE_9__["default"], {
    message: message,
    highlight: query,
    truncateLength: TRUNCATE_LENGTH
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(MiddleSearchResult));

/***/ }),

/***/ "./src/components/modals/aboutAds/AboutAdsModal.tsx":
/*!**********************************************************!*\
  !*** ./src/components/modals/aboutAds/AboutAdsModal.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useContextMenuHandlers */ "./src/hooks/useContextMenuHandlers.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_SafeLink__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/SafeLink */ "./src/components/common/SafeLink.tsx");
/* harmony import */ var _middle_message_SponsoredMessageContextMenuContainer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../middle/message/SponsoredMessageContextMenuContainer */ "./src/components/middle/message/SponsoredMessageContextMenuContainer.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _common_TableAboutModal__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../common/TableAboutModal */ "./src/components/modals/common/TableAboutModal.tsx");
/* harmony import */ var _AboutAdsModal_module_scss__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./AboutAdsModal.module.scss */ "./src/components/modals/aboutAds/AboutAdsModal.module.scss");
















const AboutAdsModal = ({
  message,
  minLevelToRestrictAds
}) => {
  const {
    closeAboutAdsModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const moreMenuRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const isOpen = Boolean(message);
  const isMonetizationSharing = message?.canReport;
  const renderingIsNewDesign = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_6__["default"])(isMonetizationSharing);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const regularAdContent = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, oldLang('SponsoredMessageInfoScreen.Title')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(oldLang('SponsoredMessageInfoDescription1'), ['br'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(oldLang('SponsoredMessageInfoDescription2'), ['br'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(oldLang('SponsoredMessageInfoDescription3'), ['br'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_SafeLink__WEBPACK_IMPORTED_MODULE_10__["default"], {
      url: oldLang('SponsoredMessageAlertLearnMoreUrl'),
      text: oldLang('SponsoredMessageAlertLearnMoreUrl')
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(oldLang('SponsoredMessageInfoDescription4'), ['br'])));
  }, [oldLang]);
  const {
    isContextMenuOpen,
    contextMenuAnchor,
    handleContextMenu,
    handleContextMenuClose,
    handleContextMenuHide
  } = (0,_hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_5__["default"])(moreMenuRef, !renderingIsNewDesign);
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    closeAboutAdsModal();
    handleContextMenuClose();
    handleContextMenuHide();
  });
  const modalData = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!isOpen) return undefined;
    const header = /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: _AboutAdsModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].title
    }, oldLang('AboutRevenueSharingAds')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_AboutAdsModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].description, _AboutAdsModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].secondary)
    }, oldLang('RevenueSharingAdsAlertSubtitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
      ref: moreMenuRef,
      round: true,
      size: "smaller",
      color: "translucent",
      className: _AboutAdsModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].moreButton,
      onClick: handleContextMenu
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
      name: "more"
    })));
    const listItemData = [['lock', oldLang('RevenueSharingAdsInfo1Title'), (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(oldLang('RevenueSharingAdsInfo1Subtitle'), ['simple_markdown'])], ['revenue-split', oldLang('RevenueSharingAdsInfo2Title'), (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(oldLang('RevenueSharingAdsInfo2Subtitle'), ['simple_markdown'])], ['nochannel', oldLang('RevenueSharingAdsInfo3Title'), (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(oldLang('RevenueSharingAdsInfo3Subtitle', minLevelToRestrictAds), ['simple_markdown'])]];
    const footer = /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: _AboutAdsModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].title
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(oldLang('RevenueSharingAdsInfo4Title'), ['simple_markdown'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: _AboutAdsModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].description
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(oldLang('RevenueSharingAdsInfo4Subtitle2', ''), ['simple_markdown']), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_SafeLink__WEBPACK_IMPORTED_MODULE_10__["default"], {
      url: oldLang('PromoteUrl'),
      text: oldLang('LearnMoreArrow')
    })));
    return {
      header,
      listItemData,
      footer
    };
  }, [isOpen, oldLang, handleContextMenu, minLevelToRestrictAds]);
  if (renderingIsNewDesign) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_TableAboutModal__WEBPACK_IMPORTED_MODULE_14__["default"], {
      isOpen: isOpen,
      listItemData: modalData?.listItemData,
      headerIconName: "channel",
      withSeparator: true,
      header: modalData?.header,
      footer: modalData?.footer,
      buttonText: oldLang('RevenueSharingAdsUnderstood'),
      onClose: handleClose
    }), contextMenuAnchor && message && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_middle_message_SponsoredMessageContextMenuContainer__WEBPACK_IMPORTED_MODULE_11__["default"], {
      isOpen: isContextMenuOpen,
      anchor: contextMenuAnchor,
      triggerRef: moreMenuRef,
      message: message,
      shouldSkipAbout: true,
      onItemClick: handleClose,
      onClose: handleContextMenuClose,
      onCloseAnimationEnd: handleContextMenuHide
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isOpen,
    className: _AboutAdsModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].root,
    contentClassName: _AboutAdsModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].content,
    onClose: handleClose
  }, regularAdContent, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    size: "smaller",
    onClick: handleClose
  }, oldLang('RevenueSharingAdsUnderstood')));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  modal
}) => {
  const message = modal?.chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectSponsoredMessage)(global, modal.chatId) : undefined;
  const minLevelToRestrictAds = global.appConfig?.channelRestrictAdsLevelMin;
  return {
    message,
    minLevelToRestrictAds
  };
})(AboutAdsModal)));

/***/ }),

/***/ "./src/components/modals/attachBotInstall/AttachBotInstallModal.tsx":
/*!**************************************************************************!*\
  !*** ./src/components/modals/attachBotInstall/AttachBotInstallModal.tsx ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");







const AttachBotInstallModal = ({
  modal
}) => {
  const {
    confirmAttachBotInstall,
    cancelAttachBotInstall
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const bot = modal?.bot;
  const [isTosAccepted, setIsTosAccepted] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const handleConfirm = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    confirmAttachBotInstall({
      isWriteAllowed: Boolean(bot?.shouldRequestWriteAccess)
    });
  }, [confirmAttachBotInstall, bot]);

  // Reset on re-open
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (bot) {
      setIsTosAccepted(false);
    }
  }, [bot]);
  const tosLabel = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const base = lang('lng_mini_apps_disclaimer_button');
    const split = base.split('{link}');
    const linkText = lang('lng_mini_apps_disclaimer_link');
    return [split[0], /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("a", {
      href: _config__WEBPACK_IMPORTED_MODULE_2__.MINI_APP_TOS_URL,
      target: "_blank",
      rel: "noopener noreferrer"
    }, linkText), split[1]];
  }, [lang]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isOpen: Boolean(bot),
    onClose: cancelAttachBotInstall,
    title: lang('lng_mini_apps_disclaimer_title'),
    confirmHandler: handleConfirm,
    isConfirmDisabled: !isTosAccepted
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(lang('lng_mini_apps_disclaimer_text', bot?.shortName), ['simple_markdown']), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_5__["default"], {
    className: "dialog-checkbox",
    checked: isTosAccepted,
    label: tosLabel,
    onCheck: setIsTosAccepted
  }), (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(lang('WebBot.Account.Desclaimer.Desc', bot?.shortName), ['simple_markdown']));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(AttachBotInstallModal));

/***/ }),

/***/ "./src/components/modals/boost/BoostModal.tsx":
/*!****************************************************!*\
  !*** ./src/components/modals/boost/BoostModal.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _common_helpers_boostInfo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/helpers/boostInfo */ "./src/components/common/helpers/boostInfo.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PremiumProgress__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/PremiumProgress */ "./src/components/common/PremiumProgress.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./BoostModal.module.scss */ "./src/components/modals/boost/BoostModal.module.scss");





















const BoostModal = ({
  modal,
  chat,
  chatFullInfo,
  prevBoostedChat,
  isCurrentUserPremium
}) => {
  const {
    applyBoost,
    closeBoostModal,
    requestConfetti,
    openPremiumModal,
    loadFullChat
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isReplaceModalOpen, openReplaceModal, closeReplaceModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isWaitDialogOpen, openWaitDialog, closeWaitDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isPremiumDialogOpen, openPremiumDialog, closePremiumDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const isChannel = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatChannel)(chat);
  const isOpen = Boolean(modal);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (chat && !chatFullInfo) {
      loadFullChat({
        chatId: chat.id
      });
    }
  }, [chat, chatFullInfo]);
  const chatTitle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!chat) {
      return undefined;
    }
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getChatTitle)(oldLang, chat);
  }, [chat, oldLang]);
  const boostedChatTitle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!prevBoostedChat) {
      return undefined;
    }
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getChatTitle)(oldLang, prevBoostedChat);
  }, [prevBoostedChat, oldLang]);
  const {
    isStatusLoaded,
    isBoosted,
    boost,
    title,
    leftText,
    rightText,
    value,
    progress,
    descriptionText,
    canBoostMore
  } = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!modal?.boostStatus || !chat) {
      return {
        isStatusLoaded: false,
        title: oldLang('Loading')
      };
    }
    const {
      hasMyBoost
    } = modal.boostStatus;
    const firstBoost = modal?.myBoosts && getFirstAvailableBoost(modal.myBoosts, chat.id);
    const areBoostsInDifferentChannels = modal?.myBoosts && !areAllBoostsInChannel(modal.myBoosts, chat.id);
    const {
      boosts,
      currentLevel,
      hasNextLevel,
      levelProgress,
      remainingBoosts,
      isMaxLevel
    } = (0,_common_helpers_boostInfo__WEBPACK_IMPORTED_MODULE_7__.getBoostProgressInfo)(modal.boostStatus, true);
    const hasBoost = hasMyBoost;
    const left = oldLang('BoostsLevel', currentLevel);
    const right = hasNextLevel ? oldLang('BoostsLevel', currentLevel + 1) : undefined;
    const moreBoosts = oldLang('ChannelBoost.MoreBoosts', remainingBoosts);
    const modalTitle = isChannel ? oldLang('BoostChannel') : oldLang('BoostGroup');
    const boostsLeftToUnrestrict = (chatFullInfo?.boostsToUnrestrict || 0) - (chatFullInfo?.boostsApplied || 0);
    let description;
    if (isMaxLevel) {
      description = oldLang('BoostsMaxLevelReached');
    } else if (boostsLeftToUnrestrict > 0 && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatAdmin)(chat)) {
      const boostTimes = oldLang('GroupBoost.BoostToUnrestrict.Times', boostsLeftToUnrestrict);
      description = oldLang('GroupBoost.BoostToUnrestrict', [boostTimes, chatTitle]);
    } else {
      description = oldLang('ChannelBoost.MoreBoostsNeeded.Text', [chatTitle, moreBoosts]);
    }
    return {
      isStatusLoaded: true,
      title: modalTitle,
      leftText: left,
      rightText: right,
      value: boosts.toString(),
      progress: levelProgress,
      remainingBoosts,
      descriptionText: description,
      boost: firstBoost,
      isBoosted: hasBoost,
      canBoostMore: areBoostsInDifferentChannels && !isMaxLevel
    };
  }, [chat, chatTitle, modal, oldLang, chatFullInfo, isChannel]);
  const isBoostDisabled = !modal?.myBoosts?.length && isCurrentUserPremium;
  const isReplacingBoost = boost?.chatId && boost.chatId !== modal?.chatId;
  const handleApplyBoost = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    closeReplaceModal();
    applyBoost({
      chatId: chat.id,
      slots: [boost.slot]
    });
    requestConfetti({});
  });
  const handleProceedPremium = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    openPremiumModal();
    closePremiumDialog();
    closeBoostModal();
  });
  const handleButtonClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    if (!boost) {
      if (!isCurrentUserPremium) {
        openPremiumDialog();
        return;
      }
      closeBoostModal();
      return;
    }
    if (!canBoostMore) {
      closeBoostModal();
      return;
    }
    if (boost.cooldownUntil) {
      openWaitDialog();
      return;
    }
    if (isReplacingBoost) {
      openReplaceModal();
      return;
    }
    handleApplyBoost();
  });
  const handleCloseClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    closeBoostModal();
  });
  function renderContent() {
    if (!isStatusLoaded) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_18__["default"], {
        className: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].loading
      });
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PremiumProgress__WEBPACK_IMPORTED_MODULE_15__["default"], {
      leftText: leftText,
      rightText: rightText,
      progress: progress,
      floatingBadgeText: value,
      floatingBadgeIcon: "boost"
    }), isBoosted && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].description, _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].bold)
    }, oldLang('ChannelBoost.YouBoostedChannelText', chatTitle)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].description
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(descriptionText, ['simple_markdown', 'emoji'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "dialog-buttons"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
      isText: true,
      className: "confirm-dialog-button",
      disabled: isBoostDisabled,
      onClick: handleButtonClick
    }, canBoostMore ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
      name: "boost"
    }), oldLang(isChannel ? 'ChannelBoost.BoostChannel' : 'GroupBoost.BoostGroup')) : oldLang('OK')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
      isText: true,
      className: "confirm-dialog-button",
      onClick: handleCloseClick
    }, oldLang('Cancel'))));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_19__["default"], {
    isOpen: isOpen,
    title: title,
    className: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].modal,
    contentClassName: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].content,
    onClose: closeBoostModal
  }, renderContent(), isReplacingBoost && boostedChatTitle && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_19__["default"], {
    isOpen: isReplaceModalOpen,
    className: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].replaceModal,
    contentClassName: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].replaceModalContent,
    onClose: closeReplaceModal
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].avatarContainer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].boostedWrapper
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_13__["default"], {
    peer: prevBoostedChat,
    size: "large"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "boostcircle",
    className: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].boostedMark
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "next",
    className: _BoostModal_module_scss__WEBPACK_IMPORTED_MODULE_20__["default"].arrow
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_13__["default"], {
    peer: chat,
    size: "large"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(oldLang('ChannelBoost.ReplaceBoost', [boostedChatTitle, chatTitle]), ['simple_markdown', 'emoji'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
    isText: true,
    className: "confirm-dialog-button",
    onClick: handleApplyBoost
  }, oldLang('Replace')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
    isText: true,
    className: "confirm-dialog-button",
    onClick: closeReplaceModal
  }, oldLang('Cancel')))), Boolean(boost?.cooldownUntil) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_17__["default"], {
    isOpen: isWaitDialogOpen,
    isOnlyConfirm: true,
    confirmLabel: oldLang('OK'),
    title: oldLang('ChannelBoost.Error.BoostTooOftenTitle'),
    onClose: closeWaitDialog,
    confirmHandler: closeWaitDialog
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(oldLang('ChannelBoost.Error.BoostTooOftenText', (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatShortDuration)(lang, boost.cooldownUntil - (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_6__.getServerTime)())), ['simple_markdown', 'emoji'])), !isCurrentUserPremium && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_17__["default"], {
    isOpen: isPremiumDialogOpen,
    confirmLabel: oldLang('Common.Yes'),
    title: oldLang('PremiumNeeded'),
    onClose: closePremiumDialog,
    confirmHandler: handleProceedPremium
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(oldLang('PremiumNeededForBoosting'), ['simple_markdown', 'emoji'])));
};
function getFirstAvailableBoost(myBoosts, chatId) {
  return myBoosts.find(boost => !boost.chatId) || myBoosts.filter(b => chatId && b.chatId !== chatId).sort((a, b) => a.date - b.date)[0];
}
function areAllBoostsInChannel(myBoosts, chatId) {
  return myBoosts.every(boost => boost.chatId === chatId);
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  modal
}) => {
  const chat = modal && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, modal?.chatId);
  const chatFullInfo = chat && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chat.id);
  const firstBoost = modal?.myBoosts && getFirstAvailableBoost(modal.myBoosts, modal.chatId);
  const boostedChat = firstBoost?.chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, firstBoost?.chatId) : undefined;
  return {
    chat,
    chatFullInfo,
    prevBoostedChat: boostedChat,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global)
  };
})(BoostModal)));

/***/ }),

/***/ "./src/components/modals/chatInvite/ChatInviteModal.tsx":
/*!**************************************************************!*\
  !*** ./src/components/modals/chatInvite/ChatInviteModal.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHorizontalScroll */ "./src/hooks/useHorizontalScroll.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePrevious__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/usePrevious */ "./src/hooks/usePrevious.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_FullNameTitle__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/FullNameTitle */ "./src/components/common/FullNameTitle.tsx");
/* harmony import */ var _common_PeerBadge__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/PeerBadge */ "./src/components/common/PeerBadge.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ChatInviteModal_module_scss__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./ChatInviteModal.module.scss */ "./src/components/modals/chatInvite/ChatInviteModal.module.scss");















const ChatInviteModal = ({
  modal
}) => {
  const {
    acceptChatInvite,
    closeChatInviteModal,
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  // eslint-disable-next-line no-null/no-null
  const participantsRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const prevModal = (0,_hooks_usePrevious__WEBPACK_IMPORTED_MODULE_8__["default"])(modal);
  const {
    hash,
    inviteInfo
  } = modal || prevModal || {};
  const {
    about,
    isBroadcast,
    participantIds,
    participantsCount,
    photo,
    isRequestNeeded
  } = inviteInfo || {};
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    closeChatInviteModal();
  });
  const handleAccept = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    acceptChatInvite({
      hash: hash
    });
    showNotification({
      message: isBroadcast ? lang('RequestToJoinChannelSentDescription') : lang('RequestToJoinGroupSentDescription')
    });
    handleClose();
  });
  const acceptLangKey = isBroadcast ? 'ProfileJoinChannel' : 'JoinGroup';
  const requestToJoinLangKey = isBroadcast ? 'MemberRequests.RequestToJoinChannel' : 'MemberRequests.RequestToJoinGroup';
  const customPeer = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!inviteInfo) return undefined;
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getCustomPeerFromInvite)(inviteInfo);
  }, [inviteInfo]);
  const participants = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!participantIds) {
      return undefined;
    }
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    return participantIds.map(id => (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, id)).filter(Boolean);
  }, [participantIds]);
  (0,_hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_5__["default"])(participantsRef, !modal || !participants);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: Boolean(modal),
    contentClassName: _ChatInviteModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].content,
    isSlim: true,
    onClose: handleClose,
    onEnter: handleAccept
  }, customPeer && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_9__["default"], {
    size: "jumbo",
    photo: photo,
    peer: customPeer,
    withVideo: true
  }), customPeer && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_FullNameTitle__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: _ChatInviteModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].title,
    peer: customPeer
  }), about && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _ChatInviteModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].about
  }, about), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _ChatInviteModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].participantCount
  }, lang(isBroadcast ? 'Subscribers' : 'Members', participantsCount, 'i')), participants && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: participantsRef,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ChatInviteModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].participants, 'no-scrollbar')
  }, participants.map(participant => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PeerBadge__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: _ChatInviteModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].participant,
    peer: participant,
    text: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(participant)
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('dialog-buttons', _ChatInviteModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].buttons)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isText: true,
    className: "confirm-dialog-button",
    onClick: handleAccept
  }, lang(isRequestNeeded ? requestToJoinLangKey : acceptLangKey)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isText: true,
    className: "confirm-dialog-button",
    onClick: handleClose
  }, lang('Cancel'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ChatInviteModal));

/***/ }),

/***/ "./src/components/modals/chatlist/ChatlistAlready.tsx":
/*!************************************************************!*\
  !*** ./src/components/modals/chatlist/ChatlistAlready.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/renderTextWithEntities */ "./src/components/common/helpers/renderTextWithEntities.tsx");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _ui_Badge__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/Badge */ "./src/components/ui/Badge.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./ChatlistModal.module.scss */ "./src/components/modals/chatlist/ChatlistModal.module.scss");











const ChatlistAlready = ({
  invite,
  folder
}) => {
  const {
    closeChatlistModal,
    joinChatlistInvite
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [selectedPeerIds, setSelectedPeerIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(invite.missingPeerIds);
  const hasChatsToAdd = Boolean(invite.missingPeerIds.length);
  const isNew = invite.alreadyPeerIds.length === 0;
  const newChatsCount = hasChatsToAdd ? invite.missingPeerIds.length : 0;
  const badgeText = selectedPeerIds.length ? selectedPeerIds.length.toString() : undefined;
  const descriptionText = isNew ? lang('FolderLinkSubtitleNew') : newChatsCount ? lang('FolderLinkSubtitleAdd', {
    chats: lang('FolderLinkSubtitleAddCount', {
      count: newChatsCount
    }, {
      pluralValue: newChatsCount
    }),
    title: (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_4__.renderTextWithEntities)({
      text: folder.title.text,
      entities: folder.title.entities,
      noCustomEmojiPlayback: folder.noTitleAnimations
    })
  }, {
    withNodes: true,
    withMarkdown: true
  }) : lang('FolderLinkSubtitleAlready');
  const handleButtonClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeChatlistModal();
    if (!selectedPeerIds.length) return;
    joinChatlistInvite({
      invite,
      peerIds: selectedPeerIds
    });
  }, [invite, selectedPeerIds]);
  const handleSelectionToggle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const areAllSelected = selectedPeerIds.length === invite.missingPeerIds.length;
    setSelectedPeerIds(areAllSelected ? [] : invite.missingPeerIds);
  }, [invite.missingPeerIds, selectedPeerIds.length]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].content
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].description
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_3__["default"])(descriptionText, ['simple_markdown', 'emoji'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].pickerWrapper, 'custom-scroll')
  }, Boolean(invite.missingPeerIds.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].pickerHeader
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].pickerHeaderInfo
  }, oldLang('FolderLinkHeaderChatsJoin', selectedPeerIds.length, 'i')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].selectionToggle,
    role: "button",
    tabIndex: 0,
    onClick: handleSelectionToggle
  }, selectedPeerIds.length === invite.missingPeerIds.length ? oldLang('DeselectAll') : oldLang('SelectAll'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_7__["default"], {
    itemIds: invite.missingPeerIds,
    onSelectedIdsChange: setSelectedPeerIds,
    selectedIds: selectedPeerIds,
    allowMultiple: true,
    withStatus: true,
    itemInputType: "checkbox"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].pickerHeader
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].pickerHeaderInfo
  }, oldLang('FolderLinkHeaderAlready'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_7__["default"], {
    itemIds: invite.alreadyPeerIds,
    lockedSelectedIds: invite.alreadyPeerIds,
    selectedIds: invite.alreadyPeerIds,
    allowMultiple: true,
    withStatus: true,
    itemInputType: "checkbox"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
    size: "smaller",
    onClick: handleButtonClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].buttonText
  }, !selectedPeerIds.length && oldLang('OK'), Boolean(selectedPeerIds.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, oldLang('FolderLinkButtonJoinPlural', selectedPeerIds.length, 'i'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Badge__WEBPACK_IMPORTED_MODULE_8__["default"], {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].buttonBadge,
    text: badgeText,
    isAlternateColor: true
  })))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ChatlistAlready));

/***/ }),

/***/ "./src/components/modals/chatlist/ChatlistDelete.tsx":
/*!***********************************************************!*\
  !*** ./src/components/modals/chatlist/ChatlistDelete.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _ui_Badge__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/Badge */ "./src/components/ui/Badge.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ChatlistModal.module.scss */ "./src/components/modals/chatlist/ChatlistModal.module.scss");










const ChatlistDelete = ({
  folder,
  suggestedPeerIds = _util_memo__WEBPACK_IMPORTED_MODULE_3__.MEMO_EMPTY_ARRAY
}) => {
  const {
    closeChatlistModal,
    leaveChatlist
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const [selectedPeerIds, setSelectedPeerIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const badgeText = selectedPeerIds.length ? selectedPeerIds.length.toString() : undefined;
  const handleSelectionToggle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const areAllSelected = selectedPeerIds.length === suggestedPeerIds.length;
    setSelectedPeerIds(areAllSelected ? [] : suggestedPeerIds);
  }, [suggestedPeerIds, selectedPeerIds.length]);
  const handleButtonClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeChatlistModal();
    leaveChatlist({
      folderId: folder.id,
      peerIds: selectedPeerIds
    });
  }, [folder.id, selectedPeerIds]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].content
  }, Boolean(suggestedPeerIds?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].description
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])(lang('FolderLinkSubtitleRemove'), ['simple_markdown', 'emoji'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].pickerWrapper, 'custom-scroll')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].pickerHeader
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].pickerHeaderInfo
  }, lang('FolderLinkHeaderChatsQuit', selectedPeerIds.length, 'i')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].selectionToggle,
    role: "button",
    tabIndex: 0,
    onClick: handleSelectionToggle
  }, selectedPeerIds.length === suggestedPeerIds.length ? lang('DeselectAll') : lang('SelectAll'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_6__["default"], {
    itemIds: suggestedPeerIds,
    onSelectedIdsChange: setSelectedPeerIds,
    selectedIds: selectedPeerIds,
    allowMultiple: true,
    withStatus: true,
    itemInputType: "checkbox"
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
    size: "smaller",
    onClick: handleButtonClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].buttonText
  }, !selectedPeerIds.length && lang('FolderLinkButtonRemove'), Boolean(selectedPeerIds.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, lang('FolderLinkButtonRemoveChats'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Badge__WEBPACK_IMPORTED_MODULE_7__["default"], {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].buttonBadge,
    text: badgeText,
    isAlternateColor: true
  })))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ChatlistDelete));

/***/ }),

/***/ "./src/components/modals/chatlist/ChatlistModal.tsx":
/*!**********************************************************!*\
  !*** ./src/components/modals/chatlist/ChatlistModal.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/helpers/renderTextWithEntities */ "./src/components/common/helpers/renderTextWithEntities.tsx");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Tab__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/Tab */ "./src/components/ui/Tab.tsx");
/* harmony import */ var _ChatlistAlready__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ChatlistAlready */ "./src/components/modals/chatlist/ChatlistAlready.tsx");
/* harmony import */ var _ChatlistDelete__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ChatlistDelete */ "./src/components/modals/chatlist/ChatlistDelete.tsx");
/* harmony import */ var _ChatlistNew__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./ChatlistNew */ "./src/components/modals/chatlist/ChatlistNew.tsx");
/* harmony import */ var _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./ChatlistModal.module.scss */ "./src/components/modals/chatlist/ChatlistModal.module.scss");












const ChatlistInviteModal = ({
  modal,
  folder
}) => {
  const {
    closeChatlistModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const isOpen = Boolean(modal);
  const renderingInfo = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_5__["default"])(modal) || modal;
  const renderingFolder = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_5__["default"])(folder) || folder;
  const title = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!renderingInfo) return undefined;
    if (renderingInfo.invite) {
      const invite = renderingInfo.invite;
      if ('alreadyPeerIds' in invite) {
        return invite.missingPeerIds.length ? lang('FolderLinkTitleAddChats') : lang('FolderLinkTitleAlready');
      }
      return lang('FolderLinkTitleAdd');
    }
    if (renderingInfo.removal) {
      return lang('FolderLinkTitleRemove');
    }
    return undefined;
  }, [lang, renderingInfo]);
  const renderingFolderTitle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (renderingFolder) {
      return (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_3__.renderTextWithEntities)({
        text: renderingFolder.title.text,
        entities: renderingFolder.title.entities,
        noCustomEmojiPlayback: renderingFolder.noTitleAnimations
      });
    }
    if (renderingInfo?.invite && 'title' in renderingInfo.invite) {
      return (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_3__.renderTextWithEntities)({
        text: renderingInfo.invite.title.text,
        entities: renderingInfo.invite.title.entities,
        noCustomEmojiPlayback: renderingInfo.invite.noTitleAnimations
      });
    }
    return undefined;
  }, [renderingFolder, renderingInfo]);
  const folderTabNumber = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!renderingInfo?.invite) return undefined;
    if ('missingPeerIds' in renderingInfo.invite) return renderingInfo.invite.missingPeerIds.length;
    return undefined;
  }, [renderingInfo]);
  function renderFolders(folderTitle) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].foldersWrapper
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].folders
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Tab__WEBPACK_IMPORTED_MODULE_7__["default"], {
      className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].folder,
      title: lang('FolderLinkPreviewLeft')
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Tab__WEBPACK_IMPORTED_MODULE_7__["default"], {
      className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].folder,
      isActive: true,
      badgeCount: folderTabNumber,
      isBadgeActive: true,
      title: folderTitle
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Tab__WEBPACK_IMPORTED_MODULE_7__["default"], {
      className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].folder,
      title: lang('FolderLinkPreviewRight')
    })));
  }
  const renderContent = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!renderingInfo) return undefined;
    if (renderingInfo.invite) {
      const invite = renderingInfo.invite;
      if ('alreadyPeerIds' in invite) {
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatlistAlready__WEBPACK_IMPORTED_MODULE_8__["default"], {
          invite: invite,
          folder: renderingFolder
        });
      }
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatlistNew__WEBPACK_IMPORTED_MODULE_10__["default"], {
        invite: invite
      });
    }
    if (renderingInfo.removal) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ChatlistDelete__WEBPACK_IMPORTED_MODULE_9__["default"], {
        folder: renderingFolder,
        suggestedPeerIds: renderingInfo.removal.suggestedPeerIds
      });
    }
    return undefined;
  }, [renderingFolder, renderingInfo]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isOpen: isOpen,
    title: title,
    onClose: closeChatlistModal,
    isSlim: true,
    hasCloseButton: true
  }, renderingFolderTitle && renderFolders(renderingFolderTitle), renderContent());
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  modal
}) => {
  const {
    invite,
    removal
  } = modal || {};
  const folderId = removal?.folderId || (invite && 'folderId' in invite ? invite.folderId : undefined);
  const folder = folderId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectChatFolder)(global, folderId) : undefined;
  return {
    folder
  };
})(ChatlistInviteModal)));

/***/ }),

/***/ "./src/components/modals/chatlist/ChatlistNew.tsx":
/*!********************************************************!*\
  !*** ./src/components/modals/chatlist/ChatlistNew.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _ui_Badge__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/Badge */ "./src/components/ui/Badge.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ChatlistModal.module.scss */ "./src/components/modals/chatlist/ChatlistModal.module.scss");









const ChatlistNew = ({
  invite
}) => {
  const {
    closeChatlistModal,
    joinChatlistInvite
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const [selectedPeerIds, setSelectedPeerIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(invite.peerIds);
  const joinedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const chatsById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId;
    return invite.peerIds.filter(id => !chatsById[id].isNotJoined);
  }, [invite.peerIds]);
  const selectedCount = selectedPeerIds.length - joinedIds.length;
  const badgeText = selectedCount ? selectedCount.toString() : undefined;
  const handleButtonClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeChatlistModal();
    joinChatlistInvite({
      invite,
      peerIds: selectedPeerIds
    });
  }, [invite, selectedPeerIds]);
  const handleSelectionToggle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const areAllSelected = selectedPeerIds.length === invite.peerIds.length;
    setSelectedPeerIds(areAllSelected ? joinedIds : invite.peerIds);
  }, [invite.peerIds, joinedIds, selectedPeerIds.length]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].content
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].description
  }, lang('FolderLinkSubtitleNew')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_2__["default"])(_ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].pickerWrapper, 'custom-scroll')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].pickerHeader
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].pickerHeaderInfo
  }, oldLang('FolderLinkHeaderChatsJoin', selectedCount, 'i')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].selectionToggle,
    role: "button",
    tabIndex: 0,
    onClick: handleSelectionToggle
  }, selectedPeerIds.length === invite.peerIds.length ? oldLang('DeselectAll') : oldLang('SelectAll'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_5__["default"], {
    itemIds: invite.peerIds,
    lockedSelectedIds: joinedIds,
    onSelectedIdsChange: setSelectedPeerIds,
    selectedIds: selectedPeerIds,
    allowMultiple: true,
    withStatus: true,
    itemInputType: "checkbox"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
    onClick: handleButtonClick,
    size: "smaller",
    disabled: !selectedPeerIds.length
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].buttonText
  }, lang('FolderLinkAddFolder'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Badge__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: _ChatlistModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].buttonBadge,
    text: badgeText,
    isAlternateColor: true
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ChatlistNew));

/***/ }),

/***/ "./src/components/modals/collectible/CollectibleInfoModal.tsx":
/*!********************************************************************!*\
  !*** ./src/components/modals/collectible/CollectibleInfoModal.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_clipboard__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/clipboard */ "./src/util/clipboard.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_formatCurrency__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/formatCurrency */ "./src/util/formatCurrency.tsx");
/* harmony import */ var _util_phoneNumber__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/phoneNumber */ "./src/util/phoneNumber.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _common_helpers_formatUsername__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/helpers/formatUsername */ "./src/components/common/helpers/formatUsername.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/AnimatedIconWithPreview */ "./src/components/common/AnimatedIconWithPreview.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PeerChip__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/PeerChip */ "./src/components/common/PeerChip.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _CollectibleInfoModal_module_scss__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./CollectibleInfoModal.module.scss */ "./src/components/modals/collectible/CollectibleInfoModal.module.scss");

















const TOP_ICON_SIZE = 60;
const CollectibleInfoModal = ({
  modal,
  phoneCodeList
}) => {
  const {
    closeCollectibleInfoModal,
    openChat,
    openUrl,
    showNotification
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const isUsername = modal?.type === 'username';
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    closeCollectibleInfoModal();
  });
  const handleOpenChat = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    openChat({
      id: modal.peerId
    });
    handleClose();
  });
  const handleOpenUrl = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    openUrl({
      url: modal.url,
      shouldSkipModal: true
    });
    handleClose();
  });
  const handleCopy = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    const text = isUsername ? (0,_common_helpers_formatUsername__WEBPACK_IMPORTED_MODULE_7__["default"])(modal.collectible) : (0,_util_phoneNumber__WEBPACK_IMPORTED_MODULE_5__.formatPhoneNumberWithCode)(phoneCodeList, modal.collectible);
    (0,_util_clipboard__WEBPACK_IMPORTED_MODULE_2__.copyTextToClipboard)(text);
    showNotification({
      message: lang(isUsername ? 'UsernameCopied' : 'PhoneCopied')
    });
    handleClose();
  });
  const title = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!modal) return undefined;
    const key = isUsername ? 'FragmentUsernameTitle' : 'FragmentPhoneTitle';
    const formattedCollectible = isUsername ? (0,_common_helpers_formatUsername__WEBPACK_IMPORTED_MODULE_7__["default"])(modal.collectible) : (0,_util_phoneNumber__WEBPACK_IMPORTED_MODULE_5__.formatPhoneNumberWithCode)(phoneCodeList, modal.collectible);
    return lang(key, formattedCollectible);
  }, [modal, isUsername, phoneCodeList, lang]);
  const description = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!modal) return undefined;
    const key = isUsername ? 'FragmentUsernameMessage' : 'FragmentPhoneMessage';
    const date = (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_3__.formatDateAtTime)(lang, modal.purchaseDate * 1000);
    const currency = (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_4__.formatCurrencyAsString)(modal.amount, modal.currency, lang.code);
    const cryptoCurrency = (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_4__.formatCurrencyAsString)(modal.cryptoAmount, modal.cryptoCurrency, lang.code);
    const paid = `${cryptoCurrency} (${currency})`;
    return lang(key, [date, paid]);
  }, [modal, isUsername, lang]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_15__["default"], {
    isOpen: Boolean(modal),
    isSlim: true,
    contentClassName: _CollectibleInfoModal_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].content,
    onClose: closeCollectibleInfoModal
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    round: true,
    color: "translucent",
    size: "smaller",
    className: _CollectibleInfoModal_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].closeButton,
    ariaLabel: lang('Close'),
    onClick: handleClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _CollectibleInfoModal_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].icon
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_11__["default"], {
    tgsUrl: isUsername ? _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_6__.LOCAL_TGS_URLS.Mention : _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_6__.LOCAL_TGS_URLS.Fragment,
    size: TOP_ICON_SIZE
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: _CollectibleInfoModal_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].title
  }, title && (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(title, ['simple_markdown'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PeerChip__WEBPACK_IMPORTED_MODULE_13__["default"], {
    className: _CollectibleInfoModal_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].chip,
    peerId: modal?.peerId,
    forceShowSelf: true,
    clickArg: modal?.peerId,
    onClick: handleOpenChat
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _CollectibleInfoModal_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].description
  }, description && (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(description, ['simple_markdown'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons dialog-buttons-centered"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: "confirm-dialog-button",
    onClick: handleOpenUrl
  }, lang('FragmentUsernameOpen')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isText: true,
    className: "confirm-dialog-button",
    onClick: handleCopy
  }, lang(isUsername ? 'FragmentUsernameCopy' : 'FragmentPhoneCopy'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    countryList
  } = global;
  return {
    phoneCodeList: countryList.phoneCodes
  };
})(CollectibleInfoModal)));

/***/ }),

/***/ "./src/components/modals/emojiStatusAccess/EmojiStatusAccessModal.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/modals/emojiStatusAccess/EmojiStatusAccessModal.tsx ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_schedulers_useInterval__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/schedulers/useInterval */ "./src/hooks/schedulers/useInterval.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_PeerChip__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/PeerChip */ "./src/components/common/PeerChip.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _EmojiStatusAccessModal_module_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./EmojiStatusAccessModal.module.scss */ "./src/components/modals/emojiStatusAccess/EmojiStatusAccessModal.module.scss");













const INTERVAL = 3000;
const EmojiStatusAccessModal = ({
  modal,
  currentUser,
  stickerSet,
  isPremium
}) => {
  const {
    closeEmojiStatusAccessModal,
    toggleUserEmojiStatusPermission,
    sendWebAppEvent,
    openPremiumModal,
    loadDefaultStatusIcons
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const isOpen = Boolean(modal);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_6__["default"])();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [currentStatusIndex, setCurrentStatusIndex] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && !stickerSet?.stickers) {
      loadDefaultStatusIcons();
    }
  }, [isOpen, stickerSet]);
  const mockPeerWithStatus = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!currentUser || !stickerSet?.stickers) return undefined;
    return {
      ...currentUser,
      emojiStatus: {
        documentId: stickerSet.stickers[currentStatusIndex].id
      }
    };
  }, [currentUser, stickerSet, currentStatusIndex]);
  const totalCount = stickerSet?.stickers?.length;
  (0,_hooks_schedulers_useInterval__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    if (!totalCount) return;
    setCurrentStatusIndex(prevIndex => (prevIndex + 1) % totalCount);
  }, totalCount ? INTERVAL : undefined);
  const renderPickerItem = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PeerChip__WEBPACK_IMPORTED_MODULE_9__["default"], {
      withEmojiStatus: true,
      className: _EmojiStatusAccessModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].chatItem,
      itemClassName: _EmojiStatusAccessModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].itemName,
      mockPeer: mockPeerWithStatus
    });
  });
  const confirmHandler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!modal?.bot?.id) return;
    closeEmojiStatusAccessModal();
    if (modal?.webAppKey) {
      if (isPremium) {
        sendWebAppEvent({
          webAppKey: modal.webAppKey,
          event: {
            eventType: 'emoji_status_access_requested',
            eventData: {
              status: 'allowed'
            }
          }
        });
        toggleUserEmojiStatusPermission({
          botId: modal.bot.id,
          isEnabled: true,
          isBotAccessEmojiGranted: true
        });
      } else {
        openPremiumModal();
        sendWebAppEvent({
          webAppKey: modal.webAppKey,
          event: {
            eventType: 'emoji_status_access_requested',
            eventData: {
              status: 'cancelled'
            }
          }
        });
      }
    }
  });
  const onCloseHandler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!modal?.bot?.id) return;
    closeEmojiStatusAccessModal();
    if (modal?.webAppKey) {
      sendWebAppEvent({
        webAppKey: modal.webAppKey,
        event: {
          eventType: 'emoji_status_access_requested',
          eventData: {
            status: 'cancelled'
          }
        }
      });
    }
    if (isPremium) {
      toggleUserEmojiStatusPermission({
        botId: modal.bot.id,
        isEnabled: false
      });
    }
  });
  const renderStatusText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!modal?.bot) return undefined;
    return lang('EmojiStatusAccessText', {
      name: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(modal?.bot)
    }, {
      withNodes: true,
      withMarkdown: true
    });
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('confirm'),
    contentClassName: _EmojiStatusAccessModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].content,
    isOpen: isOpen,
    onClose: onCloseHandler
  }, renderPickerItem(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, renderStatusText(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons mt-2",
    ref: containerRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: confirmHandler,
    color: "primary"
  }, oldLang('lng_bot_allow_write_confirm')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onCloseHandler
  }, lang('Cancel')))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const currentUser = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, global.currentUserId);
  const isPremium = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global);
  const stickerSet = global.defaultStatusIconsId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectStickerSet)(global, global.defaultStatusIconsId) : undefined;
  return {
    currentUser,
    stickerSet,
    isPremium
  };
})(EmojiStatusAccessModal)));

/***/ }),

/***/ "./src/components/modals/giftcode/GiftCodeModal.tsx":
/*!**********************************************************!*\
  !*** ./src/components/modals/giftcode/GiftCodeModal.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_LinkField__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/LinkField */ "./src/components/common/LinkField.tsx");
/* harmony import */ var _common_TableInfoModal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/TableInfoModal */ "./src/components/modals/common/TableInfoModal.tsx");
/* harmony import */ var _GiftCodeModal_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./GiftCodeModal.module.scss */ "./src/components/modals/giftcode/GiftCodeModal.module.scss");
/* harmony import */ var _assets_premium_PremiumLogo_svg__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../assets/premium/PremiumLogo.svg */ "./src/assets/premium/PremiumLogo.svg");













const GIFTCODE_PATH = 'giftcode';
const GiftCodeModal = ({
  currentUserId,
  modal,
  messageSender
}) => {
  const {
    closeGiftCodeModal,
    applyGiftCode,
    focusMessage
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const isOpen = Boolean(modal);
  const canUse = (!modal?.info.toId || modal?.info.toId === currentUserId) && !modal?.info.usedAt;
  const handleOpenGiveaway = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!modal || !modal.info.giveawayMessageId) return;
    focusMessage({
      chatId: modal.info.fromId,
      messageId: modal.info.giveawayMessageId
    });
    closeGiftCodeModal();
  });
  const handleButtonClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (canUse) {
      applyGiftCode({
        slug: modal.slug
      });
      return;
    }
    closeGiftCodeModal();
  });
  const modalData = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!modal) return undefined;
    const {
      slug,
      info
    } = modal;
    const fromId = info.fromId || messageSender?.id;
    const header = /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
      src: _assets_premium_PremiumLogo_svg__WEBPACK_IMPORTED_MODULE_12__,
      alt: "",
      className: _GiftCodeModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].logo
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: _GiftCodeModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].centered
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang('lng_gift_link_about'), ['simple_markdown'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_LinkField__WEBPACK_IMPORTED_MODULE_9__["default"], {
      title: "BoostingGiftLink",
      link: `${_config__WEBPACK_IMPORTED_MODULE_2__.TME_LINK_PREFIX}/${GIFTCODE_PATH}/${slug}`
    }));
    const tableData = [[lang('BoostingFrom'), fromId ? {
      chatId: fromId
    } : lang('BoostingNoRecipient')], [lang('BoostingTo'), info.toId ? {
      chatId: info.toId
    } : lang('BoostingNoRecipient')], [lang('BoostingGift'), lang('BoostingTelegramPremiumFor', lang('Months', info.months, 'i'))], [lang('BoostingReason'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(info.giveawayMessageId && _GiftCodeModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].clickable),
      onClick: handleOpenGiveaway
    }, info.isFromGiveaway && !info.toId ? lang('BoostingIncompleteGiveaway') : lang(info.isFromGiveaway ? 'BoostingGiveaway' : 'BoostingYouWereSelected'))], [lang('BoostingDate'), (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatDateTimeToString)(info.date * 1000, lang.code, true)]];
    const footer = /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _GiftCodeModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].centered
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(info.usedAt ? lang('BoostingUsedLinkDate', (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatDateTimeToString)(info.usedAt * 1000, lang.code, true)) : lang('BoostingSendLinkToAnyone'), ['simple_markdown']));
    return {
      header,
      tableData,
      footer
    };
  }, [lang, messageSender?.id, modal]);
  if (!modalData) return undefined;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_TableInfoModal__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isOpen: isOpen,
    title: lang('lng_gift_link_title'),
    tableData: modalData.tableData,
    header: modalData.header,
    footer: modalData.footer,
    buttonText: canUse ? lang('BoostingUseLink') : lang('Close'),
    onButtonClick: handleButtonClick,
    onClose: closeGiftCodeModal
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  modal
}) => {
  const {
    message
  } = modal || {};
  const chatMessage = message && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatMessage)(global, message.chatId, message.messageId);
  const sender = chatMessage && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectSender)(global, chatMessage);
  return {
    currentUserId: global.currentUserId,
    messageSender: sender
  };
})(GiftCodeModal)));

/***/ }),

/***/ "./src/components/modals/inviteViaLink/InviteViaLinkModal.tsx":
/*!********************************************************************!*\
  !*** ./src/components/modals/inviteViaLink/InviteViaLinkModal.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AvatarList__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/AvatarList */ "./src/components/common/AvatarList.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Separator__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/Separator */ "./src/components/ui/Separator.tsx");
/* harmony import */ var _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./InviteViaLinkModal.module.scss */ "./src/components/modals/inviteViaLink/InviteViaLinkModal.module.scss");
















const InviteViaLinkModal = ({
  modal,
  chat
}) => {
  const {
    sendInviteMessages,
    closeInviteViaLinkModal,
    openPremiumModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    missingUsers
  } = modal || {};
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [selectedMemberIds, setSelectedMemberIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const userIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => missingUsers?.map(user => user.id) || _util_memo__WEBPACK_IMPORTED_MODULE_5__.MEMO_EMPTY_ARRAY, [missingUsers]);
  const [unselectableIds, selectableIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!missingUsers?.length) return [[], []];
    const [requirePremiumIds, regularIds] = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.partition)(missingUsers, user => user.isRequiringPremiumToMessage);
    return [requirePremiumIds.map(user => user.id), regularIds.map(user => user.id)];
  }, [missingUsers]);
  const invitableWithPremiumIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return missingUsers?.filter(user => user.isRequiringPremiumToInvite || user.isRequiringPremiumToMessage).map(user => user.id);
  }, [missingUsers]);
  const isEveryPremiumBlocksPm = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!missingUsers) return undefined;
    return !missingUsers.some(user => user.isRequiringPremiumToInvite && !user.isRequiringPremiumToMessage);
  }, [missingUsers]);
  const topListPeers = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const users = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    return invitableWithPremiumIds?.map(id => users[id]);
  }, [invitableWithPremiumIds]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setSelectedMemberIds(selectableIds);
  }, [selectableIds]);
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => closeInviteViaLinkModal());
  const handleSendInviteLink = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    sendInviteMessages({
      chatId: chat.id,
      userIds: selectedMemberIds
    });
    closeInviteViaLinkModal();
  }, [selectedMemberIds, chat]);
  const handleOpenPremiumModal = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    openPremiumModal();
  }, []);
  const canSendInviteLink = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!chat) return undefined;
    return Boolean(chat?.isCreator || chat?.adminRights?.inviteUsers);
  }, [chat]);
  const inviteSectionText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return canSendInviteLink ? lang(missingUsers?.length === 1 ? 'InviteBlockedOneMessage' : 'InviteBlockedManyMessage') : lang('InviteRestrictedUsers2', missingUsers?.length);
  }, [canSendInviteLink, lang, missingUsers?.length]);
  const premiumSectionText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!invitableWithPremiumIds?.length || !topListPeers?.length) return undefined;
    const prefix = isEveryPremiumBlocksPm ? 'InviteMessagePremiumBlocked' : 'InvitePremiumBlocked';
    let langKey = `${prefix}One`;
    let params = [(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(topListPeers[0])];
    if (invitableWithPremiumIds.length === 2) {
      langKey = `${prefix}Two`;
      params = [(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(topListPeers[0]), (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(topListPeers[1])];
    } else if (invitableWithPremiumIds.length === 3) {
      langKey = `${prefix}Three`;
      params = [(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(topListPeers[0]), (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(topListPeers[1]), (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(topListPeers[2])];
    } else if (invitableWithPremiumIds.length > 3) {
      langKey = `${prefix}Many`;
      params = [(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(topListPeers[0]), (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(topListPeers[1]), (invitableWithPremiumIds.length - 2).toString()];
    }
    return lang(langKey, params, undefined, topListPeers.length);
  }, [invitableWithPremiumIds, isEveryPremiumBlocksPm, lang, topListPeers]);
  const hasPremiumSection = Boolean(topListPeers?.length);
  const hasSelectableSection = Boolean(selectableIds?.length);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: Boolean(userIds && chat),
    contentClassName: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].content,
    onClose: handleClose,
    isSlim: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    round: true,
    color: "translucent",
    size: "smaller",
    className: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].closeButton,
    ariaLabel: lang('Close'),
    onClick: handleClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "close"
  })), premiumSectionText && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AvatarList__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].avatarList,
    peers: topListPeers,
    size: "large"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].title
  }, canSendInviteLink ? lang('InvitePremiumBlockedTitle') : lang('ChannelInviteViaLinkRestricted')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].contentText
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(premiumSectionText, ['simple_markdown'])), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    withPremiumGradient: true,
    isShiny: true,
    size: "smaller",
    onClick: handleOpenPremiumModal
  }, lang('InvitePremiumBlockedSubscribe'))), hasPremiumSection && hasSelectableSection && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Separator__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].separator
  }, lang('InvitePremiumBlockedOr')), hasSelectableSection && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].title
  }, lang('InviteBlockedTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].contentText
  }, inviteSectionText), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].userPicker,
    itemIds: userIds,
    selectedIds: selectedMemberIds,
    lockedUnselectedIds: unselectableIds,
    lockedUnselectedSubtitle: lang('InvitePremiumBlockedUser'),
    onSelectedIdsChange: setSelectedMemberIds,
    isViewOnly: !canSendInviteLink,
    allowMultiple: true,
    withStatus: true,
    itemInputType: "checkbox"
  }), canSendInviteLink && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: _InviteViaLinkModal_module_scss__WEBPACK_IMPORTED_MODULE_15__["default"].sendInvites,
    size: "smaller",
    onClick: handleSendInviteLink,
    disabled: !selectedMemberIds.length
  }, lang('SendInviteLink.ActionInvite'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  modal
}) => {
  const chat = modal?.chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, modal.chatId) : undefined;
  return {
    chat
  };
})(InviteViaLinkModal)));

/***/ }),

/***/ "./src/components/modals/locationAccess/LocationAccessModal.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/modals/locationAccess/LocationAccessModal.tsx ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _LocationAccessModal_module_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./LocationAccessModal.module.scss */ "./src/components/modals/locationAccess/LocationAccessModal.module.scss");














const LocationAccessModal = ({
  modal,
  currentUser
}) => {
  const {
    closeLocationAccessModal,
    toggleUserLocationPermission,
    sendWebAppEvent
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const isOpen = Boolean(modal);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_6__["default"])();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const confirmHandler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(async () => {
    const geolocationData = await (0,_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.getGeolocationStatus)();
    const {
      geolocation
    } = geolocationData;
    if (!modal?.bot?.id) return;
    closeLocationAccessModal();
    if (modal?.webAppKey) {
      toggleUserLocationPermission({
        botId: modal.bot.id,
        isAccessGranted: true
      });
      sendWebAppEvent({
        webAppKey: modal.webAppKey,
        event: {
          eventType: 'location_requested',
          eventData: {
            available: true,
            latitude: geolocation?.latitude,
            longitude: geolocation?.longitude,
            altitude: geolocation?.altitude,
            course: geolocation?.heading,
            speed: geolocation?.speed,
            horizontal_accuracy: geolocation?.accuracy,
            vertical_accuracy: geolocation?.accuracy
          }
        }
      });
    }
  });
  const onCloseHandler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!modal?.bot?.id) return;
    closeLocationAccessModal();
    if (modal?.webAppKey) {
      toggleUserLocationPermission({
        botId: modal.bot.id,
        isAccessGranted: false
      });
      sendWebAppEvent({
        webAppKey: modal.webAppKey,
        event: {
          eventType: 'location_requested',
          eventData: {
            available: false
          }
        }
      });
    }
  });
  const renderInfo = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!modal?.bot) return undefined;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _LocationAccessModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].avatars
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_9__["default"], {
      size: "large",
      peer: currentUser
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__["default"], {
      name: "next",
      className: _LocationAccessModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].arrow
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_9__["default"], {
      size: "large",
      peer: modal.bot
    }));
  });
  const renderStatusText = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!modal?.bot) return undefined;
    return lang('LocationPermissionText', {
      name: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(modal?.bot)
    }, {
      withNodes: true,
      withMarkdown: true
    });
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('confirm'),
    isOpen: isOpen,
    onClose: onCloseHandler
  }, renderInfo(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, renderStatusText(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons mt-2",
    ref: containerRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: confirmHandler,
    color: "primary"
  }, oldLang('lng_bot_allow_write_confirm')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: onCloseHandler
  }, lang('Cancel')))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const currentUser = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, global.currentUserId);
  return {
    currentUser
  };
})(LocationAccessModal)));

/***/ }),

/***/ "./src/components/modals/map/MapModal.tsx":
/*!************************************************!*\
  !*** ./src/components/modals/map/MapModal.tsx ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _util_map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/map */ "./src/util/map.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _MapModal_module_scss__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./MapModal.module.scss */ "./src/components/modals/map/MapModal.module.scss");









const OpenMapModal = ({
  modal
}) => {
  const {
    closeMapModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    point: geoPoint,
    zoom
  } = modal || {};
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const isOpen = Boolean(geoPoint);
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    closeMapModal();
  });
  const [googleUrl, bingUrl, appleUrl, osmUrl] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!geoPoint) {
      return [];
    }
    const google = (0,_util_map__WEBPACK_IMPORTED_MODULE_2__.prepareMapUrl)('google', geoPoint, zoom);
    const bing = (0,_util_map__WEBPACK_IMPORTED_MODULE_2__.prepareMapUrl)('bing', geoPoint, zoom);
    const osm = (0,_util_map__WEBPACK_IMPORTED_MODULE_2__.prepareMapUrl)('osm', geoPoint, zoom);
    const apple = (0,_util_map__WEBPACK_IMPORTED_MODULE_2__.prepareMapUrl)('apple', geoPoint, zoom);
    return [google, bing, apple, osm];
  }, [geoPoint, zoom]);
  const openUrl = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(url => {
    closeMapModal();
    window.open(url, '_blank', 'noopener');
  });
  const handleGoogleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    openUrl(googleUrl);
  });
  const handleBingClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    openUrl(bingUrl);
  });
  const handleAppleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    openUrl(appleUrl);
  });
  const handleOsmClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    openUrl(osmUrl);
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_7__["default"], {
    contentClassName: _MapModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].root,
    title: lang('OpenMapWith'),
    isOpen: isOpen,
    onClose: handleClose,
    isSlim: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MapModal_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].buttons
  }, (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__.IS_IOS || _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_3__.IS_MAC_OS) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    fluid: true,
    size: "smaller",
    onClick: handleAppleClick
  }, "Apple Maps"), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    fluid: true,
    size: "smaller",
    onClick: handleGoogleClick
  }, "Google Maps"), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    fluid: true,
    size: "smaller",
    onClick: handleBingClick
  }, "Bing Maps"), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    fluid: true,
    size: "smaller",
    onClick: handleOsmClick
  }, "OpenStreetMap")), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons mt-2"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: "confirm-dialog-button",
    isText: true,
    onClick: handleClose
  }, lang('Cancel'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(OpenMapModal));

/***/ }),

/***/ "./src/components/modals/oneTimeMedia/OneTimeMediaModal.tsx":
/*!******************************************************************!*\
  !*** ./src/components/modals/oneTimeMedia/OneTimeMediaModal.tsx ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _common_Audio__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/Audio */ "./src/components/common/Audio.tsx");
/* harmony import */ var _middle_message_RoundVideo__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../middle/message/RoundVideo */ "./src/components/middle/message/RoundVideo.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _OneTimeMediaModal_module_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./OneTimeMediaModal.module.scss */ "./src/components/modals/oneTimeMedia/OneTimeMediaModal.module.scss");














const OneTimeMediaModal = ({
  modal
}) => {
  const {
    closeOneTimeMediaModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const message = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_6__["default"])(modal?.message, true);
  const {
    shouldRender,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_9__["default"])(Boolean(modal));
  const handlePlayVoice = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    return undefined;
  });
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    closeOneTimeMediaModal();
  });
  if (!shouldRender || !message) {
    return undefined;
  }
  const isOwn = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isOwnMessage)(message);
  const theme = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTheme)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)());
  const closeBtnTitle = isOwn ? lang('Chat.Voice.Single.Close') : lang('Chat.Voice.Single.DeleteAndClose');
  function renderMedia() {
    if (!message?.content) {
      return undefined;
    }
    const {
      voice,
      video
    } = message.content;
    if (voice) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Audio__WEBPACK_IMPORTED_MODULE_10__["default"], {
        className: _OneTimeMediaModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].voice,
        theme: theme,
        message: message,
        origin: _types__WEBPACK_IMPORTED_MODULE_2__.AudioOrigin.OneTimeModal,
        autoPlay: true,
        onPlay: handlePlayVoice,
        onPause: handleClose
      });
    } else if (video?.isRound) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_middle_message_RoundVideo__WEBPACK_IMPORTED_MODULE_11__["default"], {
        className: _OneTimeMediaModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].video,
        message: message,
        origin: "oneTimeModal",
        onStop: handleClose
      });
    }
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_OneTimeMediaModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].root, transitionClassNames)
  }, renderMedia(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _OneTimeMediaModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].footer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    faded: true,
    onClick: handleClose,
    pill: true,
    size: "smaller",
    color: theme === 'dark' ? 'dark' : 'secondary',
    className: _OneTimeMediaModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].closeBtn
  }, closeBtnTitle)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(OneTimeMediaModal));

/***/ }),

/***/ "./src/components/modals/reportAd/ReportAdModal.tsx":
/*!**********************************************************!*\
  !*** ./src/components/modals/reportAd/ReportAdModal.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_SafeLink__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/SafeLink */ "./src/components/common/SafeLink.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./ReportAdModal.module.scss */ "./src/components/modals/reportAd/ReportAdModal.module.scss");













const ADDED_PADDING = 56;
const ReportAdModal = ({
  modal
}) => {
  const {
    reportSponsoredMessage,
    closeReportAdModal,
    openPreviousReportAdModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const isOpen = Boolean(modal);

  // eslint-disable-next-line no-null/no-null
  const transitionRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const handleOptionClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])((e, option) => {
    const {
      chatId,
      randomId
    } = modal;
    reportSponsoredMessage({
      peerId: chatId,
      randomId,
      option
    });
  });
  const [renderingSection, renderingDepth] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!modal) return [undefined, 0];
    const sectionDepth = modal.sections.length - 1;
    return [modal.sections[sectionDepth], sectionDepth];
  }, [modal]);
  const handleBackClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    if (!renderingDepth) {
      closeReportAdModal();
      return;
    }
    openPreviousReportAdModal();
  });
  const bottomText = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!modal) return undefined;
    const template = lang('lng_report_sponsored_reported_learn');
    const parts = template.split('{link}');
    return [parts[0], /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_SafeLink__WEBPACK_IMPORTED_MODULE_7__["default"], {
      text: lang('lng_report_sponsored_reported_link'),
      url: lang('ReportAd.Help_URL')
    }), parts[1]];
  }, [lang, modal]);
  const header = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!modal) {
      return undefined;
    }
    const hasSubtitle = Boolean(renderingSection?.subtitle);
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header-condensed"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: lang(renderingDepth ? 'Back' : 'Close'),
      onClick: handleBackClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_6__["default"], {
      name: renderingDepth ? 'arrow-left' : 'close'
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('modal-title', _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].modalTitle, hasSubtitle && _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].titleMultiline)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].title
    }, lang('ReportAd')), hasSubtitle && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].subtitle
    }, renderingSection.subtitle)));
  }, [lang, modal, renderingDepth, renderingSection?.subtitle]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!modal) return;
    const slide = document.querySelector(`.${_ui_Transition__WEBPACK_IMPORTED_MODULE_11__.ACTIVE_SLIDE_CLASS_NAME} > .${_ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].slide}`);
    if (!slide) return;
    const height = slide.scrollHeight;
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
      transitionRef.current.style.height = `${height + ADDED_PADDING}px`;
    });
  }, [modal]);
  const handleAnimationStart = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    const slide = document.querySelector(`.${_ui_Transition__WEBPACK_IMPORTED_MODULE_11__.TO_SLIDE_CLASS_NAME} > .${_ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].slide}`);
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMeasure)(() => {
      const height = slide.scrollHeight;
      (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
        transitionRef.current.style.height = `${height + ADDED_PADDING}px`;
      });
    });
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isOpen: isOpen,
    hasCloseButton: true,
    className: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].root,
    header: header,
    onClose: closeReportAdModal
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_11__["default"], {
    name: "slide",
    className: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].transition,
    ref: transitionRef,
    activeKey: renderingDepth,
    onStart: handleAnimationStart
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].slide
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].sectionTitle
  }, renderingSection?.title), renderingSection?.options.map(option => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    narrow: true,
    secondaryIcon: "next",
    className: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].option,
    buttonClassName: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].optionButton,
    clickArg: option.option,
    onClick: handleOptionClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].optionText
  }, option.text)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _ReportAdModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].description
  }, bottomText)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ReportAdModal));

/***/ }),

/***/ "./src/components/modals/reportModal/ReportModal.tsx":
/*!***********************************************************!*\
  !*** ./src/components/modals/reportModal/ReportModal.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/AnimatedIconWithPreview */ "./src/components/common/AnimatedIconWithPreview.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_TextArea__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/TextArea */ "./src/components/ui/TextArea.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./ReportModal.module.scss */ "./src/components/modals/reportModal/ReportModal.module.scss");















const MAX_DESCRIPTION = 512;
const ADDED_PADDING = 20;
const ReportModal = ({
  modal
}) => {
  const {
    reportMessages,
    reportStory,
    closeReportModal,
    openPreviousReportModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const isOpen = Boolean(modal);

  // eslint-disable-next-line no-null/no-null
  const transitionRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [text, setText] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const handleOptionClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])((e, option) => {
    const {
      messageIds,
      subject,
      peerId,
      chatId
    } = modal;
    if (!messageIds) return;
    switch (subject) {
      case 'message':
        reportMessages({
          chatId: chatId,
          messageIds,
          option
        });
        break;
      case 'story':
        reportStory({
          storyId: messageIds[0],
          peerId: peerId,
          option
        });
        break;
    }
  });
  const [renderingSection, renderingDepth] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!modal) return [undefined, 0];
    const sectionDepth = modal.sections.length - 1;
    return [modal?.sections[sectionDepth], sectionDepth];
  }, [modal]);
  const handleBackClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    openPreviousReportModal();
  });
  const handleCloseClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    closeReportModal();
  });
  const header = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!modal) {
      return undefined;
    }
    const hasSubtitle = Boolean(renderingSection?.subtitle);
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header-condensed"
    }, renderingDepth ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: lang('Back'),
      onClick: handleBackClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
      name: "arrow-left"
    })) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: lang('Close'),
      onClick: handleCloseClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
      name: "close"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('modal-title', _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].modalTitle, hasSubtitle && _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].titleMultiline)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].title, renderingDepth && _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].hasDepth)
    }, renderingSection?.options ? lang(modal?.subject === 'story' ? 'ReportStory' : 'Report') : renderingSection?.title), hasSubtitle && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].subtitle
    }, renderingSection.subtitle)));
  }, [lang, modal, renderingDepth, renderingSection?.options, renderingSection?.subtitle, renderingSection?.title]);
  const handleTextChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(e => {
    setText(e.target.value);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!modal) return;
    const slide = document.querySelector(`.${_ui_Transition__WEBPACK_IMPORTED_MODULE_13__.ACTIVE_SLIDE_CLASS_NAME} > .${_ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].slide}`);
    if (!slide) return;
    const height = slide.scrollHeight;
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
      transitionRef.current.style.height = `${height}px`;
    });
  }, [modal]);
  const handleAnimationStart = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    const slide = document.querySelector(`.${_ui_Transition__WEBPACK_IMPORTED_MODULE_13__.TO_SLIDE_CLASS_NAME} > .${_ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].slide}`);
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMeasure)(() => {
      const height = slide.scrollHeight;
      (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
        transitionRef.current.style.height = `${height + ADDED_PADDING}px`;
      });
    });
  });
  const closeReportMessageModalHandler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    setText('');
    closeReportModal();
  });
  const sendMessageReportHandler = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    const {
      messageIds,
      subject,
      peerId,
      chatId
    } = modal;
    switch (subject) {
      case 'message':
        reportMessages({
          chatId: chatId,
          messageIds,
          option: renderingSection?.option,
          description: text
        });
        break;
      case 'story':
        reportStory({
          storyId: messageIds?.[0],
          peerId: peerId,
          option: renderingSection?.option,
          description: text
        });
        break;
    }
    closeReportMessageModalHandler();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isOpen: isOpen,
    header: header,
    onClose: closeReportMessageModalHandler,
    contentClassName: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].content,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].root, modal?.subject === 'story' && 'component-theme-dark')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_13__["default"], {
    name: "slide",
    className: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].transition,
    ref: transitionRef,
    activeKey: renderingDepth,
    onStart: handleAnimationStart
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].slide
  }, renderingSection?.options ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].sectionTitle
  }, renderingSection?.title) : undefined, renderingSection?.options?.map(option => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_10__["default"], {
    narrow: true,
    nonInteractive: true,
    secondaryIcon: "next",
    className: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].option,
    buttonClassName: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].optionButton,
    clickArg: option.option,
    onClick: handleOptionClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].optionText
  }, option.text))), renderingSection?.option ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].block
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIconWithPreview__WEBPACK_IMPORTED_MODULE_7__["default"], {
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_4__.LOCAL_TGS_URLS.Report,
    size: 100,
    className: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].reportIcon,
    nonInteractive: true,
    forceAlways: true,
    noLoop: false
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_TextArea__WEBPACK_IMPORTED_MODULE_12__["default"], {
    id: "option",
    className: _ReportModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].optionInfo,
    label: renderingSection.isOptional ? lang('Report2CommentOptional') : lang('Report2Comment'),
    onChange: handleTextChange,
    value: text,
    maxLength: MAX_DESCRIPTION,
    maxLengthIndicator: (MAX_DESCRIPTION - text.length).toString(),
    noReplaceNewlines: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
    size: "smaller",
    onClick: sendMessageReportHandler,
    disabled: !renderingSection.isOptional ? !text.length : undefined
  }, lang('ReportSend'))) : undefined)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ReportModal));

/***/ }),

/***/ "./src/components/modals/suggestedStatus/SuggestedStatusModal.tsx":
/*!************************************************************************!*\
  !*** ./src/components/modals/suggestedStatus/SuggestedStatusModal.tsx ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _common_CustomEmoji__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/CustomEmoji */ "./src/components/common/CustomEmoji.tsx");
/* harmony import */ var _common_PeerChip__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/PeerChip */ "./src/components/common/PeerChip.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _SuggestedStatusModal_module_scss__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./SuggestedStatusModal.module.scss */ "./src/components/modals/suggestedStatus/SuggestedStatusModal.module.scss");















const CUSTOM_EMOJI_SIZE = 6 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_6__.REM;
const SuggestedStatusModal = ({
  modal,
  currentUser,
  bot
}) => {
  const {
    setEmojiStatus,
    closeSuggestedStatusModal,
    sendWebAppEvent
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const isOpen = Boolean(modal);
  const renderingModal = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_7__["default"])(modal);
  const mockPeerWithStatus = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!currentUser || !renderingModal) return undefined;
    return {
      ...currentUser,
      emojiStatus: {
        documentId: renderingModal.customEmojiId
      }
    };
  }, [currentUser, renderingModal]);
  const description = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!renderingModal || !bot) return undefined;
    const botName = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(bot);
    if (renderingModal.duration) {
      return lang('BotSuggestedStatusFor', {
        bot: botName,
        duration: (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.formatShortDuration)(lang, renderingModal.duration)
      }, {
        withNodes: true,
        withMarkdown: true
      });
    }
    return lang('BotSuggestedStatus', {
      bot: botName
    }, {
      withNodes: true,
      withMarkdown: true
    });
  }, [bot, lang, renderingModal]);
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    const webAppKey = renderingModal?.webAppKey;
    if (webAppKey) {
      sendWebAppEvent({
        webAppKey,
        event: {
          eventType: 'emoji_status_failed',
          eventData: {
            error: 'USER_DECLINED'
          }
        }
      });
    }
    closeSuggestedStatusModal();
  });
  const handleSetStatus = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    if (!renderingModal) return;
    const expires = renderingModal.duration ? (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_5__.getServerTime)() + renderingModal.duration : undefined;
    setEmojiStatus({
      referrerWebAppKey: renderingModal.webAppKey,
      emojiStatusId: renderingModal.customEmojiId,
      expires
    });
    closeSuggestedStatusModal();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isOpen,
    contentClassName: _SuggestedStatusModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].content,
    hasAbsoluteCloseButton: true,
    isSlim: true,
    onClose: handleClose
  }, renderingModal && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmoji__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: _SuggestedStatusModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].topEmoji,
    documentId: renderingModal.customEmojiId,
    size: CUSTOM_EMOJI_SIZE,
    loopLimit: 1,
    forceAlways: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: _SuggestedStatusModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].title
  }, lang('BotSuggestedStatusTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _SuggestedStatusModal_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].description
  }, description)), mockPeerWithStatus && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PeerChip__WEBPACK_IMPORTED_MODULE_11__["default"], {
    mockPeer: mockPeerWithStatus,
    withEmojiStatus: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    size: "smaller",
    onClick: handleSetStatus
  }, lang('GeneralConfirm')));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  modal
}) => {
  const currentUser = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, global.currentUserId);
  const bot = modal?.botId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, modal.botId) : undefined;
  return {
    currentUser,
    bot
  };
})(SuggestedStatusModal)));

/***/ }),

/***/ "./src/components/modals/urlAuth/UrlAuthModal.tsx":
/*!********************************************************!*\
  !*** ./src/components/modals/urlAuth/UrlAuthModal.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_ensureProtocol__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/ensureProtocol */ "./src/util/ensureProtocol.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _UrlAuthModal_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./UrlAuthModal.module.scss */ "./src/components/modals/urlAuth/UrlAuthModal.module.scss");











const UrlAuthModal = ({
  modal,
  currentUser
}) => {
  const {
    closeUrlAuthModal,
    acceptBotUrlAuth,
    acceptLinkUrlAuth
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isLoginChecked, setLoginChecked] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [isWriteAccessChecked, setWriteAccessChecked] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const currentAuth = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_6__["default"])(modal, false);
  const {
    domain,
    botId,
    shouldRequestWriteAccess
  } = currentAuth?.request || {};
  const bot = botId ? (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId[botId] : undefined;
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const handleOpen = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (modal?.url && isLoginChecked) {
      const acceptAction = modal.button ? acceptBotUrlAuth : acceptLinkUrlAuth;
      acceptAction({
        isWriteAllowed: isWriteAccessChecked
      });
    } else {
      window.open((0,_util_ensureProtocol__WEBPACK_IMPORTED_MODULE_4__.ensureProtocol)(currentAuth?.url), '_blank', 'noopener');
    }
    closeUrlAuthModal();
  }, [modal, isLoginChecked, closeUrlAuthModal, acceptBotUrlAuth, acceptLinkUrlAuth, isWriteAccessChecked, currentAuth]);
  const handleDismiss = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeUrlAuthModal();
  }, [closeUrlAuthModal]);
  const handleLoginChecked = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    setLoginChecked(value);
    setWriteAccessChecked(value);
  }, [setLoginChecked]);

  // Reset on re-open
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (domain) {
      setLoginChecked(true);
      setWriteAccessChecked(Boolean(shouldRequestWriteAccess));
    }
  }, [shouldRequestWriteAccess, domain]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_9__["default"], {
    isOpen: Boolean(modal?.url),
    onClose: handleDismiss,
    title: lang('OpenUrlTitle'),
    confirmLabel: lang('OpenUrlTitle'),
    confirmHandler: handleOpen
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__["default"])(lang('OpenUrlAlert2', currentAuth?.url), ['links']), domain && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    checked: isLoginChecked,
    label: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__["default"])(lang('Conversation.OpenBotLinkLogin', [domain, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(currentUser)]), ['simple_markdown'])),
    onCheck: handleLoginChecked,
    className: _UrlAuthModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].checkbox
  }), shouldRequestWriteAccess && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_8__["default"], {
    checked: isWriteAccessChecked,
    label: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_5__["default"])(lang('Conversation.OpenBotLinkAllowMessages', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(bot)), ['simple_markdown'])),
    onCheck: setWriteAccessChecked,
    disabled: !isLoginChecked,
    className: _UrlAuthModal_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].checkbox
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const currentUser = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, global.currentUserId);
  return {
    currentUser
  };
})(UrlAuthModal)));

/***/ }),

/***/ "./src/components/modals/webApp/MinimizedWebAppModal.tsx":
/*!***************************************************************!*\
  !*** ./src/components/modals/webApp/MinimizedWebAppModal.tsx ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AvatarList__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/AvatarList */ "./src/components/common/AvatarList.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _MinimizedWebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./MinimizedWebAppModal.module.scss */ "./src/components/modals/webApp/MinimizedWebAppModal.module.scss");












const MinimizedWebAppModal = ({
  activeTabBot,
  isMinimizedState,
  openedWebApps
}) => {
  const {
    changeWebAppModalState,
    closeWebAppModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const openedWebAppsValues = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return openedWebApps && Object.values(openedWebApps);
  }, [openedWebApps]);
  const openedTabsCount = openedWebAppsValues?.length;
  const peers = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!openedTabsCount) return [];
    const global = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    const activeTabBotId = activeTabBot?.id;
    const openedApps = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.unique)([activeTabBotId, ...openedWebAppsValues.map(app => app.botId)]);
    const bots = openedApps.map(id => id && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectUser)(global, id)).filter(Boolean).slice(0, 3);
    return bots;
  }, [openedTabsCount, activeTabBot, openedWebAppsValues]);
  const handleCloseClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    closeWebAppModal();
  });
  const handleExpandClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    changeWebAppModalState({
      state: 'maximized'
    });
  });
  if (!isMinimizedState) return undefined;
  function renderTitle() {
    const activeTabName = peers.length > 0 && peers[0]?.firstName;
    const title = openedTabsCount && activeTabName && openedTabsCount > 1 ? `${lang('MiniAppsMoreTabs', {
      botName: activeTabName,
      count: openedTabsCount - 1
    }, {
      pluralValue: openedTabsCount - 1
    })}` : activeTabName;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _MinimizedWebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].title
    }, title);
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: ref,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_MinimizedWebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].root)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: _MinimizedWebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].button,
    round: true,
    color: "translucent",
    size: "tiny",
    ariaLabel: oldLang('Close'),
    onClick: handleCloseClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: _MinimizedWebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].icon,
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AvatarList__WEBPACK_IMPORTED_MODULE_8__["default"], {
    className: _MinimizedWebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].avatars,
    size: "mini",
    peers: peers
  }), renderTitle(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_MinimizedWebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].windowStateButton, 'no-drag'),
    round: true,
    color: "translucent",
    size: "tiny",
    onClick: handleExpandClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: _MinimizedWebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].stateIcon,
    name: "expand-modal"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const tabState = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global);
  const webApps = tabState.webApps;
  const {
    botId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectActiveWebApp)(global) || {};
  const {
    modalState,
    openedWebApps
  } = webApps || {};
  const isMinimizedState = modalState === 'minimized';
  const activeTabBot = botId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectUser)(global, botId) : undefined;
  return {
    activeTabBot,
    isMinimizedState,
    openedWebApps
  };
})(MinimizedWebAppModal)));

/***/ }),

/***/ "./src/components/modals/webApp/MoreAppsTabContent.tsx":
/*!*************************************************************!*\
  !*** ./src/components/modals/webApp/MoreAppsTabContent.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_SearchInput__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/SearchInput */ "./src/components/ui/SearchInput.tsx");
/* harmony import */ var _WebAppGridItem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./WebAppGridItem */ "./src/components/modals/webApp/WebAppGridItem.tsx");
/* harmony import */ var _MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./MoreAppsTabContent.module.scss */ "./src/components/modals/webApp/MoreAppsTabContent.module.scss");














const POPULAR_APPS_SLICE = 30;
const LESS_GRID_ITEMS_AMOUNT = 5;
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_6__.throttle)(cb => cb(), 500, true);
const MoreAppsTabContent = ({
  foundIds,
  recentBotIds
}) => {
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [shouldShowMoreMine, setShouldShowMoreMine] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const {
    searchPopularBotApps
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const handleToggleShowMoreMine = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    setShouldShowMoreMine(prev => !prev);
  });
  const [searchQuery, setSearchQuery] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const filteredFoundIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!foundIds) return [];
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.filterUsersByName)(foundIds, usersById, searchQuery);
  }, [foundIds, searchQuery]);
  const handleLoadMore = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards) {
      runThrottled(() => {
        searchPopularBotApps();
      });
    }
  }, []);
  const handleSearchInputReset = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setSearchQuery('');
  }, []);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].root, 'custom-scroll'),
    items: filteredFoundIds,
    onLoadMore: handleLoadMore,
    itemSelector: ".PopularAppGridItem",
    noFastList: true,
    preloadBackwards: POPULAR_APPS_SLICE
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_SearchInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: _MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].search,
    value: searchQuery,
    onChange: setSearchQuery,
    onReset: handleSearchInputReset,
    placeholder: lang('SearchApps')
  }), recentBotIds && !searchQuery && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].section
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].sectionTitle
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, oldLang('SearchAppsMine')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].showMoreLink,
    onClick: handleToggleShowMoreMine
  }, oldLang(shouldShowMoreMine ? 'ChatList.Search.ShowLess' : 'ChatList.Search.ShowMore'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].sectionContent
  }, recentBotIds.map((id, index) => {
    if (!shouldShowMoreMine && index >= LESS_GRID_ITEMS_AMOUNT) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_WebAppGridItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
      chatId: id
    });
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].section
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].sectionTitle
  }, searchQuery ? lang('Apps') : lang('PopularApps')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _MoreAppsTabContent_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].sectionContent
  }, filteredFoundIds && filteredFoundIds.map(id => {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_WebAppGridItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
      chatId: id,
      isPopularApp: !searchQuery
    });
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const globalSearch = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global).globalSearch;
  const foundIds = globalSearch.popularBotApps?.peerIds;
  return {
    isLoading: !foundIds && globalSearch.fetchingStatus?.botApps,
    foundIds,
    recentBotIds: global.topBotApps.userIds
  };
})(MoreAppsTabContent)));

/***/ }),

/***/ "./src/components/modals/webApp/WebAppGridItem.tsx":
/*!*********************************************************!*\
  !*** ./src/components/modals/webApp/WebAppGridItem.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_textFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/textFormat */ "./src/util/textFormat.ts");
/* harmony import */ var _util_themeStyle__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/themeStyle */ "./src/util/themeStyle.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _common_PeerBadge__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/PeerBadge */ "./src/components/common/PeerBadge.tsx");
/* harmony import */ var _WebAppGridItem_module_scss__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./WebAppGridItem.module.scss */ "./src/components/modals/webApp/WebAppGridItem.module.scss");









function WebAppGridItem({
  user,
  isPopularApp
}) {
  const {
    requestMainWebView
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    if (!user) {
      return;
    }
    const botId = user?.id;
    if (!botId) {
      return;
    }
    const theme = (0,_util_themeStyle__WEBPACK_IMPORTED_MODULE_5__.extractCurrentThemeParams)();
    requestMainWebView({
      botId,
      peerId: botId,
      theme
    });
  });
  if (!user) return undefined;

  // eslint-disable-next-line no-null/no-null

  const title = user?.firstName;
  const activeUserCount = user?.botActiveUsers;
  const badgeText = activeUserCount && isPopularApp ? (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_4__.formatIntegerCompact)(activeUserCount) : undefined;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _WebAppGridItem_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].container,
    onClick: handleClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PeerBadge__WEBPACK_IMPORTED_MODULE_7__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_WebAppGridItem_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].avatarContainer, isPopularApp && 'PopularAppGridItem'),
    textClassName: _WebAppGridItem_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].name,
    badgeClassName: _WebAppGridItem_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].userCountBadge,
    badgeIconClassName: _WebAppGridItem_module_scss__WEBPACK_IMPORTED_MODULE_8__["default"].userBadgeIcon,
    peer: user,
    text: title,
    badgeText: badgeText,
    badgeIcon: "user-filled"
  }));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const user = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectUser)(global, chatId);
  return {
    user
  };
})(WebAppGridItem)));

/***/ }),

/***/ "./src/components/modals/webApp/WebAppModal.tsx":
/*!******************************************************!*\
  !*** ./src/components/modals/webApp/WebAppModal.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers_bots__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers/bots */ "./src/global/helpers/bots.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_buildStyle__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/buildStyle */ "./src/util/buildStyle.ts");
/* harmony import */ var _util_colors__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/colors */ "./src/util/colors.ts");
/* harmony import */ var _util_switchTheme__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/switchTheme */ "./src/util/switchTheme.ts");
/* harmony import */ var _util_windowSize__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../util/windowSize */ "./src/util/windowSize.ts");
/* harmony import */ var _hooks_schedulers_useInterval__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/schedulers/useInterval */ "./src/hooks/schedulers/useInterval.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useContextMenuHandlers */ "./src/hooks/useContextMenuHandlers.ts");
/* harmony import */ var _hooks_useDraggable__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useDraggable */ "./src/hooks/useDraggable.ts");
/* harmony import */ var _hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../hooks/useHorizontalScroll */ "./src/hooks/useHorizontalScroll.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../ui/DropdownMenu */ "./src/components/ui/DropdownMenu.tsx");
/* harmony import */ var _ui_Menu__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../ui/Menu */ "./src/components/ui/Menu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _MinimizedWebAppModal__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./MinimizedWebAppModal */ "./src/components/modals/webApp/MinimizedWebAppModal.tsx");
/* harmony import */ var _MoreAppsTabContent__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./MoreAppsTabContent */ "./src/components/modals/webApp/MoreAppsTabContent.tsx");
/* harmony import */ var _WebAppModalTabContent__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./WebAppModalTabContent */ "./src/components/modals/webApp/WebAppModalTabContent.tsx");
/* harmony import */ var _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./WebAppModal.module.scss */ "./src/components/modals/webApp/WebAppModal.module.scss");





























const PROLONG_INTERVAL = 45000; // 45s
const LUMA_THRESHOLD = 128;
const MINIMIZED_STATE_SIZE = {
  width: 300,
  height: 40
};
const DEFAULT_MAXIMIZED_STATE_SIZE = {
  width: 420,
  height: 730
};
const MAXIMIZED_STATE_MINIMUM_SIZE = {
  width: 300,
  height: 300
};
const WebAppModal = ({
  modal,
  chat,
  bot,
  attachBot,
  theme,
  cachedSize,
  cachedPosition
}) => {
  const {
    closeActiveWebApp,
    closeWebAppModal,
    prolongWebView,
    toggleAttachBot,
    openChat,
    changeWebAppModalState,
    openWebAppTab,
    updateWebApp,
    openMoreAppsTab,
    closeMoreAppsTab,
    updateMiniAppCachedPosition,
    updateMiniAppCachedSize
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [getMaximizedStateSize, setMaximizedStateSize] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)(cachedSize || DEFAULT_MAXIMIZED_STATE_SIZE);
  function getSize() {
    if (modal?.modalState === 'fullScreen') return _util_windowSize__WEBPACK_IMPORTED_MODULE_9__["default"].get();
    if (modal?.modalState === 'maximized') return getMaximizedStateSize();
    return MINIMIZED_STATE_SIZE;
  }
  function getMinimumSize() {
    if (modal?.modalState === 'maximized') return MAXIMIZED_STATE_MINIMUM_SIZE;
    return undefined;
  }
  const {
    openedWebApps,
    activeWebAppKey,
    openedOrderedKeys,
    sessionKeys,
    isMoreAppsTabActive
  } = modal || {};
  const activeWebApp = activeWebAppKey ? openedWebApps?.[activeWebAppKey] : undefined;
  const {
    isBackButtonVisible,
    headerColor,
    backgroundColor,
    isSettingsButtonVisible
  } = activeWebApp || {};
  const tabs = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return openedOrderedKeys?.map(key => {
      const webApp = openedWebApps[key];
      return {
        bot: (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId[webApp.botId],
        webApp,
        isOpen: Boolean(activeWebApp && key === (0,_global_helpers_bots__WEBPACK_IMPORTED_MODULE_3__.getWebAppKey)(activeWebApp))
      };
    });
  }, [openedOrderedKeys, openedWebApps, activeWebApp]);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const isOpen = modal?.isModalOpen || false;
  const isMaximizedState = modal?.modalState === 'maximized';
  const isMinimizedState = modal?.modalState === 'minimized';
  const isFullScreen = modal?.modalState === 'fullScreen';
  const supportMultiTabMode = !isMobile;
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const headerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const menuRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const getTriggerElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => ref.current);
  const getRootElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => ref.current);
  const getMenuElement = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => menuRef.current);
  const {
    isContextMenuOpen,
    contextMenuAnchor,
    handleContextMenu,
    handleContextMenuClose,
    handleContextMenuHide
  } = (0,_hooks_useContextMenuHandlers__WEBPACK_IMPORTED_MODULE_12__["default"])(ref);
  const [isDraggingEnabled, setIsDraggingEnabled] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const headerElement = headerRef.current;
  const containerElement = ref.current;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setIsDraggingEnabled(Boolean(supportMultiTabMode && headerElement && containerElement && !isFullScreen));
  }, [supportMultiTabMode, headerElement, containerElement, isFullScreen]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    changeWebAppModalState({
      state: 'maximized'
    });
  }, [supportMultiTabMode]);
  const {
    isDragging,
    isResizing,
    style: draggableStyle,
    size,
    position
  } = (0,_hooks_useDraggable__WEBPACK_IMPORTED_MODULE_13__["default"])(ref, headerRef, isDraggingEnabled, getSize(), isFullScreen, getMinimumSize(), cachedPosition);
  const x = position?.x;
  const y = position?.y;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isDragging && x !== undefined && y !== undefined) {
      updateMiniAppCachedPosition({
        position: {
          x,
          y
        }
      });
    }
  }, [isDragging, x, y]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isDragging && size && isMaximizedState) {
      updateMiniAppCachedSize({
        size
      });
    }
  }, [isDragging, isMaximizedState, size]);
  const currentSize = size || getSize();
  const currentWidth = currentSize.width;
  const currentHeight = currentSize.height;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isResizing) {
      setMaximizedStateSize({
        width: currentWidth,
        height: currentHeight
      });
    }
  }, [currentHeight, currentWidth, isResizing, setMaximizedStateSize]);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_17__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_15__["default"])();
  const {
    queryId
  } = activeWebApp || {};
  const openTabsCount = openedWebApps ? Object.values(openedWebApps).length : 0;
  (0,_hooks_schedulers_useInterval__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    if (!openedWebApps) return;
    Object.keys(openedWebApps).forEach(key => {
      const webApp = openedWebApps[key];
      if (webApp.queryId) {
        prolongWebView({
          botId: webApp.botId,
          queryId: webApp.queryId,
          peerId: webApp.peerId || chat.id,
          replyInfo: webApp.replyInfo
        });
      }
    });
  }, queryId ? PROLONG_INTERVAL : undefined, true);

  // eslint-disable-next-line no-null/no-null
  const sendEventCallback = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const reloadFrameCallback = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const registerSendEventCallback = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(callback => {
    sendEventCallback.current = callback;
  });
  const sendEvent = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(event => {
    if (sendEventCallback.current) {
      sendEventCallback.current(event);
    }
  });
  const registerReloadFrameCallback = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(callback => {
    reloadFrameCallback.current = callback;
  });
  const reloadFrame = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(url => {
    if (reloadFrameCallback.current) {
      reloadFrameCallback.current(url);
    }
  });
  const handleSettingsButtonClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    sendEvent({
      eventType: 'settings_button_pressed'
    });
  });
  const handleRefreshClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    reloadFrame(activeWebApp.url);
  });
  const handleModalClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    closeWebAppModal();
  });
  const handleCloseMoreAppsTab = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    closeMoreAppsTab();
  });
  const handleTabClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    if (openTabsCount > 1) {
      closeActiveWebApp();
    } else {
      closeWebAppModal();
    }
  });
  const handleToggleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    if (attachBot) {
      const key = (0,_global_helpers_bots__WEBPACK_IMPORTED_MODULE_3__.getWebAppKey)(activeWebApp);
      updateWebApp({
        key,
        update: {
          isRemoveModalOpen: true
        }
      });
      return;
    }
    toggleAttachBot({
      botId: bot.id,
      isEnabled: true
    });
  });
  const handleBackClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    if (isBackButtonVisible) {
      sendEvent({
        eventType: 'back_button_pressed'
      });
    } else {
      handleModalClose();
    }
  });
  const handleCollapseClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    changeWebAppModalState({
      state: 'minimized'
    });
  });
  const handleFullscreenClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    changeWebAppModalState({
      state: 'fullScreen'
    });
  });
  const handleOpenMoreAppsTabClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    openMoreAppsTab();
  });
  const handleTabClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(tab => {
    openWebAppTab({
      webApp: tab.webApp
    });
  });
  const openBotChat = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_16__["default"])(() => {
    openChat({
      id: bot.id
    });
  });
  const MoreMenuButton = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return ({
      onTrigger,
      isOpen: isMenuOpen
    }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_20__["default"], {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(supportMultiTabMode ? _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabMoreButton : _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].moreButton, isMenuOpen && 'active'),
      round: true,
      ripple: !isMobile,
      size: supportMultiTabMode ? 'tiny' : 'smaller',
      color: "translucent",
      onClick: onTrigger,
      ariaLabel: "More actions"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
      name: "more"
    }));
  }, [isMobile, supportMultiTabMode]);
  function renderMenuItems() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, chat && bot && chat.id !== bot.id && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_23__["default"], {
      icon: "bots",
      onClick: openBotChat
    }, oldLang('BotWebViewOpenBot')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_23__["default"], {
      icon: "reload",
      onClick: handleRefreshClick
    }, oldLang('WebApp.ReloadPage')), isSettingsButtonVisible && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_23__["default"], {
      icon: "settings",
      onClick: handleSettingsButtonClick
    }, oldLang('Settings')), bot?.isAttachBot && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_23__["default"], {
      icon: attachBot ? 'stop' : 'install',
      onClick: handleToggleClick,
      destructive: Boolean(attachBot)
    }, oldLang(attachBot ? 'WebApp.RemoveBot' : 'WebApp.AddToAttachmentAdd')));
  }
  function renderMoreMenu() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Menu__WEBPACK_IMPORTED_MODULE_22__["default"], {
      isOpen: isContextMenuOpen,
      anchor: contextMenuAnchor,
      ref: menuRef,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(supportMultiTabMode ? _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].webAppTabMoreMenu : 'web-app-more-menu', 'with-menu-transitions'),
      getTriggerElement: getTriggerElement,
      getMenuElement: getMenuElement,
      getRootElement: getRootElement,
      autoClose: true,
      onClose: handleContextMenuClose,
      onCloseAnimationEnd: handleContextMenuHide
    }, renderMenuItems());
  }
  function renderDropdownMoreMenu() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_21__["default"], {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(supportMultiTabMode ? _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].webAppTabMoreMenu : 'web-app-more-menu', 'with-menu-transitions'),
      trigger: MoreMenuButton,
      positionX: supportMultiTabMode ? 'left' : 'right'
    }, renderMenuItems());
  }
  const backButtonClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].closeIcon, isBackButtonVisible && _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].stateBack);
  const headerTextVar = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (isMoreAppsTabActive) return 'color-text';
    if (!headerColor) return undefined;
    const {
      r,
      g,
      b
    } = (0,_util_switchTheme__WEBPACK_IMPORTED_MODULE_8__.hexToRgb)(headerColor);
    const luma = (0,_util_colors__WEBPACK_IMPORTED_MODULE_7__.getColorLuma)([r, g, b]);
    const adaptedLuma = theme === 'dark' ? 255 - luma : luma;
    return adaptedLuma > LUMA_THRESHOLD ? 'color-text' : 'color-background';
  }, [headerColor, theme, isMoreAppsTabActive]);
  function renderTabCurveBorder(className) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("svg", {
      className: className,
      width: "16",
      height: "16",
      viewBox: "0 0 16 16",
      fill: "none"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("path", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabButtonCurvePath,
      "fill-rule": "evenodd",
      "clip-rule": "evenodd",
      d: "M16 16V0C16 12 12 16 0 16H16Z"
    }));
  }
  function renderActiveTab() {
    const style = (0,_util_buildStyle__WEBPACK_IMPORTED_MODULE_6__["default"])(headerTextVar && `--color-header-text: var(--${headerTextVar})`, headerColor && `--active-tab-background: ${headerColor}`);
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabButtonWrapper,
      style: style
    }, renderTabCurveBorder(_WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabButtonLeftCurve), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabButton
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].avatarContainer
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_18__["default"], {
      size: "mini",
      peer: bot
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(MoreMenuButton, {
      onTrigger: handleContextMenu,
      isOpen: isContextMenuOpen
    })), attachBot?.shortName ?? bot?.firstName, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabRightMask
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_20__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabCloseButton,
      round: true,
      color: "translucent",
      size: "tiny",
      ariaLabel: oldLang('Close'),
      onClick: handleTabClose
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabCloseIcon,
      name: "close"
    }))), renderTabCurveBorder(_WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabButtonRightCurve));
  }
  function renderMoreAppsTab() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabButtonWrapper
    }, renderTabCurveBorder(_WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabButtonLeftCurve), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabButton
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].moreAppsTabIcon
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].icon,
      name: "add"
    })), lang('OpenApp'), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabRightMask
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_20__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabCloseButton,
      round: true,
      color: "translucent",
      size: "tiny",
      ariaLabel: oldLang('Close'),
      onClick: handleCloseMoreAppsTab
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabCloseIcon,
      name: "close"
    }))), renderTabCurveBorder(_WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabButtonRightCurve));
  }
  function renderMoreAppsButton() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_20__["default"], {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].moreAppsButton, 'no-drag'),
      round: true,
      color: "translucent",
      size: "tiny",
      onClick: handleOpenMoreAppsTabClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].icon,
      name: "add"
    }));
  }

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_hooks_useHorizontalScroll__WEBPACK_IMPORTED_MODULE_14__["default"])(containerRef, !isOpen || isMinimizedState || !containerRef.current);
  function renderTabs() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabs,
      ref: containerRef
    }, tabs?.map(tab => tab.isOpen ? renderActiveTab() : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_18__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].tabAvatar,
      size: "mini",
      peer: tab.bot
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => handleTabClick(tab)
    })), isMoreAppsTabActive && renderMoreAppsTab());
  }
  function renderHeader() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      ref: headerRef
    }, !supportMultiTabMode ? renderSinglePageModeHeader() : isMaximizedState ? renderMultiTabHeader() : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MinimizedWebAppModal__WEBPACK_IMPORTED_MODULE_25__["default"], null));
  }
  function renderMultiTabHeader() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('modal-header', 'multiTab'),
      style: (0,_util_buildStyle__WEBPACK_IMPORTED_MODULE_6__["default"])(headerTextVar && `--color-header-text: var(--${headerTextVar})`)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_20__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].headerButton,
      round: true,
      color: "translucent",
      size: "tiny",
      ariaLabel: oldLang(isBackButtonVisible ? 'Back' : 'Close'),
      onClick: handleBackClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: backButtonClassName
    })), renderTabs(), renderMoreMenu(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].toolBar
    }, !isMoreAppsTabActive && renderMoreAppsButton(), !isMoreAppsTabActive && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_20__["default"], {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].windowStateButton, _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].fullscreenButton, 'no-drag'),
      round: true,
      color: "translucent",
      size: "tiny",
      onClick: handleFullscreenClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].stateIcon,
      name: "expand-modal"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_20__["default"], {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].windowStateButton, 'no-drag'),
      round: true,
      color: "translucent",
      size: "tiny",
      onClick: handleCollapseClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_19__["default"], {
      className: _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].stateIcon,
      name: "collapse-modal"
    }))));
  }
  function renderSinglePageModeHeader() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header",
      style: (0,_util_buildStyle__WEBPACK_IMPORTED_MODULE_6__["default"])(headerColor && `background-color: ${headerColor}`, headerTextVar && `--color-header-text: var(--${headerTextVar})`)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_20__["default"], {
      round: true,
      color: "translucent",
      size: "smaller",
      ariaLabel: oldLang(isBackButtonVisible ? 'Back' : 'Close'),
      onClick: handleBackClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: backButtonClassName
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-title"
    }, attachBot?.shortName ?? bot?.firstName), !isMoreAppsTabActive && renderDropdownMoreMenu());
  }
  function buildResizeHandleClass(handleClassName) {
    return (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_config__WEBPACK_IMPORTED_MODULE_2__.RESIZE_HANDLE_CLASS_NAME, handleClassName);
  }
  function renderResizeHandles() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: buildResizeHandleClass('top')
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: buildResizeHandleClass('bottom')
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: buildResizeHandleClass('left')
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: buildResizeHandleClass('right')
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: buildResizeHandleClass('topLeft')
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: buildResizeHandleClass('topRight')
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: buildResizeHandleClass('bottomLeft')
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: buildResizeHandleClass('bottomRight')
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_24__["default"], {
    dialogRef: ref,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].root, supportMultiTabMode && _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].multiTab, isMinimizedState && _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].minimized, isFullScreen && _WebAppModal_module_scss__WEBPACK_IMPORTED_MODULE_28__["default"].fullScreen),
    dialogStyle: supportMultiTabMode ? draggableStyle : undefined,
    dialogContent: isDraggingEnabled ? renderResizeHandles() : undefined,
    isOpen: isOpen,
    isLowStackPriority: true,
    onClose: handleModalClose,
    header: renderHeader(),
    style: `background-color: ${backgroundColor || 'var(--color-background)'}`,
    noBackdrop: true,
    noBackdropClose: true
  }, isFullScreen && renderMoreMenu(), openedWebApps && sessionKeys?.map(key => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_WebAppModalTabContent__WEBPACK_IMPORTED_MODULE_27__["default"], {
    key: key,
    modal: modal,
    registerSendEventCallback: registerSendEventCallback,
    registerReloadFrameCallback: registerReloadFrameCallback,
    webApp: openedWebApps[key],
    isTransforming: isDragging || isResizing,
    onContextMenuButtonClick: handleContextMenu,
    isMultiTabSupported: supportMultiTabMode,
    modalHeight: currentHeight
  })), isMoreAppsTabActive && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_MoreAppsTabContent__WEBPACK_IMPORTED_MODULE_26__["default"], null));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  modal
}) => {
  const activeWebApp = modal?.activeWebAppKey ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectWebApp)(global, modal.activeWebAppKey) : undefined;
  const {
    botId: activeBotId
  } = activeWebApp || {};
  const attachBot = activeBotId ? global.attachMenu.bots[activeBotId] : undefined;
  const bot = activeBotId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectUser)(global, activeBotId) : undefined;
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectCurrentChat)(global);
  const theme = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTheme)(global);
  const cachedPosition = global.settings.miniAppsCachedPosition;
  const cachedSize = global.settings.miniAppsCachedSize;
  return {
    attachBot,
    bot,
    chat,
    theme,
    cachedPosition,
    cachedSize
  };
})(WebAppModal)));

/***/ }),

/***/ "./src/components/modals/webApp/WebAppModalTabContent.tsx":
/*!****************************************************************!*\
  !*** ./src/components/modals/webApp/WebAppModalTabContent.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_helpers_bots__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers/bots */ "./src/global/helpers/bots.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_download__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/download */ "./src/util/download.ts");
/* harmony import */ var _util_themeStyle__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/themeStyle */ "./src/util/themeStyle.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _api_gramjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../api/gramjs */ "./src/api/gramjs/index.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../hooks/useEffectWithPrevDeps */ "./src/hooks/useEffectWithPrevDeps.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../hooks/useSyncEffect */ "./src/hooks/useSyncEffect.ts");
/* harmony import */ var _hooks_window_useFullscreen__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../../hooks/window/useFullscreen */ "./src/hooks/window/useFullscreen.ts");
/* harmony import */ var _hooks_usePopupLimit__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./hooks/usePopupLimit */ "./src/components/modals/webApp/hooks/usePopupLimit.ts");
/* harmony import */ var _hooks_useWebAppFrame__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./hooks/useWebAppFrame */ "./src/components/modals/webApp/hooks/useWebAppFrame.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./WebAppModalTabContent.module.scss */ "./src/components/modals/webApp/WebAppModalTabContent.module.scss");






























const NBSP = '\u00A0';
const MAIN_BUTTON_ANIMATION_TIME = 250;
const ANIMATION_WAIT = 400;
const COLLAPSING_WAIT = 350;
const POPUP_SEQUENTIAL_LIMIT = 3;
const POPUP_RESET_DELAY = 2000; // 2s
const APP_NAME_DISPLAY_DURATION = 3800;
const SANDBOX_ATTRIBUTES = ['allow-scripts', 'allow-same-origin', 'allow-popups', 'allow-forms', 'allow-modals', 'allow-storage-access-by-user-activation'].join(' ');
const DEFAULT_BUTTON_TEXT = {
  ok: 'OK',
  cancel: 'Cancel',
  close: 'Close'
};
const WebAppModalTabContent = ({
  modal,
  webApp,
  bot,
  theme,
  isPaymentModalOpen,
  paymentStatus,
  registerSendEventCallback,
  registerReloadFrameCallback,
  isTransforming,
  modalState,
  isMultiTabSupported,
  onContextMenuButtonClick,
  botAppPermissions,
  botAppSettings,
  modalHeight
}) => {
  const {
    closeActiveWebApp,
    sendWebViewData,
    toggleAttachBot,
    openTelegramLink,
    setWebAppPaymentSlug,
    switchBotInline,
    sharePhoneWithBot,
    updateWebApp,
    resetPaymentStatus,
    openChatWithInfo,
    showNotification,
    openEmojiStatusAccessModal,
    openLocationAccessModal,
    changeWebAppModalState,
    closeWebAppModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [mainButton, setMainButton] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [secondaryButton, setSecondaryButton] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [isLoaded, markLoaded, markUnloaded] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_15__["default"])(false);
  const [popupParameters, setPopupParameters] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [isRequestingPhone, setIsRequestingPhone] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isRequestingWriteAccess, setIsRequestingWriteAccess] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [requestedFileDownload, setRequestedFileDownload] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [bottomBarColor, setBottomBarColor] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const {
    unlockPopupsAt,
    handlePopupOpened,
    handlePopupClosed
  } = (0,_hooks_usePopupLimit__WEBPACK_IMPORTED_MODULE_21__["default"])(POPUP_SEQUENTIAL_LIMIT, POPUP_RESET_DELAY);

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);

  // eslint-disable-next-line no-null/no-null
  const headerButtonRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);

  // eslint-disable-next-line no-null/no-null
  const headerButtonCaptionRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const isFullscreen = modalState === 'fullScreen';
  const isMinimizedState = modalState === 'minimized';
  const exitFullScreenCallback = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    setTimeout(() => {
      changeWebAppModalState({
        state: 'maximized'
      });
    }, COLLAPSING_WAIT);
  });

  // eslint-disable-next-line no-null/no-null
  const fullscreenElementRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    fullscreenElementRef.current = document.querySelector('#portals');
  }, []);
  const [, setFullscreen, exitFullscreen] = (0,_hooks_window_useFullscreen__WEBPACK_IMPORTED_MODULE_20__["default"])(fullscreenElementRef, exitFullScreenCallback);
  const activeWebApp = modal?.activeWebAppKey ? modal.openedWebApps[modal.activeWebAppKey] : undefined;
  const activeWebAppName = activeWebApp?.appName;
  const {
    url,
    buttonText,
    isBackButtonVisible
  } = webApp || {};
  const {
    placeholderPath
  } = botAppSettings || {};
  const isCloseModalOpen = Boolean(webApp?.isCloseModalOpen);
  const isRemoveModalOpen = Boolean(webApp?.isRemoveModalOpen);
  const webAppKey = webApp && (0,_global_helpers_bots__WEBPACK_IMPORTED_MODULE_4__.getWebAppKey)(webApp);
  const activeWebAppKey = activeWebApp && (0,_global_helpers_bots__WEBPACK_IMPORTED_MODULE_4__.getWebAppKey)(activeWebApp);
  const isActive = activeWebApp && webApp && activeWebAppKey === webAppKey;
  const isAvailable = _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_9__.IS_GEOLOCATION_SUPPORTED;
  const isAccessRequested = botAppPermissions?.geolocation !== undefined;
  const isAccessGranted = Boolean(botAppPermissions?.geolocation);
  const updateCurrentWebApp = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(updatedPartialWebApp => {
    if (!webAppKey) return;
    updateWebApp({
      key: webAppKey,
      update: updatedPartialWebApp
    });
  });
  const themeParams = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return (0,_util_themeStyle__WEBPACK_IMPORTED_MODULE_8__.extractCurrentThemeParams)();
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps
  }, [theme]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setBottomBarColor(themeParams.secondary_bg_color);
  }, [themeParams]);
  const themeBackgroundColor = themeParams.bg_color;
  const [backgroundColorFromEvent, setBackgroundColorFromEvent] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const backgroundColorFromSettings = theme === 'light' ? botAppSettings?.backgroundColor : botAppSettings?.backgroundDarkColor;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const color = backgroundColorFromEvent || backgroundColorFromSettings || themeBackgroundColor;
    updateCurrentWebApp({
      backgroundColor: color
    });
  }, [themeBackgroundColor, backgroundColorFromEvent, backgroundColorFromSettings]);
  const themeHeaderColor = themeParams.bg_color;
  const [headerColorFromEvent, setHeaderColorFromEvent] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const headerColorFromSettings = theme === 'light' ? botAppSettings?.headerColor : botAppSettings?.headerDarkColor;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const color = headerColorFromEvent || headerColorFromSettings || themeHeaderColor;
    updateCurrentWebApp({
      headerColor: color
    });
  }, [themeHeaderColor, headerColorFromEvent, headerColorFromSettings]);

  // eslint-disable-next-line no-null/no-null
  const frameRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_18__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_16__["default"])();
  const isOpen = modal?.isModalOpen || false;
  const isSimple = Boolean(buttonText);
  const {
    reloadFrame,
    sendEvent,
    sendFullScreenChanged,
    sendViewport,
    sendSafeArea,
    sendTheme
  } = (0,_hooks_useWebAppFrame__WEBPACK_IMPORTED_MODULE_22__["default"])(frameRef, isOpen, isFullscreen, isSimple, handleEvent, webApp, markLoaded);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isActive) registerSendEventCallback(sendEvent);
  }, [sendEvent, registerSendEventCallback, isActive]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isActive) registerReloadFrameCallback(reloadFrame);
  }, [reloadFrame, registerReloadFrameCallback, isActive]);
  const isMainButtonVisible = isLoaded && mainButton?.isVisible && mainButton.text.trim().length > 0;
  const isSecondaryButtonVisible = isLoaded && secondaryButton?.isVisible && secondaryButton.text.trim().length > 0;
  const handleHideCloseModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    updateCurrentWebApp({
      isCloseModalOpen: false
    });
  });
  const handleConfirmCloseModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    updateCurrentWebApp({
      shouldConfirmClosing: false,
      isCloseModalOpen: false
    });
    setTimeout(() => {
      closeActiveWebApp();
    }, ANIMATION_WAIT);
  });
  const handleHideRemoveModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    updateCurrentWebApp({
      isRemoveModalOpen: false
    });
  });
  const handleMainButtonClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    sendEvent({
      eventType: 'main_button_pressed'
    });
  });
  const handleSecondaryButtonClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    sendEvent({
      eventType: 'secondary_button_pressed'
    });
  });
  const handleAppPopupClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(buttonId => {
    setPopupParameters(undefined);
    handlePopupClosed();
    sendEvent({
      eventType: 'popup_closed',
      eventData: {
        button_id: buttonId
      }
    });
  });
  const handleAppPopupModalClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    handleAppPopupClose();
  });
  const sendThemeCallback = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    sendTheme();
  });

  // Notify view that theme changed
  (0,_hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_19__["default"])(() => {
    setTimeout(() => {
      sendThemeCallback();
    }, ANIMATION_WAIT);
  }, [theme]);
  const setFullscreenCallback = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    if (!(0,_hooks_window_useFullscreen__WEBPACK_IMPORTED_MODULE_20__.checkIfFullscreen)() && isActive) {
      setFullscreen?.();
    }
  });
  const exitIfFullscreenCallback = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    if ((0,_hooks_window_useFullscreen__WEBPACK_IMPORTED_MODULE_20__.checkIfFullscreen)() && isActive) {
      exitFullscreen?.();
    }
  });
  const sendFullScreenChangedCallback = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(value => {
    if (isActive) sendFullScreenChanged(value);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isFullscreen) {
      setFullscreenCallback();
      sendFullScreenChangedCallback(true);
    } else {
      exitIfFullscreenCallback();
      sendFullScreenChangedCallback(false);
    }
  }, [isFullscreen]);
  const visibilityChangedCallBack = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(visibility => {
    sendEvent({
      eventType: 'visibility_changed',
      eventData: {
        is_visible: visibility
      }
    });
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isLoaded) {
      visibilityChangedCallBack(Boolean(isActive));
    }
  }, [isActive, isLoaded]);
  (0,_hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_14__["default"])(([prevModalState]) => {
    if (modalState === 'minimized') {
      visibilityChangedCallBack(false);
    }
    if (modalState && prevModalState === 'minimized') {
      visibilityChangedCallBack(true);
    }
  }, [modalState]);
  (0,_hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_19__["default"])(([prevIsPaymentModalOpen]) => {
    if (isPaymentModalOpen === prevIsPaymentModalOpen) return;
    if (webApp?.slug && !isPaymentModalOpen && paymentStatus) {
      sendEvent({
        eventType: 'invoice_closed',
        eventData: {
          slug: webApp.slug,
          status: paymentStatus
        }
      });
      setWebAppPaymentSlug({
        slug: undefined
      });
      resetPaymentStatus();
    }
  }, [isPaymentModalOpen, paymentStatus, sendEvent, webApp?.slug]);
  const handleRemoveAttachBot = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    toggleAttachBot({
      botId: bot.id,
      isEnabled: false
    });
    closeActiveWebApp();
  });
  const handleRejectPhone = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    setIsRequestingPhone(false);
    handlePopupClosed();
    sendEvent({
      eventType: 'phone_requested',
      eventData: {
        status: 'cancelled'
      }
    });
  });
  const handleAcceptPhone = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    sharePhoneWithBot({
      botId: bot.id
    });
    setIsRequestingPhone(false);
    handlePopupClosed();
    sendEvent({
      eventType: 'phone_requested',
      eventData: {
        status: 'sent'
      }
    });
  });
  const handleRejectFileDownload = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(shouldCloseActive => {
    if (shouldCloseActive) {
      setRequestedFileDownload(undefined);
      handlePopupClosed();
    }
    sendEvent({
      eventType: 'file_download_requested',
      eventData: {
        status: 'cancelled'
      }
    });
  });
  const handleRejectWriteAccess = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    sendEvent({
      eventType: 'write_access_requested',
      eventData: {
        status: 'cancelled'
      }
    });
    setIsRequestingWriteAccess(false);
    handlePopupClosed();
  });
  const handleAcceptWriteAccess = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(async () => {
    if (!bot) return;
    const result = await (0,_api_gramjs__WEBPACK_IMPORTED_MODULE_10__.callApi)('allowBotSendMessages', {
      bot
    });
    if (!result) {
      handleRejectWriteAccess();
      return;
    }
    sendEvent({
      eventType: 'write_access_requested',
      eventData: {
        status: 'allowed'
      }
    });
    setIsRequestingWriteAccess(false);
    handlePopupClosed();
  });
  async function handleRequestWriteAccess() {
    if (!bot) return;
    const canWrite = await (0,_api_gramjs__WEBPACK_IMPORTED_MODULE_10__.callApi)('fetchBotCanSendMessage', {
      bot
    });
    if (canWrite) {
      sendEvent({
        eventType: 'write_access_requested',
        eventData: {
          status: 'allowed'
        }
      });
    }
    setIsRequestingWriteAccess(!canWrite);
  }
  async function handleCheckDownloadFile(fileUrl, fileName) {
    const canDownload = await (0,_api_gramjs__WEBPACK_IMPORTED_MODULE_10__.callApi)('checkBotDownloadFileParams', {
      bot: bot,
      url: fileUrl,
      fileName
    });
    if (!canDownload) {
      sendEvent({
        eventType: 'file_download_requested',
        eventData: {
          status: 'cancelled'
        }
      });
      return;
    }
    setRequestedFileDownload({
      url: fileUrl,
      fileName
    });
    handlePopupOpened();
  }
  const handleDownloadFile = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    if (!requestedFileDownload) return;
    setRequestedFileDownload(undefined);
    handlePopupClosed();
    (0,_util_download__WEBPACK_IMPORTED_MODULE_7__["default"])(requestedFileDownload.url, requestedFileDownload.fileName);
    sendEvent({
      eventType: 'file_download_requested',
      eventData: {
        status: 'downloading'
      }
    });
  });
  async function handleInvokeCustomMethod(requestId, method, parameters) {
    const result = await (0,_api_gramjs__WEBPACK_IMPORTED_MODULE_10__.callApi)('invokeWebViewCustomMethod', {
      bot: bot,
      customMethod: method,
      parameters
    });
    sendEvent({
      eventType: 'custom_method_invoked',
      eventData: {
        req_id: requestId,
        ...result
      }
    });
  }
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      setPopupParameters(undefined);
      setIsRequestingPhone(false);
      setIsRequestingWriteAccess(false);
      setMainButton(undefined);
      setSecondaryButton(undefined);
      updateCurrentWebApp({
        isSettingsButtonVisible: false,
        shouldConfirmClosing: false,
        isBackButtonVisible: false,
        isCloseModalOpen: false,
        isRemoveModalOpen: false
      });
      markUnloaded();
    }
  }, [isOpen]);
  const handleOpenChat = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    openChatWithInfo({
      id: bot.id
    });
  });
  function handleEvent(event) {
    const {
      eventType,
      eventData
    } = event;
    if (eventType === 'web_app_request_fullscreen') {
      if ((0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_12__.getIsWebAppsFullscreenSupported)()) {
        changeWebAppModalState({
          state: 'fullScreen'
        });
      } else {
        sendEvent({
          eventType: 'fullscreen_failed',
          eventData: {
            error: 'UNSUPPORTED'
          }
        });
      }
    }
    if (eventType === 'web_app_exit_fullscreen') {
      exitIfFullscreenCallback();
    }
    if (eventType === 'web_app_open_tg_link') {
      const linkUrl = _config__WEBPACK_IMPORTED_MODULE_2__.TME_LINK_PREFIX + eventData.path_full;
      openTelegramLink({
        url: linkUrl,
        shouldIgnoreCache: eventData.force_request
      });
      closeActiveWebApp();
    }
    if (eventType === 'web_app_setup_back_button') {
      updateCurrentWebApp({
        isBackButtonVisible: eventData.is_visible
      });
    }
    if (eventType === 'web_app_setup_settings_button') {
      updateCurrentWebApp({
        isSettingsButtonVisible: eventData.is_visible
      });
    }
    if (eventType === 'web_app_set_background_color') {
      setBackgroundColorFromEvent((0,_util_themeStyle__WEBPACK_IMPORTED_MODULE_8__.validateHexColor)(eventData.color) ? eventData.color : undefined);
    }
    if (eventType === 'web_app_set_header_color') {
      const key = eventData.color_key;
      setHeaderColorFromEvent(eventData.color || (key ? themeParams[key] : undefined));
    }
    if (eventType === 'web_app_set_bottom_bar_color') {
      setBottomBarColor(eventData.color);
    }
    if (eventType === 'web_app_data_send') {
      closeActiveWebApp();
      sendWebViewData({
        bot: bot,
        buttonText: buttonText,
        data: eventData.data
      });
    }
    if (eventType === 'web_app_setup_main_button') {
      const color = eventData.color;
      const textColor = eventData.text_color;
      setMainButton({
        isVisible: eventData.is_visible && Boolean(eventData.text?.trim().length),
        isActive: eventData.is_active,
        text: eventData.text,
        color,
        textColor,
        isProgressVisible: eventData.is_progress_visible
      });
    }
    if (eventType === 'web_app_setup_secondary_button') {
      const color = eventData.color;
      const textColor = eventData.text_color;
      setSecondaryButton({
        isVisible: eventData.is_visible && Boolean(eventData.text?.trim().length),
        isActive: eventData.is_active,
        text: eventData.text,
        color,
        textColor,
        isProgressVisible: eventData.is_progress_visible,
        position: eventData.position
      });
    }
    if (eventType === 'web_app_setup_closing_behavior') {
      updateCurrentWebApp({
        shouldConfirmClosing: true
      });
    }
    if (eventType === 'web_app_open_popup') {
      if (popupParameters || !eventData.message.trim().length || !eventData.buttons?.length || eventData.buttons.length > 3 || isRequestingPhone || isRequestingWriteAccess || unlockPopupsAt > Date.now()) {
        handleAppPopupClose(undefined);
        return;
      }
      setPopupParameters(eventData);
      handlePopupOpened();
    }
    if (eventType === 'web_app_switch_inline_query') {
      const filter = eventData.chat_types?.map(_global_helpers__WEBPACK_IMPORTED_MODULE_3__.convertToApiChatType).filter(Boolean);
      const isSamePeer = !filter?.length;
      switchBotInline({
        botId: bot.id,
        query: eventData.query,
        filter,
        isSamePeer
      });
      closeActiveWebApp();
    }
    if (eventType === 'web_app_request_phone') {
      if (popupParameters || isRequestingWriteAccess || unlockPopupsAt > Date.now()) {
        handleRejectPhone();
        return;
      }
      setIsRequestingPhone(true);
      handlePopupOpened();
    }
    if (eventType === 'web_app_request_write_access') {
      if (popupParameters || isRequestingPhone || unlockPopupsAt > Date.now()) {
        handleRejectWriteAccess();
        return;
      }
      handleRequestWriteAccess();
      handlePopupOpened();
    }
    if (eventType === 'web_app_invoke_custom_method') {
      const {
        method,
        params,
        req_id: requestId
      } = eventData;
      handleInvokeCustomMethod(requestId, method, JSON.stringify(params));
    }
    if (eventType === 'web_app_request_file_download') {
      if (requestedFileDownload || unlockPopupsAt > Date.now()) {
        handleRejectFileDownload();
        return;
      }
      handleCheckDownloadFile(eventData.url, eventData.file_name);
    }
    if (eventType === 'web_app_request_emoji_status_access') {
      if (!bot) return;
      openEmojiStatusAccessModal({
        bot,
        webAppKey
      });
    }
    if (eventType === 'web_app_check_location') {
      const handleGeolocationCheck = () => {
        sendEvent({
          eventType: 'location_checked',
          eventData: {
            available: isAvailable,
            access_requested: isAccessRequested,
            access_granted: isAccessGranted
          }
        });
      };
      handleGeolocationCheck();
    }
    if (eventType === 'web_app_request_location') {
      const handleRequestLocation = async () => {
        const geolocationData = await (0,_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_9__.getGeolocationStatus)();
        const {
          accessRequested,
          accessGranted,
          geolocation
        } = geolocationData;
        if (!accessGranted || !accessRequested) {
          sendEvent({
            eventType: 'location_requested',
            eventData: {
              available: false
            }
          });
          showNotification({
            message: oldLang('PermissionNoLocationPosition')
          });
          handleAppPopupClose(undefined);
          return;
        }
        if (isAvailable) {
          if (isAccessRequested) {
            sendEvent({
              eventType: 'location_requested',
              eventData: {
                available: botAppPermissions?.geolocation,
                latitude: geolocation?.latitude,
                longitude: geolocation?.longitude,
                altitude: geolocation?.altitude,
                course: geolocation?.heading,
                speed: geolocation?.speed,
                horizontal_accuracy: geolocation?.accuracy,
                vertical_accuracy: geolocation?.accuracy
              }
            });
          } else {
            openLocationAccessModal({
              bot,
              webAppKey
            });
          }
        } else {
          showNotification({
            message: oldLang('PermissionNoLocationPosition')
          });
          handleAppPopupClose(undefined);
        }
      };
      handleRequestLocation();
    }
    if (eventType === 'web_app_open_location_settings') {
      handleOpenChat();
    }
  }
  const mainButtonCurrentColor = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__["default"])(mainButton?.color, true);
  const mainButtonCurrentTextColor = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__["default"])(mainButton?.textColor, true);
  const mainButtonCurrentIsActive = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__["default"])(mainButton && Boolean(mainButton.isActive), true);
  const mainButtonCurrentText = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__["default"])(mainButton?.text, true);
  const secondaryButtonCurrentPosition = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__["default"])(secondaryButton?.position, true);
  const secondaryButtonCurrentColor = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__["default"])(secondaryButton?.color, true);
  const secondaryButtonCurrentTextColor = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__["default"])(secondaryButton?.textColor, true);
  const secondaryButtonCurrentIsActive = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__["default"])(secondaryButton && Boolean(secondaryButton.isActive), true);
  const secondaryButtonCurrentText = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_13__["default"])(secondaryButton?.text, true);
  const [shouldDecreaseWebFrameSize, setShouldDecreaseWebFrameSize] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [shouldHideMainButton, setShouldHideMainButton] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [shouldHideSecondaryButton, setShouldHideSecondaryButton] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [shouldShowMainButton, setShouldShowMainButton] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [shouldShowSecondaryButton, setShouldShowSecondaryButton] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [shouldShowAppNameInFullscreen, setShouldShowAppNameInFullscreen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [backButtonTextWidth, setBackButtonTextWidth] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);

  // Notify view that height changed
  (0,_hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_19__["default"])(() => {
    setTimeout(() => {
      sendViewport();
      sendSafeArea();
    }, isTransforming ? 0 : ANIMATION_WAIT);
  }, [shouldShowSecondaryButton, shouldHideSecondaryButton, shouldShowMainButton, shouldShowMainButton, secondaryButton?.position, sendViewport, isTransforming, modalHeight, sendSafeArea]);
  const isVerticalLayout = secondaryButtonCurrentPosition === 'top' || secondaryButtonCurrentPosition === 'bottom';
  const isHorizontalLayout = !isVerticalLayout;
  const rowsCount = isVerticalLayout && shouldShowMainButton && shouldShowSecondaryButton ? 2 : shouldShowMainButton || shouldShowSecondaryButton ? 1 : 0;
  const hideDirection = isHorizontalLayout && !shouldHideMainButton && !shouldHideSecondaryButton ? 'horizontal' : 'vertical';
  const mainButtonChangeTimeout = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const mainButtonFastTimeout = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const secondaryButtonChangeTimeout = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const secondaryButtonFastTimeout = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const appNameDisplayTimeout = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isFullscreen && isOpen && Boolean(activeWebAppName)) {
      setShouldShowAppNameInFullscreen(true);
      if (appNameDisplayTimeout.current) {
        clearTimeout(appNameDisplayTimeout.current);
      }
      appNameDisplayTimeout.current = setTimeout(() => {
        setShouldShowAppNameInFullscreen(false);
        appNameDisplayTimeout.current = undefined;
      }, APP_NAME_DISPLAY_DURATION);
    } else {
      setShouldShowAppNameInFullscreen(false);
      if (appNameDisplayTimeout.current) {
        clearTimeout(appNameDisplayTimeout.current);
        appNameDisplayTimeout.current = undefined;
      }
    }
    return () => {
      if (appNameDisplayTimeout.current) {
        clearTimeout(appNameDisplayTimeout.current);
      }
    };
  }, [isFullscreen, isOpen, activeWebAppName]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (mainButtonChangeTimeout.current) clearTimeout(mainButtonChangeTimeout.current);
    if (mainButtonFastTimeout.current) clearTimeout(mainButtonFastTimeout.current);
    if (isMainButtonVisible) {
      mainButtonFastTimeout.current = setTimeout(() => {
        setShouldShowMainButton(true);
      }, 35);
      setShouldHideMainButton(false);
      mainButtonChangeTimeout.current = setTimeout(() => {
        setShouldDecreaseWebFrameSize(true);
      }, MAIN_BUTTON_ANIMATION_TIME);
    }
    if (!isMainButtonVisible) {
      setShouldShowMainButton(false);
      mainButtonChangeTimeout.current = setTimeout(() => {
        setShouldHideMainButton(true);
      }, MAIN_BUTTON_ANIMATION_TIME);
    }
  }, [isMainButtonVisible]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (secondaryButtonChangeTimeout.current) clearTimeout(secondaryButtonChangeTimeout.current);
    if (secondaryButtonFastTimeout.current) clearTimeout(secondaryButtonFastTimeout.current);
    if (isSecondaryButtonVisible) {
      secondaryButtonFastTimeout.current = setTimeout(() => {
        setShouldShowSecondaryButton(true);
      }, 35);
      setShouldHideSecondaryButton(false);
      secondaryButtonChangeTimeout.current = setTimeout(() => {
        setShouldDecreaseWebFrameSize(true);
      }, MAIN_BUTTON_ANIMATION_TIME);
    }
    if (!isSecondaryButtonVisible) {
      setShouldShowSecondaryButton(false);
      secondaryButtonChangeTimeout.current = setTimeout(() => {
        setShouldHideSecondaryButton(true);
      }, MAIN_BUTTON_ANIMATION_TIME);
    }
  }, [isSecondaryButtonVisible]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!shouldShowSecondaryButton && !shouldShowMainButton) {
      setShouldDecreaseWebFrameSize(false);
    }
  }, [setShouldDecreaseWebFrameSize, shouldShowSecondaryButton, shouldShowMainButton]);
  const frameStyle = isTransforming ? 'pointer-events: none;' : '';
  const handleBackClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    if (isBackButtonVisible) {
      sendEvent({
        eventType: 'back_button_pressed'
      });
    } else {
      exitIfFullscreenCallback();
      sendFullScreenChanged(false);
      changeWebAppModalState({
        state: 'maximized'
      });
      closeWebAppModal();
    }
  });
  const handleCollapseClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    exitIfFullscreenCallback();
  });
  const handleShowContextMenu = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(e => {
    onContextMenuButtonClick(e);
  });
  const backIconClass = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].closeIcon, isBackButtonVisible && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].stateBack);
  const backButtonCaption = shouldShowAppNameInFullscreen ? activeWebAppName : oldLang(isBackButtonVisible ? 'Back' : 'Close');
  const hasHeaderElement = headerButtonCaptionRef?.current;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const width = headerButtonCaptionRef?.current?.clientWidth || 0;
    setBackButtonTextWidth(width);
  }, [backButtonCaption, hasHeaderElement]);
  function getBackButtonActiveKey() {
    if (shouldShowAppNameInFullscreen) return 0;
    return isBackButtonVisible ? 1 : 2;
  }
  function renderFullscreenBackButtonCaption() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].buttonCaptionContainer,
      style: `width: ${backButtonTextWidth}px;`
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_28__["default"], {
      activeKey: getBackButtonActiveKey(),
      name: "slideFade"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      ref: headerButtonCaptionRef,
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].backButtonCaption
    }, backButtonCaption)));
  }
  function renderFullscreenHeaderPanel() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].headerPanel
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      ref: headerButtonRef,
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].headerButton,
      onClick: handleBackClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].backIconContainer
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: backIconClass
    })), renderFullscreenBackButtonCaption()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].headerSplitButton
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].headerButton, _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].left)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_23__["default"], {
      name: "down",
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].icon, _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].collapseIcon),
      onClick: handleCollapseClick
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].headerButton, _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].right)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_23__["default"], {
      name: "more",
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].icon, _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].moreIcon),
      onClick: handleShowContextMenu
    }))));
  }
  function renderDefaultPlaceholder() {
    const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].loadingPlaceholder, _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].defaultPlaceholderGrid, isLoaded && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].hide);
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: className
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].placeholderSquare
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].placeholderSquare
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].placeholderSquare
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].placeholderSquare
    }));
  }
  function renderPlaceholder() {
    if (!placeholderPath) {
      return renderDefaultPlaceholder();
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("svg", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].loadingPlaceholder, isLoaded && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].hide),
      viewBox: "0 0 512 512"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("path", {
      className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].placeholderPath,
      d: placeholderPath
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].root, !isActive && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].hidden, isMultiTabSupported && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].multiTab)
  }, isFullscreen && (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_12__.getIsWebAppsFullscreenSupported)() && renderFullscreenHeaderPanel(), !isMinimizedState && renderPlaceholder(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("iframe", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].frame, shouldDecreaseWebFrameSize && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].withButton, !isLoaded && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].hide),
    style: frameStyle,
    src: url,
    title: `${bot?.firstName} Web App`,
    sandbox: SANDBOX_ATTRIBUTES,
    allow: "camera; microphone; geolocation;",
    allowFullScreen: true,
    ref: frameRef
  }), !isMinimizedState && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    style: `background-color: ${bottomBarColor};`,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].buttonsContainer, secondaryButtonCurrentPosition === 'left' && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].leftToRight, secondaryButtonCurrentPosition === 'right' && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].rightToLeft, secondaryButtonCurrentPosition === 'top' && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].topToBottom, secondaryButtonCurrentPosition === 'bottom' && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].bottomToTop, hideDirection === 'horizontal' && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].hideHorizontal, rowsCount === 1 && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].oneRow, rowsCount === 2 && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].twoRows)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_24__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].secondaryButton, shouldShowSecondaryButton && !shouldHideSecondaryButton && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].visible, shouldHideSecondaryButton && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].hidden),
    fluid: true,
    style: `background-color: ${secondaryButtonCurrentColor}; color: ${secondaryButtonCurrentTextColor}`,
    disabled: !secondaryButtonCurrentIsActive && !secondaryButton?.isProgressVisible,
    nonInteractive: secondaryButton?.isProgressVisible,
    onClick: handleSecondaryButtonClick,
    size: "smaller"
  }, !secondaryButton?.isProgressVisible && secondaryButtonCurrentText, secondaryButton?.isProgressVisible && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_27__["default"], {
    className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].mainButtonSpinner,
    color: "blue"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_24__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].mainButton, shouldShowMainButton && !shouldHideMainButton && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].visible, shouldHideMainButton && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].hidden),
    fluid: true,
    style: `background-color: ${mainButtonCurrentColor}; color: ${mainButtonCurrentTextColor}`,
    disabled: !mainButtonCurrentIsActive && !mainButton?.isProgressVisible,
    nonInteractive: mainButton?.isProgressVisible,
    onClick: handleMainButtonClick,
    size: "smaller"
  }, !mainButton?.isProgressVisible && mainButtonCurrentText, mainButton?.isProgressVisible && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_27__["default"], {
    className: _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].mainButtonSpinner,
    color: "white"
  }))), popupParameters && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_26__["default"], {
    isOpen: Boolean(popupParameters),
    title: popupParameters.title || NBSP,
    onClose: handleAppPopupModalClose,
    hasCloseButton: true,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].webAppPopup, !popupParameters.title?.trim().length && _WebAppModalTabContent_module_scss__WEBPACK_IMPORTED_MODULE_29__["default"].withoutTitle)
  }, popupParameters.message, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons mt-2"
  }, popupParameters.buttons.map(button => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_24__["default"], {
    key: button.id || button.type,
    className: "confirm-dialog-button",
    color: button.type === 'destructive' ? 'danger' : 'primary',
    isText: true,
    size: "smaller"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleAppPopupClose(button.id)
  }, button.text || oldLang(DEFAULT_BUTTON_TEXT[button.type]))))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_25__["default"], {
    isOpen: isRequestingPhone,
    onClose: handleRejectPhone,
    title: oldLang('ShareYouPhoneNumberTitle'),
    text: oldLang('AreYouSureShareMyContactInfoBot'),
    confirmHandler: handleAcceptPhone,
    confirmLabel: oldLang('ContactShare')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_25__["default"], {
    isOpen: isRequestingWriteAccess,
    onClose: handleRejectWriteAccess,
    title: oldLang('lng_bot_allow_write_title'),
    text: oldLang('lng_bot_allow_write'),
    confirmHandler: handleAcceptWriteAccess,
    confirmLabel: oldLang('lng_bot_allow_write_confirm')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_25__["default"], {
    isOpen: Boolean(requestedFileDownload),
    title: oldLang('BotDownloadFileTitle'),
    textParts: lang('BotDownloadFileDescription', {
      bot: bot?.firstName,
      filename: requestedFileDownload?.fileName
    }, {
      withNodes: true,
      withMarkdown: true
    }),
    confirmLabel: oldLang('BotDownloadFileButton'),
    onClose: handleRejectFileDownload,
    confirmHandler: handleDownloadFile
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_25__["default"], {
    isOpen: isCloseModalOpen,
    onClose: handleHideCloseModal,
    title: oldLang('lng_bot_close_warning_title'),
    text: oldLang('lng_bot_close_warning'),
    confirmHandler: handleConfirmCloseModal,
    confirmIsDestructive: true,
    confirmLabel: oldLang('lng_bot_close_warning_sure')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_25__["default"], {
    isOpen: isRemoveModalOpen,
    onClose: handleHideRemoveModal,
    title: oldLang('BotRemoveFromMenuTitle'),
    textParts: (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_11__["default"])(oldLang('BotRemoveFromMenu', bot?.firstName), ['simple_markdown']),
    confirmHandler: handleRemoveAttachBot,
    confirmIsDestructive: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  modal
}) => {
  const activeWebApp = modal?.activeWebAppKey ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectWebApp)(global, modal.activeWebAppKey) : undefined;
  const {
    botId: activeBotId
  } = activeWebApp || {};
  const modalState = modal?.modalState;
  const attachBot = activeBotId ? global.attachMenu.bots[activeBotId] : undefined;
  const bot = activeBotId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUser)(global, activeBotId) : undefined;
  const userFullInfo = activeBotId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUserFullInfo)(global, activeBotId) : undefined;
  const botAppSettings = userFullInfo?.botInfo?.appSettings;
  const currentUser = global.currentUserId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUser)(global, global.currentUserId) : undefined;
  const theme = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTheme)(global);
  const {
    isPaymentModalOpen,
    status: regularPaymentStatus
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global).payment;
  const {
    status: starsPaymentStatus,
    inputInvoice: starsInputInvoice
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global).starsPayment;
  const botAppPermissions = bot ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectBotAppPermissions)(global, bot.id) : undefined;
  const paymentStatus = starsPaymentStatus || regularPaymentStatus;
  return {
    attachBot,
    bot,
    currentUser,
    theme,
    isPaymentModalOpen: isPaymentModalOpen || Boolean(starsInputInvoice),
    paymentStatus,
    modalState,
    botAppPermissions,
    botAppSettings
  };
})(WebAppModalTabContent)));

/***/ }),

/***/ "./src/components/modals/webApp/hooks/usePopupLimit.ts":
/*!*************************************************************!*\
  !*** ./src/components/modals/webApp/hooks/usePopupLimit.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ usePopupLimit)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");


function usePopupLimit(sequentialLimit, resetAfter) {
  const [unlockPopupsAt, setUnlockPopupsAt] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  const sequentialCalls = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(0);
  const lastClosedDate = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(0);
  const handlePopupOpened = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_1__["default"])(() => {
    const now = Date.now();
    if (now - lastClosedDate.current > resetAfter) {
      sequentialCalls.current = 0;
    }
    sequentialCalls.current += 1;
    if (sequentialCalls.current >= sequentialLimit) {
      setUnlockPopupsAt(now + resetAfter);
    }
  });
  const handlePopupClosed = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_1__["default"])(() => {
    if (unlockPopupsAt < Date.now()) {
      // Prevent confused user from extending lock time
      lastClosedDate.current = Date.now();
    }
  });
  return {
    unlockPopupsAt,
    handlePopupOpened,
    handlePopupClosed
  };
}

/***/ }),

/***/ "./src/components/modals/webApp/hooks/useWebAppFrame.ts":
/*!**************************************************************!*\
  !*** ./src/components/modals/webApp/hooks/useWebAppFrame.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_themeStyle__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../util/themeStyle */ "./src/util/themeStyle.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../hooks/window/useWindowSize */ "./src/hooks/window/useWindowSize.ts");
/* eslint-disable @typescript-eslint/naming-convention */







const SCROLLBAR_STYLE = `* {
  scrollbar-width: thin;
  scrollbar-color: %SCROLLBAR_COLOR% transparent;
}

*::-webkit-scrollbar {
  width: 6px;
  height: 6px;
  background-color: transparent;
}

*::-webkit-scrollbar-thumb {
  border-radius: 6px;
  background-color: %SCROLLBAR_COLOR%;
}

*::-webkit-scrollbar-corner {
  background-color: transparent;
}`;
const RELOAD_TIMEOUT = 500;
const FULLSCREEN_BUTTONS_AREA_HEIGHT = 3.675 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_4__.REM;
const useWebAppFrame = (ref, isOpen, isFullscreen, isSimpleView, onEvent, webApp, onLoad) => {
  const {
    showNotification,
    setWebAppPaymentSlug,
    openInvoice,
    closeWebApp,
    openSuggestedStatusModal,
    updateWebApp
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const isReloadSupported = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);
  const reloadTimeout = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const ignoreEventsRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);
  const lastFrameSizeRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const windowSize = (0,_hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_6__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!ref.current || !isOpen) return undefined;
    const handleLoad = () => {
      onLoad?.();
    };
    const frame = ref.current;
    frame.addEventListener('load', handleLoad);
    return () => {
      frame.removeEventListener('load', handleLoad);
    };
  }, [onLoad, ref, isOpen]);
  const sendEvent = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(event => {
    if (!ref.current?.contentWindow) return;
    ref.current.contentWindow.postMessage(JSON.stringify(event), '*');
  }, [ref]);
  const sendFullScreenChanged = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    sendEvent({
      eventType: 'fullscreen_changed',
      eventData: {
        is_fullscreen: value
      }
    });
  }, [sendEvent]);
  const forceReloadFrame = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(url => {
    if (!ref.current) return;
    const frame = ref.current;
    frame.src = 'about:blank';
    frame.addEventListener('load', () => {
      frame.src = url;
    }, {
      once: true
    });
  });
  const reloadFrame = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(url => {
    if (isReloadSupported.current) {
      sendEvent({
        eventType: 'reload_iframe'
      });
      reloadTimeout.current = setTimeout(() => {
        forceReloadFrame(url);
      }, RELOAD_TIMEOUT);
      return;
    }
    forceReloadFrame(url);
  }, [sendEvent]);
  const sendViewport = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(isNonStable => {
    if (!ref.current) {
      return;
    }
    const {
      width,
      height
    } = ref.current.getBoundingClientRect();
    sendEvent({
      eventType: 'viewport_changed',
      eventData: {
        width,
        height,
        is_expanded: true,
        is_state_stable: !isNonStable
      }
    });
  }, [sendEvent, ref]);
  const sendSafeArea = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!ref.current) {
      return;
    }
    sendEvent({
      eventType: 'safe_area_changed',
      eventData: {
        left: 0,
        right: 0,
        top: 0,
        bottom: 0
      }
    });
    sendEvent({
      eventType: 'content_safe_area_changed',
      eventData: {
        left: 0,
        right: 0,
        top: isFullscreen ? FULLSCREEN_BUTTONS_AREA_HEIGHT : 0,
        bottom: 0
      }
    });
  }, [sendEvent, isFullscreen, ref]);
  const sendTheme = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    sendEvent({
      eventType: 'theme_changed',
      eventData: {
        theme_params: (0,_util_themeStyle__WEBPACK_IMPORTED_MODULE_3__.extractCurrentThemeParams)()
      }
    });
  }, [sendEvent]);
  const sendCustomStyle = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(style => {
    sendEvent({
      eventType: 'set_custom_style',
      eventData: style
    });
  }, [sendEvent]);
  const handleMessage = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(event => {
    if (ignoreEventsRef.current) {
      return;
    }
    const contentWindow = ref.current?.contentWindow;
    const sourceWindow = event.source;
    if (contentWindow !== sourceWindow) {
      return;
    }
    try {
      const data = JSON.parse(event.data);
      const {
        eventType,
        eventData
      } = data;
      // Handle some app requests here to simplify hook usage
      if (eventType === 'web_app_ready') {
        onLoad?.();
      }
      if (eventType === 'web_app_close') {
        if (webApp) {
          const key = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getWebAppKey)(webApp);
          closeWebApp({
            key,
            skipClosingConfirmation: true
          });
        }
      }
      if (eventType === 'web_app_request_viewport') {
        sendViewport(windowSize.isResizing);
      }
      if (eventType === 'web_app_request_safe_area') {
        sendSafeArea();
      }
      if (eventType === 'web_app_request_content_safe_area') {
        sendSafeArea();
      }
      if (eventType === 'web_app_request_theme') {
        sendTheme();
      }
      if (eventType === 'iframe_ready') {
        const scrollbarColor = getComputedStyle(document.body).getPropertyValue('--color-scrollbar');
        sendCustomStyle(SCROLLBAR_STYLE.replace(/%SCROLLBAR_COLOR%/g, scrollbarColor));
        isReloadSupported.current = Boolean(eventData.reload_supported);
      }
      if (eventType === 'iframe_will_reload') {
        clearTimeout(reloadTimeout.current);
      }
      if (eventType === 'web_app_data_send') {
        if (!isSimpleView) return; // Allowed only in simple view
        ignoreEventsRef.current = true;
      }

      // Clipboard access temporarily disabled to address security concerns
      if (eventType === 'web_app_read_text_from_clipboard') {
        sendEvent({
          eventType: 'clipboard_text_received',
          eventData: {
            req_id: eventData.req_id,
            // eslint-disable-next-line no-null/no-null
            data: null
          }
        });
      }
      if (eventType === 'web_app_open_scan_qr_popup') {
        showNotification({
          message: 'Scanning QR code is not supported in this client yet'
        });
      }
      if (eventType === 'web_app_open_invoice') {
        setWebAppPaymentSlug({
          slug: eventData.slug
        });
        openInvoice({
          type: 'slug',
          slug: eventData.slug
        });
      }
      if (eventType === 'web_app_open_link') {
        const linkUrl = eventData.url;
        window.open(linkUrl, '_blank', 'noreferrer');
      }
      if (eventType === 'web_app_biometry_get_info') {
        sendEvent({
          eventType: 'biometry_info_received',
          eventData: {
            available: false
          }
        });
      }
      if (eventType === 'web_app_set_emoji_status') {
        const {
          custom_emoji_id,
          duration
        } = eventData;
        if (!custom_emoji_id || typeof custom_emoji_id !== 'string') {
          sendEvent({
            eventType: 'emoji_status_failed',
            eventData: {
              error: 'SUGGESTED_EMOJI_INVALID'
            }
          });
          return;
        }
        if (duration) {
          try {
            BigInt(duration);
          } catch (e) {
            sendEvent({
              eventType: 'emoji_status_failed',
              eventData: {
                error: 'DURATION_INVALID'
              }
            });
            return;
          }
        }
        if (!webApp) {
          sendEvent({
            eventType: 'emoji_status_failed',
            eventData: {
              error: 'UNKNOWN_ERROR'
            }
          });
          return;
        }
        openSuggestedStatusModal({
          webAppKey: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getWebAppKey)(webApp),
          customEmojiId: custom_emoji_id,
          duration: Number(duration),
          botId: webApp.botId
        });
      }
      onEvent(data);
    } catch (err) {
      // Ignore other messages
    }
  }, [isSimpleView, sendEvent, onEvent, sendCustomStyle, webApp, sendTheme, sendViewport, sendSafeArea, onLoad, windowSize.isResizing, ref]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const {
      width,
      height,
      isResizing
    } = windowSize;
    if (lastFrameSizeRef.current && lastFrameSizeRef.current.width === width && lastFrameSizeRef.current.height === height && !lastFrameSizeRef.current.isResizing) return;
    lastFrameSizeRef.current = {
      width,
      height,
      isResizing
    };
    sendViewport(isResizing);
  }, [sendViewport, sendSafeArea, windowSize]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!webApp?.plannedEvents?.length) return;
    const events = webApp.plannedEvents;
    events.forEach(event => {
      sendEvent(event);
    });
    updateWebApp({
      key: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getWebAppKey)(webApp),
      update: {
        plannedEvents: []
      }
    });
  }, [sendEvent, webApp]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    window.addEventListener('message', handleMessage);
    return () => window.removeEventListener('message', handleMessage);
  }, [handleMessage, ref]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen && ref.current?.contentWindow) {
      sendViewport();
      sendSafeArea();
      ignoreEventsRef.current = false;
    } else {
      lastFrameSizeRef.current = undefined;
    }
  }, [isOpen, isFullscreen, sendViewport, sendSafeArea, ref]);
  return {
    sendEvent,
    sendFullScreenChanged,
    reloadFrame,
    sendViewport,
    sendSafeArea,
    sendTheme
  };
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (useWebAppFrame);

/***/ }),

/***/ "./src/components/payment/CardInput.tsx":
/*!**********************************************!*\
  !*** ./src/components/payment/CardInput.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _common_helpers_detectCardType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/helpers/detectCardType */ "./src/components/common/helpers/detectCardType.ts");
/* harmony import */ var _middle_helpers_inputFormatters__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../middle/helpers/inputFormatters */ "./src/components/middle/helpers/inputFormatters.ts");
/* harmony import */ var _hooks_useFocusAfterAnimation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useFocusAfterAnimation */ "./src/hooks/useFocusAfterAnimation.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _CardInput_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./CardInput.scss */ "./src/components/payment/CardInput.scss");
/* harmony import */ var _assets_mastercard_svg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../assets/mastercard.svg */ "./src/assets/mastercard.svg");
/* harmony import */ var _assets_mir_svg__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../assets/mir.svg */ "./src/assets/mir.svg");
/* harmony import */ var _assets_visa_svg__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../assets/visa.svg */ "./src/assets/visa.svg");










const CARD_NUMBER_MAX_LENGTH = 19;
const CardInput = ({
  value,
  error,
  onChange
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  // eslint-disable-next-line no-null/no-null
  const cardNumberRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_hooks_useFocusAfterAnimation__WEBPACK_IMPORTED_MODULE_3__["default"])(cardNumberRef);
  const [cardType, setCardType] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(_common_helpers_detectCardType__WEBPACK_IMPORTED_MODULE_1__.CardType.Default);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const newCardType = (0,_common_helpers_detectCardType__WEBPACK_IMPORTED_MODULE_1__.detectCardType)(value);
    setCardType(newCardType);
    // eslint-disable-next-line
  }, []);
  const handleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const newValue = (0,_middle_helpers_inputFormatters__WEBPACK_IMPORTED_MODULE_2__.formatCardNumber)(e.target.value);
    const newCardType = (0,_common_helpers_detectCardType__WEBPACK_IMPORTED_MODULE_1__.detectCardType)(e.target.value);
    setCardType(newCardType);
    onChange(newValue);
  }, [onChange]);
  const cardIcon = getCardIcon(cardType);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "CardInput"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    ref: cardNumberRef,
    label: lang('PaymentCardNumber'),
    onChange: handleChange,
    value: value,
    inputMode: "numeric",
    className: cardType ? 'has-right-addon' : '',
    error: error,
    tabIndex: 0,
    maxLength: CARD_NUMBER_MAX_LENGTH,
    teactExperimentControlled: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "right-addon"
  }, cardIcon));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(CardInput));
function getCardIcon(cardType) {
  switch (cardType) {
    case _common_helpers_detectCardType__WEBPACK_IMPORTED_MODULE_1__.CardType.Mastercard:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
        src: _assets_mastercard_svg__WEBPACK_IMPORTED_MODULE_7__,
        draggable: false,
        alt: ""
      });
    case _common_helpers_detectCardType__WEBPACK_IMPORTED_MODULE_1__.CardType.Visa:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
        src: _assets_visa_svg__WEBPACK_IMPORTED_MODULE_9__,
        draggable: false,
        alt: ""
      });
    case _common_helpers_detectCardType__WEBPACK_IMPORTED_MODULE_1__.CardType.Mir:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
        src: _assets_mir_svg__WEBPACK_IMPORTED_MODULE_8__,
        draggable: false,
        alt: ""
      });
    default:
      return undefined;
  }
}

/***/ }),

/***/ "./src/components/payment/Checkout.tsx":
/*!*********************************************!*\
  !*** ./src/components/payment/Checkout.tsx ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_formatCurrency__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/formatCurrency */ "./src/util/formatCurrency.tsx");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useMediaTransition__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useMediaTransition */ "./src/hooks/useMediaTransition.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_SafeLink__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/SafeLink */ "./src/components/common/SafeLink.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/placeholder/Skeleton */ "./src/components/ui/placeholder/Skeleton.tsx");
/* harmony import */ var _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Checkout.module.scss */ "./src/components/payment/Checkout.module.scss");















const Checkout = ({
  title,
  description,
  photo,
  invoice,
  shippingPrices,
  checkoutInfo,
  totalPrice,
  isTosAccepted,
  dispatch,
  onAcceptTos,
  tipAmount,
  needAddress,
  hasShippingOptions,
  savedCredentials,
  isPaymentFormUrl,
  botName
}) => {
  const {
    setPaymentStep
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const isInteractive = Boolean(dispatch);
  const {
    termsUrl,
    suggestedTipAmounts,
    maxTipAmount
  } = invoice || {};
  const {
    paymentMethod,
    paymentProvider,
    shippingAddress,
    name,
    phone,
    shippingMethod
  } = checkoutInfo || {};
  const photoUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_7__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getWebDocumentHash)(photo));
  const ref = (0,_hooks_useMediaTransition__WEBPACK_IMPORTED_MODULE_8__["default"])(photoUrl);
  const handleTipsClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(tips => {
    dispatch({
      type: 'setTipAmount',
      payload: maxTipAmount ? Math.min(tips, maxTipAmount) : tips
    });
  }, [dispatch, maxTipAmount]);
  const handlePaymentMethodClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setPaymentStep({
      step: savedCredentials?.length ? _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.SavedPayments : _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.PaymentInfo
    });
  }, [savedCredentials?.length, setPaymentStep]);
  const handleShippingAddressClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setPaymentStep({
      step: _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ShippingInfo
    });
  }, [setPaymentStep]);
  const handleShippingMethodClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setPaymentStep({
      step: _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Shipping
    });
  }, [setPaymentStep]);
  function renderTips() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].priceInfoItem
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].priceInfoItemTitle
    }, title), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_5__.formatCurrency)(tipAmount, invoice.currency, lang.code))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].tipsList
    }, suggestedTipAmounts.map(tip => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      key: tip,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].tipsItem, tip === tipAmount && _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].tipsItem_active),
      onClick: dispatch ? () => handleTipsClick(tip === tipAmount ? 0 : tip) : undefined
    }, (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_5__.formatCurrency)(tip, invoice.currency, lang.code, {
      shouldOmitFractions: true
    })))));
  }
  function renderTosLink(url, isRtl) {
    const langString = lang('PaymentCheckoutAcceptRecurrent', botName);
    const langStringSplit = langString.split('*');
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, langStringSplit[0], /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_SafeLink__WEBPACK_IMPORTED_MODULE_10__["default"], {
      url: url,
      text: langStringSplit[1],
      isRtl: isRtl
    }), langStringSplit.slice(2));
  }
  function renderTos(url) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__["default"], {
      label: renderTosLink(url, lang.isRtl),
      name: "checkout_tos",
      checked: Boolean(isTosAccepted),
      className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].tosCheckbox,
      tabIndex: 0,
      onCheck: onAcceptTos
    });
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].root
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].description
  }, photoUrl && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    ref: ref,
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].checkoutPicture,
    src: photoUrl,
    draggable: false,
    width: photo.dimensions?.width,
    height: photo.dimensions?.height,
    alt: ""
  }), !photoUrl && photo && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_13__["default"], {
    width: photo.dimensions?.width,
    height: photo.dimensions?.height,
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].checkoutPicture,
    forceAspectRatio: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].text
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h5", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].checkoutTitle
  }, title), description && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].checkoutDescription
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(description, ['br', 'links', 'emoji'])))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].priceInfo
  }, invoice.prices.map(item => renderPaymentItem(lang.code, item.label, item.amount, invoice.currency)), shippingPrices && shippingPrices.map(item => renderPaymentItem(lang.code, item.label, item.amount, invoice.currency)), suggestedTipAmounts && suggestedTipAmounts.length > 0 && renderTips(), totalPrice !== undefined && renderPaymentItem(lang.code, lang('Checkout.TotalAmount'), totalPrice, invoice.currency, true)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].invoiceInfo
  }, !isPaymentFormUrl && renderCheckoutItem({
    title: paymentMethod || savedCredentials?.[0].title,
    label: lang('PaymentCheckoutMethod'),
    icon: 'card',
    onClick: isInteractive ? handlePaymentMethodClick : undefined
  }), paymentProvider && renderCheckoutItem({
    title: paymentProvider,
    label: lang('PaymentCheckoutProvider'),
    customIcon: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].provider, _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"][paymentProvider.toLowerCase()])
  }), (needAddress || !isInteractive && shippingAddress) && renderCheckoutItem({
    title: shippingAddress,
    label: lang('PaymentShippingAddress'),
    icon: 'location',
    onClick: isInteractive ? handleShippingAddressClick : undefined
  }), name && renderCheckoutItem({
    title: name,
    label: lang('PaymentCheckoutName'),
    icon: 'user'
  }), phone && renderCheckoutItem({
    title: phone,
    label: lang('PaymentCheckoutPhoneNumber'),
    icon: 'phone'
  }), (hasShippingOptions || !isInteractive && shippingMethod) && renderCheckoutItem({
    title: shippingMethod,
    label: lang('PaymentCheckoutShippingMethod'),
    icon: 'truck',
    onClick: isInteractive ? handleShippingMethodClick : undefined
  }), termsUrl && renderTos(termsUrl)));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(Checkout));
function renderPaymentItem(langCode, title, value, currency, main = false) {
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].priceInfoItem, main && _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].priceInfoItemMain)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].priceInfoItemTitle
  }, title), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_5__.formatCurrency)(value, currency, langCode)));
}
function renderCheckoutItem({
  title,
  label,
  icon,
  customIcon,
  onClick
}) {
  const isMultiline = Boolean(title && label !== title);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].list,
    narrow: true,
    multiline: isMultiline,
    icon: icon,
    inactive: !onClick,
    onClick: onClick,
    leftElement: customIcon && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("i", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('icon', customIcon)
    })
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].checkoutInfoItemInfoTitle
  }, title || label), title && label !== title && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: _Checkout_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].checkoutInfoItemInfoData
  }, label));
}

/***/ }),

/***/ "./src/components/payment/ConfirmPayment.tsx":
/*!***************************************************!*\
  !*** ./src/components/payment/ConfirmPayment.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ConfirmPayment_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ConfirmPayment.scss */ "./src/components/payment/ConfirmPayment.scss");





const ConfirmPayment = ({
  url,
  noRedirect,
  onClose,
  onPaymentFormSubmit
}) => {
  const {
    openTelegramLink
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const handleMessage = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(event => {
    try {
      const data = JSON.parse(event.data);
      const {
        eventType,
        eventData
      } = data;
      switch (eventType) {
        case 'web_app_open_tg_link':
          if (!noRedirect) {
            const linkUrl = _config__WEBPACK_IMPORTED_MODULE_2__.TME_LINK_PREFIX + eventData.path_full;
            openTelegramLink({
              url: linkUrl
            });
          }
          onClose();
          break;
        case 'payment_form_submit':
          if (onPaymentFormSubmit) {
            onPaymentFormSubmit(eventData);
          }
          break;
        default:
          onClose();
          break;
      }
    } catch (err) {
      // Ignore other messages
    }
  }, [onClose, noRedirect, openTelegramLink, onPaymentFormSubmit]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    window.addEventListener('message', handleMessage);
    return () => window.removeEventListener('message', handleMessage);
  }, [handleMessage]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ConfirmPayment"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("iframe", {
    src: url,
    title: lang('Checkout.WebConfirmation.Title'),
    allow: "payment",
    sandbox: "allow-modals allow-forms allow-scripts allow-same-origin allow-top-navigation",
    className: "ConfirmPayment__content"
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ConfirmPayment));

/***/ }),

/***/ "./src/components/payment/ExpiryInput.tsx":
/*!************************************************!*\
  !*** ./src/components/payment/ExpiryInput.tsx ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _middle_helpers_inputFormatters__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../middle/helpers/inputFormatters */ "./src/components/middle/helpers/inputFormatters.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");




const MAX_FIELD_LENGTH = 5;
const ExpiryInput = ({
  value,
  error,
  onChange
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const handleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const newValue = e.target.value;
    // Allow deleting separator
    if (value.endsWith('/') && value.length > newValue.length) {
      onChange(newValue);
    } else {
      onChange((0,_middle_helpers_inputFormatters__WEBPACK_IMPORTED_MODULE_1__.formatCardExpiry)(e.target.value));
    }
  }, [onChange, value]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_3__["default"], {
    label: lang('PaymentCardExpireDate'),
    onChange: handleChange,
    value: value,
    error: error,
    inputMode: "numeric",
    tabIndex: 0,
    maxLength: MAX_FIELD_LENGTH,
    teactExperimentControlled: true
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ExpiryInput));

/***/ }),

/***/ "./src/components/payment/PasswordConfirm.tsx":
/*!****************************************************!*\
  !*** ./src/components/payment/PasswordConfirm.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_PasswordForm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/PasswordForm */ "./src/components/common/PasswordForm.tsx");
/* harmony import */ var _common_PasswordMonkey__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/PasswordMonkey */ "./src/components/common/PasswordMonkey.tsx");







const PasswordConfirm = ({
  isActive,
  errorKey,
  state,
  savedCredentials,
  passwordHint,
  onPasswordChange
}) => {
  const {
    clearPaymentError
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const [shouldShowPassword, setShouldShowPassword] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const cardName = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return savedCredentials?.length && state.savedCredentialId ? savedCredentials.find(({
      id
    }) => id === state.savedCredentialId)?.title : undefined;
  }, [savedCredentials, state.savedCredentialId]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "PaymentInfo"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PasswordMonkey__WEBPACK_IMPORTED_MODULE_6__["default"], {
    isBig: true,
    isPasswordVisible: shouldShowPassword
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PasswordForm__WEBPACK_IMPORTED_MODULE_5__["default"], {
    error: errorKey && lang.withRegular(errorKey),
    hint: passwordHint,
    description: oldLang('PaymentConfirmationMessage', cardName),
    placeholder: oldLang('Password'),
    clearError: clearPaymentError,
    shouldShowSubmit: false,
    shouldResetValue: isActive,
    isPasswordVisible: shouldShowPassword,
    onChangePasswordVisibility: setShouldShowPassword,
    onInputChange: onPasswordChange
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    payment
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global);
  return {
    errorKey: payment.error?.messageKey,
    passwordHint: global.twoFaSettings.hint,
    savedCredentials: payment.form?.type === 'regular' ? payment.form.savedCredentials : undefined
  };
})(PasswordConfirm)));

/***/ }),

/***/ "./src/components/payment/PaymentInfo.tsx":
/*!************************************************!*\
  !*** ./src/components/payment/PaymentInfo.tsx ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Select__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ui/Select */ "./src/components/ui/Select.tsx");
/* harmony import */ var _CardInput__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./CardInput */ "./src/components/payment/CardInput.tsx");
/* harmony import */ var _ExpiryInput__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ExpiryInput */ "./src/components/payment/ExpiryInput.tsx");
/* harmony import */ var _PaymentInfo_scss__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./PaymentInfo.scss */ "./src/components/payment/PaymentInfo.scss");









const PaymentInfo = ({
  state,
  canSaveCredentials,
  needCardholderName,
  needCountry,
  needZip,
  countryList,
  dispatch
}) => {
  // eslint-disable-next-line no-null/no-null
  const selectCountryRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (selectCountryRef.current && selectCountryRef.current.value !== state.billingCountry) {
      selectCountryRef.current.value = state.billingCountry;
    }
  }, [state.billingCountry]);
  const handleCardNumberChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'changeCardNumber',
      payload: value
    });
  }, [dispatch]);
  const handleCardholderChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeCardholder',
      payload: e.target.value.toUpperCase()
    });
  }, [dispatch]);
  const handleExpiryChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'changeExpiryDate',
      payload: value
    });
  }, [dispatch]);
  const handleCvvChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const newValue = e.target.value.replace(/[^0-9]/g, '');
    dispatch({
      type: 'changeCvvCode',
      payload: newValue
    });
  }, [dispatch]);
  const handleCountryChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeBillingCountry',
      payload: e.target.value
    });
  }, [dispatch]);
  const handleBillingPostCodeChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeBillingZip',
      payload: e.target.value
    });
  }, [dispatch]);
  const handleChangeSaveCredentials = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeSaveCredentials',
      payload: e.target.value
    });
  }, [dispatch]);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_1__["default"])();
  const {
    formErrors = {}
  } = state;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "PaymentInfo"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("form", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h5", null, oldLang('PaymentCardTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_CardInput__WEBPACK_IMPORTED_MODULE_6__["default"], {
    onChange: handleCardNumberChange,
    value: state.cardNumber,
    error: formErrors.cardNumber && lang.withRegular(formErrors.cardNumber)
  }), needCardholderName && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_4__["default"], {
    label: oldLang('Checkout.NewCard.CardholderNamePlaceholder'),
    onChange: handleCardholderChange,
    value: state.cardholder,
    inputMode: "text",
    tabIndex: 0,
    error: formErrors.cardholder && lang.withRegular(formErrors.cardholder)
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("section", {
    className: "inline-inputs"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ExpiryInput__WEBPACK_IMPORTED_MODULE_7__["default"], {
    value: state.expiry,
    onChange: handleExpiryChange,
    error: formErrors.expiry && lang.withRegular(formErrors.expiry)
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_4__["default"], {
    label: oldLang('lng_payments_card_cvc'),
    onChange: handleCvvChange,
    value: state.cvv,
    inputMode: "numeric",
    maxLength: 3,
    tabIndex: 0,
    error: formErrors.cvv && lang.withRegular(formErrors.cvv),
    teactExperimentControlled: true
  })), needCountry || needZip ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h5", null, oldLang('PaymentBillingAddress')) : undefined, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("section", {
    className: "inline-inputs"
  }, needCountry && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Select__WEBPACK_IMPORTED_MODULE_5__["default"], {
    label: oldLang('PaymentShippingCountry'),
    onChange: handleCountryChange,
    value: state.billingCountry,
    hasArrow: Boolean(true),
    id: "billing-country",
    error: formErrors.billingCountry && lang.withRegular(formErrors.billingCountry),
    tabIndex: 0,
    ref: selectCountryRef
  }, countryList.map(({
    defaultName,
    name
  }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("option", {
    value: defaultName,
    className: "county-item",
    selected: defaultName === state.billingCountry
  }, defaultName || name))), needZip && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_4__["default"], {
    label: oldLang('PaymentShippingZipPlaceholder'),
    onChange: handleBillingPostCodeChange,
    value: state.billingZip,
    inputMode: "text",
    tabIndex: 0,
    maxLength: 12,
    error: formErrors.billingZip && lang.withRegular(formErrors.billingZip)
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "checkbox"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_3__["default"], {
    label: oldLang('PaymentCardSavePaymentInformation'),
    checked: canSaveCredentials ? state.saveCredentials : false,
    tabIndex: 0,
    subLabel: oldLang(canSaveCredentials ? 'Checkout.NewCard.SaveInfoHelp' : 'Checkout.2FA.Text'),
    onChange: handleChangeSaveCredentials,
    disabled: !canSaveCredentials
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(PaymentInfo));

/***/ }),

/***/ "./src/components/payment/PaymentModal.tsx":
/*!*************************************************!*\
  !*** ./src/components/payment/PaymentModal.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureKeyboardListeners__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/captureKeyboardListeners */ "./src/util/captureKeyboardListeners.ts");
/* harmony import */ var _util_formatCurrency__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../util/formatCurrency */ "./src/util/formatCurrency.tsx");
/* harmony import */ var _common_helpers_detectCardType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common/helpers/detectCardType */ "./src/components/common/helpers/detectCardType.ts");
/* harmony import */ var _hooks_reducers_usePaymentReducer__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/reducers/usePaymentReducer */ "./src/hooks/reducers/usePaymentReducer.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _Checkout__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./Checkout */ "./src/components/payment/Checkout.tsx");
/* harmony import */ var _ConfirmPayment__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./ConfirmPayment */ "./src/components/payment/ConfirmPayment.tsx");
/* harmony import */ var _PasswordConfirm__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./PasswordConfirm */ "./src/components/payment/PasswordConfirm.tsx");
/* harmony import */ var _PaymentInfo__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./PaymentInfo */ "./src/components/payment/PaymentInfo.tsx");
/* harmony import */ var _SavedPaymentCredentials__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./SavedPaymentCredentials */ "./src/components/payment/SavedPaymentCredentials.tsx");
/* harmony import */ var _Shipping__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./Shipping */ "./src/components/payment/Shipping.tsx");
/* harmony import */ var _ShippingInfo__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./ShippingInfo */ "./src/components/payment/ShippingInfo.tsx");
/* harmony import */ var _PaymentModal_scss__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./PaymentModal.scss */ "./src/components/payment/PaymentModal.scss");




























const DEFAULT_PROVIDER = 'stripe';
const DONATE_PROVIDER = 'smartglocal';
const DONATE_PROVIDER_URL = 'https://payment.smart-glocal.com';
const SUPPORTED_PROVIDERS = new Set([DEFAULT_PROVIDER, DONATE_PROVIDER]);
const NETWORK_REQUEST_TIMEOUT_S = 3;
const PaymentModal = ({
  isOpen,
  onClose,
  step,
  shippingOptions,
  form,
  isProviderError,
  invoice,
  nativeProvider,
  needCardholderName,
  needCountry,
  needZip,
  confirmPaymentUrl,
  error,
  countryList,
  hasShippingOptions,
  requestId,
  smartGlocalToken,
  stripeId,
  savedCredentials,
  passwordValidUntil,
  isExtendedMedia,
  isPaymentFormUrl,
  botName
}) => {
  const {
    loadPasswordInfo,
    validateRequestedInfo,
    sendPaymentForm,
    setPaymentStep,
    sendCredentialsInfo,
    clearPaymentError,
    validatePaymentPassword,
    setSmartGlocalCardInfo
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const [isModalOpen, openModal, closeModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const [paymentState, paymentDispatch] = (0,_hooks_reducers_usePaymentReducer__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isLoading, setIsLoading] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isTosAccepted, setIsTosAccepted] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [twoFaPassword, setTwoFaPassword] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const prevStep = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_14__["default"])(step, true);
  const prevRequestId = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_14__["default"])(requestId);
  const canRenderFooter = step !== _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPayment;
  const setStep = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(nextStep => {
    setPaymentStep({
      step: nextStep
    });
  }, [setPaymentStep]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      setTwoFaPassword('');
      loadPasswordInfo();
      openModal();
    }
  }, [isOpen, loadPasswordInfo, openModal]);

  // Modal window can be closed by an event from the server side
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen && isModalOpen) {
      closeModal();
    }
  }, [closeModal, isModalOpen, isOpen]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (step !== undefined || error) {
      setIsLoading(false);
    }
  }, [step, error, requestId]);

  // When payment verification occurs and the `step` does not change, the card details must be requested
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (step === _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout && step === prevStep && requestId !== prevRequestId && !paymentState.savedCredentialId && !paymentState.cardNumber) {
      setStep(_types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.PaymentInfo);
    }
  }, [paymentState.cardNumber, paymentState.savedCredentialId, prevRequestId, prevStep, requestId, setStep, step]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (error?.field) {
      paymentDispatch({
        type: 'setFormErrors',
        payload: {
          [error.field]: error.messageKey
        }
      });
    }
  }, [error, paymentDispatch]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (form?.savedInfo) {
      const {
        name: fullName,
        phone,
        email,
        shippingAddress
      } = form.savedInfo;
      const {
        countryIso2,
        ...shippingAddressRest
      } = shippingAddress || {};
      const shippingCountry = countryIso2 && countryList.find(({
        iso2
      }) => iso2 === countryIso2).defaultName;
      paymentDispatch({
        type: 'updateUserInfo',
        payload: {
          fullName,
          phone: phone && phone.charAt(0) !== '+' ? `+${phone}` : phone,
          email,
          ...(shippingCountry && {
            country: shippingCountry,
            countryIso2,
            ...shippingAddressRest
          })
        }
      });
    }
  }, [form, paymentDispatch, countryList]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (savedCredentials?.length) {
      paymentDispatch({
        type: 'changeSavedCredentialId',
        payload: savedCredentials[0].id
      });
    }
  }, [paymentDispatch, savedCredentials]);
  const handleErrorModalClose = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    clearPaymentError();
  }, [clearPaymentError]);
  const totalPrice = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (step !== _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout) {
      return 0;
    }
    return getTotalPrice(invoice?.prices, shippingOptions, paymentState.shipping, paymentState.tipAmount);
  }, [step, invoice?.prices, shippingOptions, paymentState.shipping, paymentState.tipAmount]);
  const checkoutInfo = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (step !== _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout) {
      return undefined;
    }
    return getCheckoutInfo(paymentState, shippingOptions, nativeProvider || '');
  }, [step, paymentState, shippingOptions, nativeProvider]);
  const handleNewCardClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setStep(_types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.PaymentInfo);
  }, [setStep]);
  const handleClearPaymentError = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    clearPaymentError();
  }, [clearPaymentError]);
  function renderError() {
    if (!error) {
      return undefined;
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_17__["default"], {
      className: "error",
      isOpen: Boolean(error),
      onClose: handleErrorModalClose
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h4", null, error.descriptionKey ? lang.withRegular(error.descriptionKey) : lang('ErrorUnspecified')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "dialog-buttons mt-2"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
      isText: true,
      onClick: handleClearPaymentError
    }, oldLang('OK'))));
  }
  const sendForm = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    sendPaymentForm({
      shippingOptionId: paymentState.shipping,
      saveCredentials: paymentState.saveCredentials,
      savedCredentialId: paymentState.savedCredentialId,
      tipAmount: paymentState.tipAmount
    });
  }, [sendPaymentForm, paymentState]);
  const handlePaymentFormSubmit = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(eventData => {
    const {
      credentials
    } = eventData;
    setSmartGlocalCardInfo(credentials);
    sendForm();
  }, [sendForm]);
  function renderModalContent(currentStep) {
    switch (currentStep) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Checkout__WEBPACK_IMPORTED_MODULE_20__["default"], {
          title: form.title,
          description: form.description,
          photo: form.photo,
          dispatch: paymentDispatch,
          shippingPrices: paymentState.shipping && shippingOptions ? getShippingPrices(shippingOptions, paymentState.shipping) : undefined,
          totalPrice: totalPrice,
          invoice: invoice,
          checkoutInfo: checkoutInfo,
          isPaymentFormUrl: isPaymentFormUrl,
          hasShippingOptions: hasShippingOptions,
          tipAmount: paymentState.tipAmount,
          needAddress: Boolean(invoice?.isShippingAddressRequested),
          savedCredentials: savedCredentials,
          isTosAccepted: isTosAccepted,
          onAcceptTos: setIsTosAccepted,
          botName: botName
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.SavedPayments:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_SavedPaymentCredentials__WEBPACK_IMPORTED_MODULE_24__["default"], {
          state: paymentState,
          savedCredentials: savedCredentials,
          dispatch: paymentDispatch,
          onNewCardClick: handleNewCardClick
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPassword:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PasswordConfirm__WEBPACK_IMPORTED_MODULE_22__["default"], {
          state: paymentState,
          savedCredentials: savedCredentials,
          onPasswordChange: setTwoFaPassword,
          isActive: currentStep === step
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.PaymentInfo:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PaymentInfo__WEBPACK_IMPORTED_MODULE_23__["default"], {
          state: paymentState,
          dispatch: paymentDispatch,
          canSaveCredentials: Boolean(!form.isPasswordMissing && form.canSaveCredentials),
          needCardholderName: needCardholderName,
          needCountry: needCountry,
          needZip: needZip,
          countryList: countryList
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ShippingInfo:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ShippingInfo__WEBPACK_IMPORTED_MODULE_26__["default"], {
          state: paymentState,
          dispatch: paymentDispatch,
          needAddress: Boolean(invoice?.isShippingAddressRequested),
          needEmail: Boolean(invoice?.isEmailRequested || invoice?.isEmailSentToProvider),
          needPhone: Boolean(invoice?.isPhoneRequested || invoice?.isPhoneSentToProvider),
          needName: Boolean(invoice?.isNameRequested),
          countryList: countryList
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Shipping:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Shipping__WEBPACK_IMPORTED_MODULE_25__["default"], {
          state: paymentState,
          dispatch: paymentDispatch,
          shippingOptions: shippingOptions || [],
          currency: invoice.currency
        });
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPayment:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ConfirmPayment__WEBPACK_IMPORTED_MODULE_21__["default"], {
          url: confirmPaymentUrl,
          noRedirect: isExtendedMedia,
          onPaymentFormSubmit: handlePaymentFormSubmit,
          onClose: closeModal
        });
      default:
        return undefined;
    }
  }
  const validateRequest = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const {
      saveInfo
    } = paymentState;
    const requestInfo = getRequestInfo(paymentState);
    validateRequestedInfo({
      requestInfo,
      saveInfo
    });
  }, [validateRequestedInfo, paymentState]);
  const sendCredentials = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const credentials = getCredentials(paymentState);
    sendCredentialsInfo({
      credentials
    });
  }, [sendCredentialsInfo, paymentState]);
  const handleButtonClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_12__["default"])(() => {
    switch (step) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ShippingInfo:
        setIsLoading(true);
        validateRequest();
        break;
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Shipping:
        setStep(_types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout);
        break;
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.SavedPayments:
        setStep(_types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPassword);
        break;
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPassword:
        if (twoFaPassword === '') {
          return;
        }
        setIsLoading(true);
        validatePaymentPassword({
          password: twoFaPassword
        });
        break;
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.PaymentInfo:
        setIsLoading(true);
        sendCredentials();
        paymentDispatch({
          type: 'changeSavedCredentialId',
          payload: ''
        });
        break;
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout:
        {
          if (isPaymentFormUrl) {
            setIsLoading(true);
            setStep(_types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPayment);
            return;
          }
          if (form?.savedInfo && !requestId && !paymentState.shipping) {
            setIsLoading(true);
            validateRequest();
            return;
          }
          if (paymentState.savedCredentialId && (!passwordValidUntil || passwordValidUntil <= Date.now() / 1000 - NETWORK_REQUEST_TIMEOUT_S)) {
            setStep(_types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPassword);
            return;
          }
          if (!paymentState.savedCredentialId && (nativeProvider === DEFAULT_PROVIDER && !stripeId || nativeProvider === DONATE_PROVIDER && !smartGlocalToken)) {
            setStep(_types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.PaymentInfo);
            return;
          }
          const {
            phone,
            email,
            fullName
          } = paymentState;
          const shouldFillRequestedData = invoice?.isEmailRequested && !email || invoice?.isPhoneRequested && !phone || invoice?.isNameRequested && !fullName;
          if (invoice?.isShippingAddressRequested && !requestId || shouldFillRequestedData) {
            setStep(_types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ShippingInfo);
            return;
          }
          if (invoice?.isShippingAddressRequested && !paymentState.shipping && shippingOptions?.length) {
            setStep(_types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Shipping);
            return;
          }
          setIsLoading(true);
          sendForm();
          break;
        }
    }
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    return step === _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPassword ? (0,_util_captureKeyboardListeners__WEBPACK_IMPORTED_MODULE_6__["default"])({
      onEnter: handleButtonClick
    }) : undefined;
  }, [handleButtonClick, step]);
  const handleModalClose = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    paymentDispatch({
      type: 'resetState'
    });
    setIsTosAccepted(false);
    onClose();
  }, [onClose, paymentDispatch]);
  const handleBackClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setStep(step === _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPassword ? _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.SavedPayments : _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout);
  }, [setStep, step]);
  const modalHeader = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    switch (step) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout:
        return oldLang('PaymentCheckout');
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ShippingInfo:
        return oldLang('PaymentShippingInfo');
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Shipping:
        return oldLang('PaymentShippingMethod');
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.SavedPayments:
        return oldLang('PaymentCheckoutMethod');
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPassword:
        return oldLang('Checkout.PasswordEntry.Title');
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.PaymentInfo:
        return oldLang('PaymentCardInfo');
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPayment:
        return oldLang('Checkout.WebConfirmation.Title');
      default:
        return '';
    }
  }, [step, oldLang]);
  const buttonText = step === _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout ? oldLang('Checkout.PayPrice', (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_7__.formatCurrencyAsString)(totalPrice, invoice.currency, oldLang.code)) : lang('PaymentInfoDone');
  function getIsSubmitDisabled() {
    if (isLoading) {
      return true;
    }
    switch (step) {
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout:
        return Boolean(invoice?.termsUrl) && !isTosAccepted;
      case _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.PaymentInfo:
        return Boolean(paymentState.cardNumber === '' || needCardholderName && paymentState.cardholder === '' || paymentState.cvv === '' || paymentState.expiry === '');
      default:
        return false;
    }
  }
  if (isProviderError) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_17__["default"], {
      className: "error",
      isOpen: isModalOpen,
      onClose: closeModal,
      onCloseAnimationEnd: handleModalClose
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, "Sorry, Telegram Web A doesn't support payments with this provider yet. ", /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("br", null), "Please use one of our mobile apps to do this."), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "dialog-buttons mt-2"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
      isText: true,
      onClick: closeModal
    }, oldLang('OK'))));
  }
  const isSubmitDisabled = getIsSubmitDisabled();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_17__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])('PaymentModal', invoice?.isRecurring && 'recurring'),
    isOpen: isModalOpen,
    onClose: closeModal,
    onCloseAnimationEnd: handleModalClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "header",
    dir: oldLang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
    className: "close-button",
    color: "translucent",
    round: true,
    size: "smaller",
    onClick: step === _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout ? closeModal : handleBackClick,
    ariaLabel: "Close"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: step === _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.Checkout ? 'close' : 'arrow-left'
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, modalHeader)), step !== undefined ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_19__["default"], {
    name: "slide",
    activeKey: step,
    shouldCleanup: true,
    cleanupOnlyKey: _types__WEBPACK_IMPORTED_MODULE_2__.PaymentStep.ConfirmPayment
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "content custom-scroll"
  }, renderModalContent(step))) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "empty-content"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_18__["default"], {
    color: "gray"
  })), canRenderFooter && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "footer"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_16__["default"], {
    className: "button-text",
    type: "submit",
    onClick: handleButtonClick,
    disabled: isSubmitDisabled,
    isLoading: isLoading
  }, buttonText)), error && !error.field && renderError());
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    form,
    step,
    shippingOptions,
    error,
    confirmPaymentUrl,
    inputInvoice,
    requestId,
    stripeCredentials,
    smartGlocalCredentials,
    temporaryPassword,
    isExtendedMedia,
    url
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global).payment;
  const {
    invoice,
    nativeParams,
    nativeProvider
  } = form || {};
  const countryList = global.countryList.general;
  let providerName = form?.nativeProvider;
  if (!providerName && url) {
    providerName = url.startsWith(DONATE_PROVIDER_URL) ? DONATE_PROVIDER : undefined;
  }
  const chat = inputInvoice && 'chatId' in inputInvoice ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, inputInvoice.chatId) : undefined;
  const isProviderError = Boolean(invoice && (!providerName || !SUPPORTED_PROVIDERS.has(providerName)));
  const {
    needCardholderName,
    needCountry,
    needZip
  } = nativeParams || {};
  const bot = form?.botId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectUser)(global, form.botId) : undefined;
  const botName = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFullName)(bot);
  return {
    step,
    chat,
    shippingOptions,
    nativeProvider: providerName,
    isProviderError,
    form,
    invoice,
    needCardholderName,
    needCountry,
    needZip,
    error,
    confirmPaymentUrl: confirmPaymentUrl ?? url,
    isPaymentFormUrl: Boolean(!nativeProvider && url),
    countryList,
    requestId,
    hasShippingOptions: Boolean(shippingOptions?.length),
    smartGlocalToken: smartGlocalCredentials?.token,
    stripeId: stripeCredentials?.id,
    passwordValidUntil: temporaryPassword?.validUntil,
    isExtendedMedia,
    botName
  };
})(PaymentModal)));
function findShippingOption(shippingOptions, optionId) {
  return shippingOptions.find(({
    id
  }) => id === optionId);
}
function getShippingPrices(shippingOptions, shippingOption) {
  const option = findShippingOption(shippingOptions, shippingOption);
  return option?.prices;
}
function getTotalPrice(prices = [], shippingOptions, shippingOption, tipAmount) {
  const shippingPrices = shippingOptions ? getShippingPrices(shippingOptions, shippingOption) : [];
  let total = tipAmount;
  const totalPrices = prices.concat(shippingPrices || []);
  total = totalPrices.reduce((acc, cur) => {
    return acc + cur.amount;
  }, total);
  return total;
}
function getCheckoutInfo(state, shippingOptions, paymentProvider) {
  const cardTypeText = (0,_common_helpers_detectCardType__WEBPACK_IMPORTED_MODULE_8__.detectCardTypeText)(state.cardNumber);
  const paymentMethod = cardTypeText && state.cardNumber ? `${cardTypeText} *${state.cardNumber.slice(-4)}` : undefined;
  const shippingAddress = state.streetLine1 ? `${state.streetLine1}, ${state.city}, ${state.countryIso2}` : undefined;
  const {
    phone,
    fullName: name
  } = state;
  const shippingOption = shippingOptions ? findShippingOption(shippingOptions, state.shipping) : undefined;
  const shippingMethod = shippingOption?.title;
  return {
    paymentMethod,
    paymentProvider,
    shippingAddress,
    name,
    phone,
    shippingMethod
  };
}
function getRequestInfo(paymentState) {
  const {
    streetLine1,
    streetLine2,
    city,
    state,
    countryIso2,
    postCode,
    fullName: name,
    phone,
    email
  } = paymentState;
  const shippingAddress = {
    streetLine1,
    streetLine2,
    city,
    state,
    countryIso2,
    postCode
  };
  return {
    name,
    phone,
    email,
    shippingAddress
  };
}
function getCredentials(paymentState) {
  const {
    cardNumber,
    cardholder,
    expiry,
    cvv,
    billingCountry,
    billingZip
  } = paymentState;
  const [expiryMonth, expiryYear] = expiry.split('/');
  const data = {
    cardNumber,
    cardholder,
    expiryMonth,
    expiryYear,
    cvv,
    country: billingCountry,
    zip: billingZip
  };
  return {
    data
  };
}

/***/ }),

/***/ "./src/components/payment/ReceiptModal.tsx":
/*!*************************************************!*\
  !*** ./src/components/payment/ReceiptModal.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_usePrevious__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/usePrevious */ "./src/hooks/usePrevious.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _Checkout__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Checkout */ "./src/components/payment/Checkout.tsx");
/* harmony import */ var _PaymentModal_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./PaymentModal.scss */ "./src/components/payment/PaymentModal.scss");











const ReceiptModal = ({
  isOpen,
  onClose,
  receipt
}) => {
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const [isModalOpen, openModal, closeModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_3__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      openModal();
    }
  }, [isOpen, openModal]);
  const prevReceipt = (0,_hooks_usePrevious__WEBPACK_IMPORTED_MODULE_5__["default"])(receipt);
  const renderingReceipt = receipt || prevReceipt;
  const checkoutInfo = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!renderingReceipt) return undefined;
    return getCheckoutInfo(renderingReceipt.credentialsTitle, renderingReceipt.info, renderingReceipt.shippingMethod);
  }, [renderingReceipt]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_8__["default"], {
    className: "PaymentModal PaymentModal-receipt",
    isOpen: isModalOpen,
    onClose: closeModal,
    onCloseAnimationEnd: onClose
  }, renderingReceipt && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "header",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_7__["default"], {
    className: "close-button",
    color: "translucent",
    round: true,
    size: "smaller",
    onClick: closeModal,
    ariaLabel: "Close"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_6__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", null, " ", lang('PaymentReceipt'), " ")), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "receipt-content custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Checkout__WEBPACK_IMPORTED_MODULE_9__["default"], {
    shippingPrices: renderingReceipt.shippingPrices,
    totalPrice: renderingReceipt.totalAmount,
    tipAmount: renderingReceipt.tipAmount,
    invoice: renderingReceipt.invoice,
    checkoutInfo: checkoutInfo,
    title: renderingReceipt.title,
    description: renderingReceipt.description,
    photo: renderingReceipt.photo
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    receipt
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global).payment;
  return {
    receipt
  };
})(ReceiptModal)));
function getCheckoutInfo(paymentMethod, info, shippingMethod) {
  if (!info) {
    return {
      paymentMethod
    };
  }
  const {
    shippingAddress
  } = info;
  const fullAddress = shippingAddress?.streetLine1 ? `${shippingAddress.streetLine1}, ${shippingAddress.city}, ${shippingAddress.countryIso2}` : undefined;
  const {
    phone,
    name
  } = info;
  return {
    paymentMethod,
    shippingAddress: fullAddress,
    name,
    phone,
    shippingMethod
  };
}

/***/ }),

/***/ "./src/components/payment/SavedPaymentCredentials.tsx":
/*!************************************************************!*\
  !*** ./src/components/payment/SavedPaymentCredentials.tsx ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");





const SavedPaymentCredentials = ({
  state,
  savedCredentials,
  dispatch,
  onNewCardClick
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const options = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return savedCredentials?.length ? savedCredentials.map(({
      id,
      title
    }) => ({
      label: title,
      value: id
    })) : _util_memo__WEBPACK_IMPORTED_MODULE_1__.MEMO_EMPTY_ARRAY;
  }, [savedCredentials]);
  const onChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'changeSavedCredentialId',
      payload: value
    });
  }, [dispatch]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "PaymentInfo"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("form", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h5", null, lang('PaymentCardTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_4__["default"], {
    name: "saved-credentials",
    options: options,
    selected: state.savedCredentialId,
    onChange: onChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_3__["default"], {
    isText: true,
    onClick: onNewCardClick
  }, lang('PaymentCheckoutMethodNewCard'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(SavedPaymentCredentials));

/***/ }),

/***/ "./src/components/payment/Shipping.tsx":
/*!*********************************************!*\
  !*** ./src/components/payment/Shipping.tsx ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_formatCurrency__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/formatCurrency */ "./src/util/formatCurrency.tsx");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");
/* harmony import */ var _Shipping_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Shipping.scss */ "./src/components/payment/Shipping.scss");





const Shipping = ({
  state,
  shippingOptions,
  currency,
  dispatch
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!shippingOptions || !shippingOptions.length || state.shipping) {
      return;
    }
    dispatch({
      type: 'changeShipping',
      payload: shippingOptions[0].id
    });
  }, [shippingOptions, state.shipping, dispatch]);
  const handleShippingSelect = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    dispatch({
      type: 'changeShipping',
      payload: value
    });
  }, [dispatch]);
  const options = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => shippingOptions.map(({
    id: value,
    title: label,
    amount
  }) => ({
    label,
    subLabel: (0,_util_formatCurrency__WEBPACK_IMPORTED_MODULE_1__.formatCurrency)(amount, currency, lang.code),
    value
  })), [shippingOptions, currency, lang.code]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Shipping"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("form", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, lang('PaymentShippingMethod')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_3__["default"], {
    name: "shipping-options",
    options: options,
    onChange: handleShippingSelect,
    selected: state.shipping
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(Shipping));

/***/ }),

/***/ "./src/components/payment/ShippingInfo.tsx":
/*!*************************************************!*\
  !*** ./src/components/payment/ShippingInfo.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _hooks_useFocusAfterAnimation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../hooks/useFocusAfterAnimation */ "./src/hooks/useFocusAfterAnimation.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Select__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/Select */ "./src/components/ui/Select.tsx");
/* harmony import */ var _ShippingInfo_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ShippingInfo.scss */ "./src/components/payment/ShippingInfo.scss");








const ShippingInfo = ({
  state,
  needEmail,
  needPhone,
  needName,
  needAddress,
  countryList,
  dispatch
}) => {
  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const phoneRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const selectCountryRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (selectCountryRef.current && selectCountryRef.current.value !== state.countryIso2) {
      selectCountryRef.current.value = state.countryIso2;
    }
  }, [state.countryIso2]);
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_3__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  (0,_hooks_useFocusAfterAnimation__WEBPACK_IMPORTED_MODULE_1__["default"])(inputRef);
  const handleAddress1Change = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeAddress1',
      payload: e.target.value
    });
  }, [dispatch]);
  const handleAddress2Change = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeAddress2',
      payload: e.target.value
    });
  }, [dispatch]);
  const handleCityChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeCity',
      payload: e.target.value
    });
  }, [dispatch]);
  const handleStateChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeState',
      payload: e.target.value
    });
  }, [dispatch]);
  const handleCountryChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeCountry',
      payload: countryList.find(country => country.iso2 === e.target.value)
    });
  }, [countryList, dispatch]);
  const handlePostCodeChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changePostCode',
      payload: e.target.value
    });
  }, [dispatch]);
  const handleFullNameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeFullName',
      payload: e.target.value
    });
  }, [dispatch]);
  const handleEmailChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeEmail',
      payload: e.target.value
    });
  }, [dispatch]);
  const handlePhoneChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    let {
      value
    } = e.target;
    value = `+${value.replace(/\D/g, '')}`;
    if (phoneRef.current) {
      phoneRef.current.value = value;
    }
    dispatch({
      type: 'changePhone',
      payload: value
    });
  }, [dispatch]);
  const handleSaveInfoChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    dispatch({
      type: 'changeSaveInfo',
      payload: e.target.value
    });
  }, [dispatch]);
  const {
    formErrors
  } = state;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ShippingInfo"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("form", null, needAddress ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h5", null, oldLang('PaymentShippingAddress')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    ref: inputRef,
    label: oldLang('PaymentShippingAddress1Placeholder'),
    onChange: handleAddress1Change,
    value: state.streetLine1,
    inputMode: "text",
    tabIndex: 0,
    error: formErrors.streetLine1 && lang.withRegular(formErrors.streetLine1)
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    label: oldLang('PaymentShippingAddress2Placeholder'),
    onChange: handleAddress2Change,
    value: state.streetLine2,
    inputMode: "text",
    tabIndex: 0,
    error: formErrors.streetLine2 && lang.withRegular(formErrors.streetLine2)
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    label: oldLang('PaymentShippingCityPlaceholder'),
    onChange: handleCityChange,
    value: state.city,
    inputMode: "text",
    tabIndex: 0,
    error: formErrors.city && lang.withRegular(formErrors.city)
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    label: oldLang('PaymentShippingStatePlaceholder'),
    onChange: handleStateChange,
    value: state.state,
    inputMode: "text",
    error: formErrors.state && lang.withRegular(formErrors.state)
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Select__WEBPACK_IMPORTED_MODULE_6__["default"], {
    label: oldLang('PaymentShippingCountry'),
    onChange: handleCountryChange,
    value: state.countryIso2,
    hasArrow: Boolean(true),
    id: "shipping-country",
    error: formErrors.countryIso2 && lang.withRegular(formErrors.countryIso2),
    ref: selectCountryRef,
    tabIndex: 0
  }, countryList.map(({
    defaultName,
    name,
    iso2
  }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("option", {
    value: iso2,
    className: "county-item",
    selected: iso2 === state.countryIso2
  }, defaultName || name))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    label: oldLang('PaymentShippingZipPlaceholder'),
    onChange: handlePostCodeChange,
    value: state.postCode,
    inputMode: "text",
    tabIndex: 0,
    error: formErrors.postCode && lang.withRegular(formErrors.postCode)
  })) : undefined, needName || needEmail || needPhone ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h5", null, oldLang('PaymentShippingReceiver')) : undefined, needName && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    label: oldLang('PaymentShippingName'),
    onChange: handleFullNameChange,
    value: state.fullName,
    inputMode: "text",
    tabIndex: 0,
    error: formErrors.fullName && lang.withRegular(formErrors.fullName)
  }), needEmail && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    label: oldLang('PaymentShippingEmailPlaceholder'),
    onChange: handleEmailChange,
    value: state.email,
    inputMode: "email",
    tabIndex: 0,
    error: formErrors.email && lang.withRegular(formErrors.email)
  }), needPhone && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_5__["default"], {
    label: oldLang('PaymentShippingPhoneNumber'),
    onChange: handlePhoneChange,
    value: state.phone,
    inputMode: "tel",
    tabIndex: 0,
    error: formErrors.phone && lang.withRegular(formErrors.phone),
    ref: phoneRef
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_4__["default"], {
    label: oldLang('PaymentShippingSave'),
    subLabel: oldLang('PaymentShippingSaveInfo'),
    checked: Boolean(state.saveInfo),
    tabIndex: 0,
    onChange: handleSaveInfoChange
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(ShippingInfo));

/***/ }),

/***/ "./src/components/right/CreateTopic.tsx":
/*!**********************************************!*\
  !*** ./src/components/right/CreateTopic.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_cycleRestrict__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/cycleRestrict */ "./src/util/cycleRestrict.ts");
/* harmony import */ var _util_forumColors__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/forumColors */ "./src/util/forumColors.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/CustomEmojiPicker */ "./src/components/common/CustomEmojiPicker.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_TopicIcon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../common/TopicIcon */ "./src/components/common/TopicIcon.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./ManageTopic.module.scss */ "./src/components/right/ManageTopic.module.scss");


















const ICON_SIZE = 5 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_7__.REM;
const CreateTopic = ({
  isActive,
  chat,
  createTopicPanel,
  isCurrentUserPremium,
  onClose
}) => {
  const {
    createTopic,
    openPremiumModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [title, setTitle] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [iconColorIndex, setIconColorIndex] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(0);
  const [iconEmojiId, setIconEmojiId] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const isTouched = Boolean(title);
  const isLoading = Boolean(createTopicPanel?.isLoading);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__["default"])({
    isActive,
    onBack: onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isActive) {
      setTitle('');
      setIconEmojiId(undefined);
    }
  }, [isActive]);
  const handleTitleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setTitle(e.target.value);
  }, []);
  const handleIconClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setIconColorIndex(prev => (0,_util_cycleRestrict__WEBPACK_IMPORTED_MODULE_5__["default"])((0,_util_forumColors__WEBPACK_IMPORTED_MODULE_6__.getTopicColors)().length, prev + 1));
  }, []);
  const handleCreateTopic = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    createTopic({
      chatId: chat.id,
      title,
      iconColor: (0,_util_forumColors__WEBPACK_IMPORTED_MODULE_6__.getTopicColors)()[iconColorIndex],
      iconEmojiId
    });
  }, [chat, createTopic, iconColorIndex, iconEmojiId, title]);
  const handleCustomEmojiSelect = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(emoji => {
    if (!emoji.isFree && !isCurrentUserPremium && emoji.id !== _config__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_TOPIC_ICON_STICKER_ID) {
      openPremiumModal({
        initialSection: 'animated_emoji'
      });
      return;
    }
    if (emoji.id === _config__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_TOPIC_ICON_STICKER_ID) {
      setIconEmojiId(undefined);
      return;
    }
    setIconEmojiId(emoji.id);
  }, [isCurrentUserPremium, openPremiumModal]);
  const dummyTopic = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return {
      id: 0,
      title,
      iconColor: (0,_util_forumColors__WEBPACK_IMPORTED_MODULE_6__.getTopicColors)()[iconColorIndex],
      iconEmojiId
    };
  }, [iconColorIndex, iconEmojiId, title]);
  if (!chat?.isForum) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].root
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].content, 'custom-scroll')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].section, _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].top)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].heading
  }, lang('CreateTopicTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_16__["default"], {
    name: "zoomFade",
    activeKey: Number(dummyTopic.iconEmojiId) || 0,
    shouldCleanup: true,
    direction: 1,
    className: _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].iconWrapper
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_TopicIcon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    topic: dummyTopic,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].icon, _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].clickable),
    onClick: handleIconClick,
    size: ICON_SIZE,
    noLoopLimit: true
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_14__["default"], {
    value: title,
    onChange: handleTitleChange,
    label: lang('lng_forum_topic_title'),
    disabled: isLoading,
    teactExperimentControlled: true
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].section, _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].bottom)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_10__["default"], {
    idPrefix: "create-topic-icons-set-",
    isHidden: !isActive,
    loadAndPlay: isActive,
    onCustomEmojiSelect: handleCustomEmojiSelect,
    className: _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_17__["default"].iconPicker,
    pickerListClassName: "fab-padding-bottom",
    withDefaultTopicIcons: true
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isShown: isTouched,
    disabled: isLoading,
    onClick: handleCreateTopic,
    ariaLabel: lang('Save')
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
    name: "check"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    createTopicPanel
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global);
  return {
    chat: createTopicPanel?.chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, createTopicPanel.chatId) : undefined,
    createTopicPanel,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global)
  };
})(CreateTopic)));

/***/ }),

/***/ "./src/components/right/EditTopic.tsx":
/*!********************************************!*\
  !*** ./src/components/right/EditTopic.tsx ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common/CustomEmojiPicker */ "./src/components/common/CustomEmojiPicker.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_TopicIcon__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/TopicIcon */ "./src/components/common/TopicIcon.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./ManageTopic.module.scss */ "./src/components/right/ManageTopic.module.scss");

















const ICON_SIZE = 5 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_5__.REM;
const RESET_ICON_ID = '0';
const EditTopic = ({
  isActive,
  chat,
  topic,
  editTopicPanel,
  isCurrentUserPremium,
  onClose
}) => {
  const {
    editTopic,
    openPremiumModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [title, setTitle] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [iconEmojiId, setIconEmojiId] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const isLoading = Boolean(editTopicPanel?.isLoading);
  const isGeneral = topic?.id === _config__WEBPACK_IMPORTED_MODULE_2__.GENERAL_TOPIC_ID;
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__["default"])({
    isActive,
    onBack: onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isActive) {
      setTitle('');
      setIconEmojiId(undefined);
    }
  }, [isActive]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (topic?.title || topic?.iconEmojiId) {
      setTitle(topic.title);
      setIconEmojiId(topic.iconEmojiId);
    }
  }, [topic]);
  const isTouched = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return title !== topic?.title || iconEmojiId !== topic?.iconEmojiId;
  }, [iconEmojiId, title, topic?.iconEmojiId, topic?.title]);
  const handleTitleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const newTitle = e.target.value;
    setTitle(newTitle);
  }, []);
  const handleEditTopic = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    editTopic({
      chatId: chat.id,
      title,
      topicId: topic.id,
      iconEmojiId
    });
  }, [chat, editTopic, iconEmojiId, title, topic]);
  const handleCustomEmojiSelect = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(emoji => {
    if (!emoji.isFree && !isCurrentUserPremium && emoji.id !== _config__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_TOPIC_ICON_STICKER_ID) {
      openPremiumModal({
        initialSection: 'animated_emoji'
      });
      return;
    }
    if (emoji.id === _config__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_TOPIC_ICON_STICKER_ID) {
      setIconEmojiId(RESET_ICON_ID);
      return;
    }
    setIconEmojiId(emoji.id);
  }, [isCurrentUserPremium, openPremiumModal]);
  const dummyTopic = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return {
      ...topic,
      title,
      iconEmojiId
    };
  }, [iconEmojiId, title, topic]);
  if (!chat?.isForum) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].root
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].content, 'custom-scroll')
  }, !topic && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_13__["default"], null), topic && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].section, _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].top, isGeneral && _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].general)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].heading
  }, lang(isGeneral ? 'CreateGeneralTopicTitle' : 'CreateTopicTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: "zoomFade",
    activeKey: Number(dummyTopic.iconEmojiId) || 0,
    shouldCleanup: true,
    direction: 1,
    className: _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].iconWrapper
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_TopicIcon__WEBPACK_IMPORTED_MODULE_10__["default"], {
    topic: dummyTopic,
    className: _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].icon,
    size: ICON_SIZE,
    noLoopLimit: true
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_12__["default"], {
    value: title,
    onChange: handleTitleChange,
    label: lang('lng_forum_topic_title'),
    disabled: isLoading,
    teactExperimentControlled: true
  })), !isGeneral && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].section, _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].bottom)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CustomEmojiPicker__WEBPACK_IMPORTED_MODULE_8__["default"], {
    idPrefix: "edit-topic-icons-set-",
    isHidden: !isActive,
    loadAndPlay: isActive,
    onCustomEmojiSelect: handleCustomEmojiSelect,
    className: _ManageTopic_module_scss__WEBPACK_IMPORTED_MODULE_16__["default"].iconPicker,
    pickerListClassName: "fab-padding-bottom",
    withDefaultTopicIcons: true
  })))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isShown: isTouched,
    disabled: isLoading,
    onClick: handleEditTopic,
    ariaLabel: lang('Save')
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_14__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    name: "check"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    editTopicPanel
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global);
  const chat = editTopicPanel?.chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, editTopicPanel.chatId) : undefined;
  const topic = editTopicPanel?.chatId && editTopicPanel?.topicId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTopic)(global, editTopicPanel.chatId, editTopicPanel.topicId) : undefined;
  return {
    chat,
    topic,
    editTopicPanel,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global)
  };
})(EditTopic)));

/***/ }),

/***/ "./src/components/right/GifSearch.tsx":
/*!********************************************!*\
  !*** ./src/components/right/GifSearch.tsx ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useSchedule__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useSchedule */ "./src/hooks/useSchedule.tsx");
/* harmony import */ var _common_GifButton__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/GifButton */ "./src/components/common/GifButton.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _GifSearch_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./GifSearch.scss */ "./src/components/right/GifSearch.scss");














const PRELOAD_BACKWARDS = 96; // GIF Search bot results are multiplied by 24
const INTERSECTION_DEBOUNCE = 300;
const GifSearch = ({
  isActive,
  query,
  results,
  chat,
  chatFullInfo,
  isChatWithBot,
  canScheduleUntilOnline,
  isSavedMessages,
  canPostInChat,
  currentMessageList,
  onClose
}) => {
  const {
    searchMoreGifs,
    sendMessage,
    setGifSearchQuery
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [requestCalendar, calendar] = (0,_hooks_useSchedule__WEBPACK_IMPORTED_MODULE_9__["default"])(canScheduleUntilOnline);
  const {
    observe: observeIntersection
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_7__.useIntersectionObserver)({
    rootRef: containerRef,
    debounceMs: INTERSECTION_DEBOUNCE
  });
  const canSendGifs = canPostInChat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getAllowedAttachmentOptions)(chat, chatFullInfo, isChatWithBot).canSendGifs;
  const handleGifClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((gif, isSilent, shouldSchedule) => {
    if (canSendGifs) {
      if (!currentMessageList) {
        return;
      }
      if (shouldSchedule) {
        requestCalendar(scheduledAt => {
          sendMessage({
            messageList: currentMessageList,
            gif,
            scheduledAt,
            isSilent
          });
        });
      } else {
        sendMessage({
          messageList: currentMessageList,
          gif,
          isSilent
        });
      }
    }
    if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_5__.IS_TOUCH_ENV) {
      setGifSearchQuery({
        query: undefined
      });
    }
  }, [canSendGifs, currentMessageList, requestCalendar]);
  const handleSearchMoreGifs = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    searchMoreGifs();
  }, [searchMoreGifs]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__["default"])({
    isActive,
    onBack: onClose
  });
  function renderContent() {
    if (query === undefined) {
      return undefined;
    }
    if (!results) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_12__["default"], null);
    }
    if (!results.length) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
        className: "helper-text",
        dir: "auto"
      }, lang('NoGIFsFound'));
    }
    return results.map(gif => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GifButton__WEBPACK_IMPORTED_MODULE_10__["default"], {
      key: gif.id,
      gif: gif,
      observeIntersection: observeIntersection,
      onClick: canSendGifs ? handleGifClick : undefined,
      isSavedMessages: isSavedMessages
    }));
  }
  const hasResults = Boolean(query !== undefined && results && results.length);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "GifSearch",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_11__["default"], {
    ref: containerRef,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('gif-container custom-scroll', hasResults && 'grid'),
    items: results,
    itemSelector: ".GifButton",
    preloadBackwards: PRELOAD_BACKWARDS,
    noFastList: true,
    onLoadMore: handleSearchMoreGifs
  }, renderContent()), calendar);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const currentSearch = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentGifSearch)(global);
  const {
    query,
    results
  } = currentSearch || {};
  const {
    chatId,
    threadId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentMessageList)(global) || {};
  const chat = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId) : undefined;
  const chatFullInfo = chatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chatId) : undefined;
  const isChatWithBot = chat ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsChatWithBot)(global, chat) : undefined;
  const isSavedMessages = Boolean(chatId) && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsChatWithSelf)(global, chatId);
  const threadInfo = chatId && threadId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectThreadInfo)(global, chatId, threadId) : undefined;
  const isMessageThread = Boolean(!threadInfo?.isCommentsInfo && threadInfo?.fromChannelId);
  const topic = chatId && threadId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTopic)(global, chatId, threadId) : undefined;
  const canPostInChat = Boolean(chat) && Boolean(threadId) && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getCanPostInChat)(chat, topic, isMessageThread, chatFullInfo);
  return {
    query,
    results,
    chat,
    isChatWithBot,
    isSavedMessages,
    canPostInChat,
    canScheduleUntilOnline: Boolean(chatId) && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCanScheduleUntilOnline)(global, chatId),
    currentMessageList: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentMessageList)(global)
  };
})(GifSearch)));

/***/ }),

/***/ "./src/components/right/PollAnswerResults.tsx":
/*!****************************************************!*\
  !*** ./src/components/right/PollAnswerResults.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/helpers/renderTextWithEntities */ "./src/components/common/helpers/renderTextWithEntities.tsx");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/GroupChatInfo */ "./src/components/common/GroupChatInfo.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_ShowMoreButton__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/ShowMoreButton */ "./src/components/ui/ShowMoreButton.tsx");
/* harmony import */ var _PollAnswerResults_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./PollAnswerResults.scss */ "./src/components/right/PollAnswerResults.scss");













const INITIAL_LIMIT = 4;
const VIEW_MORE_LIMIT = 50;
const PollAnswerResults = ({
  chat,
  message,
  answer,
  answerVote,
  totalVoters,
  voters,
  offset
}) => {
  const {
    loadPollOptionResults,
    openChat,
    closePollResults
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const prevVotersCount = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_6__["default"])(answerVote.votersCount);
  const [isLoading, setIsLoading] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const areVotersLoaded = Boolean(voters);
  const {
    option,
    text
  } = answer;
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    // For update when new votes arrive or when the user takes back his vote
    if (!areVotersLoaded || prevVotersCount !== answerVote.votersCount) {
      loadPollOptionResults({
        chat,
        messageId: message.id,
        option,
        offset,
        limit: INITIAL_LIMIT,
        shouldResetVoters: true
      });
    }
    // eslint-disable-next-line
  }, [answerVote.votersCount, areVotersLoaded]);
  const handleViewMoreClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setIsLoading(true);
    loadPollOptionResults({
      chat,
      messageId: message.id,
      option,
      offset,
      limit: VIEW_MORE_LIMIT
    });
  }, [chat, loadPollOptionResults, message.id, offset, option]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setIsLoading(false);
  }, [voters]);
  const handleMemberClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(id => {
    openChat({
      id
    });
    closePollResults();
  }, [closePollResults, openChat]);
  function renderViewMoreButton() {
    const leftVotersCount = answerVote.votersCount - voters.length;
    return answerVote.votersCount > INITIAL_LIMIT && leftVotersCount > 0 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ShowMoreButton__WEBPACK_IMPORTED_MODULE_11__["default"], {
      count: leftVotersCount,
      itemName: "voter",
      isLoading: isLoading,
      onClick: handleViewMoreClick
    });
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "PollAnswerResults"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "poll-voters"
  }, voters ? voters.map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    key: id,
    className: "chat-item-clickable"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleMemberClick(id)
  }, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(id) ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_8__["default"], {
    avatarSize: "tiny",
    userId: id,
    forceShowSelf: true,
    noStatusOrTyping: true
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_7__["default"], {
    avatarSize: "tiny",
    chatId: id,
    noStatusOrTyping: true
  }))) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_10__["default"], null), voters && renderViewMoreButton()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "answer-head",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "answer-title",
    dir: "auto"
  }, (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_4__.renderTextWithEntities)({
    text: text.text,
    entities: text.entities
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "answer-percent",
    dir: lang.isRtl ? 'auto' : undefined
  }, getPercentage(answerVote.votersCount, totalVoters), "%")));
};
function getPercentage(value, total) {
  return total > 0 ? (value / total * 100).toFixed() : 0;
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  answer
}) => {
  const {
    voters,
    offsets
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).pollResults;
  return {
    voters: voters?.[answer.option],
    offset: offsets?.[answer.option] || ''
  };
})(PollAnswerResults)));

/***/ }),

/***/ "./src/components/right/PollResults.tsx":
/*!**********************************************!*\
  !*** ./src/components/right/PollResults.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/helpers/renderTextWithEntities */ "./src/components/common/helpers/renderTextWithEntities.tsx");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _PollAnswerResults__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./PollAnswerResults */ "./src/components/right/PollAnswerResults.tsx");
/* harmony import */ var _PollResults_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./PollResults.scss */ "./src/components/right/PollResults.scss");










const PollResults = ({
  isActive,
  chat,
  message,
  poll,
  onClose
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onClose
  });
  if (!message || !poll || !chat) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_7__["default"], null);
  }
  const {
    summary,
    results
  } = poll;
  if (!results.results) {
    return undefined;
  }
  const resultsByOption = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_3__.buildCollectionByKey)(results.results, 'option');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "PollResults",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "poll-question",
    dir: "auto"
  }, (0,_common_helpers_renderTextWithEntities__WEBPACK_IMPORTED_MODULE_4__.renderTextWithEntities)({
    text: summary.question.text,
    entities: summary.question.entities
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "poll-results-list custom-scroll"
  }, summary.answers.map(answer => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_PollAnswerResults__WEBPACK_IMPORTED_MODULE_8__["default"], {
    key: `${poll.id}-${answer.option}`,
    chat: chat,
    message: message,
    answer: answer,
    answerVote: resultsByOption[answer.option],
    totalVoters: results.totalVoters
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    pollResults: {
      chatId,
      messageId
    }
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global);
  if (!chatId || !messageId) {
    return {};
  }
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectChat)(global, chatId);
  const message = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectChatMessage)(global, chatId, messageId);
  const poll = message && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectPollFromMessage)(global, message);
  return {
    chat,
    message,
    poll
  };
})(PollResults)));

/***/ }),

/***/ "./src/components/right/StickerSearch.tsx":
/*!************************************************!*\
  !*** ./src/components/right/StickerSearch.tsx ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useIntersectionObserver */ "./src/hooks/useIntersectionObserver.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _StickerSetResult__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./StickerSetResult */ "./src/components/right/StickerSetResult.tsx");
/* harmony import */ var _StickerSearch_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./StickerSearch.scss */ "./src/components/right/StickerSearch.scss");










const INTERSECTION_THROTTLE = 200;
const runThrottled = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_3__.throttle)(cb => cb(), 60000, true);
const StickerSearch = ({
  isActive,
  query,
  featuredIds,
  resultIds,
  isModalOpen,
  onClose
}) => {
  const {
    loadFeaturedStickers
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const {
    observe: observeIntersection
  } = (0,_hooks_useIntersectionObserver__WEBPACK_IMPORTED_MODULE_5__.useIntersectionObserver)({
    rootRef: containerRef,
    throttleMs: INTERSECTION_THROTTLE
  });

  // Due to the parent Transition, this component never gets unmounted,
  // that's why we use throttled API call on every update.
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    runThrottled(() => {
      loadFeaturedStickers();
    });
  });
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_4__["default"])({
    isActive,
    onBack: onClose
  });
  function renderContent() {
    if (query === undefined) {
      return undefined;
    }
    if (!query && featuredIds) {
      return featuredIds.map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerSetResult__WEBPACK_IMPORTED_MODULE_8__["default"], {
        key: id,
        stickerSetId: id,
        observeIntersection: observeIntersection,
        isModalOpen: isModalOpen
      }));
    }
    if (resultIds) {
      if (!resultIds.length) {
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
          className: "helper-text",
          dir: "auto"
        }, "Nothing found.");
      }
      return resultIds.map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StickerSetResult__WEBPACK_IMPORTED_MODULE_8__["default"], {
        key: id,
        stickerSetId: id,
        observeIntersection: observeIntersection,
        isModalOpen: isModalOpen
      }));
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_7__["default"], null);
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef,
    className: "StickerSearch custom-scroll",
    dir: lang.isRtl ? 'rtl' : undefined
  }, renderContent());
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const currentSearch = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectCurrentStickerSearch)(global);
  const {
    query,
    resultIds
  } = currentSearch || {};
  const {
    featured
  } = global.stickers;
  return {
    query,
    featuredIds: featured.setIds,
    resultIds,
    isModalOpen: Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global).openedStickerSetShortName)
  };
})(StickerSearch)));

/***/ }),

/***/ "./src/components/right/StickerSetResult.tsx":
/*!***************************************************!*\
  !*** ./src/components/right/StickerSetResult.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_StickerButton__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/StickerButton */ "./src/components/common/StickerButton.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/Spinner */ "./src/components/ui/Spinner.tsx");








const PREMIUM_STICKERS_TO_DISPLAY = 3;
const STICKERS_TO_DISPLAY = 5;
const StickerSetResult = ({
  stickerSetId,
  observeIntersection,
  set,
  shouldPlay,
  isModalOpen,
  isCurrentUserPremium
}) => {
  const {
    loadStickers,
    toggleStickerSet,
    openStickerSet
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();

  // eslint-disable-next-line no-null/no-null
  const sharedCanvasRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const isAdded = set && !set.isArchived && Boolean(set.installedDate);
  const areStickersLoaded = Boolean(set?.stickers);
  const displayedStickers = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!set) {
      return [];
    }
    const premiumStickerIds = (set.stickers?.filter(({
      hasEffect
    }) => hasEffect) ?? []).slice(0, PREMIUM_STICKERS_TO_DISPLAY);
    const coverStickerIds = (set.covers || []).map(({
      id
    }) => id);
    const otherStickers = set.stickers ? set.stickers.filter(({
      id
    }) => !coverStickerIds.includes(id)) : [];
    return [...premiumStickerIds, ...(set.covers || []), ...otherStickers].slice(0, STICKERS_TO_DISPLAY);
  }, [set]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    // Featured stickers are initialized with one sticker in collection (cover of SickerSet)
    if (!areStickersLoaded && displayedStickers.length < STICKERS_TO_DISPLAY && set) {
      loadStickers({
        stickerSetInfo: {
          shortName: set.shortName
        }
      });
    }
  }, [areStickersLoaded, displayedStickers.length, loadStickers, set, stickerSetId]);
  const handleAddClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    toggleStickerSet({
      stickerSetId
    });
  }, [toggleStickerSet, stickerSetId]);
  const handleStickerClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(sticker => {
    openStickerSet({
      stickerSetInfo: sticker.stickerSetInfo
    });
  }, [openStickerSet]);
  if (!set) {
    return undefined;
  }
  const canRenderStickers = displayedStickers.length > 0;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    key: set.id,
    className: "sticker-set",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "sticker-set-header"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "title-wrapper"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "title",
    dir: "auto"
  }, set.title), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "count",
    dir: "auto"
  }, lang('Stickers', set.count, 'i'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_6__["default"], {
    className: isAdded ? 'is-added' : undefined,
    color: "primary",
    size: "tiny",
    pill: true,
    fluid: true,
    onClick: handleAddClick
  }, lang(isAdded ? 'Stickers.Installed' : 'Stickers.Install'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "sticker-set-main shared-canvas-container"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: sharedCanvasRef,
    className: "shared-canvas"
  }), !canRenderStickers && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_7__["default"], null), canRenderStickers && displayedStickers.map(sticker => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_StickerButton__WEBPACK_IMPORTED_MODULE_5__["default"], {
    sticker: sticker,
    size: _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_SEARCH,
    observeIntersection: observeIntersection,
    noPlay: !shouldPlay || isModalOpen,
    clickArg: sticker,
    onClick: handleStickerClick,
    noContextMenu: true,
    isCurrentUserPremium: isCurrentUserPremium,
    sharedCanvasRef: sharedCanvasRef
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  stickerSetId
}) => {
  return {
    set: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectStickerSet)(global, stickerSetId),
    shouldPlay: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectShouldLoopStickers)(global),
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global)
  };
})(StickerSetResult)));

/***/ }),

/***/ "./src/components/right/hooks/useManagePermissions.ts":
/*!************************************************************!*\
  !*** ./src/components/right/hooks/useManagePermissions.ts ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useManagePermissions)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");

const FLOATING_BUTTON_ANIMATION_TIMEOUT_MS = 250;
const MEDIA_PERMISSIONS = ['embedLinks', 'sendPolls', 'sendPhotos', 'sendVideos', 'sendRoundvideos', 'sendVoices', 'sendAudios', 'sendDocs', 'sendStickers', 'sendGifs'];
const MESSAGE_PERMISSIONS = [...MEDIA_PERMISSIONS, 'sendPlain'];
function useManagePermissions(defaultPermissions) {
  const [permissions, setPermissions] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)({});
  const [havePermissionChanged, setHavePermissionChanged] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isLoading, setIsLoading] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setPermissions(defaultPermissions || {});
    setHavePermissionChanged(false);
    setTimeout(() => {
      setIsLoading(false);
    }, FLOATING_BUTTON_ANIMATION_TIMEOUT_MS);
  }, [defaultPermissions]);
  const handlePermissionChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const {
      name: targetName
    } = e.target;
    const name = targetName;
    function getUpdatedPermissionValue(value) {
      return value ? undefined : true;
    }
    const oldPermissions = permissions;
    let newPermissions = {
      ...oldPermissions,
      [name]: getUpdatedPermissionValue(oldPermissions[name]),
      ...(name === 'sendStickers' && {
        sendGifs: getUpdatedPermissionValue(oldPermissions[name])
      })
    };
    const checkMedia = () => {
      const mediaPermissions = MEDIA_PERMISSIONS.map(key => newPermissions[key]);
      if (mediaPermissions.some(v => !v)) {
        newPermissions = {
          ...newPermissions,
          sendMedia: undefined
        };
      } else if (mediaPermissions.every(Boolean)) {
        newPermissions = {
          ...newPermissions,
          sendMedia: true
        };
      }
    };
    if (name !== 'sendMedia') {
      checkMedia();
    } else {
      newPermissions = {
        ...newPermissions,
        ...MEDIA_PERMISSIONS.reduce((acc, key) => Object.assign(acc, {
          [key]: newPermissions.sendMedia
        }), {})
      };
    }

    // Embed links can't be enabled if plain text is banned
    if (name !== 'embedLinks' && !newPermissions.embedLinks && newPermissions.sendPlain) {
      newPermissions = {
        ...newPermissions,
        embedLinks: true
      };
    }
    if (name !== 'sendPlain' && !newPermissions.embedLinks && newPermissions.sendPlain) {
      newPermissions = {
        ...newPermissions,
        sendPlain: undefined
      };
    }
    if (name !== 'sendMedia') {
      checkMedia();
    }
    const sendMessages = MESSAGE_PERMISSIONS.every(key => newPermissions[key]);
    newPermissions = {
      ...newPermissions,
      sendMessages: sendMessages ? true : undefined
    };
    setPermissions(newPermissions);
    setHavePermissionChanged(!defaultPermissions || Object.keys(newPermissions).some(k => {
      const key = k;
      return Boolean(defaultPermissions[key]) !== Boolean(newPermissions[key]);
    }));
  }, [defaultPermissions, permissions]);
  const resetPermissions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setPermissions(defaultPermissions || {});
    setHavePermissionChanged(false);
  }, [defaultPermissions]);
  return {
    permissions,
    isLoading,
    havePermissionChanged,
    handlePermissionChange,
    setIsLoading,
    resetPermissions
  };
}

/***/ }),

/***/ "./src/components/right/management/JoinRequest.tsx":
/*!*********************************************************!*\
  !*** ./src/components/right/management/JoinRequest.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _JoinRequest_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./JoinRequest.scss */ "./src/components/right/management/JoinRequest.scss");











const JoinRequest = ({
  userId,
  chatId,
  about,
  date,
  isChannel,
  user
}) => {
  const {
    openChat,
    hideChatJoinRequest
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const buildClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__.createClassNameBuilder)('JoinRequest');
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const fullName = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(user);
  const fixedDate = (date - (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_6__.getServerTime)()) * 1000 + Date.now();
  const dateString = (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.isToday)(new Date(fixedDate)) ? (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatTime)(lang, fixedDate) : (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatHumanDate)(lang, fixedDate, true, false, true);
  const handleUserClick = () => {
    openChat({
      id: userId
    });
  };
  const handleAcceptRequest = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    hideChatJoinRequest({
      chatId,
      userId,
      isApproved: true
    });
  }, [chatId, hideChatJoinRequest, userId]);
  const handleRejectRequest = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    hideChatJoinRequest({
      chatId,
      userId,
      isApproved: false
    });
  }, [chatId, hideChatJoinRequest, userId]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: buildClassName('&')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: buildClassName('top')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: buildClassName('user'),
    onClick: handleUserClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_8__["default"], {
    key: userId,
    size: "medium",
    peer: user
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: buildClassName('user-info')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: buildClassName('user-name')
  }, fullName), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: buildClassName('user-subtitle')
  }, about))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: buildClassName('date')
  }, dateString)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: buildClassName('buttons')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: buildClassName('button'),
    onClick: handleAcceptRequest
  }, isChannel ? lang('ChannelAddToChannel') : lang('ChannelAddToGroup')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: buildClassName('button'),
    isText: true,
    onClick: handleRejectRequest
  }, lang('DismissRequest'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  userId
}) => {
  const user = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectUser)(global, userId);
  return {
    user
  };
})(JoinRequest)));

/***/ }),

/***/ "./src/components/right/management/ManageBot.tsx":
/*!*******************************************************!*\
  !*** ./src/components/right/management/ManageBot.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _global_selectors_limits__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../global/selectors/limits */ "./src/global/selectors/limits.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/AvatarEditable */ "./src/components/ui/AvatarEditable.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_SelectAvatar__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/SelectAvatar */ "./src/components/ui/SelectAvatar.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _ui_TextArea__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/TextArea */ "./src/components/ui/TextArea.tsx");
/* harmony import */ var _Management_scss__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./Management.scss */ "./src/components/right/management/Management.scss");






















const ERROR_NAME_MISSING = 'Please provide name';
const ManageBot = ({
  userId,
  user,
  progress,
  onClose,
  currentBio,
  isActive,
  maxBioLength
}) => {
  const {
    setBotInfo,
    uploadProfilePhoto,
    uploadContactProfilePhoto,
    startBotFatherConversation
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isFieldTouched, markFieldTouched, unmarkProfileTouched] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__["default"])(false);
  const [isAvatarTouched, markAvatarTouched, unmarkAvatarTouched] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__["default"])(false);
  const [error, setError] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const username = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => user ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getMainUsername)(user) : undefined, [user]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__["default"])({
    isActive,
    onBack: onClose
  });
  const currentName = user ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getUserFirstOrLastName)(user) : '';
  const [photo, setPhoto] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [name, setName] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentName || '');
  const [bio, setBio] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentBio || '');
  const currentAvatarHash = user && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getChatAvatarHash)(user);
  const currentAvatarBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_11__["default"])(currentAvatarHash, false, _api_types__WEBPACK_IMPORTED_MODULE_2__.ApiMediaFormat.BlobUrl);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    unmarkProfileTouched();
    unmarkAvatarTouched();
  }, [userId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setName(currentName || '');
    setBio(currentBio || '');
  }, [currentName, currentBio, user]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setPhoto(undefined);
  }, [currentAvatarBlobUrl]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (progress === _types__WEBPACK_IMPORTED_MODULE_3__.ManagementProgress.Complete) {
      unmarkProfileTouched();
      unmarkAvatarTouched();
      setError(undefined);
    }
  }, [progress]);
  const handleNameChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    setName(e.target.value);
    markFieldTouched();
    if (error === ERROR_NAME_MISSING) {
      setError(undefined);
    }
  });
  const handleBioChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(e => {
    setBio(e.target.value);
    markFieldTouched();
  });
  const handlePhotoChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(newPhoto => {
    setPhoto(newPhoto);
    markAvatarTouched();
  });
  const handleProfileSave = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    const trimmedName = name.trim();
    const trimmedBio = bio.trim();
    if (!trimmedName.length) {
      setError(ERROR_NAME_MISSING);
      return;
    }
    setBotInfo({
      ...(isFieldTouched && {
        bot: user,
        name: trimmedName,
        description: trimmedBio
      })
    });
    if (photo) {
      uploadProfilePhoto({
        file: photo,
        ...(isAvatarTouched && {
          bot: user
        })
      });
    }
  });
  const handleChangeEditIntro = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    startBotFatherConversation({
      param: `${username}-intro`
    });
  });
  const handleChangeEditCommands = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    startBotFatherConversation({
      param: `${username}-commands`
    });
  });
  const handleChangeSettings = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(() => {
    startBotFatherConversation({
      param: `${username}`
    });
  });

  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const isSuggestRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);
  const handleSelectAvatar = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_10__["default"])(file => {
    markAvatarTouched();
    uploadContactProfilePhoto({
      userId,
      file,
      isSuggest: isSuggestRef.current
    });
  });
  if (!user) {
    return undefined;
  }
  const isLoading = progress === _types__WEBPACK_IMPORTED_MODULE_3__.ManagementProgress.InProgress;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_14__["default"], {
    currentAvatarBlobUrl: currentAvatarBlobUrl,
    onChange: handlePhotoChange,
    title: lang('ChatSetPhotoOrVideo'),
    disabled: isLoading
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_16__["default"], {
    id: "user-name",
    label: lang('PaymentCheckoutName'),
    onChange: handleNameChange,
    value: name,
    error: error === ERROR_NAME_MISSING ? error : undefined,
    teactExperimentControlled: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_TextArea__WEBPACK_IMPORTED_MODULE_20__["default"], {
    value: bio,
    onChange: handleBioChange,
    label: lang('DescriptionPlaceholder'),
    disabled: isLoading,
    maxLength: maxBioLength,
    maxLengthIndicator: maxBioLength ? (maxBioLength - bio.length).toString() : undefined
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "dialog-buttons"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
    icon: "bot-commands-filled",
    ripple: true,
    onClick: handleChangeEditIntro
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, lang('BotEditIntro'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
    icon: "bot-command",
    ripple: true,
    onClick: handleChangeEditCommands
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, lang('BotEditCommands'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
    icon: "bots",
    ripple: true,
    onClick: handleChangeSettings
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, lang('BotChangeSettings'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section-info section-info_push"
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__["default"])(lang('BotManageInfo'), ['links']))))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_15__["default"], {
    isShown: isFieldTouched || isAvatarTouched,
    onClick: handleProfileSave,
    disabled: isLoading,
    ariaLabel: lang('Save')
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_19__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_13__["default"], {
    name: "check"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_SelectAvatar__WEBPACK_IMPORTED_MODULE_18__["default"], {
    onChange: handleSelectAvatar,
    inputRef: inputRef
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  userId
}) => {
  const user = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectBot)(global, userId);
  const userFullInfo = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUserFullInfo)(global, userId);
  const {
    progress
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global).management;
  const maxBioLength = (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_6__.selectCurrentLimit)(global, 'aboutLength');
  return {
    userId,
    user,
    progress,
    currentBio: userFullInfo?.bio,
    maxBioLength
  };
})(ManageBot)));

/***/ }),

/***/ "./src/components/right/management/ManageChannel.tsx":
/*!***********************************************************!*\
  !*** ./src/components/right/management/ManageChannel.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_textFormat__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/textFormat */ "./src/util/textFormat.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/AvatarEditable */ "./src/components/ui/AvatarEditable.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _ui_TextArea__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/TextArea */ "./src/components/ui/TextArea.tsx");
/* harmony import */ var _Management_scss__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./Management.scss */ "./src/components/right/management/Management.scss");




















const CHANNEL_TITLE_EMPTY = 'Channel title can\'t be empty';
const CHANNEL_MAX_DESCRIPTION = 255;
const ManageChannel = ({
  chatId,
  chat,
  chatFullInfo,
  progress,
  canChangeInfo,
  canInvite,
  exportedInvites,
  isActive,
  availableReactions,
  onScreenSelect,
  onClose
}) => {
  const {
    updateChat,
    closeManagement,
    leaveChannel,
    deleteChannel,
    openChat,
    loadExportedChatInvites,
    loadChatJoinRequests
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const currentTitle = chat?.title || '';
  const currentAbout = chatFullInfo?.about || '';
  const hasLinkedChat = Boolean(chatFullInfo?.linkedChatId);
  const [isDeleteDialogOpen, openDeleteDialog, closeDeleteDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [isProfileFieldsTouched, setIsProfileFieldsTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [title, setTitle] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentTitle);
  const [about, setAbout] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentAbout);
  const [photo, setPhoto] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [error, setError] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const imageHash = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getChatAvatarHash)(chat);
  const currentAvatarBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_9__["default"])(imageHash, false, _api_types__WEBPACK_IMPORTED_MODULE_2__.ApiMediaFormat.BlobUrl);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__["default"])({
    isActive,
    onBack: onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!canInvite) return;
    loadExportedChatInvites({
      chatId
    });
    loadExportedChatInvites({
      chatId,
      isRevoked: true
    });
    loadChatJoinRequests({
      chatId
    });
  }, [chatId, canInvite]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (progress === _types__WEBPACK_IMPORTED_MODULE_3__.ManagementProgress.Complete) {
      setIsProfileFieldsTouched(false);
      setError(undefined);
    }
  }, [progress]);
  const adminsCount = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return Object.keys(chatFullInfo?.adminMembersById || {}).length;
  }, [chatFullInfo?.adminMembersById]);
  const removedUsersCount = chatFullInfo?.kickedMembers?.length || 0;
  const handleClickEditType = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.ChatPrivacyType);
  }, [onScreenSelect]);
  const handleClickDiscussion = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.Discussion);
  }, [onScreenSelect]);
  const handleClickReactions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.Reactions);
  }, [onScreenSelect]);
  const handleClickAdministrators = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.ChatAdministrators);
  }, [onScreenSelect]);
  const handleClickInvites = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.Invites);
  }, [onScreenSelect]);
  const handleClickRequests = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.JoinRequests);
  }, [onScreenSelect]);
  const handleSetPhoto = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(file => {
    setPhoto(file);
    setIsProfileFieldsTouched(true);
  }, []);
  const handleTitleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setTitle(e.target.value);
    setIsProfileFieldsTouched(true);
  }, []);
  const handleAboutChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setAbout(e.target.value);
    setIsProfileFieldsTouched(true);
  }, []);
  const handleUpdateChannel = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const trimmedTitle = title.trim();
    const trimmedAbout = about.trim();
    if (!trimmedTitle.length) {
      setError(CHANNEL_TITLE_EMPTY);
      return;
    }
    updateChat({
      chatId,
      title: trimmedTitle,
      about: trimmedAbout,
      photo
    });
  }, [about, chatId, photo, title, updateChat]);
  const handleClickSubscribers = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.ChannelSubscribers);
  }, [onScreenSelect]);
  const handleRemovedUsersClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.ChannelRemovedUsers);
  }, [onScreenSelect]);
  const handleDeleteChannel = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (chat.isCreator) {
      deleteChannel({
        chatId: chat.id
      });
    } else {
      leaveChannel({
        chatId: chat.id
      });
    }
    closeDeleteDialog();
    closeManagement();
    openChat({
      id: undefined
    });
  }, [chat.isCreator, chat.id, closeDeleteDialog, closeManagement, leaveChannel, deleteChannel, openChat]);
  const chatReactionsDescription = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!chatFullInfo?.enabledReactions) {
      return lang('ReactionsOff');
    }
    if (chatFullInfo.enabledReactions.type === 'all') {
      return lang('ReactionsAll');
    }
    const enabledLength = chatFullInfo.enabledReactions.allowed.length;
    const totalLength = availableReactions?.filter(reaction => !reaction.isInactive).length || 0;
    return totalLength ? `${enabledLength} / ${totalLength}` : `${enabledLength}`;
  }, [availableReactions, chatFullInfo?.enabledReactions, lang]);
  const isChannelPublic = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatPublic)(chat), [chat]);
  if (chat.isRestricted || chat.isForbidden) {
    return undefined;
  }
  const isLoading = progress === _types__WEBPACK_IMPORTED_MODULE_3__.ManagementProgress.InProgress;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_12__["default"], {
    currentAvatarBlobUrl: currentAvatarBlobUrl,
    onChange: handleSetPhoto,
    disabled: !canChangeInfo
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-edit"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_15__["default"], {
    id: "channel-title",
    label: lang('EnterChannelName'),
    onChange: handleTitleChange,
    value: title,
    error: error === CHANNEL_TITLE_EMPTY ? error : undefined,
    disabled: !canChangeInfo
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_TextArea__WEBPACK_IMPORTED_MODULE_18__["default"], {
    id: "channel-about",
    label: lang('DescriptionPlaceholder'),
    onChange: handleAboutChange,
    value: about,
    maxLength: CHANNEL_MAX_DESCRIPTION,
    maxLengthIndicator: (CHANNEL_MAX_DESCRIPTION - about.length).toString(),
    disabled: !canChangeInfo,
    noReplaceNewlines: true
  })), chat.isCreator && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "lock",
    multiline: true,
    onClick: handleClickEditType
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('ChannelType')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, isChannelPublic ? lang('TypePublic') : lang('TypePrivate'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "message",
    multiline: true,
    onClick: handleClickDiscussion,
    disabled: !canChangeInfo
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('Discussion')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, hasLinkedChat ? lang('DiscussionUnlink') : lang('Add'))), canInvite && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "link",
    onClick: handleClickInvites,
    multiline: true,
    disabled: !exportedInvites
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('GroupInfo.InviteLinks')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, exportedInvites ? (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_6__.formatInteger)(exportedInvites.length) : lang('Loading'))), Boolean(chat.joinRequests?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "add-user-filled",
    onClick: handleClickRequests,
    multiline: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('SubscribeRequests')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_6__.formatInteger)(chat.joinRequests.length))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "heart-outline",
    multiline: true,
    onClick: handleClickReactions,
    disabled: !canChangeInfo
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('Reactions')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, chatReactionsDescription))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "admin",
    multiline: true,
    onClick: handleClickAdministrators
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('ChannelAdministrators')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, adminsCount)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "group",
    multiline: true,
    onClick: handleClickSubscribers
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title",
    dir: "auto"
  }, lang('ChannelSubscribers')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_6__.formatInteger)(chat.membersCount))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "delete-user",
    multiline: true,
    onClick: handleRemovedUsersClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('ChannelBlockedUsers')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, removedUsersCount))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "delete",
    ripple: true,
    destructive: true,
    onClick: openDeleteDialog
  }, chat.isCreator ? lang('ChannelDelete') : lang('LeaveChannel')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isShown: isProfileFieldsTouched,
    onClick: handleUpdateChannel,
    disabled: isLoading,
    ariaLabel: lang('Save')
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_17__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
    name: "check"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isDeleteDialogOpen,
    onClose: closeDeleteDialog,
    text: chat.isCreator ? lang('ChannelDeleteAlert') : lang('ChannelLeaveAlert'),
    confirmLabel: chat.isCreator ? lang('ChannelDelete') : lang('LeaveChannel'),
    confirmHandler: handleDeleteChannel,
    confirmIsDestructive: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, chatId);
  const {
    management
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global);
  const {
    progress
  } = management;
  const {
    invites
  } = management.byChatId[chatId] || {};
  return {
    chat,
    chatFullInfo: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChatFullInfo)(global, chatId),
    progress,
    canChangeInfo: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getHasAdminRight)(chat, 'changeInfo'),
    canInvite: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getHasAdminRight)(chat, 'inviteUsers'),
    exportedInvites: invites,
    availableReactions: global.reactions.availableReactions
  };
}, (global, {
  chatId
}) => {
  return Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, chatId));
})(ManageChannel)));

/***/ }),

/***/ "./src/components/right/management/ManageChatAdministrators.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/right/management/ManageChatAdministrators.tsx ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");














const ManageChatAdministrators = ({
  isActive,
  chat,
  isChannel,
  currentUserId,
  adminMembersById,
  onScreenSelect,
  onChatMemberSelect,
  onClose
}) => {
  const {
    toggleSignatures
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__["default"])({
    isActive,
    onBack: onClose
  });
  const areSignaturesEnabled = Boolean(chat?.areSignaturesShown);
  const areProfilesEnabled = Boolean(chat?.areProfilesShown);
  const canAddNewAdmins = Boolean(chat?.isCreator || chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getHasAdminRight)(chat, 'addAdmins'));
  const canToggleSignatures = isChannel && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getHasAdminRight)(chat, 'postMessages');
  const adminMembers = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!adminMembersById) {
      return [];
    }
    const [owner, admins] = (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_5__.partition)(Object.values(adminMembersById), member => member.isOwner);
    return [...owner, ...admins];
  }, [adminMembersById]);
  const handleAdminMemberClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(member => {
    onChatMemberSelect(member.userId, member.promotedByUserId === currentUserId);
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatAdminRights);
  });
  const handleToggleSignatures = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    toggleSignatures({
      chatId: chat.id,
      areProfilesEnabled,
      areSignaturesEnabled: !areSignaturesEnabled
    });
  });
  const handleToggleProfiles = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    toggleSignatures({
      chatId: chat.id,
      areProfilesEnabled: !areProfilesEnabled,
      areSignaturesEnabled
    });
  });
  const handleAddAdminClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupAddAdmins);
  });
  const getMemberStatus = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(member => {
    if (member.isOwner) {
      return lang('ChannelCreator');
    }

    // No need for expensive global updates on users, so we avoid them
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    const promotedByUser = member.promotedByUserId ? usersById[member.promotedByUserId] : undefined;
    if (promotedByUser) {
      return lang('EditAdminPromotedBy', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFullName)(promotedByUser));
    }
    return lang('ChannelAdmin');
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
    icon: "recent",
    multiline: true,
    disabled: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('EventLog')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, lang(isChannel ? 'EventLogInfoDetailChannel' : 'EventLogInfoDetail')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help",
    dir: "auto"
  }, lang(isChannel ? 'Channel.Management.AddModeratorHelp' : 'Group.Management.AddModeratorHelp')), adminMembers.map(member => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_13__["default"], {
    key: member.userId,
    className: "chat-item-clickable"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleAdminMemberClick(member)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_10__["default"], {
    userId: member.userId,
    status: getMemberStatus(member),
    forceShowSelf: true
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isShown: canAddNewAdmins,
    onClick: handleAddAdminClick,
    ariaLabel: lang('Channel.Management.AddModerator')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    name: "add-user-filled"
  }))), canToggleSignatures && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem narrow"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__["default"], {
    checked: areSignaturesEnabled,
    label: lang('ChannelSignMessages'),
    onChange: handleToggleSignatures
  })), areSignaturesEnabled && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem narrow"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_11__["default"], {
    checked: areProfilesEnabled,
    label: lang('ChannelSignMessagesWithProfile'),
    onChange: handleToggleProfiles
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-info section-info_push"
  }, lang('ChannelSignProfilesInfo'))))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  return {
    chat,
    currentUserId: global.currentUserId,
    isChannel: chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatChannel)(chat),
    adminMembersById: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId)?.adminMembersById
  };
})(ManageChatAdministrators)));

/***/ }),

/***/ "./src/components/right/management/ManageChatPrivacyType.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/right/management/ManageChatPrivacyType.tsx ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _global_selectors_limits__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../global/selectors/limits */ "./src/global/selectors/limits.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_ManageUsernames__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/ManageUsernames */ "./src/components/common/ManageUsernames.tsx");
/* harmony import */ var _common_SafeLink__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/SafeLink */ "./src/components/common/SafeLink.tsx");
/* harmony import */ var _common_UsernameInput__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/UsernameInput */ "./src/components/common/UsernameInput.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");





















const ManageChatPrivacyType = ({
  chat,
  isActive,
  isChannel,
  progress,
  isUsernameAvailable,
  checkedUsername,
  error,
  isProtected,
  maxPublicLinks,
  privateInviteLink,
  onClose
}) => {
  const {
    updatePublicLink,
    updatePrivateLink,
    toggleIsProtected,
    openLimitReachedModal,
    resetManagementError
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const firstEditableUsername = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => chat.usernames?.find(({
    isEditable
  }) => isEditable), [chat.usernames]);
  const currentUsername = firstEditableUsername?.username || '';
  const isPublic = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatPublic)(chat), [chat]);
  const [isProfileFieldsTouched, setIsProfileFieldsTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [privacyType, setPrivacyType] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(isPublic ? 'public' : 'private');
  const [editableUsername, setEditableUsername] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [isRevokeConfirmDialogOpen, openRevokeConfirmDialog, closeRevokeConfirmDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [isUsernameLostDialogOpen, openUsernameLostDialog, closeUsernameLostDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const previousIsUsernameAvailable = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(isUsernameAvailable);
  const renderingIsUsernameAvailable = isUsernameAvailable ?? previousIsUsernameAvailable;
  const canUpdate = isProfileFieldsTouched && Boolean(privacyType === 'public' && (editableUsername || currentUsername && editableUsername === '') && renderingIsUsernameAvailable || privacyType === 'private' && isPublic);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__["default"])({
    isActive,
    onBack: onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setIsProfileFieldsTouched(false);
  }, [currentUsername]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (privacyType && !privateInviteLink) {
      updatePrivateLink();
    }
  }, [privacyType, privateInviteLink, updatePrivateLink]);
  const handleUsernameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    setEditableUsername(value);
    setIsProfileFieldsTouched(true);
    if (error) {
      resetManagementError({
        chatId: chat.id
      });
    }
  }, [chat.id, error]);
  const handleOptionChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)((value, e) => {
    const myChats = Object.values((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().chats.byId).filter(({
      isCreator,
      usernames
    }) => isCreator && usernames?.some(c => c.isActive));
    if (myChats.length >= maxPublicLinks && value === 'public') {
      openLimitReachedModal({
        limit: 'channelsPublic'
      });
      const radioGroup = e.currentTarget.closest('.radio-group');
      // Patch for Teact bug with controlled inputs
      // TODO Teact support added, this can now be removed
      radioGroup.querySelector('[value=public]').checked = false;
      radioGroup.querySelector('[value=private]').checked = true;
      return;
    }
    setPrivacyType(value);
    setIsProfileFieldsTouched(true);
  }, [maxPublicLinks, openLimitReachedModal]);
  const handleForwardingOptionChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    toggleIsProtected({
      chatId: chat.id,
      isProtected: value === 'protected'
    });
  }, [chat.id, toggleIsProtected]);
  const handleSave = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (isPublic && privacyType === 'private') {
      openUsernameLostDialog();
    } else {
      updatePublicLink({
        username: privacyType === 'public' ? editableUsername || '' : ''
      });
    }
  }, [isPublic, openUsernameLostDialog, privacyType, updatePublicLink, editableUsername]);
  const handleMakeChannelPrivateConfirm = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    updatePublicLink({
      username: '',
      shouldDisableUsernames: true
    });
    closeUsernameLostDialog();
  }, [closeUsernameLostDialog, updatePublicLink]);
  const handleRevokePrivateLink = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeRevokeConfirmDialog();
    updatePrivateLink();
  }, [closeRevokeConfirmDialog, updatePrivateLink]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const langPrefix1 = isChannel ? 'Channel' : 'Mega';
  const langPrefix2 = isChannel ? 'Channel' : 'Group';
  const options = [{
    value: 'private',
    label: lang(`${langPrefix1}Private`),
    subLabel: lang(`${langPrefix1}PrivateInfo`)
  }, {
    value: 'public',
    label: lang(`${langPrefix1}Public`),
    subLabel: lang(`${langPrefix1}PublicInfo`)
  }];
  const forwardingOptions = [{
    value: 'allowed',
    label: lang('ChannelVisibility.Forwarding.Enabled')
  }, {
    value: 'protected',
    label: lang('ChannelVisibility.Forwarding.Disabled')
  }];
  const isLoading = progress === _types__WEBPACK_IMPORTED_MODULE_2__.ManagementProgress.InProgress;
  const shouldRenderUsernamesManage = privacyType === 'public' && chat.usernames && chat.usernames.length > 0;
  function renderPurchaseLink() {
    const purchaseInfoLink = `${_config__WEBPACK_IMPORTED_MODULE_3__.TME_LINK_PREFIX}${_config__WEBPACK_IMPORTED_MODULE_3__.PURCHASE_USERNAME}`;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "section-info",
      dir: "auto"
    }, lang('lng_username_purchase_available').replace('{link}', '%PURCHASE_LINK%').split('%').map(s => {
      return s === 'PURCHASE_LINK' ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_SafeLink__WEBPACK_IMPORTED_MODULE_13__["default"], {
        url: purchaseInfoLink,
        text: `@${_config__WEBPACK_IMPORTED_MODULE_3__.PURCHASE_USERNAME}`
      }) : s;
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading"
  }, lang(`${langPrefix2}Type`)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_19__["default"], {
    selected: privacyType,
    name: "channel-type",
    options: options,
    onChange: handleOptionChange
  })), privacyType === 'private' ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section",
    dir: lang.isRtl ? 'rtl' : undefined
  }, privateInviteLink ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_SafeLink__WEBPACK_IMPORTED_MODULE_13__["default"], {
    url: privateInviteLink,
    className: "group-link",
    text: privateInviteLink
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-info",
    dir: lang.isRtl ? 'rtl' : undefined
  }, lang(`${langPrefix1}PrivateLinkHelp`)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
    icon: "delete",
    ripple: true,
    destructive: true,
    onClick: openRevokeConfirmDialog
  }, lang('RevokeLink')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_15__["default"], {
    isOpen: isRevokeConfirmDialogOpen,
    onClose: closeRevokeConfirmDialog,
    text: lang('RevokeAlert'),
    confirmLabel: lang('RevokeButton'),
    confirmHandler: handleRevokePrivateLink,
    confirmIsDestructive: true
  })) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_18__["default"], null)) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section no-border"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_UsernameInput__WEBPACK_IMPORTED_MODULE_14__["default"], {
    asLink: true,
    currentUsername: currentUsername,
    isLoading: isLoading,
    isUsernameAvailable: isUsernameAvailable,
    checkedUsername: checkedUsername,
    onChange: handleUsernameChange
  }), error === _config__WEBPACK_IMPORTED_MODULE_3__.USERNAME_PURCHASE_ERROR && renderPurchaseLink(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-info",
    dir: "auto"
  }, lang(`${langPrefix2}.Username.CreatePublicLinkHelp`))), shouldRenderUsernamesManage && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_ManageUsernames__WEBPACK_IMPORTED_MODULE_12__["default"], {
    chatId: chat.id,
    usernames: chat.usernames,
    onEditUsername: handleUsernameChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading"
  }, lang(isChannel ? 'ChannelVisibility.Forwarding.ChannelTitle' : 'ChannelVisibility.Forwarding.GroupTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_19__["default"], {
    selected: isProtected ? 'protected' : 'allowed',
    name: "forwarding-type",
    options: forwardingOptions,
    onChange: handleForwardingOptionChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-info section-info_push"
  }, isChannel ? lang('ChannelVisibility.Forwarding.ChannelInfo') : lang('ChannelVisibility.Forwarding.GroupInfo')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_16__["default"], {
    isShown: canUpdate,
    disabled: isLoading,
    ariaLabel: lang('Save'),
    onClick: handleSave
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_20__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
    name: "check"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_15__["default"], {
    isOpen: isUsernameLostDialogOpen,
    onClose: closeUsernameLostDialog,
    text: lang('ChannelVisibility.Confirm.MakePrivate.Channel', currentUsername),
    confirmHandler: handleMakeChannelPrivateConfirm,
    confirmIsDestructive: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, chatId);
  const {
    isUsernameAvailable,
    checkedUsername,
    error
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectManagement)(global, chatId);
  return {
    chat,
    isChannel: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatChannel)(chat),
    progress: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global).management.progress,
    error,
    isUsernameAvailable,
    checkedUsername,
    isProtected: chat?.isProtected,
    maxPublicLinks: (0,_global_selectors_limits__WEBPACK_IMPORTED_MODULE_6__.selectCurrentLimit)(global, 'channelsPublic'),
    privateInviteLink: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChatFullInfo)(global, chatId)?.inviteLink
  };
}, (global, {
  chatId
}) => {
  return Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, chatId) && (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectManagement)(global, chatId));
})(ManageChatPrivacyType)));

/***/ }),

/***/ "./src/components/right/management/ManageChatRemovedUsers.tsx":
/*!********************************************************************!*\
  !*** ./src/components/right/management/ManageChatRemovedUsers.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _RemoveGroupUserModal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./RemoveGroupUserModal */ "./src/components/right/management/RemoveGroupUserModal.tsx");













const ManageChatRemovedUsers = ({
  chat,
  usersById,
  canDeleteMembers,
  removedMembers,
  isChannel,
  onClose,
  isActive
}) => {
  const {
    updateChatMemberBannedRights
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [isRemoveUserModalOpen, openRemoveUserModal, closeRemoveUserModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__["default"])({
    isActive,
    onBack: onClose
  });
  const getRemovedBy = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(member => {
    if (!member.kickedByUserId) {
      return undefined;
    }
    const kickedByUser = usersById[member.kickedByUserId];
    if (!kickedByUser) {
      return undefined;
    }
    return lang('UserRemovedBy', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(kickedByUser));
  }, [lang, usersById]);
  const getContextActions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(member => {
    if (!chat) {
      return undefined;
    }
    return [{
      title: lang('Unblock'),
      icon: 'delete',
      destructive: true,
      handler: () => updateChatMemberBannedRights({
        chatId: chat.id,
        userId: member.userId,
        bannedRights: {}
      })
    }];
  }, [lang, chat, updateChatMemberBannedRights]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section",
    dir: lang.isRtl ? 'rtl' : undefined
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help"
  }, lang(isChannel ? 'NoBlockedChannel2' : 'NoBlockedGroup2')), removedMembers.map(member => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
    key: member.userId,
    className: "chat-item-clickable",
    ripple: true,
    contextActions: getContextActions(member)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__["default"], {
    userId: member.userId,
    status: getRemovedBy(member),
    forceShowSelf: true
  }))), canDeleteMembers && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isShown: true,
    onClick: openRemoveUserModal,
    ariaLabel: lang('Channel.EditAdmin.Permission.BanUsers')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "add-user-filled"
  })), chat && canDeleteMembers && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_RemoveGroupUserModal__WEBPACK_IMPORTED_MODULE_12__["default"], {
    chat: chat,
    isOpen: isRemoveUserModalOpen,
    onClose: closeRemoveUserModal
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId);
  const {
    byId: usersById
  } = global.users;
  const canDeleteMembers = chat && ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getHasAdminRight)(chat, 'banUsers') || chat.isCreator);
  return {
    chat,
    usersById,
    canDeleteMembers,
    removedMembers: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chatId)?.kickedMembers || _util_memo__WEBPACK_IMPORTED_MODULE_4__.MEMO_EMPTY_ARRAY,
    isChannel: chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatChannel)(chat)
  };
})(ManageChatRemovedUsers)));

/***/ }),

/***/ "./src/components/right/management/ManageDiscussion.tsx":
/*!**************************************************************!*\
  !*** ./src/components/right/management/ManageDiscussion.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/AnimatedIcon */ "./src/components/common/AnimatedIcon.tsx");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/GroupChatInfo */ "./src/components/common/GroupChatInfo.tsx");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");


















const ManageDiscussion = ({
  chat,
  onClose,
  isActive,
  chatId,
  chatsByIds,
  linkedChat,
  forDiscussionIds,
  isChannel,
  onScreenSelect
}) => {
  const {
    loadGroupsForDiscussion,
    linkDiscussionGroup,
    unlinkDiscussionGroup,
    toggleJoinRequest,
    toggleJoinToSend
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [linkedGroupId, setLinkedGroupId] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [isConfirmUnlinkGroupDialogOpen, openConfirmUnlinkGroupDialog, closeConfirmUnlinkGroupDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [isConfirmLinkGroupDialogOpen, openConfirmLinkGroupDialog, closeConfirmLinkGroupDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [isJoinToSend, setIsJoinToSend] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(Boolean(linkedChat?.isJoinToSend));
  const [isJoinRequest, setIsJoinRequest] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(Boolean(linkedChat?.isJoinRequest));
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const linkedChatId = linkedChat?.id;
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_9__["default"])({
    isActive,
    onBack: onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    loadGroupsForDiscussion();
  }, [loadGroupsForDiscussion]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isActive) {
      setIsJoinToSend(linkedChat?.isJoinToSend || false);
      setIsJoinRequest(linkedChat?.isJoinRequest || false);
    }
  }, [linkedChat, isActive]);
  const handleUnlinkGroupSessions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeConfirmUnlinkGroupDialog();
    unlinkDiscussionGroup({
      channelId: isChannel ? chatId : linkedChatId
    });
    if (!isChannel) {
      onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.Initial);
    }
  }, [closeConfirmUnlinkGroupDialog, unlinkDiscussionGroup, isChannel, chatId, linkedChatId, onScreenSelect]);
  const handleLinkGroupSessions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeConfirmLinkGroupDialog();
    linkDiscussionGroup({
      channelId: chatId,
      chatId: linkedGroupId
    });
  }, [closeConfirmLinkGroupDialog, linkDiscussionGroup, chatId, linkedGroupId]);
  const handleJoinToSendCheck = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(checked => {
    setIsJoinToSend(checked);
    toggleJoinToSend({
      chatId: linkedChatId,
      isEnabled: checked
    });
    if (!checked) {
      setIsJoinRequest(false);
    }
  }, [linkedChatId, toggleJoinToSend]);
  const handleJoinRequestCheck = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(checked => {
    setIsJoinRequest(checked);
    toggleJoinRequest({
      chatId: linkedChatId,
      isEnabled: checked
    });
  }, [linkedChatId, toggleJoinRequest]);
  const onDiscussionClick = groupId => {
    setLinkedGroupId(groupId);
    openConfirmLinkGroupDialog();
  };
  function renderUnlinkGroupHeader() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_12__["default"], {
      size: "tiny",
      peer: linkedChat
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-title"
    }, lang(isChannel ? 'DiscussionUnlinkGroup' : 'DiscussionUnlinkChannel')));
  }
  function renderLinkGroupHeader() {
    if (!linkedGroupId) return undefined;
    const linkedGroup = chatsByIds[linkedGroupId];
    if (!linkedGroup) return undefined;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-header"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_12__["default"], {
      size: "tiny",
      peer: linkedGroup
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "modal-title"
    }, lang('Channel.DiscussionGroup.LinkGroup')));
  }
  function renderLinkGroupConfirmText() {
    if (!linkedGroupId) return undefined;
    const linkedGroup = chatsByIds[linkedGroupId];
    if (!linkedGroup) return undefined;
    if (linkedGroup.hasPrivateLink) {
      return (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__["default"])(`Do you want to make **${linkedGroup.title}** the discussion board for **${chat.title}**?`, ['br', 'simple_markdown']);
    }
    return (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__["default"])(
    // eslint-disable-next-line max-len
    `Do you want to make **${linkedGroup.title}** the discussion board for **${chat.title}**?\n\nAnyone from the channel will be able to see messages in this group.`, ['br', 'simple_markdown']);
  }
  function renderLinkedGroup() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
      className: "chat-item-clickable",
      inactive: true
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_13__["default"], {
      chatId: linkedChat.id
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
      icon: "delete",
      ripple: true,
      destructive: true,
      onClick: openConfirmUnlinkGroupDialog
    }, lang(isChannel ? 'DiscussionUnlinkGroup' : 'DiscussionUnlinkChannel')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_16__["default"], {
      isOpen: isConfirmUnlinkGroupDialogOpen,
      onClose: closeConfirmUnlinkGroupDialog,
      header: renderUnlinkGroupHeader(),
      textParts: (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_7__["default"])(lang(isChannel ? 'DiscussionUnlinkChannelAlert' : 'DiscussionUnlinkGroupAlert', linkedChat.title), ['br', 'simple_markdown']),
      confirmLabel: lang(isChannel ? 'DiscussionUnlinkGroup' : 'DiscussionUnlinkChannel'),
      confirmHandler: handleUnlinkGroupSessions,
      confirmIsDestructive: true
    }));
  }
  function renderDiscussionGroups() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "section-help",
      dir: "auto"
    }, lang('DiscussionChannelHelp')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      teactFastList: true
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
      key: "create-group",
      icon: "group",
      ripple: true,
      teactOrderKey: 0,
      disabled: true
    }, lang('DiscussionCreateGroup')), forDiscussionIds ? forDiscussionIds.map((id, i) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
      key: id,
      teactOrderKey: i + 1,
      className: "chat-item-clickable scroll-item"
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => {
        onDiscussionClick(id);
      }
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_13__["default"], {
      chatId: id
    }))) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_14__["default"], {
      key: "nothing-found",
      teactOrderKey: 0,
      text: "No discussion groups found"
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "mt-4 mb-0 section-help",
      dir: "auto"
    }, lang('DiscussionChannelHelp2')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_16__["default"], {
      isOpen: isConfirmLinkGroupDialogOpen,
      onClose: closeConfirmLinkGroupDialog,
      header: renderLinkGroupHeader(),
      textParts: renderLinkGroupConfirmText(),
      confirmLabel: lang('DiscussionLinkGroup'),
      confirmHandler: handleLinkGroupSessions
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_11__["default"], {
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_6__.LOCAL_TGS_URLS.DiscussionGroups,
    size: _config__WEBPACK_IMPORTED_MODULE_3__.STICKER_SIZE_DISCUSSION_GROUPS,
    className: "section-icon"
  }), linkedChat && renderLinkedGroup(), !linkedChat && renderDiscussionGroups()), linkedChat && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading"
  }, lang('ChannelSettingsJoinTitle')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem narrow"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_15__["default"], {
    checked: isJoinToSend,
    onCheck: handleJoinToSendCheck,
    label: lang('ChannelSettingsJoinToSend')
  })), isJoinToSend && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem narrow"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_15__["default"], {
    checked: isJoinRequest,
    onCheck: handleJoinRequestCheck,
    label: lang('ChannelSettingsJoinRequest')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-info section-info_push"
  }, isJoinToSend ? lang('ChannelSettingsJoinRequestInfo') : lang('ChannelSettingsJoinToSendInfo')))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, chatId);
  const {
    linkedChatId
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChatFullInfo)(global, chatId) || {};
  const {
    forDiscussionIds,
    byId: chatsByIds
  } = global.chats;
  const linkedChat = linkedChatId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, linkedChatId) : undefined;
  return {
    chat,
    chatsByIds,
    forDiscussionIds,
    linkedChat,
    isChannel: chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatChannel)(chat)
  };
})(ManageDiscussion)));

/***/ }),

/***/ "./src/components/right/management/ManageGroup.tsx":
/*!*********************************************************!*\
  !*** ./src/components/right/management/ManageGroup.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_schedulers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/schedulers */ "./src/util/schedulers.ts");
/* harmony import */ var _util_textFormat__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/textFormat */ "./src/util/textFormat.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/AvatarEditable */ "./src/components/ui/AvatarEditable.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _ui_Switcher__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../ui/Switcher */ "./src/components/ui/Switcher.tsx");
/* harmony import */ var _ui_TextArea__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../ui/TextArea */ "./src/components/ui/TextArea.tsx");
/* harmony import */ var _Management_scss__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./Management.scss */ "./src/components/right/management/Management.scss");

























const GROUP_TITLE_EMPTY = 'Group title can\'t be empty';
const GROUP_MAX_DESCRIPTION = 255;
const ALL_PERMISSIONS = ['sendMessages', 'embedLinks', 'sendPolls', 'changeInfo', 'inviteUsers', 'pinMessages', 'manageTopics', 'sendPhotos', 'sendVideos', 'sendRoundvideos', 'sendVoices', 'sendAudios', 'sendDocs'];
// Some checkboxes control multiple rights, and some rights are not controlled from Permissions screen,
// so we need to define the amount manually
const TOTAL_PERMISSIONS_COUNT = ALL_PERMISSIONS.length + 1;
const runDebounced = (0,_util_schedulers__WEBPACK_IMPORTED_MODULE_6__.debounce)(cb => cb(), 500, false);
const ManageGroup = ({
  chatId,
  chat,
  chatFullInfo,
  progress,
  isBasicGroup,
  hasLinkedChannel,
  canChangeInfo,
  canBanUsers,
  canInvite,
  canEditForum,
  isActive,
  exportedInvites,
  isChannelsPremiumLimitReached,
  availableReactions,
  onScreenSelect,
  onClose
}) => {
  const {
    togglePreHistoryHidden,
    updateChat,
    deleteChat,
    leaveChannel,
    deleteChannel,
    closeManagement,
    openChat,
    loadExportedChatInvites,
    loadChatJoinRequests,
    toggleForum
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isDeleteDialogOpen, openDeleteDialog, closeDeleteDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const currentTitle = chat.title;
  const currentAbout = chatFullInfo?.about || '';
  const [isProfileFieldsTouched, setIsProfileFieldsTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [title, setTitle] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentTitle);
  const [about, setAbout] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentAbout);
  const [photo, setPhoto] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [error, setError] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [isForumEnabled, setIsForumEnabled] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(chat.isForum);
  const imageHash = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getChatAvatarHash)(chat);
  const currentAvatarBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_12__["default"])(imageHash, false, _api_types__WEBPACK_IMPORTED_MODULE_2__.ApiMediaFormat.BlobUrl);
  const isPublicGroup = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatPublic)(chat), [chat]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_13__["default"])();
  // eslint-disable-next-line no-null/no-null
  const isPreHistoryHiddenCheckboxRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_10__["default"])({
    isActive,
    onBack: onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (canInvite) {
      loadExportedChatInvites({
        chatId
      });
      loadExportedChatInvites({
        chatId,
        isRevoked: true
      });
      loadChatJoinRequests({
        chatId
      });
    }
  }, [chatId, canInvite]);

  // Resetting `isForum` switch on flood wait error
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setIsForumEnabled(Boolean(chat.isForum));
  }, [chat.isForum]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (progress === _types__WEBPACK_IMPORTED_MODULE_3__.ManagementProgress.Complete) {
      setIsProfileFieldsTouched(false);
      setError(undefined);
    }
  }, [progress]);
  const handleClickEditType = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.ChatPrivacyType);
  });
  const handleClickDiscussion = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.Discussion);
  });
  const handleClickReactions = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.Reactions);
  });
  const handleClickPermissions = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.GroupPermissions);
  });
  const handleClickAdministrators = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.ChatAdministrators);
  });
  const handleClickInvites = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.Invites);
  });
  const handleClickRequests = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.JoinRequests);
  });
  const handleSetPhoto = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(file => {
    setPhoto(file);
    setIsProfileFieldsTouched(true);
  });
  const handleTitleChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(e => {
    setTitle(e.target.value);
    setIsProfileFieldsTouched(true);
  });
  const handleAboutChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(e => {
    setAbout(e.target.value);
    setIsProfileFieldsTouched(true);
  });
  const handleUpdateGroup = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    const trimmedTitle = title.trim();
    const trimmedAbout = about.trim();
    if (!trimmedTitle.length) {
      setError(GROUP_TITLE_EMPTY);
      return;
    }
    updateChat({
      chatId,
      title: trimmedTitle,
      about: trimmedAbout,
      photo
    });
  });
  const handleClickMembers = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_3__.ManagementScreens.GroupMembers);
  });
  const handleTogglePreHistory = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    if (!chatFullInfo) {
      return;
    }
    const {
      isPreHistoryHidden
    } = chatFullInfo;
    togglePreHistoryHidden({
      chatId: chat.id,
      isEnabled: !isPreHistoryHidden
    });
  });
  const handleForumToggle = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    setIsForumEnabled(current => {
      const newIsForumEnabled = !current;
      runDebounced(() => {
        toggleForum({
          chatId,
          isEnabled: newIsForumEnabled
        });
      });
      return newIsForumEnabled;
    });
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isChannelsPremiumLimitReached) {
      return;
    }

    // Teact does not have full support of controlled form components, we need to "disable" input value change manually
    // TODO Teact support added, this can now be removed
    const checkbox = isPreHistoryHiddenCheckboxRef.current?.querySelector('input');
    checkbox.checked = !chatFullInfo?.isPreHistoryHidden;
  }, [isChannelsPremiumLimitReached, chatFullInfo?.isPreHistoryHidden]);
  const chatReactionsDescription = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!chatFullInfo?.enabledReactions) {
      return lang('ReactionsOff');
    }
    if (chatFullInfo.enabledReactions.type === 'all') {
      return lang('ReactionsAll');
    }
    const enabledLength = chatFullInfo.enabledReactions.allowed.length;
    const totalLength = availableReactions?.filter(reaction => !reaction.isInactive).length || 0;
    return totalLength ? `${enabledLength} / ${totalLength}` : `${enabledLength}`;
  }, [availableReactions, chatFullInfo?.enabledReactions, lang]);
  const enabledPermissionsCount = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!chat.defaultBannedRights) {
      return 0;
    }
    let totalCount = ALL_PERMISSIONS.filter(key => {
      if (key === 'manageTopics' && !isForumEnabled) return false;
      return !chat.defaultBannedRights[key];
    }).length;
    const {
      sendStickers,
      sendGifs
    } = chat.defaultBannedRights;

    // These two rights are controlled with a single checkbox
    if (!sendStickers && !sendGifs) {
      totalCount += 1;
    }
    return totalCount;
  }, [chat.defaultBannedRights, isForumEnabled]);
  const adminsCount = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return Object.keys(chatFullInfo?.adminMembersById || {}).length;
  }, [chatFullInfo?.adminMembersById]);
  const handleDeleteGroup = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    if (isBasicGroup) {
      deleteChat({
        chatId: chat.id
      });
    } else if (!chat.isCreator) {
      leaveChannel({
        chatId: chat.id
      });
    } else {
      deleteChannel({
        chatId: chat.id
      });
    }
    closeDeleteDialog();
    closeManagement();
    openChat({
      id: undefined
    });
  });
  if (chat.isRestricted || chat.isForbidden) {
    return undefined;
  }
  const isLoading = progress === _types__WEBPACK_IMPORTED_MODULE_3__.ManagementProgress.InProgress;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_AvatarEditable__WEBPACK_IMPORTED_MODULE_15__["default"], {
    isForForum: isForumEnabled,
    currentAvatarBlobUrl: currentAvatarBlobUrl,
    onChange: handleSetPhoto,
    disabled: !canChangeInfo
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-edit"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_19__["default"], {
    id: "group-title",
    label: lang('GroupName'),
    onChange: handleTitleChange,
    value: title,
    error: error === GROUP_TITLE_EMPTY ? error : undefined,
    disabled: !canChangeInfo
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_TextArea__WEBPACK_IMPORTED_MODULE_23__["default"], {
    id: "group-about",
    label: lang('DescriptionPlaceholder'),
    maxLength: GROUP_MAX_DESCRIPTION,
    maxLengthIndicator: (GROUP_MAX_DESCRIPTION - about.length).toString(),
    onChange: handleAboutChange,
    value: about,
    disabled: !canChangeInfo,
    noReplaceNewlines: true
  })), chat.isCreator && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "lock",
    multiline: true,
    onClick: handleClickEditType
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('GroupType')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, isPublicGroup ? lang('TypePublic') : lang('TypePrivate'))), hasLinkedChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "message",
    multiline: true,
    onClick: handleClickDiscussion
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('LinkedChannel')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, lang('DiscussionUnlink'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "permissions",
    multiline: true,
    onClick: handleClickPermissions,
    disabled: !canBanUsers
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('ChannelPermissions')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, enabledPermissionsCount, "/", TOTAL_PERMISSIONS_COUNT - (isForumEnabled ? 0 : 1))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "heart-outline",
    multiline: true,
    onClick: handleClickReactions,
    disabled: !canChangeInfo
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('Reactions')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, chatReactionsDescription)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "admin",
    multiline: true,
    onClick: handleClickAdministrators
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('ChannelAdministrators')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_7__.formatInteger)(adminsCount))), canInvite && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "link",
    onClick: handleClickInvites,
    multiline: true,
    disabled: !exportedInvites
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('GroupInfo.InviteLinks')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, exportedInvites ? (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_7__.formatInteger)(exportedInvites.length) : lang('Loading'))), Boolean(chat.joinRequests?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "add-user-filled",
    onClick: handleClickRequests,
    multiline: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('MemberRequests')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_7__.formatInteger)(chat.joinRequests.length))), canEditForum && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "forums",
    ripple: true,
    onClick: handleForumToggle
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, lang('ChannelTopics')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Switcher__WEBPACK_IMPORTED_MODULE_22__["default"], {
    id: "group-notifications",
    label: lang('ChannelTopics'),
    checked: isForumEnabled,
    inactive: true
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section-info section-info_push"
  }, lang('ForumToggleDescription')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "group",
    multiline: true,
    onClick: handleClickMembers
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('GroupMembers')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_7__.formatInteger)(chat.membersCount ?? 0))), !isPublicGroup && !hasLinkedChannel && Boolean(chatFullInfo) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem narrow",
    ref: isPreHistoryHiddenCheckboxRef
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_16__["default"], {
    checked: !chatFullInfo.isPreHistoryHidden,
    label: lang('ChatHistory'),
    onChange: handleTogglePreHistory,
    subLabel: chatFullInfo.isPreHistoryHidden ? lang('ChatHistoryHiddenInfo2') : lang('ChatHistoryVisibleInfo'),
    disabled: !canBanUsers
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_20__["default"], {
    icon: "delete",
    ripple: true,
    destructive: true,
    onClick: openDeleteDialog
  }, lang('DeleteMega')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_18__["default"], {
    isShown: isProfileFieldsTouched,
    onClick: handleUpdateGroup,
    disabled: isLoading,
    ariaLabel: lang('Save')
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_21__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "check"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_17__["default"], {
    isOpen: isDeleteDialogOpen,
    onClose: closeDeleteDialog,
    textParts: (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_8__["default"])(isBasicGroup || !chat.isCreator ? lang('AreYouSureDeleteAndExit') : lang('AreYouSureDeleteThisChatWithGroup', chat.title), ['br', 'simple_markdown']),
    confirmLabel: isBasicGroup || !chat.isCreator ? lang('DeleteMega') : lang('DeleteGroupForAll'),
    confirmHandler: handleDeleteGroup,
    confirmIsDestructive: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, chatId);
  const chatFullInfo = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChatFullInfo)(global, chatId);
  const {
    management,
    limitReachedModal
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global);
  const {
    progress
  } = management;
  const hasLinkedChannel = Boolean(chatFullInfo?.linkedChatId);
  const isBasicGroup = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatBasicGroup)(chat);
  const {
    invites
  } = management.byChatId[chatId] || {};
  const canEditForum = !hasLinkedChannel && ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getHasAdminRight)(chat, 'changeInfo') || chat.isCreator);
  const canChangeInfo = chat.isCreator || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getHasAdminRight)(chat, 'changeInfo');
  const canBanUsers = chat.isCreator || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getHasAdminRight)(chat, 'banUsers');
  const canInvite = chat.isCreator || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getHasAdminRight)(chat, 'inviteUsers');
  return {
    chat,
    chatFullInfo,
    progress,
    isBasicGroup,
    hasLinkedChannel,
    canChangeInfo,
    canBanUsers,
    canInvite,
    exportedInvites: invites,
    isChannelsPremiumLimitReached: limitReachedModal?.limit === 'channels',
    availableReactions: global.reactions.availableReactions,
    canEditForum
  };
}, (global, {
  chatId
}) => {
  return Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, chatId));
})(ManageGroup)));

/***/ }),

/***/ "./src/components/right/management/ManageGroupAdminRights.tsx":
/*!********************************************************************!*\
  !*** ./src/components/right/management/ManageGroupAdminRights.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");
















const CUSTOM_TITLE_MAX_LENGTH = 16;
const ManageGroupAdminRights = ({
  isActive,
  isNewAdmin,
  selectedUserId,
  defaultRights,
  chat,
  usersById,
  currentUserId,
  adminMembersById,
  hasFullInfo,
  isChannel,
  isForum,
  isFormFullyDisabled,
  onClose,
  onScreenSelect
}) => {
  const {
    updateChatAdmin
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [permissions, setPermissions] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)({});
  const [isTouched, setIsTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(Boolean(isNewAdmin));
  const [isLoading, setIsLoading] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isDismissConfirmationDialogOpen, openDismissConfirmationDialog, closeDismissConfirmationDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const [customTitle, setCustomTitle] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__["default"])({
    isActive,
    onBack: onClose
  });
  const selectedChatMember = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const selectedAdminMember = selectedUserId ? adminMembersById?.[selectedUserId] : undefined;

    // If `selectedAdminMember` variable is filled with a value, then we have already saved the administrator,
    // so now we need to return to the list of administrators
    if (isNewAdmin && (selectedAdminMember || !selectedUserId)) {
      return undefined;
    }
    if (isNewAdmin) {
      const user = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId[selectedUserId];
      return user ? {
        userId: user.id,
        adminRights: defaultRights,
        customTitle: lang('ChannelAdmin'),
        isOwner: false,
        promotedByUserId: undefined
      } : undefined;
    }
    return selectedAdminMember;
  }, [adminMembersById, defaultRights, isNewAdmin, lang, selectedUserId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (hasFullInfo && selectedUserId && !selectedChatMember) {
      onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatAdministrators);
    }
  }, [chat, hasFullInfo, onScreenSelect, selectedChatMember, selectedUserId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setPermissions(selectedChatMember?.adminRights || {});
    setCustomTitle((selectedChatMember?.customTitle || '').substr(0, CUSTOM_TITLE_MAX_LENGTH));
    setIsTouched(Boolean(isNewAdmin));
    setIsLoading(false);
  }, [defaultRights, isNewAdmin, selectedChatMember]);
  const handlePermissionChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const {
      name
    } = e.target;
    function getUpdatedPermissionValue(value) {
      return value ? undefined : true;
    }
    setPermissions(p => ({
      ...p,
      [name]: getUpdatedPermissionValue(p[name])
    }));
    setIsTouched(true);
  }, []);
  const handleSavePermissions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!selectedUserId) {
      return;
    }
    setIsLoading(true);
    updateChatAdmin({
      chatId: chat.id,
      userId: selectedUserId,
      adminRights: permissions,
      customTitle
    });
  }, [selectedUserId, updateChatAdmin, chat.id, permissions, customTitle]);
  const handleDismissAdmin = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!selectedUserId) {
      return;
    }
    updateChatAdmin({
      chatId: chat.id,
      userId: selectedUserId,
      adminRights: {}
    });
    closeDismissConfirmationDialog();
  }, [chat.id, closeDismissConfirmationDialog, selectedUserId, updateChatAdmin]);
  const getControlIsDisabled = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(key => {
    if ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatBasicGroup)(chat)) {
      return false;
    }
    if (isFormFullyDisabled || !chat.adminRights) {
      return true;
    }
    if (chat.isCreator) {
      return false;
    }
    return !chat.adminRights[key];
  }, [chat, isFormFullyDisabled]);
  const memberStatus = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (isNewAdmin || !selectedChatMember) {
      return undefined;
    }
    if (selectedChatMember.isOwner) {
      return lang('ChannelCreator');
    }
    const promotedByUser = selectedChatMember.promotedByUserId ? usersById[selectedChatMember.promotedByUserId] : undefined;
    if (promotedByUser) {
      return lang('EditAdminPromotedBy', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getUserFullName)(promotedByUser));
    }
    return lang('ChannelAdmin');
  }, [isNewAdmin, selectedChatMember, usersById, lang]);
  const handleCustomTitleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    const {
      value
    } = e.target;
    setCustomTitle(value);
    setIsTouched(true);
  }, []);
  if (!selectedChatMember) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    inactive: true,
    className: "chat-item-clickable"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__["default"], {
    userId: selectedChatMember.userId,
    status: memberStatus,
    forceShowSelf: true
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading mt-4",
    dir: "auto"
  }, lang('EditAdminWhatCanDo')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "changeInfo",
    checked: Boolean(permissions.changeInfo),
    label: lang(isChannel ? 'EditAdminChangeChannelInfo' : 'EditAdminChangeGroupInfo'),
    blocking: true,
    disabled: getControlIsDisabled('changeInfo'),
    onChange: handlePermissionChange
  })), isChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "postMessages",
    checked: Boolean(permissions.postMessages),
    label: lang('EditAdminPostMessages'),
    blocking: true,
    disabled: getControlIsDisabled('postMessages'),
    onChange: handlePermissionChange
  })), isChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "editMessages",
    checked: Boolean(permissions.editMessages),
    label: lang('EditAdminEditMessages'),
    blocking: true,
    disabled: getControlIsDisabled('editMessages'),
    onChange: handlePermissionChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "deleteMessages",
    checked: Boolean(permissions.deleteMessages),
    label: lang(isChannel ? 'EditAdminDeleteMessages' : 'EditAdminGroupDeleteMessages'),
    blocking: true,
    disabled: getControlIsDisabled('deleteMessages'),
    onChange: handlePermissionChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "postStories",
    checked: Boolean(permissions.postStories),
    label: lang('EditAdminPostStories'),
    blocking: true,
    disabled: getControlIsDisabled('postStories'),
    onChange: handlePermissionChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "editStories",
    checked: Boolean(permissions.editStories),
    label: lang('EditAdminEditStories'),
    blocking: true,
    disabled: getControlIsDisabled('editStories'),
    onChange: handlePermissionChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "deleteStories",
    checked: Boolean(permissions.deleteStories),
    label: lang('EditAdminDeleteStories'),
    blocking: true,
    disabled: getControlIsDisabled('deleteStories'),
    onChange: handlePermissionChange
  })), !isChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "banUsers",
    checked: Boolean(permissions.banUsers),
    label: lang('EditAdminBanUsers'),
    blocking: true,
    disabled: getControlIsDisabled('banUsers'),
    onChange: handlePermissionChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "inviteUsers",
    checked: Boolean(permissions.inviteUsers),
    label: lang('EditAdminAddUsers'),
    blocking: true,
    disabled: getControlIsDisabled('inviteUsers'),
    onChange: handlePermissionChange
  })), !isChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "pinMessages",
    checked: Boolean(permissions.pinMessages),
    label: lang('EditAdminPinMessages'),
    blocking: true,
    disabled: getControlIsDisabled('pinMessages'),
    onChange: handlePermissionChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "addAdmins",
    checked: Boolean(permissions.addAdmins),
    label: lang('EditAdminAddAdmins'),
    blocking: true,
    disabled: getControlIsDisabled('addAdmins'),
    onChange: handlePermissionChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "manageCall",
    checked: Boolean(permissions.manageCall),
    label: lang('StartVoipChatPermission'),
    blocking: true,
    disabled: getControlIsDisabled('manageCall'),
    onChange: handlePermissionChange
  })), isForum && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "manageTopics",
    checked: Boolean(permissions.manageTopics),
    label: lang('ManageTopicsPermission'),
    blocking: true,
    disabled: getControlIsDisabled('manageTopics'),
    onChange: handlePermissionChange
  })), !isChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "anonymous",
    checked: Boolean(permissions.anonymous),
    label: lang('EditAdminSendAnonymously'),
    blocking: true,
    disabled: getControlIsDisabled('anonymous'),
    onChange: handlePermissionChange
  })), isFormFullyDisabled && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-info mb-4",
    dir: "auto"
  }, lang('Channel.EditAdmin.CannotEdit')), !isChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_13__["default"], {
    id: "admin-title",
    label: lang('EditAdminRank'),
    onChange: handleCustomTitleChange,
    value: customTitle,
    disabled: isFormFullyDisabled,
    maxLength: CUSTOM_TITLE_MAX_LENGTH
  }), currentUserId !== selectedUserId && !isFormFullyDisabled && !isNewAdmin && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_14__["default"], {
    icon: "delete",
    ripple: true,
    destructive: true,
    onClick: openDismissConfirmationDialog
  }, lang('EditAdminRemoveAdmin')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_12__["default"], {
    isShown: isTouched,
    onClick: handleSavePermissions,
    ariaLabel: lang('Save'),
    disabled: isLoading
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_15__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "check"
  })), !isNewAdmin && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isOpen: isDismissConfirmationDialogOpen,
    onClose: closeDismissConfirmationDialog,
    text: "Are you sure you want to dismiss this admin?",
    confirmLabel: lang('Channel.Admin.Dismiss'),
    confirmHandler: handleDismissAdmin,
    confirmIsDestructive: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId,
  isPromotedByCurrentUser
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  const fullInfo = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId);
  const {
    byId: usersById
  } = global.users;
  const {
    currentUserId
  } = global;
  const isChannel = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatChannel)(chat);
  const isFormFullyDisabled = !(chat.isCreator || isPromotedByCurrentUser);
  const isForum = chat.isForum;
  return {
    chat,
    usersById,
    currentUserId,
    isChannel,
    isForum,
    isFormFullyDisabled,
    defaultRights: chat.adminRights,
    hasFullInfo: Boolean(fullInfo),
    adminMembersById: fullInfo?.adminMembersById
  };
}, (global, {
  chatId
}) => {
  return Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId));
})(ManageGroupAdminRights)));

/***/ }),

/***/ "./src/components/right/management/ManageGroupMembers.tsx":
/*!****************************************************************!*\
  !*** ./src/components/right/management/ManageGroupMembers.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/helpers/sortChatIds */ "./src/components/common/helpers/sortChatIds.ts");
/* harmony import */ var _hooks_polling_usePeerStoriesPolling__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/polling/usePeerStoriesPolling */ "./src/hooks/polling/usePeerStoriesPolling.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useInfiniteScroll */ "./src/hooks/useInfiniteScroll.ts");
/* harmony import */ var _hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/useKeyboardListNavigation */ "./src/hooks/useKeyboardListNavigation.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _ui_Switcher__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../ui/Switcher */ "./src/components/ui/Switcher.tsx");
/* harmony import */ var _DeleteMemberModal__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../DeleteMemberModal */ "./src/components/right/DeleteMemberModal.tsx");























const ManageGroupMembers = ({
  chatId,
  noAdmins,
  members,
  canAddMembers,
  adminMembersById,
  userStatusesById,
  isChannel,
  isActive,
  globalUserIds,
  localContactIds,
  localUserIds,
  isSearching,
  searchQuery,
  currentUserId,
  canDeleteMembers,
  areParticipantsHidden,
  canHideParticipants,
  onClose,
  onScreenSelect,
  onChatMemberSelect
}) => {
  const {
    openChat,
    setUserSearchQuery,
    closeManagement,
    toggleParticipantsHidden,
    setNewChatMembersDialogState,
    toggleManagement
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_12__["default"])();
  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [deletingUserId, setDeletingUserId] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const adminIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return noAdmins && adminMembersById ? Object.keys(adminMembersById) : [];
  }, [adminMembersById, noAdmins]);
  const memberIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    // No need for expensive global updates on users, so we avoid them
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    if (!members || !usersById) {
      return [];
    }
    const userIds = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.sortUserIds)(members.map(({
      userId
    }) => userId), usersById, userStatusesById);
    return noAdmins ? userIds.filter(userId => !adminIds.includes(userId)) : userIds;
  }, [members, userStatusesById, noAdmins, adminIds]);
  (0,_hooks_polling_usePeerStoriesPolling__WEBPACK_IMPORTED_MODULE_7__["default"])(memberIds);
  const displayedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    // No need for expensive global updates on users, so we avoid them
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    const shouldUseSearchResults = Boolean(searchQuery);
    const listedIds = !shouldUseSearchResults ? memberIds : localContactIds ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.filterUsersByName)(localContactIds, usersById, searchQuery) : [];
    return (0,_common_helpers_sortChatIds__WEBPACK_IMPORTED_MODULE_6__["default"])((0,_util_iteratees__WEBPACK_IMPORTED_MODULE_5__.unique)([...listedIds, ...(shouldUseSearchResults ? localUserIds || [] : []), ...(shouldUseSearchResults ? globalUserIds || [] : [])]).filter(contactId => {
      const user = usersById[contactId];
      if (!user) {
        return true;
      }
      return (isChannel || user.canBeInvitedToGroup || !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserBot)(user)) && (!noAdmins || !adminIds.includes(contactId));
    }), true);
  }, [memberIds, localContactIds, searchQuery, localUserIds, globalUserIds, isChannel, noAdmins, adminIds]);
  const [viewportIds, getMore] = (0,_hooks_useInfiniteScroll__WEBPACK_IMPORTED_MODULE_9__["default"])(undefined, displayedIds, Boolean(searchQuery));
  const handleMemberClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(id => {
    if (noAdmins) {
      onChatMemberSelect(id, true);
      onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatNewAdminRights);
    } else {
      closeManagement();
      openChat({
        id
      });
    }
  });
  const handleFilterChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(e => {
    setUserSearchQuery({
      query: e.target.value
    });
  });
  const handleKeyDown = (0,_hooks_useKeyboardListNavigation__WEBPACK_IMPORTED_MODULE_10__["default"])(containerRef, isActive, index => {
    if (viewportIds && viewportIds.length > 0) {
      handleMemberClick(viewportIds[index === -1 ? 0 : index]);
    }
  }, '.ListItem-button', true);
  const handleDeleteMembersModalClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    setDeletingUserId(undefined);
  });
  const handleToggleParticipantsHidden = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    toggleParticipantsHidden({
      chatId,
      isEnabled: !areParticipantsHidden
    });
  });
  const handleNewMemberDialogOpen = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_11__["default"])(() => {
    toggleManagement();
    setNewChatMembersDialogState({
      newChatMembersProgress: _types__WEBPACK_IMPORTED_MODULE_2__.NewChatMembersProgress.InProgress
    });
  });
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_8__["default"])({
    isActive,
    onBack: onClose
  });
  function getMemberContextAction(memberId) {
    return memberId === currentUserId || !canDeleteMembers ? undefined : [{
      title: lang('lng_context_remove_from_group'),
      icon: 'stop',
      handler: () => {
        setDeletingUserId(memberId);
      }
    }];
  }
  function renderSearchField() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "Management__filter",
      dir: lang.isRtl ? 'rtl' : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_18__["default"], {
      ref: inputRef,
      value: searchQuery,
      onChange: handleFilterChange,
      placeholder: lang('Search')
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, noAdmins && renderSearchField(), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, canHideParticipants && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_19__["default"], {
    icon: "group",
    ripple: true,
    onClick: handleToggleParticipantsHidden
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, lang('ChannelHideMembers')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Switcher__WEBPACK_IMPORTED_MODULE_21__["default"], {
    label: lang('ChannelHideMembers'),
    checked: areParticipantsHidden
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-info"
  }, lang(areParticipantsHidden ? 'GroupMembers.MembersHiddenOn' : 'GroupMembers.MembersHiddenOff'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, viewportIds?.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_17__["default"], {
    className: "picker-list custom-scroll",
    items: displayedIds,
    onLoadMore: getMore,
    noScrollRestore: Boolean(searchQuery),
    ref: containerRef,
    onKeyDown: handleKeyDown
  }, viewportIds.map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_19__["default"], {
    key: id,
    className: "chat-item-clickable scroll-item"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleMemberClick(id),
    contextActions: getMemberContextAction(id)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_15__["default"], {
    userId: id,
    forceShowSelf: true,
    withStory: true
  })))) : !isSearching && viewportIds && !viewportIds.length ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_14__["default"], {
    teactOrderKey: 0,
    key: "nothing-found",
    text: isChannel ? 'No subscribers found' : 'No members found'
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_20__["default"], null))), canAddMembers && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_16__["default"], {
    isShown: true,
    onClick: handleNewMemberDialogOpen,
    ariaLabel: lang('lng_channel_add_users')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_13__["default"], {
    name: "add-user-filled"
  })), canDeleteMembers && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_DeleteMemberModal__WEBPACK_IMPORTED_MODULE_22__["default"], {
    isOpen: Boolean(deletingUserId),
    userId: deletingUserId,
    onClose: handleDeleteMembersModalClose
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  const {
    statusesById: userStatusesById
  } = global.users;
  const {
    members,
    adminMembersById,
    areParticipantsHidden
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId) || {};
  const isChannel = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatChannel)(chat);
  const {
    userIds: localContactIds
  } = global.contactList || {};
  const hiddenMembersMinCount = global.appConfig?.hiddenMembersMinCount;
  const canDeleteMembers = chat && (chat.isCreator || (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getHasAdminRight)(chat, 'banUsers'));
  const canHideParticipants = canDeleteMembers && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatBasicGroup)(chat) && chat.membersCount !== undefined && hiddenMembersMinCount !== undefined && chat.membersCount >= hiddenMembersMinCount;
  const canAddMembers = chat && ((0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getHasAdminRight)(chat, 'inviteUsers') || !isChannel && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserRightBanned)(chat, 'inviteUsers') || chat.isCreator);
  const {
    query: searchQuery,
    fetchingStatus,
    globalUserIds,
    localUserIds
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global).userSearch;
  return {
    areParticipantsHidden: Boolean(chat && areParticipantsHidden),
    members,
    canAddMembers,
    adminMembersById,
    userStatusesById,
    isChannel,
    localContactIds,
    searchQuery,
    isSearching: fetchingStatus,
    globalUserIds,
    localUserIds,
    canDeleteMembers,
    currentUserId: global.currentUserId,
    canHideParticipants
  };
})(ManageGroupMembers)));

/***/ }),

/***/ "./src/components/right/management/ManageGroupPermissions.tsx":
/*!********************************************************************!*\
  !*** ./src/components/right/management/ManageGroupPermissions.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useManagePermissions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../hooks/useManagePermissions */ "./src/components/right/hooks/useManagePermissions.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _main_PermissionCheckboxList__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../main/PermissionCheckboxList */ "./src/components/main/PermissionCheckboxList.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");














const ITEM_HEIGHT = 24 + 20;
const BEFORE_ITEMS_COUNT = 2;
const ITEMS_COUNT = 9;
function getLangKeyForBannedRightKey(key) {
  switch (key) {
    case 'sendMessages':
      return 'UserRestrictionsNoSend';
    case 'sendMedia':
      return 'UserRestrictionsNoSendMedia';
    case 'sendStickers':
      return 'UserRestrictionsNoSendStickers';
    case 'embedLinks':
      return 'UserRestrictionsNoEmbedLinks';
    case 'sendPolls':
      return 'UserRestrictionsNoSendPolls';
    case 'changeInfo':
      return 'UserRestrictionsNoChangeInfo';
    case 'inviteUsers':
      return 'UserRestrictionsInviteUsers';
    case 'pinMessages':
      return 'UserRestrictionsPinMessages';
    case 'manageTopics':
      return 'GroupPermission.NoManageTopics';
    case 'sendPlain':
      return 'UserRestrictionsNoSendText';
    case 'sendDocs':
      return 'UserRestrictionsNoSendDocs';
    case 'sendRoundvideos':
      return 'UserRestrictionsNoSendRound';
    case 'sendVoices':
      return 'UserRestrictionsNoSendVoice';
    case 'sendAudios':
      return 'UserRestrictionsNoSendMusic';
    case 'sendVideos':
      return 'UserRestrictionsNoSendVideos';
    case 'sendPhotos':
      return 'UserRestrictionsNoSendPhotos';
    default:
      return undefined;
  }
}
const ManageGroupPermissions = ({
  onScreenSelect,
  onChatMemberSelect,
  chat,
  currentUserId,
  removedUsersCount,
  members,
  onClose,
  isActive
}) => {
  const {
    updateChatDefaultBannedRights
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const {
    permissions,
    havePermissionChanged,
    isLoading,
    handlePermissionChange,
    setIsLoading
  } = (0,_hooks_useManagePermissions__WEBPACK_IMPORTED_MODULE_7__["default"])(chat?.defaultBannedRights);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onClose
  });
  const handleRemovedUsersClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupRemovedUsers);
  }, [onScreenSelect]);
  const handleAddExceptionClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissionsCreate);
  }, [onScreenSelect]);
  const handleExceptionMemberClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(member => {
    onChatMemberSelect(member.userId, member.promotedByUserId === currentUserId);
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissions);
  }, [currentUserId, onChatMemberSelect, onScreenSelect]);
  const [isMediaDropdownOpen, setIsMediaDropdownOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const handleSavePermissions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!chat) {
      return;
    }
    setIsLoading(true);
    updateChatDefaultBannedRights({
      chatId: chat.id,
      bannedRights: permissions
    });
  }, [chat, permissions, setIsLoading, updateChatDefaultBannedRights]);
  const exceptionMembers = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!members) {
      return [];
    }
    return members.filter(({
      bannedRights
    }) => Boolean(bannedRights));
  }, [members]);
  const getMemberExceptions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(member => {
    const {
      bannedRights
    } = member;
    if (!bannedRights || !chat) {
      return undefined;
    }
    const {
      defaultBannedRights
    } = chat;
    return Object.keys(bannedRights).reduce((result, k) => {
      const key = k;
      if (!bannedRights[key] || defaultBannedRights?.[key] || key === 'sendInline' || key === 'viewMessages' || key === 'sendGames') {
        return result;
      }
      const langKey = getLangKeyForBannedRightKey(key);
      if (!langKey) {
        return result;
      }
      const translatedString = lang(langKey);
      return `${result}${!result.length ? translatedString : `, ${translatedString}`}`;
    }, '');
  }, [chat, lang]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management with-shifted-dropdown",
    style: `--shift-height: ${ITEMS_COUNT * ITEM_HEIGHT}px;` + `--before-shift-height: ${BEFORE_ITEMS_COUNT * ITEM_HEIGHT}px;`
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section without-bottom-shadow"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading",
    dir: "auto"
  }, lang('ChannelPermissionsHeader')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_main_PermissionCheckboxList__WEBPACK_IMPORTED_MODULE_10__["default"], {
    chatId: chat?.id,
    isMediaDropdownOpen: isMediaDropdownOpen,
    setIsMediaDropdownOpen: setIsMediaDropdownOpen,
    handlePermissionChange: handlePermissionChange,
    permissions: permissions,
    dropdownClassName: "DropdownListTrap",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('DropdownList', isMediaDropdownOpen && 'DropdownList--open'),
    shiftedClassName: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('part', isMediaDropdownOpen && 'shifted')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('section', isMediaDropdownOpen && 'shifted')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    icon: "delete-user",
    multiline: true,
    narrow: true,
    onClick: handleRemovedUsersClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('ChannelBlockedUsers')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle"
  }, removedUsersCount))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('section', isMediaDropdownOpen && 'shifted')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading",
    dir: "auto"
  }, lang('PrivacyExceptions')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    icon: "add-user",
    onClick: handleAddExceptionClick
  }, lang('ChannelAddException')), exceptionMembers.map(member => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    key: member.userId,
    className: "chat-item-clickable exceptions-member"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleExceptionMemberClick(member)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__["default"], {
    userId: member.userId,
    status: getMemberExceptions(member),
    forceShowSelf: true
  }))))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isShown: havePermissionChanged,
    onClick: handleSavePermissions,
    ariaLabel: lang('Save'),
    disabled: isLoading
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_13__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "check"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId);
  const fullInfo = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chatId);
  return {
    chat,
    currentUserId: global.currentUserId,
    removedUsersCount: fullInfo?.kickedMembers?.length || 0,
    members: fullInfo?.members
  };
})(ManageGroupPermissions)));

/***/ }),

/***/ "./src/components/right/management/ManageGroupUserPermissions.tsx":
/*!************************************************************************!*\
  !*** ./src/components/right/management/ManageGroupUserPermissions.tsx ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLang */ "./src/hooks/useLang.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useManagePermissions__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../hooks/useManagePermissions */ "./src/components/right/hooks/useManagePermissions.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _main_PermissionCheckboxList__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../main/PermissionCheckboxList */ "./src/components/main/PermissionCheckboxList.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");

















const ITEM_HEIGHT = 24 + 32;
const SHIFT_HEIGHT_MINUS = 1;
const BEFORE_ITEMS_COUNT = 2;
const BEFORE_USER_INFO_HEIGHT = 96;
const ITEMS_COUNT = 9;
const ManageGroupUserPermissions = ({
  chat,
  selectedChatMemberId,
  hasFullInfo,
  members,
  onScreenSelect,
  isFormFullyDisabled,
  onClose,
  isActive
}) => {
  const {
    updateChatMemberBannedRights
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const selectedChatMember = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!members) {
      return undefined;
    }
    return members.find(({
      userId
    }) => userId === selectedChatMemberId);
  }, [members, selectedChatMemberId]);
  const {
    permissions,
    havePermissionChanged,
    isLoading,
    handlePermissionChange,
    setIsLoading
  } = (0,_hooks_useManagePermissions__WEBPACK_IMPORTED_MODULE_9__["default"])(selectedChatMember?.bannedRights || chat?.defaultBannedRights);
  const [isBanConfirmationDialogOpen, openBanConfirmationDialog, closeBanConfirmationDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const lang = (0,_hooks_useLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const oldLang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_6__["default"])({
    isActive,
    onBack: onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (hasFullInfo && selectedChatMemberId && !selectedChatMember) {
      onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupPermissions);
    }
  }, [chat, hasFullInfo, onScreenSelect, selectedChatMember, selectedChatMemberId]);
  const handleSavePermissions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!chat || !selectedChatMemberId) {
      return;
    }
    setIsLoading(true);
    updateChatMemberBannedRights({
      chatId: chat.id,
      userId: selectedChatMemberId,
      bannedRights: permissions
    });
  }, [chat, selectedChatMemberId, setIsLoading, updateChatMemberBannedRights, permissions]);
  const handleBanFromGroup = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!chat || !selectedChatMemberId) {
      return;
    }
    updateChatMemberBannedRights({
      chatId: chat.id,
      userId: selectedChatMemberId,
      bannedRights: {
        viewMessages: true
      }
    });
  }, [chat, selectedChatMemberId, updateChatMemberBannedRights]);
  const getControlIsDisabled = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(key => {
    if (isFormFullyDisabled) {
      return true;
    }
    if (!chat || !chat.defaultBannedRights) {
      return false;
    }
    return chat.defaultBannedRights[key];
  }, [chat, isFormFullyDisabled]);
  const [isMediaDropdownOpen, setIsMediaDropdownOpen] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  if (!selectedChatMember) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management with-shifted-dropdown",
    style: `--shift-height: ${ITEMS_COUNT * ITEM_HEIGHT - SHIFT_HEIGHT_MINUS}px;` + `--before-shift-height: ${BEFORE_ITEMS_COUNT * ITEM_HEIGHT + BEFORE_USER_INFO_HEIGHT}px;`
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section without-bottom-shadow"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    inactive: true,
    className: "chat-item-clickable"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_11__["default"], {
    userId: selectedChatMember.userId,
    forceShowSelf: true
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading mt-4",
    dir: "auto"
  }, oldLang('UserRestrictionsCanDo')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_main_PermissionCheckboxList__WEBPACK_IMPORTED_MODULE_12__["default"], {
    chatId: chat?.id,
    isMediaDropdownOpen: isMediaDropdownOpen,
    setIsMediaDropdownOpen: setIsMediaDropdownOpen,
    handlePermissionChange: handlePermissionChange,
    permissions: permissions,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('DropdownList', isMediaDropdownOpen && 'DropdownList--open'),
    dropdownClassName: "DropdownListTrap",
    shiftedClassName: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('part', isMediaDropdownOpen && 'shifted'),
    getControlIsDisabled: getControlIsDisabled
  })), !isFormFullyDisabled && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('section', isMediaDropdownOpen && 'shifted')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_15__["default"], {
    icon: "delete-user",
    ripple: true,
    destructive: true,
    onClick: openBanConfirmationDialog
  }, oldLang('UserRestrictionsBlock')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isShown: havePermissionChanged,
    onClick: handleSavePermissions,
    ariaLabel: oldLang('Save'),
    disabled: isLoading
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_16__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "check"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isBanConfirmationDialogOpen,
    onClose: closeBanConfirmationDialog,
    text: lang('GroupManagementBanUserConfirm'),
    confirmLabel: "Remove",
    confirmHandler: handleBanFromGroup,
    confirmIsDestructive: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId,
  isPromotedByCurrentUser
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId);
  const fullInfo = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chatId);
  const isFormFullyDisabled = !(chat.isCreator || isPromotedByCurrentUser);
  return {
    chat,
    isFormFullyDisabled,
    hasFullInfo: Boolean(fullInfo),
    members: fullInfo?.members
  };
}, (global, {
  chatId
}) => {
  return Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId));
})(ManageGroupUserPermissions)));

/***/ }),

/***/ "./src/components/right/management/ManageGroupUserPermissionsCreate.tsx":
/*!******************************************************************************!*\
  !*** ./src/components/right/management/ManageGroupUserPermissionsCreate.tsx ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");









const ManageGroupUserPermissionsCreate = ({
  usersById,
  userStatusesById,
  members,
  isChannel,
  onScreenSelect,
  onChatMemberSelect,
  onClose,
  isActive
}) => {
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onClose
  });
  const memberIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!members || !usersById) {
      return undefined;
    }
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.sortUserIds)(members.filter(member => !member.isOwner).map(({
      userId
    }) => userId), usersById, userStatusesById);
  }, [members, usersById, userStatusesById]);
  const handleExceptionMemberClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(memberId => {
    onChatMemberSelect(memberId);
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissions);
  }, [onChatMemberSelect, onScreenSelect]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section",
    teactFastList: true
  }, memberIds ? memberIds.map((id, i) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_8__["default"], {
    key: id,
    teactOrderKey: i,
    className: "chat-item-clickable scroll-item"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => handleExceptionMemberClick(id)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_7__["default"], {
    userId: id,
    forceShowSelf: true
  }))) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_6__["default"], {
    teactOrderKey: 0,
    key: "nothing-found",
    text: isChannel ? 'No subscribers found' : 'No members found'
  }))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  const {
    byId: usersById,
    statusesById: userStatusesById
  } = global.users;
  const members = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId)?.members;
  const isChannel = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatChannel)(chat);
  return {
    members,
    usersById,
    userStatusesById,
    isChannel
  };
})(ManageGroupUserPermissionsCreate)));

/***/ }),

/***/ "./src/components/right/management/ManageInvite.tsx":
/*!**********************************************************!*\
  !*** ./src/components/right/management/ManageInvite.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useSyncEffect */ "./src/hooks/useSyncEffect.ts");
/* harmony import */ var _common_CalendarModal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/CalendarModal */ "./src/components/common/CalendarModal.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");

















const DEFAULT_USAGE_LIMITS = [1, 10, 100];
const DEFAULT_EXPIRE_DATE = {
  hour: 3600000,
  day: 86400000,
  week: 604800000
};
const DEFAULT_CUSTOM_EXPIRE_DATE = DEFAULT_EXPIRE_DATE.hour;
const ManageInvite = ({
  chatId,
  editingInvite,
  isActive,
  onClose,
  onScreenSelect
}) => {
  const {
    editExportedChatInvite,
    exportChatInvite
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const [isCalendarOpened, openCalendar, closeCalendar] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [isRequestNeeded, setIsRequestNeeded] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [title, setTitle] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [customExpireDate, setCustomExpireDate] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(Date.now() + DEFAULT_CUSTOM_EXPIRE_DATE);
  const [selectedExpireOption, setSelectedExpireOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('unlimited');
  const [customUsageLimit, setCustomUsageLimit] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(10);
  const [selectedUsageOption, setSelectedUsageOption] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('0');
  const [isSubmitBlocked, setIsSubmitBlocked] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onClose
  });
  (0,_hooks_useSyncEffect__WEBPACK_IMPORTED_MODULE_9__["default"])(([oldEditingInvite]) => {
    if (oldEditingInvite === editingInvite) return;
    if (!editingInvite) {
      setTitle('');
      setSelectedExpireOption('unlimited');
      setSelectedUsageOption('0');
      setCustomExpireDate((0,_util_serverTime__WEBPACK_IMPORTED_MODULE_5__.getServerTime)() * 1000 + DEFAULT_CUSTOM_EXPIRE_DATE);
      setCustomUsageLimit(10);
      setIsRequestNeeded(false);
    } else {
      const {
        title: editingTitle,
        usageLimit,
        expireDate,
        isRequestNeeded: editingIsRequestNeeded
      } = editingInvite;
      if (editingTitle) setTitle(editingTitle);
      if (usageLimit) {
        setSelectedUsageOption(DEFAULT_USAGE_LIMITS.includes(usageLimit) ? usageLimit.toString() : 'custom');
        setCustomUsageLimit(usageLimit);
      }
      if (expireDate) {
        const minSafeDate = (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_5__.getServerTime)() + DEFAULT_CUSTOM_EXPIRE_DATE;
        setSelectedExpireOption('custom');
        setCustomExpireDate(Math.max(expireDate, minSafeDate) * 1000);
      }
      if (editingIsRequestNeeded) {
        setIsRequestNeeded(true);
      }
    }
  }, [editingInvite]);
  const handleIsRequestChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setIsRequestNeeded(e.target.checked);
  }, []);
  const handleTitleChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setTitle(e.target.value);
  }, []);
  const handleCustomUsageLimitChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setCustomUsageLimit(Number.parseInt(e.target.value, 10));
  }, []);
  const handleExpireDateChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(date => {
    setCustomExpireDate(date.getTime());
    closeCalendar();
  }, [closeCalendar]);
  const handleSaveClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    setIsSubmitBlocked(true);
    const usageLimit = selectedUsageOption === 'custom' ? customUsageLimit : Number(selectedUsageOption);
    let expireDate;
    switch (selectedExpireOption) {
      case 'custom':
        expireDate = (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_5__.getServerTime)() + (customExpireDate - Date.now()) / 1000;
        break;
      case 'hour':
      case 'day':
      case 'week':
        expireDate = (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_5__.getServerTime)() + DEFAULT_EXPIRE_DATE[selectedExpireOption] / 1000;
        break;
      case 'unlimited':
        expireDate = 0;
        break;
      default:
        expireDate = undefined;
    }
    if (editingInvite) {
      editExportedChatInvite({
        link: editingInvite.link,
        chatId,
        title,
        isRequestNeeded,
        expireDate,
        usageLimit
      });
    } else {
      exportChatInvite({
        chatId,
        title,
        isRequestNeeded,
        expireDate,
        usageLimit
      });
    }
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.Invites);
  }, [chatId, customExpireDate, customUsageLimit, editExportedChatInvite, editingInvite, exportChatInvite, isRequestNeeded, selectedExpireOption, selectedUsageOption, title, onScreenSelect]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management ManageInvite"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_13__["default"], {
    label: lang('ApproveNewMembers'),
    subLabel: lang('ApproveNewMembersDescription'),
    checked: isRequestNeeded,
    onChange: handleIsRequestChange
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_15__["default"], {
    className: "link-name",
    placeholder: lang('LinkNameHint'),
    value: title,
    onChange: handleTitleChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help hint"
  }, lang('LinkNameHelp'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section-header"
  }, lang('LimitByPeriod')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_16__["default"], {
    name: "expireOptions",
    options: [{
      value: 'hour',
      label: lang('Hours', 1)
    }, {
      value: 'day',
      label: lang('Days', 1)
    }, {
      value: 'week',
      label: lang('Weeks', 1)
    }, {
      value: 'unlimited',
      label: lang('NoLimit')
    }, {
      value: 'custom',
      label: lang('lng_group_invite_expire_custom')
    }],
    onChange: setSelectedExpireOption,
    selected: selectedExpireOption
  }), selectedExpireOption === 'custom' && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_12__["default"], {
    className: "expire-limit",
    isText: true,
    onClick: openCalendar
  }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.formatFullDate)(lang, customExpireDate), " ", (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.formatTime)(lang, customExpireDate)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help hint"
  }, lang('TimeLimitHelp'))), !isRequestNeeded && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section-header"
  }, lang('LimitNumberOfUses')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_16__["default"], {
    name: "usageOptions",
    options: [...DEFAULT_USAGE_LIMITS.map(n => ({
      value: n.toString(),
      label: n
    })), {
      value: '0',
      label: lang('NoLimit')
    }, {
      value: 'custom',
      label: lang('lng_group_invite_usage_custom')
    }],
    onChange: setSelectedUsageOption,
    selected: selectedUsageOption
  }), selectedUsageOption === 'custom' && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    className: "form-control usage-limit",
    type: "number",
    min: "1",
    max: "99999",
    value: customUsageLimit,
    onChange: handleCustomUsageLimitChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help hint"
  }, lang('UsesLimitHelp'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isShown: true,
    onClick: handleSaveClick,
    disabled: isSubmitBlocked,
    ariaLabel: editingInvite ? lang('SaveLink') : lang('CreateLink')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
    name: "check"
  }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_CalendarModal__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isOpen: isCalendarOpened,
    isFutureMode: true,
    withTimePicker: true,
    onClose: closeCalendar,
    onSubmit: handleExpireDateChange,
    selectedAt: customExpireDate,
    submitButtonLabel: lang('Save')
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const {
    editingInvite
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).management.byChatId[chatId] || {};
  return {
    editingInvite
  };
})(ManageInvite)));

/***/ }),

/***/ "./src/components/right/management/ManageInviteInfo.tsx":
/*!**************************************************************!*\
  !*** ./src/components/right/management/ManageInviteInfo.tsx ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_clipboard__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/clipboard */ "./src/util/clipboard.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");













const BULLET = '\u2022';
const ManageInviteInfo = ({
  chatId,
  invite,
  importers,
  requesters,
  isChannel,
  isActive,
  onClose
}) => {
  const {
    showNotification,
    loadChatInviteImporters,
    loadChatInviteRequesters,
    openChat
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const {
    usage = 0,
    usageLimit,
    link,
    adminId
  } = invite || {};
  const expireDate = invite?.expireDate && (invite.expireDate - (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_6__.getServerTime)()) * 1000 + Date.now();
  const isExpired = (invite?.expireDate || 0) - (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_6__.getServerTime)() < 0;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (link) {
      loadChatInviteImporters({
        chatId,
        link
      });
      loadChatInviteRequesters({
        chatId,
        link
      });
    }
  }, [chatId, link, loadChatInviteImporters, loadChatInviteRequesters]);
  const handleCopyClicked = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    (0,_util_clipboard__WEBPACK_IMPORTED_MODULE_4__.copyTextToClipboard)(invite.link);
    showNotification({
      message: lang('LinkCopied')
    });
  }, [invite, lang, showNotification]);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onClose
  });
  const renderImporters = () => {
    if (!importers?.length && requesters?.length) return undefined;
    if (!importers) return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_12__["default"], null);
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "section"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, importers.length ? lang('PeopleJoined', usage) : lang('NoOneJoined')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "section-help"
    }, !importers.length && (usageLimit ? lang('PeopleCanJoinViaLinkCount', usageLimit - usage) : lang('NoOneJoinedYet')), importers.map(importer => {
      const joinTime = (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatMediaDateTime)(lang, importer.date * 1000, true);
      const status = importer.isFromChatList ? `${joinTime} ${BULLET} ${lang('JoinedViaFolder')}` : joinTime;
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
        className: "chat-item-clickable scroll-item small-icon"
        // eslint-disable-next-line react/jsx-no-bind
        ,
        onClick: () => openChat({
          id: importer.userId
        })
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__["default"], {
        userId: importer.userId,
        status: status,
        forceShowSelf: true
      }));
    })));
  };
  const renderRequesters = () => {
    if (invite?.isRevoked) return undefined;
    if (!requesters && importers) return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_12__["default"], null);
    if (!requesters?.length) return undefined;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "section"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, isChannel ? lang('SubscribeRequests') : lang('MemberRequests')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
      className: "section-help"
    }, requesters.map(requester => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
      className: "chat-item-clickable scroll-item small-icon"
      // eslint-disable-next-line react/jsx-no-bind
      ,
      onClick: () => openChat({
        id: requester.userId
      })
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__["default"], {
      userId: requester.userId,
      status: (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatMediaDateTime)(lang, requester.date * 1000, true),
      forceShowSelf: true
    })))));
  };
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management ManageInviteInfo"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, !invite && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help"
  }, lang('Loading')), invite && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "link-title"
  }, invite.title || invite.link), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    className: "form-control",
    value: invite.link,
    readOnly: true,
    onClick: handleCopyClicked
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "copy-link",
    onClick: handleCopyClicked
  }, lang('CopyLink')), Boolean(expireDate) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help"
  }, isExpired ? lang('ExpiredLink') : lang('LinkExpiresIn', `${(0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatFullDate)(lang, expireDate)} ${(0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatTime)(lang, expireDate)}`))), adminId && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", null, lang('LinkCreatedeBy')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: "chat-item-clickable scroll-item small-icon"
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => openChat({
      id: adminId
    })
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_9__["default"], {
    userId: adminId,
    status: (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatMediaDateTime)(lang, invite.date * 1000, true),
    forceShowSelf: true
  }))), renderImporters(), renderRequesters())));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const {
    inviteInfo
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global).management.byChatId[chatId] || {};
  const {
    invite,
    importers,
    requesters
  } = inviteInfo || {};
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChat)(global, chatId);
  const isChannel = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isChatChannel)(chat);
  return {
    invite,
    importers,
    requesters,
    isChannel
  };
})(ManageInviteInfo)));

/***/ }),

/***/ "./src/components/right/management/ManageInvites.tsx":
/*!***********************************************************!*\
  !*** ./src/components/right/management/ManageInvites.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_clipboard__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/clipboard */ "./src/util/clipboard.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_schedulers_useInterval__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../hooks/schedulers/useInterval */ "./src/hooks/schedulers/useInterval.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../hooks/useForceUpdate */ "./src/hooks/useForceUpdate.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/AnimatedIcon */ "./src/components/common/AnimatedIcon.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_LinkField__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../common/LinkField */ "./src/components/common/LinkField.tsx");
/* harmony import */ var _common_NothingFound__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../common/NothingFound */ "./src/components/common/NothingFound.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");






















const BULLET = '\u2022';
function inviteComparator(i1, i2) {
  const {
    isPermanent: i1IsPermanent,
    usage: i1Usage = 0,
    date: i1Date
  } = i1;
  const {
    isPermanent: i2IsPermanent,
    usage: i2Usage = 0,
    date: i2Date
  } = i2;
  if (i1IsPermanent || i2IsPermanent) return Number(i1IsPermanent) - Number(i2IsPermanent);
  if (i1Usage || i2Usage) return i2Usage - i1Usage;
  return i2Date - i1Date;
}
const ManageInvites = ({
  chatId,
  chat,
  exportedInvites,
  revokedExportedInvites,
  isActive,
  isChannel,
  onClose,
  onScreenSelect
}) => {
  const {
    setEditingExportedInvite,
    showNotification,
    editExportedChatInvite,
    deleteExportedChatInvite,
    deleteRevokedExportedChatInvites,
    setOpenedInviteInfo
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_14__["default"])();
  const [isDeleteRevokeAllDialogOpen, openDeleteRevokeAllDialog, closeDeleteRevokeAllDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const [isRevokeDialogOpen, openRevokeDialog, closeRevokeDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const [revokingInvite, setRevokingInvite] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const [isDeleteDialogOpen, openDeleteDialog, closeDeleteDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const [deletingInvite, setDeletingInvite] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_13__["default"])({
    isActive,
    onBack: onClose
  });
  const hasDetailedCountdown = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!exportedInvites) return undefined;
    return exportedInvites.some(({
      expireDate
    }) => expireDate && expireDate - (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_8__.getServerTime)() < _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_7__.MILLISECONDS_IN_DAY / 1000);
  }, [exportedInvites]);
  const forceUpdate = (0,_hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_12__["default"])();
  (0,_hooks_schedulers_useInterval__WEBPACK_IMPORTED_MODULE_10__["default"])(forceUpdate, hasDetailedCountdown ? 1000 : undefined);
  const chatMainUsername = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getMainUsername)(chat), [chat]);
  const primaryInvite = exportedInvites?.find(({
    isPermanent
  }) => isPermanent);
  const primaryInviteLink = chatMainUsername ? `${_config__WEBPACK_IMPORTED_MODULE_3__.TME_LINK_PREFIX}${chatMainUsername}` : primaryInvite?.link;
  const temporalInvites = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const invites = chat?.usernames ? exportedInvites : exportedInvites?.filter(({
      isPermanent
    }) => !isPermanent);
    return invites?.sort(inviteComparator);
  }, [chat?.usernames, exportedInvites]);
  const editInvite = invite => {
    setEditingExportedInvite({
      chatId,
      invite
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.EditInvite);
  };
  const revokeInvite = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(invite => {
    const {
      link,
      title,
      isRequestNeeded,
      expireDate,
      usageLimit
    } = invite;
    editExportedChatInvite({
      chatId,
      link,
      title,
      isRequestNeeded,
      expireDate,
      usageLimit,
      isRevoked: true
    });
  }, [chatId, editExportedChatInvite]);
  const askToRevoke = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(invite => {
    setRevokingInvite(invite);
    openRevokeDialog();
  }, [openRevokeDialog]);
  const handleRevoke = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!revokingInvite) return;
    revokeInvite(revokingInvite);
    setRevokingInvite(undefined);
    closeRevokeDialog();
  }, [closeRevokeDialog, revokeInvite, revokingInvite]);
  const handleCreateNewClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.EditInvite);
  }, [onScreenSelect]);
  const handlePrimaryRevoke = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (primaryInvite) {
      askToRevoke(primaryInvite);
    }
  }, [askToRevoke, primaryInvite]);
  const handleDeleteAllRevoked = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    deleteRevokedExportedChatInvites({
      chatId
    });
    closeDeleteRevokeAllDialog();
  }, [chatId, closeDeleteRevokeAllDialog, deleteRevokedExportedChatInvites]);
  const showInviteInfo = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(invite => {
    setOpenedInviteInfo({
      chatId,
      invite
    });
    onScreenSelect(_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.InviteInfo);
  }, [chatId, onScreenSelect, setOpenedInviteInfo]);
  const deleteInvite = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(invite => {
    deleteExportedChatInvite({
      chatId,
      link: invite.link
    });
  }, [chatId, deleteExportedChatInvite]);
  const askToDelete = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(invite => {
    setDeletingInvite(invite);
    openDeleteDialog();
  }, [openDeleteDialog]);
  const handleDelete = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!deletingInvite) return;
    deleteInvite(deletingInvite);
    setDeletingInvite(undefined);
    closeDeleteDialog();
  }, [closeDeleteDialog, deleteInvite, deletingInvite]);
  const copyLink = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(link => {
    (0,_util_clipboard__WEBPACK_IMPORTED_MODULE_6__.copyTextToClipboard)(link);
    showNotification({
      message: lang('LinkCopied')
    });
  }, [lang, showNotification]);
  const prepareUsageText = invite => {
    const {
      usage = 0,
      usageLimit,
      expireDate,
      isPermanent,
      requested,
      isRevoked
    } = invite;
    let text = '';
    if (!isRevoked && usageLimit && usage < usageLimit) {
      text = lang('CanJoin', usageLimit - usage);
    } else if (usage) {
      text = lang('PeopleJoined', usage);
    } else {
      text = lang('NoOneJoined');
    }
    if (isRevoked) {
      text += ` ${BULLET} ${lang('Revoked')}`;
      return text;
    }
    if (requested) {
      text += ` ${BULLET} ${lang('JoinRequests', requested)}`;
    }
    if (usageLimit !== undefined && usage === usageLimit) {
      text += ` ${BULLET} ${lang('LinkLimitReached')}`;
    } else if (expireDate) {
      const diff = (expireDate - (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_8__.getServerTime)()) * 1000;
      text += ` ${BULLET} `;
      if (diff > 0) {
        text += lang('InviteLink.ExpiresIn', (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_7__.formatCountdown)(lang, diff));
      } else {
        text += lang('InviteLink.Expired');
      }
    } else if (isPermanent) {
      text += ` ${BULLET} ${lang('Permanent')}`;
    }
    return text;
  };
  const getInviteIconClass = invite => {
    const {
      usage = 0,
      usageLimit,
      isRevoked,
      expireDate
    } = invite;
    if (isRevoked) {
      return 'link-status-icon-gray';
    }
    if (usageLimit && usage < usageLimit) {
      return 'link-status-icon-green';
    }
    if (expireDate) {
      const diff = (expireDate - (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_8__.getServerTime)()) * 1000;
      if (diff <= 0) {
        return 'link-status-icon-red';
      }
    }
    return 'link-status-icon-blue';
  };
  const prepareContextActions = invite => {
    const actions = [];
    actions.push({
      title: lang('Copy'),
      icon: 'copy',
      handler: () => copyLink(invite.link)
    });
    if (!invite.isPermanent && !invite.isRevoked) {
      actions.push({
        title: lang('Edit'),
        icon: 'edit',
        handler: () => editInvite(invite)
      });
    }
    if (!invite.isRevoked) {
      actions.push({
        title: lang('RevokeButton'),
        icon: 'delete',
        handler: () => askToRevoke(invite),
        destructive: true
      });
    } else {
      actions.push({
        title: lang('DeleteLink'),
        icon: 'delete',
        handler: () => askToDelete(invite),
        destructive: true
      });
    }
    return actions;
  };
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management ManageInvites"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_15__["default"], {
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_9__.LOCAL_TGS_URLS.Invite,
    size: _config__WEBPACK_IMPORTED_MODULE_3__.STICKER_SIZE_INVITES,
    className: "section-icon"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help"
  }, isChannel ? lang('PrimaryLinkHelpChannel') : lang('PrimaryLinkHelp'))), primaryInviteLink && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_LinkField__WEBPACK_IMPORTED_MODULE_17__["default"], {
    className: "settings-input",
    link: primaryInviteLink,
    withShare: true,
    onRevoke: !chat?.usernames ? handlePrimaryRevoke : undefined,
    title: chat?.usernames ? lang('PublicLink') : lang('lng_create_permanent_link_title')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section",
    teactFastList: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_19__["default"], {
    isText: true,
    key: "create",
    className: "create-link",
    onClick: handleCreateNewClick
  }, lang('CreateNewLink')), (!temporalInvites || !temporalInvites.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_NothingFound__WEBPACK_IMPORTED_MODULE_18__["default"], {
    text: "No links found",
    key: "nothing"
  }), temporalInvites?.map(invite => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_21__["default"], {
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_16__["default"], {
      name: "link",
      className: `link-status-icon ${getInviteIconClass(invite)}`
    }),
    secondaryIcon: "more",
    multiline: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => showInviteInfo(invite),
    contextActions: prepareContextActions(invite),
    key: invite.link
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title invite-title"
  }, invite.title || invite.link), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, prepareUsageText(invite)))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help hint",
    key: "links-hint"
  }, lang('ManageLinksInfoHelp'))), revokedExportedInvites && Boolean(revokedExportedInvites.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section",
    teactFastList: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help",
    key: "title"
  }, lang('RevokedLinks')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_21__["default"], {
    icon: "delete",
    destructive: true,
    key: "delete",
    onClick: openDeleteRevokeAllDialog
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('DeleteAllRevokedLinks'))), revokedExportedInvites?.map(invite => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_21__["default"], {
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_16__["default"], {
      name: "link",
      className: `link-status-icon ${getInviteIconClass(invite)}`
    }),
    secondaryIcon: "more",
    multiline: true
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => showInviteInfo(invite),
    contextActions: prepareContextActions(invite),
    key: invite.link
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, invite.title || invite.link), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "subtitle",
    dir: "auto"
  }, prepareUsageText(invite)))))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_20__["default"], {
    isOpen: isDeleteRevokeAllDialogOpen,
    onClose: closeDeleteRevokeAllDialog,
    title: lang('DeleteAllRevokedLinks'),
    text: lang('DeleteAllRevokedLinkHelp'),
    confirmIsDestructive: true,
    confirmLabel: lang('DeleteAll'),
    confirmHandler: handleDeleteAllRevoked
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_20__["default"], {
    isOpen: isRevokeDialogOpen,
    onClose: closeRevokeDialog,
    title: lang('RevokeLink'),
    text: lang('RevokeAlert'),
    confirmIsDestructive: true,
    confirmLabel: lang('RevokeButton'),
    confirmHandler: handleRevoke
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_20__["default"], {
    isOpen: isDeleteDialogOpen,
    onClose: closeDeleteDialog,
    title: lang('DeleteLink'),
    text: lang('DeleteLinkHelp'),
    confirmIsDestructive: true,
    confirmLabel: lang('Delete'),
    confirmHandler: handleDelete
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const {
    invites,
    revokedInvites
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global).management.byChatId[chatId] || {};
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, chatId);
  const isChannel = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatChannel)(chat);
  return {
    exportedInvites: invites,
    revokedExportedInvites: revokedInvites,
    chat,
    isChannel
  };
})(ManageInvites)));

/***/ }),

/***/ "./src/components/right/management/ManageJoinRequests.tsx":
/*!****************************************************************!*\
  !*** ./src/components/right/management/ManageJoinRequests.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/helpers/animatedAssets */ "./src/components/common/helpers/animatedAssets.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/AnimatedIcon */ "./src/components/common/AnimatedIcon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _JoinRequest__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./JoinRequest */ "./src/components/right/management/JoinRequest.tsx");














const ManageJoinRequests = ({
  chat,
  chatId,
  isActive,
  isChannel,
  onClose
}) => {
  const {
    hideAllChatJoinRequests,
    loadChatJoinRequests
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isAcceptAllDialogOpen, openAcceptAllDialog, closeAcceptAllDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [isRejectAllDialogOpen, openRejectAllDialog, closeRejectAllDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onClose
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!chat?.joinRequests && !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserId)(chatId)) {
      loadChatJoinRequests({
        chatId
      });
    }
  }, [chat, chatId, loadChatJoinRequests]);
  const handleAcceptAllRequests = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    hideAllChatJoinRequests({
      chatId,
      isApproved: true
    });
    closeAcceptAllDialog();
  }, [hideAllChatJoinRequests, chatId, closeAcceptAllDialog]);
  const handleRejectAllRequests = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    hideAllChatJoinRequests({
      chatId,
      isApproved: false
    });
    closeRejectAllDialog();
  }, [hideAllChatJoinRequests, chatId, closeRejectAllDialog]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management ManageJoinRequests"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AnimatedIcon__WEBPACK_IMPORTED_MODULE_9__["default"], {
    tgsUrl: _common_helpers_animatedAssets__WEBPACK_IMPORTED_MODULE_5__.LOCAL_TGS_URLS.JoinRequest,
    size: _config__WEBPACK_IMPORTED_MODULE_2__.STICKER_SIZE_JOIN_REQUESTS,
    className: "section-icon"
  }), Boolean(chat?.joinRequests?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "bulk-actions"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "bulk-action-button",
    onClick: openAcceptAllDialog
  }, "Accept all"), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "bulk-action-button",
    onClick: openRejectAllDialog,
    isText: true
  }, "Dismiss all"))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section",
    teactFastList: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    key: "title"
  }, !chat?.joinRequests ? lang('Loading') : chat.joinRequests.length ? lang('JoinRequests', chat.joinRequests.length) : lang('NoMemberRequests')), !chat?.joinRequests && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_12__["default"], {
    key: "loading"
  }), chat?.joinRequests?.length === 0 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help",
    key: "empty"
  }, isChannel ? lang('NoSubscribeRequestsDescription') : lang('NoMemberRequestsDescription')), chat?.joinRequests?.map(({
    userId,
    about,
    date
  }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_JoinRequest__WEBPACK_IMPORTED_MODULE_13__["default"], {
    userId: userId,
    about: about,
    date: date,
    isChannel: isChannel,
    chatId: chatId,
    key: userId
  })))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isOpen: isAcceptAllDialogOpen,
    onClose: closeAcceptAllDialog,
    title: "Accept all requests?",
    text: "Are you sure you want to accept all requests?",
    confirmHandler: handleAcceptAllRequests
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_11__["default"], {
    isOpen: isRejectAllDialogOpen,
    onClose: closeRejectAllDialog,
    title: "Reject all requests?",
    text: "Are you sure you want to reject all requests?",
    confirmHandler: handleRejectAllRequests
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  return {
    chat,
    isChannel: chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatChannel)(chat)
  };
})(ManageJoinRequests)));

/***/ }),

/***/ "./src/components/right/management/ManageReactions.tsx":
/*!*************************************************************!*\
  !*** ./src/components/right/management/ManageReactions.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/reactions/ReactionStaticEmoji */ "./src/components/common/reactions/ReactionStaticEmoji.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_RadioGroup__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/RadioGroup */ "./src/components/ui/RadioGroup.tsx");
/* harmony import */ var _ui_RangeSlider__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/RangeSlider */ "./src/components/ui/RangeSlider.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");














const ManageReactions = ({
  availableReactions,
  enabledReactions,
  chat,
  isActive,
  onClose,
  maxUniqueReactions,
  reactionsLimit,
  isChannel
}) => {
  const {
    setChatEnabledReactions
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [isTouched, setIsTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isLoading, setIsLoading] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [localEnabledReactions, setLocalEnabledReactions] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(enabledReactions);
  const [localReactionsLimit, setLocalReactionsLimit] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(reactionsLimit);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_5__["default"])({
    isActive,
    onBack: onClose
  });
  const reactionsOptions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => [{
    value: 'all',
    label: lang('AllReactions')
  }, {
    value: 'some',
    label: lang('SomeReactions')
  }, {
    value: 'none',
    label: lang('NoReactions')
  }], [lang]);
  const handleSaveReactions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!chat) return;
    setIsLoading(true);
    setChatEnabledReactions({
      chatId: chat.id,
      enabledReactions: localEnabledReactions,
      reactionsLimit: localReactionsLimit
    });
  }, [chat, localEnabledReactions, setChatEnabledReactions, localReactionsLimit]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setIsLoading(false);
    setIsTouched(false);
    setLocalEnabledReactions(enabledReactions);
    setLocalReactionsLimit(reactionsLimit);
  }, [enabledReactions, reactionsLimit]);
  const availableActiveReactions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => availableReactions?.filter(({
    isInactive
  }) => !isInactive), [availableReactions]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (localReactionsLimit !== undefined && localReactionsLimit !== reactionsLimit) {
      setIsTouched(true);
      return;
    }
    if (localEnabledReactions?.type === 'some') {
      const isReactionsDisabled = enabledReactions?.type !== 'all' && enabledReactions?.type !== 'some';
      if (isReactionsDisabled && localEnabledReactions.allowed.length === 0) {
        setIsTouched(false);
        return;
      }
    }
    if (localEnabledReactions?.type !== enabledReactions?.type) {
      setIsTouched(true);
      return;
    }
    if (localEnabledReactions?.type === 'some' && enabledReactions?.type === 'some') {
      const localAllowedReactions = localEnabledReactions.allowed;
      const enabledAllowedReactions = enabledReactions?.allowed;
      if (localAllowedReactions.length !== enabledAllowedReactions.length || localAllowedReactions.reverse().some(localReaction => !enabledAllowedReactions.find(enabledReaction => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(localReaction, enabledReaction)))) {
        setIsTouched(true);
        return;
      }
    }
    setIsTouched(false);
  }, [localReactionsLimit, reactionsLimit, localEnabledReactions, enabledReactions]);
  const handleReactionsOptionChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    if (value === 'all') {
      setLocalEnabledReactions({
        type: 'all'
      });
      setLocalReactionsLimit(reactionsLimit);
    } else if (value === 'some') {
      setLocalEnabledReactions({
        type: 'some',
        allowed: enabledReactions?.type === 'some' ? enabledReactions.allowed : []
      });
      setLocalReactionsLimit(reactionsLimit);
    } else {
      setLocalEnabledReactions(undefined);
      setLocalReactionsLimit(undefined);
    }
  }, [enabledReactions, reactionsLimit]);
  const handleReactionChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    if (!chat || !availableActiveReactions) return;
    const {
      name,
      checked
    } = e.currentTarget;
    if (localEnabledReactions?.type === 'some') {
      const reaction = {
        emoticon: name
      };
      if (checked) {
        setLocalEnabledReactions({
          type: 'some',
          allowed: [...localEnabledReactions.allowed, reaction]
        });
      } else {
        setLocalEnabledReactions({
          type: 'some',
          allowed: localEnabledReactions.allowed.filter(local => !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(local, reaction))
        });
      }
    }
  }, [availableActiveReactions, chat, localEnabledReactions]);
  const handleReactionsLimitChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    setLocalReactionsLimit(value);
  }, []);
  const renderReactionsMaxCountValue = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    return lang('PeerInfo.AllowedReactions.MaxCountValue', value);
  }, [lang]);
  const shouldShowReactionsLimit = isChannel && (localEnabledReactions?.type === 'all' || localEnabledReactions?.type === 'some');
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, localReactionsLimit && shouldShowReactionsLimit && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading"
  }, lang('MaximumReactionsHeader')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RangeSlider__WEBPACK_IMPORTED_MODULE_12__["default"], {
    min: 1,
    max: maxUniqueReactions,
    value: localReactionsLimit,
    onChange: handleReactionsLimitChange,
    renderValue: renderReactionsMaxCountValue,
    isCenteredLayout: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-info section-info_push"
  }, lang('ChannelReactions.MaxCount.Info'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading"
  }, lang('AvailableReactions')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_RadioGroup__WEBPACK_IMPORTED_MODULE_11__["default"], {
    selected: localEnabledReactions?.type || 'none',
    name: "reactions",
    options: reactionsOptions,
    onChange: handleReactionsOptionChange
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-info section-info_push"
  }, localEnabledReactions?.type === 'all' && lang('EnableAllReactionsInfo'), localEnabledReactions?.type === 'some' && lang('EnableSomeReactionsInfo'), !localEnabledReactions && lang('DisableReactionsInfo'))), localEnabledReactions?.type === 'some' && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section section-with-fab"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
    className: "section-heading"
  }, lang('OnlyAllowThisReactions')), availableActiveReactions?.map(({
    reaction,
    title
  }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_9__["default"], {
    name: reaction.emoticon,
    checked: localEnabledReactions?.allowed.some(r => (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(reaction, r)),
    label: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: "Reaction"
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_8__["default"], {
      reaction: reaction,
      availableReactions: availableReactions
    }), title),
    withIcon: true,
    onChange: handleReactionChange
  }))))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isShown: isTouched,
    onClick: handleSaveReactions,
    ariaLabel: lang('Save'),
    disabled: isLoading
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_13__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
    name: "check"
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId);
  const {
    maxUniqueReactions = _config__WEBPACK_IMPORTED_MODULE_2__.MAX_UNIQUE_REACTIONS
  } = global.appConfig || {};
  const chatFullInfo = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId);
  const reactionsLimit = chatFullInfo?.reactionsLimit || maxUniqueReactions;
  const isChannel = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isChatChannel)(chat);
  return {
    enabledReactions: chatFullInfo?.enabledReactions,
    availableReactions: global.reactions.availableReactions,
    chat,
    maxUniqueReactions,
    reactionsLimit,
    isChannel
  };
}, (global, {
  chatId
}) => {
  return Boolean((0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChat)(global, chatId));
})(ManageReactions)));

/***/ }),

/***/ "./src/components/right/management/ManageUser.tsx":
/*!********************************************************!*\
  !*** ./src/components/right/management/ManageUser.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ui/Checkbox */ "./src/components/ui/Checkbox.tsx");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _ui_InputText__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../ui/InputText */ "./src/components/ui/InputText.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_SelectAvatar__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../ui/SelectAvatar */ "./src/components/ui/SelectAvatar.tsx");
/* harmony import */ var _ui_Spinner__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../ui/Spinner */ "./src/components/ui/Spinner.tsx");
/* harmony import */ var _Management_scss__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./Management.scss */ "./src/components/right/management/Management.scss");




















const ERROR_FIRST_NAME_MISSING = 'Please provide first name';
const ManageUser = ({
  userId,
  user,
  progress,
  isMuted,
  onClose,
  isActive,
  personalPhoto,
  notPersonalPhoto
}) => {
  const {
    updateContact,
    deleteContact,
    closeManagement,
    uploadContactProfilePhoto
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isDeleteDialogOpen, openDeleteDialog, closeDeleteDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [isResetPersonalPhotoDialogOpen, openResetPersonalPhotoDialog, closeResetPersonalPhotoDialog] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const [isProfileFieldsTouched, setIsProfileFieldsTouched] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [error, setError] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_7__["default"])({
    isActive,
    onBack: onClose
  });
  const currentFirstName = user ? user.firstName || '' : '';
  const currentLastName = user ? user.lastName || '' : '';
  const [firstName, setFirstName] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentFirstName);
  const [lastName, setLastName] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentLastName);
  const [isNotificationsEnabled, setIsNotificationsEnabled] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(!isMuted);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setIsNotificationsEnabled(!isMuted);
  }, [isMuted]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setIsProfileFieldsTouched(false);
    closeDeleteDialog();
  }, [closeDeleteDialog, userId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setFirstName(currentFirstName);
    setLastName(currentLastName);
  }, [currentFirstName, currentLastName, user]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (progress === _types__WEBPACK_IMPORTED_MODULE_2__.ManagementProgress.Complete) {
      setIsProfileFieldsTouched(false);
      setError(undefined);
      closeDeleteDialog();
    }
  }, [closeDeleteDialog, progress]);
  const handleFirstNameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setFirstName(e.target.value);
    setIsProfileFieldsTouched(true);
    if (error === ERROR_FIRST_NAME_MISSING) {
      setError(undefined);
    }
  }, [error]);
  const handleLastNameChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setLastName(e.target.value);
    setIsProfileFieldsTouched(true);
  }, []);
  const handleNotificationChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    setIsNotificationsEnabled(e.target.checked);
    setIsProfileFieldsTouched(true);
  }, []);
  const handleProfileSave = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    const trimmedFirstName = firstName.trim();
    const trimmedLastName = lastName.trim();
    if (!trimmedFirstName.length) {
      setError(ERROR_FIRST_NAME_MISSING);
      return;
    }
    updateContact({
      userId,
      isMuted: !isNotificationsEnabled,
      firstName: trimmedFirstName,
      lastName: trimmedLastName
    });
  }, [firstName, lastName, updateContact, userId, isNotificationsEnabled]);
  const handleDeleteContact = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    deleteContact({
      userId
    });
    closeDeleteDialog();
    closeManagement();
  }, [closeDeleteDialog, closeManagement, deleteContact, userId]);

  // eslint-disable-next-line no-null/no-null
  const inputRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const isSuggestRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);
  const handleSuggestPhoto = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    inputRef.current?.click();
    isSuggestRef.current = true;
  }, []);
  const handleSetPersonalPhoto = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    inputRef.current?.click();
    isSuggestRef.current = false;
  }, []);
  const handleResetPersonalAvatar = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeResetPersonalPhotoDialog();
    setIsProfileFieldsTouched(true);
    uploadContactProfilePhoto({
      userId
    });
  }, [closeResetPersonalPhotoDialog, uploadContactProfilePhoto, userId]);
  const handleSelectAvatar = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(file => {
    setIsProfileFieldsTouched(true);
    uploadContactProfilePhoto({
      userId,
      file,
      isSuggest: isSuggestRef.current
    });
  }, [uploadContactProfilePhoto, userId]);
  if (!user) {
    return undefined;
  }
  const canSetPersonalPhoto = !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isUserBot)(user) && user.id !== _config__WEBPACK_IMPORTED_MODULE_3__.SERVICE_NOTIFICATIONS_USER_ID;
  const isLoading = progress === _types__WEBPACK_IMPORTED_MODULE_2__.ManagementProgress.InProgress;
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "Management"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "custom-scroll"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_11__["default"], {
    userId: user.id,
    avatarSize: "jumbo",
    noStatusOrTyping: true,
    noEmojiStatus: true,
    withFullInfo: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "settings-edit"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_15__["default"], {
    id: "user-first-name",
    label: lang('UserInfo.FirstNamePlaceholder'),
    onChange: handleFirstNameChange,
    value: firstName,
    error: error === ERROR_FIRST_NAME_MISSING ? error : undefined
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InputText__WEBPACK_IMPORTED_MODULE_15__["default"], {
    id: "user-last-name",
    label: lang('UserInfo.LastNamePlaceholder'),
    onChange: handleLastNameChange,
    value: lastName
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "ListItem narrow"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Checkbox__WEBPACK_IMPORTED_MODULE_12__["default"], {
    checked: isNotificationsEnabled,
    label: lang('Notifications'),
    subLabel: lang(isNotificationsEnabled ? 'UserInfo.NotificationsEnabled' : 'UserInfo.NotificationsDisabled'),
    onChange: handleNotificationChange
  }))), canSetPersonalPhoto && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "camera-add",
    ripple: true,
    onClick: handleSuggestPhoto
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "list-item-ellipsis"
  }, lang('UserInfo.SuggestPhoto', user.firstName))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "camera-add",
    ripple: true,
    onClick: handleSetPersonalPhoto
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "list-item-ellipsis"
  }, lang('UserInfo.SetCustomPhoto', user.firstName))), personalPhoto && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_9__["default"], {
      photo: notPersonalPhoto,
      noPersonalPhoto: true,
      peer: user,
      size: "mini",
      className: "personal-photo"
    }),
    ripple: true,
    onClick: openResetPersonalPhotoDialog
  }, lang('UserInfo.ResetCustomPhoto')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("p", {
    className: "section-help",
    dir: "auto"
  }, lang('UserInfo.CustomPhotoInfo', user.firstName))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: "section"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"], {
    icon: "delete",
    ripple: true,
    destructive: true,
    onClick: openDeleteDialog
  }, lang('DeleteContact')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_14__["default"], {
    isShown: isProfileFieldsTouched,
    onClick: handleProfileSave,
    disabled: isLoading,
    ariaLabel: lang('Save')
  }, isLoading ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Spinner__WEBPACK_IMPORTED_MODULE_18__["default"], {
    color: "white"
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__["default"], {
    name: "check"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isDeleteDialogOpen,
    onClose: closeDeleteDialog,
    text: lang('AreYouSureDeleteContact'),
    confirmLabel: lang('DeleteContact'),
    confirmHandler: handleDeleteContact,
    confirmIsDestructive: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isResetPersonalPhotoDialogOpen,
    onClose: closeResetPersonalPhotoDialog,
    text: lang('UserInfo.ResetToOriginalAlertText', user.firstName),
    confirmLabel: lang('Reset'),
    confirmHandler: handleResetPersonalAvatar,
    confirmIsDestructive: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_SelectAvatar__WEBPACK_IMPORTED_MODULE_17__["default"], {
    onChange: handleSelectAvatar,
    inputRef: inputRef
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  userId
}) => {
  const user = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUser)(global, userId);
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, userId);
  const userFullInfo = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUserFullInfo)(global, userId);
  const {
    progress
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global).management;
  const isMuted = chat && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.selectIsChatMuted)(chat, (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectNotifySettings)(global), (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectNotifyExceptions)(global));
  const personalPhoto = userFullInfo?.personalPhoto;
  const notPersonalPhoto = userFullInfo?.profilePhoto || userFullInfo?.fallbackPhoto;
  return {
    user,
    progress,
    isMuted,
    personalPhoto,
    notPersonalPhoto
  };
})(ManageUser)));

/***/ }),

/***/ "./src/components/right/management/Management.tsx":
/*!********************************************************!*\
  !*** ./src/components/right/management/Management.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _ManageBot__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ManageBot */ "./src/components/right/management/ManageBot.tsx");
/* harmony import */ var _ManageChannel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ManageChannel */ "./src/components/right/management/ManageChannel.tsx");
/* harmony import */ var _ManageChatAdministrators__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ManageChatAdministrators */ "./src/components/right/management/ManageChatAdministrators.tsx");
/* harmony import */ var _ManageChatPrivacyType__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ManageChatPrivacyType */ "./src/components/right/management/ManageChatPrivacyType.tsx");
/* harmony import */ var _ManageChatRemovedUsers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ManageChatRemovedUsers */ "./src/components/right/management/ManageChatRemovedUsers.tsx");
/* harmony import */ var _ManageDiscussion__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ManageDiscussion */ "./src/components/right/management/ManageDiscussion.tsx");
/* harmony import */ var _ManageGroup__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./ManageGroup */ "./src/components/right/management/ManageGroup.tsx");
/* harmony import */ var _ManageGroupAdminRights__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./ManageGroupAdminRights */ "./src/components/right/management/ManageGroupAdminRights.tsx");
/* harmony import */ var _ManageGroupMembers__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./ManageGroupMembers */ "./src/components/right/management/ManageGroupMembers.tsx");
/* harmony import */ var _ManageGroupPermissions__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./ManageGroupPermissions */ "./src/components/right/management/ManageGroupPermissions.tsx");
/* harmony import */ var _ManageGroupUserPermissions__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./ManageGroupUserPermissions */ "./src/components/right/management/ManageGroupUserPermissions.tsx");
/* harmony import */ var _ManageGroupUserPermissionsCreate__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./ManageGroupUserPermissionsCreate */ "./src/components/right/management/ManageGroupUserPermissionsCreate.tsx");
/* harmony import */ var _ManageInvite__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./ManageInvite */ "./src/components/right/management/ManageInvite.tsx");
/* harmony import */ var _ManageInviteInfo__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./ManageInviteInfo */ "./src/components/right/management/ManageInviteInfo.tsx");
/* harmony import */ var _ManageInvites__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./ManageInvites */ "./src/components/right/management/ManageInvites.tsx");
/* harmony import */ var _ManageJoinRequests__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./ManageJoinRequests */ "./src/components/right/management/ManageJoinRequests.tsx");
/* harmony import */ var _ManageReactions__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./ManageReactions */ "./src/components/right/management/ManageReactions.tsx");
/* harmony import */ var _ManageUser__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./ManageUser */ "./src/components/right/management/ManageUser.tsx");






















const Management = ({
  chatId,
  currentScreen,
  selectedChatMemberId,
  isPromotedByCurrentUser,
  onScreenSelect,
  onChatMemberSelect,
  onClose,
  isActive,
  managementType
}) => {
  switch (currentScreen) {
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.Initial:
      {
        switch (managementType) {
          case 'bot':
            return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageBot__WEBPACK_IMPORTED_MODULE_4__["default"], {
              key: chatId,
              userId: chatId,
              onClose: onClose,
              isActive: isActive
            });
          case 'user':
            return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageUser__WEBPACK_IMPORTED_MODULE_21__["default"], {
              key: chatId,
              userId: chatId,
              onClose: onClose,
              isActive: isActive
            });
          case 'group':
            return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageGroup__WEBPACK_IMPORTED_MODULE_10__["default"], {
              key: chatId,
              chatId: chatId,
              onScreenSelect: onScreenSelect,
              onClose: onClose,
              isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatPrivacyType, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.Discussion, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupPermissions, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatAdministrators, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupRemovedUsers, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissionsCreate, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissions, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatAdminRights, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatNewAdminRights, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupRecentActions].includes(currentScreen)
            });
          case 'channel':
            return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageChannel__WEBPACK_IMPORTED_MODULE_5__["default"], {
              key: chatId,
              chatId: chatId,
              onScreenSelect: onScreenSelect,
              onClose: onClose,
              isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChannelSubscribers, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatAdministrators, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChannelRemovedUsers, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.Discussion, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatPrivacyType, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatAdminRights, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatNewAdminRights, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupRecentActions].includes(currentScreen)
            });
        }
        break;
      }
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatPrivacyType:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageChatPrivacyType__WEBPACK_IMPORTED_MODULE_7__["default"], {
        chatId: chatId,
        isActive: isActive,
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.Discussion:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageDiscussion__WEBPACK_IMPORTED_MODULE_9__["default"], {
        chatId: chatId,
        onScreenSelect: onScreenSelect,
        isActive: isActive,
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupPermissions:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageGroupPermissions__WEBPACK_IMPORTED_MODULE_13__["default"], {
        chatId: chatId,
        onScreenSelect: onScreenSelect,
        onChatMemberSelect: onChatMemberSelect,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupRemovedUsers, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissionsCreate, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissions].includes(currentScreen),
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChannelRemovedUsers:
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupRemovedUsers:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageChatRemovedUsers__WEBPACK_IMPORTED_MODULE_8__["default"], {
        chatId: chatId,
        isActive: isActive,
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissionsCreate:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageGroupUserPermissionsCreate__WEBPACK_IMPORTED_MODULE_15__["default"], {
        chatId: chatId,
        onChatMemberSelect: onChatMemberSelect,
        onScreenSelect: onScreenSelect,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissions].includes(currentScreen),
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupUserPermissions:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageGroupUserPermissions__WEBPACK_IMPORTED_MODULE_14__["default"], {
        chatId: chatId,
        selectedChatMemberId: selectedChatMemberId,
        isPromotedByCurrentUser: isPromotedByCurrentUser,
        onScreenSelect: onScreenSelect,
        isActive: isActive,
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatAdministrators:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageChatAdministrators__WEBPACK_IMPORTED_MODULE_6__["default"], {
        chatId: chatId,
        onScreenSelect: onScreenSelect,
        onChatMemberSelect: onChatMemberSelect,
        isActive: isActive || [_types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatAdminRights, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatNewAdminRights, _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupRecentActions].includes(currentScreen),
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatNewAdminRights:
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatAdminRights:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageGroupAdminRights__WEBPACK_IMPORTED_MODULE_11__["default"], {
        chatId: chatId,
        isNewAdmin: currentScreen === _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChatNewAdminRights,
        selectedUserId: selectedChatMemberId,
        isPromotedByCurrentUser: isPromotedByCurrentUser,
        onScreenSelect: onScreenSelect,
        isActive: isActive,
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.ChannelSubscribers:
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupMembers:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageGroupMembers__WEBPACK_IMPORTED_MODULE_12__["default"], {
        chatId: chatId,
        isActive: isActive,
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.Invites:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageInvites__WEBPACK_IMPORTED_MODULE_18__["default"], {
        chatId: chatId,
        isActive: isActive,
        onClose: onClose,
        onScreenSelect: onScreenSelect
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.EditInvite:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageInvite__WEBPACK_IMPORTED_MODULE_16__["default"], {
        chatId: chatId,
        isActive: isActive,
        onClose: onClose,
        onScreenSelect: onScreenSelect
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.GroupAddAdmins:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageGroupMembers__WEBPACK_IMPORTED_MODULE_12__["default"], {
        chatId: chatId,
        noAdmins: true,
        isActive: isActive,
        onClose: onClose,
        onScreenSelect: onScreenSelect,
        onChatMemberSelect: onChatMemberSelect
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.Reactions:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageReactions__WEBPACK_IMPORTED_MODULE_20__["default"], {
        chatId: chatId,
        isActive: isActive,
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.InviteInfo:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageInviteInfo__WEBPACK_IMPORTED_MODULE_17__["default"], {
        chatId: chatId,
        isActive: isActive,
        onClose: onClose
      });
    case _types__WEBPACK_IMPORTED_MODULE_2__.ManagementScreens.JoinRequests:
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ManageJoinRequests__WEBPACK_IMPORTED_MODULE_19__["default"], {
        chatId: chatId,
        isActive: isActive,
        onClose: onClose
      });
  }
  return undefined; // Never reached
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const managementType = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectCurrentManagementType)(global);
  return {
    managementType
  };
})(Management)));

/***/ }),

/***/ "./src/components/right/management/RemoveGroupUserModal.tsx":
/*!******************************************************************!*\
  !*** ./src/components/right/management/RemoveGroupUserModal.tsx ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_ChatOrUserPicker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/pickers/ChatOrUserPicker */ "./src/components/common/pickers/ChatOrUserPicker.tsx");






const RemoveGroupUserModal = ({
  chat,
  currentUserId,
  chatMembers,
  isOpen,
  onClose
}) => {
  const {
    loadMoreMembers,
    deleteChatMember
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const [search, setSearch] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const usersId = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const availableMemberIds = (chatMembers || []).reduce((acc, member) => {
      if (!member.isAdmin && !member.isOwner && member.userId !== currentUserId) {
        acc.push(member.userId);
      }
      return acc;
    }, []);

    // No need for expensive global updates on users, so we avoid them
    const usersById = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)().users.byId;
    return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.filterUsersByName)(availableMemberIds, usersById, search);
  }, [chatMembers, currentUserId, search]);
  const handleRemoveUser = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(userId => {
    deleteChatMember({
      chatId: chat.id,
      userId
    });
    onClose();
  }, [chat.id, deleteChatMember, onClose]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_ChatOrUserPicker__WEBPACK_IMPORTED_MODULE_5__["default"], {
    isOpen: isOpen,
    chatOrUserIds: usersId,
    searchPlaceholder: lang('ChannelBlockUser'),
    search: search,
    onSearchChange: setSearch,
    loadMore: loadMoreMembers,
    onSelectChatOrUser: handleRemoveUser,
    onClose: onClose
  });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chat
}) => {
  const {
    currentUserId
  } = global;
  return {
    currentUserId,
    chatMembers: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chat.id)?.members
  };
})(RemoveGroupUserModal)));

/***/ }),

/***/ "./src/components/right/statistics/MessageStatistics.tsx":
/*!***************************************************************!*\
  !*** ./src/components/right/statistics/MessageStatistics.tsx ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _api_gramjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../api/gramjs */ "./src/api/gramjs/index.ts");
/* harmony import */ var _hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useForceUpdate */ "./src/hooks/useForceUpdate.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _StatisticsMessagePublicForward__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./StatisticsMessagePublicForward */ "./src/components/right/statistics/StatisticsMessagePublicForward.tsx");
/* harmony import */ var _StatisticsOverview__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./StatisticsOverview */ "./src/components/right/statistics/StatisticsOverview.tsx");
/* harmony import */ var _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Statistics.module.scss */ "./src/components/right/statistics/Statistics.module.scss");















let lovelyChartPromise;
let LovelyChart;
async function ensureLovelyChart() {
  if (!lovelyChartPromise) {
    lovelyChartPromise = __webpack_require__.e(/*! import() */ "src_lib_lovely-chart_LovelyChart_js").then(__webpack_require__.bind(__webpack_require__, /*! ../../../lib/lovely-chart/LovelyChart */ "./src/lib/lovely-chart/LovelyChart.js"));
    LovelyChart = await lovelyChartPromise;
  }
  return lovelyChartPromise;
}
const GRAPH_TITLES = {
  viewsGraph: 'Stats.MessageInteractionsTitle',
  reactionsGraph: 'ReactionsByEmotionChartTitle'
};
const GRAPHS = Object.keys(GRAPH_TITLES);
function Statistics({
  chatId,
  isActive,
  statistics,
  dcId,
  messageId
}) {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [isReady, setIsReady] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const loadedCharts = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)([]);
  const {
    loadMessageStatistics,
    loadMessagePublicForwards,
    loadStatisticsAsyncGraph
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const forceUpdate = (0,_hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_7__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (messageId) {
      loadMessageStatistics({
        chatId,
        messageId
      });
    }
  }, [chatId, loadMessageStatistics, messageId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isActive || messageId) {
      loadedCharts.current = [];
      setIsReady(false);
    }
  }, [isActive, messageId]);

  // Load async graphs
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!statistics) {
      return;
    }
    GRAPHS.forEach(name => {
      const graph = statistics[name];
      const isAsync = typeof graph === 'string';
      if (isAsync) {
        loadStatisticsAsyncGraph({
          name,
          chatId,
          token: graph
        });
      }
    });
  }, [chatId, statistics, loadStatisticsAsyncGraph]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    (async () => {
      await ensureLovelyChart();
      if (!isReady) {
        setIsReady(true);
        return;
      }
      if (!statistics || !containerRef.current) {
        return;
      }
      GRAPHS.forEach((name, index) => {
        const graph = statistics[name];
        const isAsync = typeof graph === 'string';
        if (isAsync || loadedCharts.current.includes(name)) {
          return;
        }
        if (!graph) {
          loadedCharts.current.push(name);
          return;
        }
        const {
          zoomToken
        } = graph;
        LovelyChart.create(containerRef.current.children[index], {
          title: lang(GRAPH_TITLES[name]),
          ...(zoomToken ? {
            onZoom: x => (0,_api_gramjs__WEBPACK_IMPORTED_MODULE_6__.callApi)('fetchStatisticsAsyncGraph', {
              token: zoomToken,
              x,
              dcId
            }),
            zoomOutLabel: lang('Graph.ZoomOut')
          } : {}),
          ...graph
        });
        loadedCharts.current.push(name);
      });
      forceUpdate();
    })();
  }, [isReady, statistics, lang, chatId, messageId, loadStatisticsAsyncGraph, dcId, forceUpdate]);
  const handleLoadMore = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(({
    direction
  }) => {
    if (direction === _types__WEBPACK_IMPORTED_MODULE_2__.LoadMoreDirection.Backwards && messageId) {
      loadMessagePublicForwards({
        chatId,
        messageId
      });
    }
  });
  if (!isReady || !statistics || !messageId) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_11__["default"], null);
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].root, 'custom-scroll', isReady && _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].ready)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsOverview__WEBPACK_IMPORTED_MODULE_13__["default"], {
    statistics: statistics,
    type: "message",
    title: lang('StatisticOverview')
  }), !loadedCharts.current.length && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_11__["default"], null), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef
  }, GRAPHS.map(graph => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_5__["default"])(_Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].graph, !loadedCharts.current.includes(graph) && _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].hidden)
  }))), Boolean(statistics.publicForwards) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].publicForwards
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].publicForwardsTitle
  }, lang('Stats.Message.PublicShares')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_10__["default"], {
    items: statistics.publicForwardsData,
    itemSelector: ".statistic-public-forward",
    onLoadMore: handleLoadMore,
    preloadBackwards: _config__WEBPACK_IMPORTED_MODULE_3__.STATISTICS_PUBLIC_FORWARDS_LIMIT,
    noFastList: true
  }, statistics.publicForwardsData.map(item => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsMessagePublicForward__WEBPACK_IMPORTED_MODULE_12__["default"], {
    key: item.messageId,
    data: item
  })))));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const dcId = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectChatFullInfo)(global, chatId)?.statisticsDcId;
  const tabState = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_4__.selectTabState)(global);
  const statistics = tabState.statistics.currentMessage;
  const messageId = tabState.statistics.currentMessageId;
  return {
    statistics,
    dcId,
    messageId
  };
})(Statistics)));

/***/ }),

/***/ "./src/components/right/statistics/Statistics.tsx":
/*!********************************************************!*\
  !*** ./src/components/right/statistics/Statistics.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _api_gramjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../api/gramjs */ "./src/api/gramjs/index.ts");
/* harmony import */ var _hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useForceUpdate */ "./src/hooks/useForceUpdate.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _StatisticsOverview__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./StatisticsOverview */ "./src/components/right/statistics/StatisticsOverview.tsx");
/* harmony import */ var _StatisticsRecentMessage__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./StatisticsRecentMessage */ "./src/components/right/statistics/StatisticsRecentMessage.tsx");
/* harmony import */ var _StatisticsRecentStory__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./StatisticsRecentStory */ "./src/components/right/statistics/StatisticsRecentStory.tsx");
/* harmony import */ var _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Statistics.module.scss */ "./src/components/right/statistics/Statistics.module.scss");












let lovelyChartPromise;
let LovelyChart;
async function ensureLovelyChart() {
  if (!lovelyChartPromise) {
    lovelyChartPromise = __webpack_require__.e(/*! import() */ "src_lib_lovely-chart_LovelyChart_js").then(__webpack_require__.bind(__webpack_require__, /*! ../../../lib/lovely-chart/LovelyChart */ "./src/lib/lovely-chart/LovelyChart.js"));
    LovelyChart = await lovelyChartPromise;
  }
  return lovelyChartPromise;
}
const CHANNEL_GRAPHS_TITLES = {
  growthGraph: 'ChannelStats.Graph.Growth',
  followersGraph: 'ChannelStats.Graph.Followers',
  muteGraph: 'ChannelStats.Graph.Notifications',
  topHoursGraph: 'ChannelStats.Graph.ViewsByHours',
  viewsBySourceGraph: 'ChannelStats.Graph.ViewsBySource',
  newFollowersBySourceGraph: 'ChannelStats.Graph.NewFollowersBySource',
  languagesGraph: 'ChannelStats.Graph.Language',
  interactionsGraph: 'ChannelStats.Graph.Interactions',
  reactionsByEmotionGraph: 'ChannelStats.Graph.Reactions',
  storyInteractionsGraph: 'ChannelStats.Graph.Stories',
  storyReactionsByEmotionGraph: 'ChannelStats.Graph.StoriesReactions'
};
const CHANNEL_GRAPHS = Object.keys(CHANNEL_GRAPHS_TITLES);
const GROUP_GRAPHS_TITLES = {
  growthGraph: 'Stats.GroupGrowthTitle',
  membersGraph: 'Stats.GroupMembersTitle',
  languagesGraph: 'Stats.GroupLanguagesTitle',
  messagesGraph: 'Stats.GroupMessagesTitle',
  actionsGraph: 'Stats.GroupActionsTitle',
  topHoursGraph: 'Stats.GroupTopHoursTitle'
};
const GROUP_GRAPHS = Object.keys(GROUP_GRAPHS_TITLES);
const Statistics = ({
  chatId,
  chat,
  statistics,
  dcId,
  isGroup,
  messagesById,
  storiesById
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [isReady, setIsReady] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const loadedCharts = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)([]);
  const {
    loadStatistics,
    loadStatisticsAsyncGraph
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const forceUpdate = (0,_hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_5__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    loadStatistics({
      chatId,
      isGroup
    });
  }, [chatId, loadStatistics, isGroup]);
  const graphs = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return isGroup ? GROUP_GRAPHS : CHANNEL_GRAPHS;
  }, [isGroup]);
  const graphTitles = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return isGroup ? GROUP_GRAPHS_TITLES : CHANNEL_GRAPHS_TITLES;
  }, [isGroup]);

  // Load async graphs
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!statistics) {
      return;
    }
    graphs.forEach(name => {
      const graph = statistics[name];
      const isAsync = typeof graph === 'string';
      if (isAsync) {
        loadStatisticsAsyncGraph({
          name,
          chatId,
          token: graph,
          // Hardcode percentage for languages graph, since API does not return `percentage` flag
          isPercentage: name === 'languagesGraph'
        });
      }
    });
  }, [graphs, chatId, statistics, loadStatisticsAsyncGraph]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    (async () => {
      await ensureLovelyChart();
      if (!isReady) {
        setIsReady(true);
        return;
      }
      if (!statistics || !containerRef.current) {
        return;
      }
      graphs.forEach((name, index) => {
        const graph = statistics[name];
        const isAsync = typeof graph === 'string';
        if (isAsync || loadedCharts.current.includes(name)) {
          return;
        }
        if (!graph) {
          loadedCharts.current.push(name);
          return;
        }
        const {
          zoomToken
        } = graph;
        LovelyChart.create(containerRef.current.children[index], {
          title: lang(graphTitles[name]),
          ...(zoomToken ? {
            onZoom: x => (0,_api_gramjs__WEBPACK_IMPORTED_MODULE_4__.callApi)('fetchStatisticsAsyncGraph', {
              token: zoomToken,
              x,
              dcId
            }),
            zoomOutLabel: lang('Graph.ZoomOut')
          } : {}),
          ...graph
        });
        loadedCharts.current.push(name);
        containerRef.current.children[index].classList.remove(_Statistics_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].hidden);
      });
      forceUpdate();
    })();
  }, [graphs, graphTitles, isReady, statistics, lang, chatId, loadStatisticsAsyncGraph, dcId, forceUpdate]);
  if (!isReady || !statistics) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_7__["default"], null);
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_Statistics_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].root, 'custom-scroll', isReady && _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].ready)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsOverview__WEBPACK_IMPORTED_MODULE_8__["default"], {
    statistics: statistics,
    type: isGroup ? 'group' : 'channel',
    title: lang('StatisticOverview')
  }), !loadedCharts.current.length && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_7__["default"], null), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef
  }, graphs.map(graph => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    key: graph,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_Statistics_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].graph, _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].hidden)
  }))), Boolean(statistics.recentPosts?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].messages
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].messagesTitle
  }, lang('ChannelStats.Recent.Header')), statistics.recentPosts.map(postStatistic => {
    if ('msgId' in postStatistic) {
      const message = messagesById[postStatistic.msgId];
      if (!message || !('content' in message)) return undefined;
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsRecentMessage__WEBPACK_IMPORTED_MODULE_9__["default"], {
        key: `statistic_message_${postStatistic.msgId}`,
        message: message,
        postStatistic: postStatistic
      });
    }
    if ('storyId' in postStatistic && chat) {
      const story = storiesById?.[postStatistic.storyId];
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsRecentStory__WEBPACK_IMPORTED_MODULE_10__["default"], {
        key: `statistic_story_${postStatistic.storyId}`,
        chat: chat,
        story: story,
        postStatistic: postStatistic
      });
    }
    return undefined;
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const statistics = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectStatistics)(global, chatId);
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectChat)(global, chatId);
  const dcId = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectChatFullInfo)(global, chatId)?.statisticsDcId;
  const isGroup = chat?.type === 'chatTypeSuperGroup';
  const messagesById = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectChatMessages)(global, chatId);
  const storiesById = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectPeerStories)(global, chatId)?.byId;
  return {
    statistics,
    dcId,
    isGroup,
    chat,
    messagesById,
    storiesById
  };
})(Statistics)));

/***/ }),

/***/ "./src/components/right/statistics/StatisticsMessagePublicForward.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/right/statistics/StatisticsMessagePublicForward.tsx ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _StatisticsPublicForward_module_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./StatisticsPublicForward.module.scss */ "./src/components/right/statistics/StatisticsPublicForward.module.scss");







const StatisticsMessagePublicForward = ({
  data
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const {
    openChatByUsername
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const username = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => data.chat ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMainUsername)(data.chat) : undefined, [data.chat]);
  const handleClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    openChatByUsername({
      username: username,
      messageId: data.messageId
    });
  }, [data.messageId, openChatByUsername, username]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StatisticsPublicForward_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].root, 'statistic-public-forward'),
    onClick: handleClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_5__["default"], {
    size: "medium",
    peer: data.chat
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsPublicForward_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].title
  }, data.title), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsPublicForward_module_scss__WEBPACK_IMPORTED_MODULE_6__["default"].views
  }, lang('ChannelStats.ViewsCount', data.views, 'i'))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StatisticsMessagePublicForward));

/***/ }),

/***/ "./src/components/right/statistics/StatisticsRecentMessage.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/right/statistics/StatisticsRecentMessage.tsx ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/helpers/renderMessageText */ "./src/components/common/helpers/renderMessageText.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _StatisticsRecentPostMeta__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./StatisticsRecentPostMeta */ "./src/components/right/statistics/StatisticsRecentPostMeta.tsx");
/* harmony import */ var _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./StatisticsRecentPost.module.scss */ "./src/components/right/statistics/StatisticsRecentPost.module.scss");











const StatisticsRecentMessage = ({
  postStatistic,
  message
}) => {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const {
    toggleMessageStatistics
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const mediaThumbnail = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageMediaThumbDataUri)(message);
  const mediaBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_6__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageMediaHash)(message, 'micro'));
  const isRoundVideo = Boolean((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageRoundVideo)(message));
  const handleClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    toggleMessageStatistics({
      messageId: message.id
    });
  }, [toggleMessageStatistics, message.id]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].root, Boolean(mediaBlobUrl || mediaThumbnail) && _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].withImage),
    onClick: handleClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].title
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].summary
  }, renderSummary(lang, message, mediaBlobUrl || mediaThumbnail, isRoundVideo)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].meta
  }, lang('ChannelStats.ViewsCount', postStatistic.viewsCount, 'i'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].info
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].date
  }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.formatDateTimeToString)(message.date * 1000, lang.code)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsRecentPostMeta__WEBPACK_IMPORTED_MODULE_9__["default"], {
    postStatistic: postStatistic
  })));
};
function renderSummary(lang, message, blobUrl, isRoundVideo) {
  if (!blobUrl) {
    return (0,_common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_5__.renderMessageSummary)(lang, message);
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: blobUrl,
    alt: "",
    draggable: false,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].image, isRoundVideo && _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].round)
  }), (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getMessageVideo)(message) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "play"
  }), (0,_common_helpers_renderMessageText__WEBPACK_IMPORTED_MODULE_5__.renderMessageSummary)(lang, message, true));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StatisticsRecentMessage));

/***/ }),

/***/ "./src/components/right/statistics/StatisticsRecentPostMeta.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/right/statistics/StatisticsRecentPostMeta.tsx ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_textFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../util/textFormat */ "./src/util/textFormat.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./StatisticsRecentPost.module.scss */ "./src/components/right/statistics/StatisticsRecentPost.module.scss");





function StatisticsRecentPostMeta({
  postStatistic
}) {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].meta
  }, postStatistic.reactionsCount > 0 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].metaWithIcon
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_3__["default"], {
    name: "heart-outline",
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].metaIcon
  }), (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_1__.formatIntegerCompact)(postStatistic.reactionsCount)), postStatistic.forwardsCount > 0 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].metaWithIcon
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_3__["default"], {
    name: "forward",
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_4__["default"].metaIcon
  }), (0,_util_textFormat__WEBPACK_IMPORTED_MODULE_1__.formatIntegerCompact)(postStatistic.forwardsCount)), !postStatistic.forwardsCount && !postStatistic.reactionsCount && lang('ChannelStats.SharesCount_ZeroValueHolder'));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StatisticsRecentPostMeta));

/***/ }),

/***/ "./src/components/right/statistics/StatisticsRecentStory.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/right/statistics/StatisticsRecentStory.tsx ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _StatisticsRecentPostMeta__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./StatisticsRecentPostMeta */ "./src/components/right/statistics/StatisticsRecentPostMeta.tsx");
/* harmony import */ var _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./StatisticsRecentPost.module.scss */ "./src/components/right/statistics/StatisticsRecentPost.module.scss");











function StatisticsRecentStory({
  chat,
  story,
  postStatistic
}) {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const {
    toggleStoryStatistics
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const isLoaded = story && 'content' in story;
  const video = isLoaded ? story.content.video : undefined;
  const imageHash = isLoaded ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getStoryMediaHash)(story) : undefined;
  const imgBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_6__["default"])(imageHash);
  const mediaThumbnail = imgBlobUrl || video?.thumbnail?.dataUri;
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    toggleStoryStatistics({
      storyId: postStatistic.storyId
    });
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].root, _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].withImage),
    onClick: handleClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].title
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].summary
  }, renderSummary(lang, chat, imgBlobUrl || mediaThumbnail)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].meta
  }, lang('ChannelStats.ViewsCount', postStatistic.viewsCount, 'i'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].info
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].date
  }, isLoaded && Boolean(story.date) && (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_4__.formatDateTimeToString)(story.date * 1000, lang.code)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsRecentPostMeta__WEBPACK_IMPORTED_MODULE_9__["default"], {
    postStatistic: postStatistic
  })));
}
function renderSummary(lang, chat, blobUrl) {
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, blobUrl ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].imageContainer
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: blobUrl,
    alt: "",
    draggable: false,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].image, _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].circle, _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].withStoryCircle)
  })) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_8__["default"], {
    peer: chat,
    size: "small",
    className: _StatisticsRecentPost_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].image,
    withStorySolid: true,
    forceUnreadStorySolid: true
  }), lang('Story'));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StatisticsRecentStory));

/***/ }),

/***/ "./src/components/right/statistics/StatisticsStoryPublicForward.tsx":
/*!**************************************************************************!*\
  !*** ./src/components/right/statistics/StatisticsStoryPublicForward.tsx ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _StatisticsPublicForward_module_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./StatisticsPublicForward.module.scss */ "./src/components/right/statistics/StatisticsPublicForward.module.scss");








function StatisticsMessagePublicForward({
  data,
  chatsById,
  usersById
}) {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_5__["default"])();
  const {
    openChat
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const user = usersById[data.peerId];
  const chat = chatsById[data.peerId];
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    openChat({
      id: user.id
    });
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StatisticsPublicForward_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].root, 'statistic-public-forward'),
    onClick: handleClick
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_6__["default"], {
    size: "medium",
    peer: user || chat,
    withStorySolid: true,
    forceUnreadStorySolid: true
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsPublicForward_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].title
  }, user ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(user) : (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getChatTitle)(lang, chat)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StatisticsPublicForward_module_scss__WEBPACK_IMPORTED_MODULE_7__["default"].views
  }, data.viewsCount ? lang('ChannelStats.ViewsCount', data.viewsCount, 'i') : lang('NoViews'))));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StatisticsMessagePublicForward));

/***/ }),

/***/ "./src/components/right/statistics/StoryStatistics.tsx":
/*!*************************************************************!*\
  !*** ./src/components/right/statistics/StoryStatistics.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _api_gramjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../api/gramjs */ "./src/api/gramjs/index.ts");
/* harmony import */ var _hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useForceUpdate */ "./src/hooks/useForceUpdate.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_Loading__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/Loading */ "./src/components/ui/Loading.tsx");
/* harmony import */ var _StatisticsMessagePublicForward__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./StatisticsMessagePublicForward */ "./src/components/right/statistics/StatisticsMessagePublicForward.tsx");
/* harmony import */ var _StatisticsOverview__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./StatisticsOverview */ "./src/components/right/statistics/StatisticsOverview.tsx");
/* harmony import */ var _StatisticsStoryPublicForward__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./StatisticsStoryPublicForward */ "./src/components/right/statistics/StatisticsStoryPublicForward.tsx");
/* harmony import */ var _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Statistics.module.scss */ "./src/components/right/statistics/Statistics.module.scss");















let lovelyChartPromise;
let LovelyChart;
async function ensureLovelyChart() {
  if (!lovelyChartPromise) {
    lovelyChartPromise = __webpack_require__.e(/*! import() */ "src_lib_lovely-chart_LovelyChart_js").then(__webpack_require__.bind(__webpack_require__, /*! ../../../lib/lovely-chart/LovelyChart */ "./src/lib/lovely-chart/LovelyChart.js"));
    LovelyChart = await lovelyChartPromise;
  }
  return lovelyChartPromise;
}
const GRAPH_TITLES = {
  viewsGraph: 'Stats.StoryInteractionsTitle',
  reactionsGraph: 'ReactionsByEmotionChartTitle'
};
const GRAPHS = Object.keys(GRAPH_TITLES);
function StoryStatistics({
  chatId,
  isActive,
  statistics,
  dcId,
  storyId,
  chatsById,
  usersById
}) {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [isReady, setIsReady] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const loadedCharts = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)([]);
  const {
    loadStoryStatistics,
    loadStoryPublicForwards,
    loadStatisticsAsyncGraph
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const forceUpdate = (0,_hooks_useForceUpdate__WEBPACK_IMPORTED_MODULE_6__["default"])();
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (storyId) {
      loadStoryStatistics({
        chatId,
        storyId
      });
    }
  }, [chatId, storyId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isActive || storyId) {
      loadedCharts.current = [];
      setIsReady(false);
    }
  }, [isActive, storyId]);

  // Load async graphs
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!statistics) {
      return;
    }
    GRAPHS.forEach(name => {
      const graph = statistics[name];
      const isAsync = typeof graph === 'string';
      if (isAsync) {
        loadStatisticsAsyncGraph({
          name,
          chatId,
          token: graph
        });
      }
    });
  }, [chatId, statistics, loadStatisticsAsyncGraph]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    (async () => {
      await ensureLovelyChart();
      if (!isReady) {
        setIsReady(true);
        return;
      }
      if (!statistics || !containerRef.current) {
        return;
      }
      GRAPHS.forEach((name, index) => {
        const graph = statistics[name];
        const isAsync = typeof graph === 'string';
        if (isAsync || loadedCharts.current.includes(name)) {
          return;
        }
        if (!graph) {
          loadedCharts.current.push(name);
          return;
        }
        const {
          zoomToken
        } = graph;
        LovelyChart.create(containerRef.current.children[index], {
          title: lang(GRAPH_TITLES[name]),
          ...(zoomToken ? {
            onZoom: x => (0,_api_gramjs__WEBPACK_IMPORTED_MODULE_5__.callApi)('fetchStatisticsAsyncGraph', {
              token: zoomToken,
              x,
              dcId
            }),
            zoomOutLabel: lang('Graph.ZoomOut')
          } : {}),
          ...graph
        });
        loadedCharts.current.push(name);
      });
      forceUpdate();
    })();
  }, [isReady, statistics, lang, chatId, storyId, loadStatisticsAsyncGraph, dcId, forceUpdate]);
  const handleLoadMore = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    if (!storyId) return;
    loadStoryPublicForwards({
      chatId,
      storyId
    });
  });
  if (!isReady || !statistics || !storyId) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_10__["default"], null);
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].root, 'custom-scroll', isReady && _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].ready)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsOverview__WEBPACK_IMPORTED_MODULE_12__["default"], {
    statistics: statistics,
    type: "story",
    title: lang('StatisticOverview')
  }), !loadedCharts.current.length && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Loading__WEBPACK_IMPORTED_MODULE_10__["default"], null), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: containerRef
  }, GRAPHS.map(graph => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].graph, !loadedCharts.current.includes(graph) && _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].hidden)
  }))), Boolean(statistics.publicForwards) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].publicForwards
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h2", {
    className: _Statistics_module_scss__WEBPACK_IMPORTED_MODULE_14__["default"].publicForwardsTitle
  }, lang('Stats.Message.PublicShares')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_9__["default"], {
    items: statistics.publicForwardsData,
    itemSelector: ".statistic-public-forward",
    onLoadMore: handleLoadMore,
    preloadBackwards: _config__WEBPACK_IMPORTED_MODULE_2__.STATISTICS_PUBLIC_FORWARDS_LIMIT,
    noFastList: true
  }, statistics.publicForwardsData.map(item => {
    if ('messageId' in item) {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsMessagePublicForward__WEBPACK_IMPORTED_MODULE_11__["default"], {
        key: `message_${item.messageId}`,
        data: item
      });
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StatisticsStoryPublicForward__WEBPACK_IMPORTED_MODULE_13__["default"], {
      key: `story_${item.storyId}`,
      data: item,
      chatsById: chatsById,
      usersById: usersById
    });
  }))));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  chatId
}) => {
  const dcId = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectChatFullInfo)(global, chatId)?.statisticsDcId;
  const tabState = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global);
  const statistics = tabState.statistics.currentStory;
  const storyId = tabState.statistics.currentStoryId;
  const {
    byId: usersById
  } = global.users;
  const {
    byId: chatsById
  } = global.chats;
  return {
    statistics,
    dcId,
    storyId,
    usersById,
    chatsById
  };
})(StoryStatistics)));

/***/ }),

/***/ "./src/components/story/StealthModeModal.tsx":
/*!***************************************************!*\
  !*** ./src/components/story/StealthModeModal.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_TextTimer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/TextTimer */ "./src/components/ui/TextTimer.tsx");
/* harmony import */ var _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./StealthModeModal.module.scss */ "./src/components/story/StealthModeModal.module.scss");













const StealthModeModal = ({
  isOpen,
  stealthMode,
  isCurrentUserPremium
}) => {
  const {
    toggleStealthModal,
    activateStealthMode,
    showNotification,
    openPremiumModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [isOnCooldown, setIsOnCooldown] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!stealthMode) return;
    const serverTime = (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_4__.getServerTime)();
    if (stealthMode.cooldownUntil && stealthMode.cooldownUntil > serverTime) {
      setIsOnCooldown(true);
    }
  }, [stealthMode, isOpen]);
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const handleTimerEnds = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    setIsOnCooldown(false);
  });
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    toggleStealthModal({
      isOpen: false
    });
  });
  const handleActivate = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    if (!isCurrentUserPremium) {
      openPremiumModal({
        initialSection: 'stories'
      });
      return;
    }
    activateStealthMode();
    showNotification({
      title: lang('StealthModeOn'),
      message: lang('StealthModeOnHint')
    });
    toggleStealthModal({
      isOpen: false
    });
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: "component-theme-dark",
    contentClassName: _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].root,
    isOpen: isOpen,
    isSlim: true,
    onClose: handleClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
    round: true,
    color: "translucent",
    size: "smaller",
    className: _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].closeButton,
    ariaLabel: lang('Close'),
    onClick: handleClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].stealthIcon
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
    name: "eye-closed-outline"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].title
  }, lang('StealthMode')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].description
  }, lang(isCurrentUserPremium ? 'StealthModeHint' : 'StealthModePremiumHint')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].listItem, 'smaller-icon'),
    multiline: true,
    inactive: true,
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
      name: "stealth-past",
      className: _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].icon
    })
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('HideRecentViews')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('subtitle', _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].subtitle)
  }, lang('HideRecentViewsDescription'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].listItem, 'smaller-icon'),
    multiline: true,
    inactive: true,
    leftElement: /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
      name: "stealth-future",
      className: _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].icon,
      "aria-hidden": true
    })
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: "title"
  }, lang('HideNextViews')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])('subtitle', _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].subtitle)
  }, lang('HideNextViewsDescription'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_8__["default"], {
    className: _StealthModeModal_module_scss__WEBPACK_IMPORTED_MODULE_12__["default"].button,
    size: "smaller",
    disabled: isOnCooldown,
    isShiny: !isCurrentUserPremium,
    withPremiumGradient: !isCurrentUserPremium,
    onClick: handleActivate
  }, !isCurrentUserPremium ? lang('UnlockStealthMode') : isOnCooldown ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_TextTimer__WEBPACK_IMPORTED_MODULE_11__["default"], {
    langKey: "AvailableIn",
    endsAt: stealthMode.cooldownUntil,
    onEnd: handleTimerEnds
  }) : lang('EnableStealthMode')));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const tabState = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectTabState)(global);
  return {
    isOpen: tabState.storyViewer?.isStealthModalOpen,
    stealthMode: global.stories.stealthMode,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_2__.selectIsCurrentUserPremium)(global)
  };
})(StealthModeModal)));

/***/ }),

/***/ "./src/components/story/Story.tsx":
/*!****************************************!*\
  !*** ./src/components/story/Story.tsx ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_captureKeyboardListeners__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../util/captureKeyboardListeners */ "./src/util/captureKeyboardListeners.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _util_download__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../util/download */ "./src/util/download.ts");
/* harmony import */ var _util_math__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../util/math */ "./src/util/math.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _helpers_dimensions__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./helpers/dimensions */ "./src/components/story/helpers/dimensions.ts");
/* harmony import */ var _helpers_videoFormats__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./helpers/videoFormats */ "./src/components/story/helpers/videoFormats.ts");
/* harmony import */ var _hooks_media_useUnsupportedMedia__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../hooks/media/useUnsupportedMedia */ "./src/hooks/media/useUnsupportedMedia.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useCanvasBlur__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../hooks/useCanvasBlur */ "./src/hooks/useCanvasBlur.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../hooks/useEffectWithPrevDeps */ "./src/hooks/useEffectWithPrevDeps.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useLongPress__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../hooks/useLongPress */ "./src/hooks/useLongPress.ts");
/* harmony import */ var _hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../hooks/useMediaTransitionDeprecated */ "./src/hooks/useMediaTransitionDeprecated.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _hooks_useStreaming__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../../hooks/useStreaming */ "./src/hooks/useStreaming.ts");
/* harmony import */ var _hooks_window_useBackgroundMode__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../../hooks/window/useBackgroundMode */ "./src/hooks/window/useBackgroundMode.ts");
/* harmony import */ var _hooks_useStoryPreloader__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./hooks/useStoryPreloader */ "./src/components/story/hooks/useStoryPreloader.ts");
/* harmony import */ var _hooks_useStoryProps__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./hooks/useStoryProps */ "./src/components/story/hooks/useStoryProps.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _common_Composer__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../common/Composer */ "./src/components/common/Composer.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../ui/DropdownMenu */ "./src/components/ui/DropdownMenu.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_OptimizedVideo__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../ui/OptimizedVideo */ "./src/components/ui/OptimizedVideo.tsx");
/* harmony import */ var _ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../ui/placeholder/Skeleton */ "./src/components/ui/placeholder/Skeleton.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _mediaArea_MediaAreaOverlay__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./mediaArea/MediaAreaOverlay */ "./src/components/story/mediaArea/MediaAreaOverlay.tsx");
/* harmony import */ var _StoryCaption__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./StoryCaption */ "./src/components/story/StoryCaption.tsx");
/* harmony import */ var _StoryFooter__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./StoryFooter */ "./src/components/story/StoryFooter.tsx");
/* harmony import */ var _StoryProgress__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./StoryProgress */ "./src/components/story/StoryProgress.tsx");
/* harmony import */ var _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./StoryViewer.module.scss */ "./src/components/story/StoryViewer.module.scss");













































const VIDEO_MIN_READY_STATE = _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_12__.IS_SAFARI ? 4 : 3;
const SPACEBAR_CODE = 32;
const STEALTH_MODE_NOTIFICATION_DURATION = 4000;
function Story({
  peerId,
  storyId,
  peer,
  forwardSender,
  fromPeer,
  isMuted,
  isArchivedStories,
  isPrivateStories,
  story,
  orderedIds,
  isSingleStory,
  dimensions,
  shouldForcePause,
  storyChangelogUserId,
  viewersExpirePeriod,
  isChatExist,
  areChatSettingsLoaded,
  getIsAnimating,
  isCurrentUserPremium,
  stealthMode,
  withHeaderAnimation,
  onDelete,
  onClose,
  onReport
}) {
  const {
    viewStory,
    setStoryViewerMuted,
    openPreviousStory,
    openNextStory,
    loadPeerSkippedStories,
    openForwardMenu,
    copyStoryLink,
    toggleStoryInProfile,
    openChat,
    showNotification,
    openStoryPrivacyEditor,
    loadChatSettings,
    fetchChat,
    loadStoryViews,
    toggleStealthModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const serverTime = (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_11__.getServerTime)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_25__["default"])();
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_17__["default"])();
  const [isComposerHasFocus, markComposerHasFocus, unmarkComposerHasFocus] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_21__["default"])(false);
  const [isStoryPlaybackRequested, playStory, pauseStory] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_21__["default"])(false);
  const [isStoryPlaying, markStoryPlaying, unmarkStoryPlaying] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_21__["default"])(false);
  const [isAppFocused, markAppFocused, unmarkAppFocused] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_21__["default"])(true);
  const [isCaptionExpanded, expandCaption, foldCaption] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_21__["default"])(false);
  const [isPausedBySpacebar, setIsPausedBySpacebar] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isPausedByLongPress, markIsPausedByLongPress, unmarkIsPausedByLongPress] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_21__["default"])(false);
  const [isDropdownMenuOpen, markDropdownMenuOpen, unmarkDropdownMenuOpen] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_21__["default"])(false);
  // eslint-disable-next-line no-null/no-null
  const videoRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const {
    isDeletedStory,
    hasText,
    hasForwardInfo,
    thumbnail,
    previewBlobUrl,
    isVideo,
    noSound,
    fullMediaData,
    altMediaHash,
    altMediaData,
    hasFullData,
    hasThumb,
    canDownload,
    downloadMediaData
  } = (0,_hooks_useStoryProps__WEBPACK_IMPORTED_MODULE_30__["default"])(story, isCurrentUserPremium, isDropdownMenuOpen);
  const isLoadedStory = story && 'content' in story;
  const isChangelog = peerId === storyChangelogUserId;
  const isUserStory = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isUserId)(peerId);
  const isChatStory = !isUserStory;
  const isChannelStory = isChatStory && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isChatChannel)(peer);
  const isOut = isLoadedStory && story.isOut;
  const canPinToProfile = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_19__["default"])(isOut ? !story.isInProfile : undefined, true);
  const canUnpinFromProfile = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_19__["default"])(isOut ? story.isInProfile : undefined, true);
  const areViewsExpired = Boolean(isOut && story.date + viewersExpirePeriod < (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_11__.getServerTime)());
  const forwardSenderTitle = forwardSender ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getPeerTitle)(lang, forwardSender) : isLoadedStory && story.forwardInfo?.fromName;
  const canCopyLink = Boolean(isLoadedStory && story.isPublic && !isChangelog && peer?.usernames?.length);
  const canShare = Boolean(isLoadedStory && story.isPublic && !story.noForwards && !isChangelog && !isCaptionExpanded);
  const canPlayStory = Boolean(hasFullData && !shouldForcePause && isAppFocused && !isComposerHasFocus && !isCaptionExpanded && !isPausedBySpacebar && !isPausedByLongPress);
  const duration = isLoadedStory && story.content.video?.duration ? story.content.video.duration : undefined;
  const shouldShowComposer = !(isOut && isUserStory) && !isChangelog && !isChannelStory;
  const shouldShowFooter = isLoadedStory && !shouldShowComposer && (isOut || isChannelStory);
  const headerAnimation = isMobile && withHeaderAnimation ? 'slideFade' : 'none';
  const {
    shouldRender: shouldRenderSkeleton,
    transitionClassNames: skeletonTransitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_26__["default"])(!hasFullData);
  const {
    transitionClassNames: mediaTransitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_26__["default"])(Boolean(fullMediaData));
  const thumbRef = (0,_hooks_useCanvasBlur__WEBPACK_IMPORTED_MODULE_18__["default"])(thumbnail, !hasThumb);
  const previewTransitionClassNames = (0,_hooks_useMediaTransitionDeprecated__WEBPACK_IMPORTED_MODULE_24__["default"])(previewBlobUrl);
  const {
    shouldRender: shouldRenderComposer,
    transitionClassNames: composerAppearanceAnimationClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_26__["default"])(shouldShowComposer);
  const {
    shouldRender: shouldRenderCaptionBackdrop,
    transitionClassNames: captionBackdropTransitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_26__["default"])(hasText && isCaptionExpanded);
  const {
    transitionClassNames: appearanceAnimationClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_26__["default"])(true);
  const {
    shouldRender: shouldRenderCaption,
    transitionClassNames: captionAppearanceAnimationClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_26__["default"])(hasText || hasForwardInfo);
  const isStreamingSupported = (0,_hooks_useStreaming__WEBPACK_IMPORTED_MODULE_27__.useStreaming)(videoRef, fullMediaData, _helpers_videoFormats__WEBPACK_IMPORTED_MODULE_15__.PRIMARY_VIDEO_MIME);
  (0,_hooks_useStoryPreloader__WEBPACK_IMPORTED_MODULE_29__["default"])(peerId, storyId);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (storyId) {
      viewStory({
        peerId,
        storyId
      });
    }
  }, [storyId, peerId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    loadPeerSkippedStories({
      peerId
    });
  }, [peerId]);

  // Fetching user privacy settings for use in Composer
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const canWrite = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.isUserId)(peerId);
    if (!isChatExist && canWrite) {
      fetchChat({
        chatId: peerId
      });
    }
  }, [isChatExist, peerId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isChatExist && !areChatSettingsLoaded) {
      loadChatSettings({
        chatId: peerId
      });
    }
  }, [areChatSettingsLoaded, isChatExist, peerId]);
  const handlePauseStory = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    if (isVideo) {
      videoRef.current?.pause();
    }
    unmarkStoryPlaying();
    pauseStory();
  });
  const handlePlayStory = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    if (!canPlayStory) return;
    playStory();
    if (!isVideo) markStoryPlaying();
  });
  const handleLongPressStart = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    markIsPausedByLongPress();
  });
  const handleLongPressEnd = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    unmarkIsPausedByLongPress();
  });
  const handleDropdownMenuOpen = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    markDropdownMenuOpen();
    handlePauseStory();
  });
  const handleDropdownMenuClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    unmarkDropdownMenuOpen();
    handlePlayStory();
  });
  const {
    onMouseDown: handleLongPressMouseDown,
    onMouseUp: handleLongPressMouseUp,
    onMouseLeave: handleLongPressMouseLeave,
    onTouchStart: handleLongPressTouchStart,
    onTouchEnd: handleLongPressTouchEnd
  } = (0,_hooks_useLongPress__WEBPACK_IMPORTED_MODULE_23__["default"])({
    onStart: handleLongPressStart,
    onEnd: handleLongPressEnd
  });
  const isUnsupported = (0,_hooks_media_useUnsupportedMedia__WEBPACK_IMPORTED_MODULE_16__["default"])(videoRef, undefined, !isVideo || !fullMediaData || isStreamingSupported);
  const hasAllData = fullMediaData && (!altMediaHash || altMediaData);
  // Play story after media has been downloaded
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (hasAllData && !isUnsupported) handlePlayStory();
  }, [hasAllData, isUnsupported]);
  (0,_hooks_window_useBackgroundMode__WEBPACK_IMPORTED_MODULE_28__["default"])(unmarkAppFocused, markAppFocused);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!hasAllData) return;
    videoRef.current?.load();
  }, [hasAllData]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isLoadedStory || isDeletedStory || areViewsExpired) return;
    if (!isOut && !isChannelStory) return;

    // Refresh counters each time
    loadStoryViews({
      peerId,
      storyId
    });
  }, [isDeletedStory, areViewsExpired, isLoadedStory, peerId, storyId, isOut, isChannelStory]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (shouldForcePause || !isAppFocused || isComposerHasFocus || isCaptionExpanded || isPausedBySpacebar || isPausedByLongPress) {
      handlePauseStory();
    } else {
      handlePlayStory();
    }
  }, [handlePlayStory, isAppFocused, isCaptionExpanded, isComposerHasFocus, shouldForcePause, isPausedBySpacebar, isPausedByLongPress]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isComposerHasFocus || shouldForcePause || isCaptionExpanded) {
      return undefined;
    }
    function handleKeyDown(e) {
      if (e.keyCode === SPACEBAR_CODE) {
        e.preventDefault();
        setIsPausedBySpacebar(!isPausedBySpacebar);
      }
    }
    document.addEventListener('keydown', handleKeyDown);
    return () => {
      document.removeEventListener('keydown', handleKeyDown);
    };
  }, [isCaptionExpanded, isComposerHasFocus, isPausedBySpacebar, shouldForcePause]);

  // Reset the state of `isPausedBySpacebar` when closing the caption, losing focus by composer or disable forced pause
  (0,_hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_20__["default"])(([prevIsComposerHasFocus, prevIsCaptionExpanded, prevShouldForcePause, prevIsAppFocused, prevIsPausedByLongPress]) => {
    if (!isPausedBySpacebar || isCaptionExpanded || isComposerHasFocus || shouldForcePause || !isAppFocused || isPausedByLongPress) {
      return;
    }
    if (prevIsCaptionExpanded !== isCaptionExpanded || prevIsComposerHasFocus !== isComposerHasFocus || prevShouldForcePause !== shouldForcePause || prevIsAppFocused !== isAppFocused || prevIsPausedByLongPress !== isPausedByLongPress) {
      setIsPausedBySpacebar(false);
    }
  }, [isComposerHasFocus, isCaptionExpanded, shouldForcePause, isAppFocused, isPausedByLongPress, isPausedBySpacebar]);
  const handleOpenChat = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    onClose();
    openChat({
      id: peerId
    });
  });
  const handleForwardPeerClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    onClose();
    openChat({
      id: forwardSender.id
    });
  });
  const handleFromPeerClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    onClose();
    openChat({
      id: fromPeer.id
    });
  });
  const handleOpenPrevStory = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    openPreviousStory();
  });
  const handleOpenNextStory = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    openNextStory();
  });
  const handleVideoStoryTimeUpdate = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(e => {
    const video = e.currentTarget;
    if (video.readyState >= VIDEO_MIN_READY_STATE) {
      markStoryPlaying();
    } else {
      unmarkStoryPlaying();
    }
    if (duration && (0,_util_math__WEBPACK_IMPORTED_MODULE_10__.round)(video.currentTime, 2) >= (0,_util_math__WEBPACK_IMPORTED_MODULE_10__.round)(duration, 2)) {
      handleOpenNextStory();
    }
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    return !getIsAnimating() && !isComposerHasFocus ? (0,_util_captureKeyboardListeners__WEBPACK_IMPORTED_MODULE_7__["default"])({
      onRight: handleOpenNextStory,
      onLeft: handleOpenPrevStory
    }) : undefined;
  }, [getIsAnimating, isComposerHasFocus]);
  const handleCopyStoryLink = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    copyStoryLink({
      peerId,
      storyId
    });
  });
  const handlePinClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    toggleStoryInProfile({
      peerId,
      storyId,
      isInProfile: true
    });
  });
  const handleUnpinClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    toggleStoryInProfile({
      peerId,
      storyId,
      isInProfile: false
    });
  });
  const handleDeleteStoryClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    onDelete(story);
  });
  const handleReportStoryClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    onReport();
  });
  const handleForwardClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    openForwardMenu({
      fromChatId: peerId,
      storyId
    });
  });
  const handleInfoPrivacyEdit = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    openStoryPrivacyEditor();
  });
  const handleInfoPrivacyClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    const visibility = !isLoadedStory || story.isPublic ? undefined : story.isForContacts ? 'contacts' : story.isForCloseFriends ? 'closeFriends' : 'nobody';
    let message;
    const myName = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getPeerTitle)(lang, peer);
    switch (visibility) {
      case 'nobody':
        message = lang('StorySelectedContactsHint', myName);
        break;
      case 'contacts':
        message = lang('StoryContactsHint', myName);
        break;
      case 'closeFriends':
        message = lang('StoryCloseFriendsHint', myName);
        break;
      default:
        return;
    }
    showNotification({
      message
    });
  });
  const handleVolumeMuted = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    if (noSound) {
      showNotification({
        message: lang('Story.TooltipVideoHasNoSound')
      });
      return;
    }
    // Browser requires explicit user interaction to keep video playing after unmuting
    videoRef.current.muted = !videoRef.current.muted;
    setStoryViewerMuted({
      isMuted: !isMuted
    });
  });
  const handleOpenStealthModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    if (stealthMode.activeUntil && (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_11__.getServerTime)() < stealthMode.activeUntil) {
      const diff = stealthMode.activeUntil - (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_11__.getServerTime)();
      showNotification({
        title: lang('StealthModeOn'),
        message: lang('Story.ToastStealthModeActiveText', (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_8__.formatMediaDuration)(diff)),
        duration: STEALTH_MODE_NOTIFICATION_DURATION
      });
      return;
    }
    toggleStealthModal({
      isOpen: true
    });
  });
  const handleDownload = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_22__["default"])(() => {
    if (!downloadMediaData) return;
    (0,_util_download__WEBPACK_IMPORTED_MODULE_9__["default"])(downloadMediaData, `story-${peerId}-${storyId}.${isVideo ? 'mp4' : 'jpg'}`);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isDeletedStory) return;
    showNotification({
      message: lang('StoryNotFound')
    });
  }, [lang, isDeletedStory]);
  const MenuButton = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return ({
      onTrigger,
      isOpen
    }) => {
      return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_34__["default"], {
        round: true,
        ripple: !isMobile,
        size: "tiny",
        color: "translucent-white",
        onClick: onTrigger,
        className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].button, isOpen && 'active'),
        ariaLabel: lang('AccDescrOpenMenu2')
      }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_33__["default"], {
        name: "more"
      }));
    };
  }, [isMobile, lang]);
  function renderStoriesTabs() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].storyIndicators
    }, (isSingleStory ? [storyId] : orderedIds ?? []).map(id => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StoryProgress__WEBPACK_IMPORTED_MODULE_43__["default"], {
      key: `progress-${id}`,
      isActive: id === story?.id,
      isVideo: isVideo,
      isViewed: Boolean(story?.id && (isPrivateStories || isArchivedStories ? id > story?.id : id < story?.id)),
      isPaused: !isStoryPlaying,
      duration: duration,
      onImageComplete: handleOpenNextStory
    })));
  }
  function renderStoryPrivacyButton() {
    if (!isUserStory) return undefined;
    let privacyIcon = 'channel-filled';
    const gradient = {
      'channel-filled': ['#50ABFF', '#007AFF'],
      'user-filled': ['#C36EFF', '#8B60FA'],
      'favorite-filled': ['#88D93A', '#30B73B'],
      'group-filled': ['#FFB743', '#F69A36']
    };
    if (isOut) {
      const {
        visibility
      } = story && 'visibility' in story && story.visibility || {};
      switch (visibility) {
        case 'everybody':
          privacyIcon = 'channel-filled';
          break;
        case 'contacts':
          privacyIcon = 'user-filled';
          break;
        case 'closeFriends':
          privacyIcon = 'favorite-filled';
          break;
        case 'nobody':
          privacyIcon = 'group-filled';
      }
    } else {
      if (!story || !('content' in story) || story.isPublic) {
        return undefined;
      }
      privacyIcon = story.isForCloseFriends ? 'favorite-filled' : story.isForContacts ? 'user-filled' : 'group-filled';
    }
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].visibilityButton, isOut && _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].visibilityButtonSelf),
      onClick: isOut ? handleInfoPrivacyEdit : handleInfoPrivacyClick,
      style: `--color-from: ${gradient[privacyIcon][0]}; --color-to: ${gradient[privacyIcon][1]}`
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_33__["default"], {
      name: privacyIcon
    }), isOut && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_33__["default"], {
      name: "next"
    }));
  }
  function renderSenderInfo() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].senderInfo
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_31__["default"], {
      peer: peer,
      size: "tiny",
      onClick: handleOpenChat
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].senderMeta
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      onClick: handleOpenChat,
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].senderName
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_13__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getPeerTitle)(lang, peer) || '')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].storyMetaRow
    }, forwardSenderTitle && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].storyMeta, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].forwardHeader, forwardSender && _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].clickable),
      onClick: forwardSender ? handleForwardPeerClick : undefined
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_33__["default"], {
      name: "loop"
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].headerTitle
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_13__["default"])(forwardSenderTitle))), fromPeer && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].storyMeta, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].fromPeer),
      onClick: handleFromPeerClick
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_31__["default"], {
      peer: fromPeer,
      size: "micro"
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].headerTitle
    }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_13__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getPeerTitle)(lang, fromPeer) || ''))), story && 'date' in story && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].storyMeta
    }, (0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_8__.formatRelativeTime)(lang, serverTime, story.date)), isLoadedStory && story.isEdited && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].storyMeta
    }, lang('Story.HeaderEdited')))));
  }
  function renderSender() {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].sender
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_39__["default"], {
      activeKey: Number(peerId),
      name: headerAnimation,
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].senderInfoTransition
    }, renderSenderInfo()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].actions
    }, renderStoryPrivacyButton(), isVideo && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_34__["default"], {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].button,
      round: true,
      ripple: !isMobile,
      size: "tiny",
      color: "translucent-white",
      disabled: !hasFullData,
      onClick: handleVolumeMuted,
      ariaLabel: lang('Volume')
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_33__["default"], {
      name: isMuted || noSound ? 'speaker-muted-story' : 'speaker-story'
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_35__["default"], {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].buttonMenu,
      trigger: MenuButton,
      positionX: "right",
      onOpen: handleDropdownMenuOpen,
      onClose: handleDropdownMenuClose
    }, canCopyLink && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_36__["default"], {
      icon: "copy",
      onClick: handleCopyStoryLink
    }, lang('CopyLink')), canPinToProfile && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_36__["default"], {
      icon: "save-story",
      onClick: handlePinClick
    }, lang(isUserStory ? 'StorySave' : 'SaveToPosts')), canUnpinFromProfile && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_36__["default"], {
      icon: "delete",
      onClick: handleUnpinClick
    }, lang(isUserStory ? 'ArchiveStory' : 'RemoveFromPosts')), canDownload && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_36__["default"], {
      icon: "download",
      disabled: !downloadMediaData,
      onClick: handleDownload
    }, lang('lng_media_download')), !isOut && isUserStory && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_36__["default"], {
      icon: "eye-closed-outline",
      onClick: handleOpenStealthModal
    }, lang('StealthMode')), !isOut && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_36__["default"], {
      icon: "flag",
      onClick: handleReportStoryClick
    }, lang('lng_report_story')), isOut && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_36__["default"], {
      icon: "delete",
      destructive: true,
      onClick: handleDeleteStoryClick
    }, lang('Delete'))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_34__["default"], {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].button, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].closeButton),
      round: true,
      size: "tiny",
      color: "translucent-white",
      ariaLabel: lang('Close'),
      onClick: onClose
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_33__["default"], {
      name: "close"
    }))));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].slideInner, 'component-theme-dark'),
    onMouseDown: handleLongPressMouseDown,
    onMouseUp: handleLongPressMouseUp,
    onMouseLeave: handleLongPressMouseLeave,
    onTouchStart: handleLongPressTouchStart,
    onTouchEnd: handleLongPressTouchEnd
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].storyHeader, appearanceAnimationClassNames)
  }, renderStoriesTabs(), renderSender()), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].mediaWrapper,
    style: `width: ${dimensions.width}px; height: ${dimensions.height}px`
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("canvas", {
    ref: thumbRef,
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].thumbnail
  }), previewBlobUrl && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    key: `preview-${storyId}`,
    src: previewBlobUrl,
    draggable: false,
    alt: "",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].media, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].mediaPreview, previewTransitionClassNames)
  }), shouldRenderSkeleton && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_placeholder_Skeleton__WEBPACK_IMPORTED_MODULE_38__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(skeletonTransitionClassNames, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].fullSize)
  }), !isVideo && fullMediaData && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: fullMediaData,
    alt: "",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].media, mediaTransitionClassNames),
    draggable: false
  }), isVideo && fullMediaData && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_OptimizedVideo__WEBPACK_IMPORTED_MODULE_37__["default"], {
    ref: videoRef,
    key: `video-${storyId}`,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].media, mediaTransitionClassNames),
    canPlay: isStoryPlaybackRequested,
    muted: isMuted,
    width: _helpers_dimensions__WEBPACK_IMPORTED_MODULE_14__.BASE_STORY_WIDTH,
    height: _helpers_dimensions__WEBPACK_IMPORTED_MODULE_14__.BASE_STORY_HEIGHT,
    draggable: false,
    playsInline: true,
    disablePictureInPicture: true,
    isPriority: true,
    onPause: unmarkStoryPlaying,
    onWaiting: unmarkStoryPlaying,
    disableRemotePlayback: true,
    onTimeUpdate: handleVideoStoryTimeUpdate
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("source", {
    src: fullMediaData,
    type: _helpers_videoFormats__WEBPACK_IMPORTED_MODULE_15__.PRIMARY_VIDEO_MIME,
    width: "720"
  }), altMediaData && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("source", {
    src: altMediaData,
    type: _helpers_videoFormats__WEBPACK_IMPORTED_MODULE_15__.SECONDARY_VIDEO_MIME,
    width: "480"
  })), !isPausedByLongPress && !isComposerHasFocus && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("button", {
    type: "button",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].navigate, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].prev),
    onClick: handleOpenPrevStory,
    "aria-label": lang('Previous')
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("button", {
    type: "button",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].navigate, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].next),
    onClick: handleOpenNextStory,
    "aria-label": lang('Next')
  })), isLoadedStory && fullMediaData && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_mediaArea_MediaAreaOverlay__WEBPACK_IMPORTED_MODULE_40__["default"], {
    key: `area-overlay-${storyId}-${peerId}`,
    story: story,
    isActive: true,
    isStoryPlaying: isDropdownMenuOpen
  }), !isMobile && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].content
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].contentInner
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_31__["default"], {
    peer: peer,
    withStory: true,
    storyViewerMode: "disabled"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].name
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_13__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getPeerTitle)(lang, peer) || ''))))), shouldShowFooter && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StoryFooter__WEBPACK_IMPORTED_MODULE_42__["default"], {
    story: story,
    className: appearanceAnimationClassNames
  }), shouldRenderCaptionBackdrop && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    tabIndex: 0,
    role: "button",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].captionBackdrop, captionBackdropTransitionClassNames),
    onClick: () => foldCaption(),
    "aria-label": lang('Close')
  }), hasText && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].captionGradient, captionAppearanceAnimationClassNames)
  }), shouldRenderCaption && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StoryCaption__WEBPACK_IMPORTED_MODULE_41__["default"], {
    key: `caption-${storyId}-${peerId}`,
    story: story,
    isExpanded: isCaptionExpanded,
    onExpand: expandCaption,
    onFold: foldCaption,
    className: captionAppearanceAnimationClassNames
  }), shouldRenderComposer && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Composer__WEBPACK_IMPORTED_MODULE_32__["default"], {
    type: "story",
    chatId: peerId,
    threadId: _api_types__WEBPACK_IMPORTED_MODULE_2__.MAIN_THREAD_ID,
    storyId: storyId,
    isReady: !isOut,
    messageListType: "thread",
    isMobile: (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_17__.getIsMobile)(),
    editableInputCssSelector: _config__WEBPACK_IMPORTED_MODULE_3__.EDITABLE_STORY_INPUT_CSS_SELECTOR,
    editableInputId: _config__WEBPACK_IMPORTED_MODULE_3__.EDITABLE_STORY_INPUT_ID,
    inputId: "story-input-text",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_44__["default"].composer, composerAppearanceAnimationClassNames),
    inputPlaceholder: lang(isChatStory ? 'ReplyToGroupStory' : 'ReplyPrivately'),
    onForward: canShare ? handleForwardClick : undefined,
    onFocus: markComposerHasFocus,
    onBlur: unmarkComposerHasFocus
  }));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  peerId,
  storyId,
  isDeleteModalOpen
}) => {
  const {
    appConfig
  } = global;
  const user = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectUser)(global, peerId);
  const chat = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectChat)(global, peerId);
  const tabState = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global);
  const {
    storyViewer: {
      isMuted,
      viewModal,
      isPrivacyModalOpen,
      isStealthModalOpen,
      storyList
    },
    forwardMessages: {
      storyId: forwardedStoryId
    },
    premiumModal,
    safeLinkModalUrl,
    mapModal,
    reportModal,
    giftInfoModal
  } = tabState;
  const {
    isOpen: isPremiumModalOpen
  } = premiumModal || {};
  const story = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectPeerStory)(global, peerId, storyId);
  const isLoadedStory = story && 'content' in story;
  const shouldForcePause = Boolean(viewModal || forwardedStoryId || tabState.reactionPicker?.storyId || reportModal || isPrivacyModalOpen || isPremiumModalOpen || isDeleteModalOpen || safeLinkModalUrl || isStealthModalOpen || mapModal || giftInfoModal);
  const forwardInfo = isLoadedStory ? story.forwardInfo : undefined;
  const mediaAreas = isLoadedStory ? story.mediaAreas : undefined;
  const forwardSenderId = forwardInfo?.fromPeerId || mediaAreas?.find(area => area.type === 'channelPost')?.channelId;
  const forwardSender = forwardSenderId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectPeer)(global, forwardSenderId) : undefined;
  const withHeaderAnimation = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectPerformanceSettingsValue)(global, 'mediaViewerAnimations');
  const fromPeer = isLoadedStory && story.fromId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectPeer)(global, story.fromId) : undefined;
  return {
    peer: user || chat,
    forwardSender,
    fromPeer,
    story,
    orderedIds: storyList?.storyIdsByPeerId[peerId],
    isMuted,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsCurrentUserPremium)(global),
    shouldForcePause,
    storyChangelogUserId: appConfig.storyChangelogUserId,
    viewersExpirePeriod: appConfig.storyExpirePeriod + appConfig.storyViewersExpirePeriod,
    isChatExist: Boolean(chat),
    areChatSettingsLoaded: Boolean(chat?.settings),
    stealthMode: global.stories.stealthMode,
    withHeaderAnimation
  };
})(Story)));

/***/ }),

/***/ "./src/components/story/StoryCaption.tsx":
/*!***********************************************!*\
  !*** ./src/components/story/StoryCaption.tsx ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _lib_teact_teact_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/teact/teact-dom */ "./src/lib/teact/teact-dom.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_element_calcTextLineHeightAndCount__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/element/calcTextLineHeightAndCount */ "./src/util/element/calcTextLineHeightAndCount.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePrevDuringAnimation__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/usePrevDuringAnimation */ "./src/hooks/usePrevDuringAnimation.ts");
/* harmony import */ var _hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useShowTransitionDeprecated */ "./src/hooks/useShowTransitionDeprecated.ts");
/* harmony import */ var _common_embedded_EmbeddedStoryForward__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common/embedded/EmbeddedStoryForward */ "./src/components/common/embedded/EmbeddedStoryForward.tsx");
/* harmony import */ var _common_MessageText__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/MessageText */ "./src/components/common/MessageText.tsx");
/* harmony import */ var _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./StoryViewer.module.scss */ "./src/components/story/StoryViewer.module.scss");












const EXPAND_ANIMATION_DURATION_MS = 400;
const LINES_TO_SHOW = 3;
function StoryCaption({
  story,
  isExpanded,
  className,
  onExpand,
  onFold
}) {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  // eslint-disable-next-line no-null/no-null
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const contentRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const textRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  // eslint-disable-next-line no-null/no-null
  const showMoreButtonRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const renderingStory = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_5__["default"])(story, true);
  const caption = renderingStory?.content.text;
  const [hasOverflow, setHasOverflow] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const prevIsExpanded = (0,_hooks_usePrevDuringAnimation__WEBPACK_IMPORTED_MODULE_7__["default"])(isExpanded || undefined, EXPAND_ANIMATION_DURATION_MS);
  const isInExpandedState = isExpanded || prevIsExpanded;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
      if (!contentRef.current) {
        return;
      }
      if (isExpanded) {
        (0,_lib_teact_teact_dom__WEBPACK_IMPORTED_MODULE_1__.addExtraClass)(contentRef.current, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].animate);
      } else {
        (0,_lib_teact_teact_dom__WEBPACK_IMPORTED_MODULE_1__.removeExtraClass)(contentRef.current, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].animate);
      }
    });
  }, [isExpanded]);
  const canExpand = hasOverflow && !isInExpandedState;
  const {
    shouldRender: shouldRenderShowMore,
    transitionClassNames
  } = (0,_hooks_useShowTransitionDeprecated__WEBPACK_IMPORTED_MODULE_8__["default"])(canExpand, undefined, true, 'slow', true);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMeasure)(() => {
      if (!showMoreButtonRef.current) {
        return;
      }
      const button = showMoreButtonRef.current;
      const {
        offsetWidth
      } = button;
      (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestMutation)(() => {
        button.style.setProperty('--expand-button-width', `${offsetWidth}px`);
      });
    });
  }, []);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_2__.requestForcedReflow)(() => {
      if (!contentRef.current || !textRef.current) {
        return undefined;
      }
      const container = contentRef.current;
      const textContainer = textRef.current;
      const textOffsetTop = textContainer.offsetTop;
      const {
        lineHeight,
        totalLines
      } = (0,_util_element_calcTextLineHeightAndCount__WEBPACK_IMPORTED_MODULE_4__["default"])(textContainer);
      const isOverflowing = totalLines > LINES_TO_SHOW;
      const overflowShift = textOffsetTop + lineHeight * LINES_TO_SHOW;
      return () => {
        if (isOverflowing) {
          (0,_lib_teact_teact_dom__WEBPACK_IMPORTED_MODULE_1__.addExtraClass)(container, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].hasOverflow);
          setHasOverflow(true);
        }
        container.style.setProperty('--_overflow-shift', `${overflowShift}px`);
      };
    });
  }, [caption]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isExpanded) {
      ref.current?.scrollTo({
        top: 0
      });
    }
  }, [isExpanded]);
  const fullClassName = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].captionContent, isInExpandedState && _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].expanded, shouldRenderShowMore && _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].withShowMore);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].caption, className)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: contentRef,
    className: fullClassName,
    role: canExpand ? 'button' : undefined,
    onClick: canExpand ? onExpand : onFold
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: ref,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].captionInner, 'allow-selection', 'custom-scroll')
  }, renderingStory?.forwardInfo && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_embedded_EmbeddedStoryForward__WEBPACK_IMPORTED_MODULE_9__["default"], {
    forwardInfo: renderingStory.forwardInfo,
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].forwardInfo
  }), renderingStory && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: textRef,
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].captionText
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_MessageText__WEBPACK_IMPORTED_MODULE_10__["default"], {
    messageOrStory: renderingStory,
    withTranslucentThumbs: true,
    forcePlayback: true
  })))), shouldRenderShowMore && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    ref: showMoreButtonRef,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].captionShowMore, transitionClassNames),
    onClick: onExpand
  }, lang('Story.CaptionShowMore')));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StoryCaption));

/***/ }),

/***/ "./src/components/story/StoryDeleteConfirmModal.tsx":
/*!**********************************************************!*\
  !*** ./src/components/story/StoryDeleteConfirmModal.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui/ConfirmDialog */ "./src/components/ui/ConfirmDialog.tsx");




function StoryDeleteConfirmModal({
  isOpen,
  story,
  onClose
}) {
  const {
    deleteStory,
    openNextStory
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const handleDeleteStoryClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!story) {
      return;
    }
    openNextStory();
    deleteStory({
      peerId: story.peerId,
      storyId: story.id
    });
    onClose();
  }, [onClose, story]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ConfirmDialog__WEBPACK_IMPORTED_MODULE_3__["default"], {
    isOpen: isOpen,
    onClose: onClose,
    title: lang('DeleteStoryTitle'),
    text: lang('DeleteStorySubtitle'),
    confirmLabel: lang('Delete'),
    confirmHandler: handleDeleteStoryClick,
    confirmIsDestructive: true,
    className: "component-theme-dark"
  });
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StoryDeleteConfirmModal));

/***/ }),

/***/ "./src/components/story/StoryFooter.tsx":
/*!**********************************************!*\
  !*** ./src/components/story/StoryFooter.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_AvatarList__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/AvatarList */ "./src/components/common/AvatarList.tsx");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_reactions_ReactionAnimatedEmoji__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common/reactions/ReactionAnimatedEmoji */ "./src/components/common/reactions/ReactionAnimatedEmoji.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./StoryFooter.module.scss */ "./src/components/story/StoryFooter.module.scss");












const StoryFooter = ({
  story,
  className
}) => {
  const {
    openStoryViewModal,
    openForwardMenu,
    sendStoryReaction
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const {
    views,
    isOut,
    peerId,
    id: storyId,
    sentReaction
  } = story;
  const {
    viewsCount,
    forwardsCount,
    reactionsCount
  } = views || {};
  const isChannel = !(0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isUserId)(peerId);
  const isSentStoryReactionHeart = sentReaction && (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.isSameReaction)(sentReaction, _config__WEBPACK_IMPORTED_MODULE_2__.HEART_REACTION);
  const canForward = Boolean((isOut || isChannel) && story.isPublic && !story.noForwards);
  const containerId = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getStoryKey)(peerId, storyId);
  const recentViewers = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const {
      users: {
        byId: usersById
      }
    } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)();
    const recentViewerIds = views && 'recentViewerIds' in views ? views.recentViewerIds : undefined;
    if (!recentViewerIds) return undefined;
    return recentViewerIds.map(id => usersById[id]).filter(Boolean);
  }, [views]);
  const handleOpenStoryViewModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    openStoryViewModal({
      storyId
    });
  });
  const handleForwardClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    openForwardMenu({
      fromChatId: peerId,
      storyId
    });
  });
  const handleLikeStory = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    const reaction = sentReaction ? undefined : _config__WEBPACK_IMPORTED_MODULE_2__.HEART_REACTION;
    sendStoryReaction({
      peerId,
      storyId,
      containerId,
      reaction
    });
  });
  if (!viewsCount) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].root, className)
    }, lang('NobodyViewed'));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].root, className)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].viewInfo, !isChannel && _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].interactive),
    onClick: !isChannel ? handleOpenStoryViewModal : undefined
  }, Boolean(recentViewers?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_AvatarList__WEBPACK_IMPORTED_MODULE_7__["default"], {
    size: "small",
    peers: recentViewers,
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].avatars
  }), isChannel ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].views
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "channelviews",
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].viewIcon
  }), viewsCount) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].views
  }, lang('Views', viewsCount, 'i')), Boolean(reactionsCount) && !isChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].reactionCount
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "heart",
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].reactionCountHeart
  }), reactionsCount)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].spacer
  }), canForward && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    color: "translucent",
    size: "smaller",
    round: true,
    onClick: handleForwardClick,
    ariaLabel: lang('Forward'),
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].footerItem
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "forward"
  })), isChannel && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, Boolean(forwardsCount) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].footerItem
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    round: true,
    color: "translucent",
    size: "smaller",
    nonInteractive: true,
    ariaLabel: lang('PublicShares')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "loop"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, forwardsCount)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].footerItem
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_10__["default"], {
    round: true,
    className: _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].reactionButton,
    color: "translucent",
    size: "smaller",
    onClick: handleLikeStory,
    ariaLabel: lang('AccDescrLike')
  }, sentReaction && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_reactions_ReactionAnimatedEmoji__WEBPACK_IMPORTED_MODULE_9__["default"], {
    key: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_3__.getReactionKey)(sentReaction),
    containerId: containerId,
    reaction: sentReaction,
    withEffectOnly: isSentStoryReactionHeart
  }), (!sentReaction || isSentStoryReactionHeart) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: isSentStoryReactionHeart ? 'heart' : 'heart-outline',
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(isSentStoryReactionHeart && _StoryFooter_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].reactionHeart)
  })), Boolean(reactionsCount) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, reactionsCount))));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StoryFooter));

/***/ }),

/***/ "./src/components/story/StoryPreview.tsx":
/*!***********************************************!*\
  !*** ./src/components/story/StoryPreview.tsx ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../hooks/useMedia */ "./src/hooks/useMedia.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_Avatar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Avatar */ "./src/components/common/Avatar.tsx");
/* harmony import */ var _mediaArea_MediaAreaOverlay__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./mediaArea/MediaAreaOverlay */ "./src/components/story/mediaArea/MediaAreaOverlay.tsx");
/* harmony import */ var _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./StoryViewer.module.scss */ "./src/components/story/StoryViewer.module.scss");










function StoryPreview({
  peer,
  peerStories,
  lastViewedId,
  storyIdsForViewer,
  origin
}) {
  const {
    openStoryViewer,
    loadPeerSkippedStories
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_6__["default"])();
  const story = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!peerStories) {
      return undefined;
    }
    const {
      orderedIds,
      lastReadId,
      byId
    } = peerStories;
    const hasUnreadStories = orderedIds[orderedIds.length - 1] !== lastReadId;
    const previewIndexId = lastViewedId && storyIdsForViewer?.includes(lastViewedId) ? lastViewedId ?? (hasUnreadStories ? lastReadId ?? -1 : -1) : -1;
    const resultId = byId[previewIndexId]?.id || storyIdsForViewer?.[0] || orderedIds[0];
    return byId[resultId];
  }, [lastViewedId, peerStories, storyIdsForViewer]);
  const isLoaded = story && 'content' in story;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (story && !isLoaded) {
      loadPeerSkippedStories({
        peerId: story.peerId
      });
    }
  }, [story, isLoaded]);
  const video = isLoaded ? story.content.video : undefined;
  const imageHash = isLoaded ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getStoryMediaHash)(story) : undefined;
  const imgBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_5__["default"])(imageHash);
  const thumbUrl = imgBlobUrl || video?.thumbnail?.dataUri;
  if (!peer || !story || 'isDeleted' in story) {
    return undefined;
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].slideInner,
    onClick: () => {
      openStoryViewer({
        peerId: story.peerId,
        storyId: story.id,
        origin
      });
    }
  }, thumbUrl && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("img", {
    src: thumbUrl,
    alt: "",
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].media,
    draggable: false
  }), isLoaded && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_mediaArea_MediaAreaOverlay__WEBPACK_IMPORTED_MODULE_8__["default"], {
    story: story
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].content
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].contentInner
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_Avatar__WEBPACK_IMPORTED_MODULE_7__["default"], {
    peer: peer,
    withStory: true,
    storyViewerMode: "disabled"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_9__["default"].name
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_4__["default"])((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getPeerTitle)(lang, peer) || '')))));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  peer
}) => {
  const {
    storyViewer: {
      lastViewedByPeerIds,
      origin,
      storyList
    }
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global);
  return {
    lastViewedId: peer?.id ? lastViewedByPeerIds?.[peer.id] : undefined,
    origin,
    storyIdsForViewer: peer?.id ? storyList?.storyIdsByPeerId[peer.id] : undefined
  };
})(StoryPreview)));

/***/ }),

/***/ "./src/components/story/StoryProgress.tsx":
/*!************************************************!*\
  !*** ./src/components/story/StoryProgress.tsx ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _StoryProgress_module_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./StoryProgress.module.scss */ "./src/components/story/StoryProgress.module.scss");




const DEFAULT_STORY_DURATION_S = 6;
function StoryProgress({
  isActive,
  isViewed,
  isVideo,
  duration = DEFAULT_STORY_DURATION_S,
  isPaused,
  onImageComplete
}) {
  const handleAnimationEnd = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_2__["default"])(event => {
    if (!isVideo && event.animationName === _StoryProgress_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].progress) {
      onImageComplete();
    }
  });
  const classNames = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_1__["default"])(_StoryProgress_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].root, isViewed && _StoryProgress_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].viewed, isActive && _StoryProgress_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].active, isPaused && _StoryProgress_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].paused);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
    className: classNames,
    "aria-hidden": true
  }, isActive && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("i", {
    style: `--progress-duration: ${duration}s`,
    className: _StoryProgress_module_scss__WEBPACK_IMPORTED_MODULE_3__["default"].inner,
    onAnimationEnd: handleAnimationEnd
  }));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(StoryProgress));

/***/ }),

/***/ "./src/components/story/StorySettings.tsx":
/*!************************************************!*\
  !*** ./src/components/story/StorySettings.tsx ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_units__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/dates/units */ "./src/util/dates/units.ts");
/* harmony import */ var _util_stopEvent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/stopEvent */ "./src/util/stopEvent.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_Switcher__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/Switcher */ "./src/components/ui/Switcher.tsx");
/* harmony import */ var _ui_Transition__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/Transition */ "./src/components/ui/Transition.tsx");
/* harmony import */ var _privacy_AllowDenyList__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./privacy/AllowDenyList */ "./src/components/story/privacy/AllowDenyList.tsx");
/* harmony import */ var _privacy_CloseFriends__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./privacy/CloseFriends */ "./src/components/story/privacy/CloseFriends.tsx");
/* harmony import */ var _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./StorySettings.module.scss */ "./src/components/story/StorySettings.module.scss");



















const OPTIONS = [{
  name: 'StoryPrivacyOptionEveryone',
  value: 'everybody',
  color: ['#50ABFF', '#007AFF'],
  icon: 'channel-filled',
  actions: 'blockUserIds'
}, {
  name: 'StoryPrivacyOptionContacts',
  value: 'contacts',
  color: ['#C36EFF', '#8B60FA'],
  icon: 'user-filled',
  actions: 'blockContactUserIds'
}, {
  name: 'StoryPrivacyOptionCloseFriends',
  value: 'closeFriends',
  color: ['#88D93A', '#30B73B'],
  icon: 'favorite-filled',
  actions: 'closeFriends'
}, {
  name: 'StoryPrivacyOptionSelectedContacts',
  value: 'nobody',
  color: ['#FFB743', '#F69A36'],
  icon: 'group-filled',
  actions: 'allowUserIds'
}];
var Screens = /*#__PURE__*/function (Screens) {
  Screens[Screens["privacy"] = 0] = "privacy";
  Screens[Screens["allowList"] = 1] = "allowList";
  Screens[Screens["closeFriends"] = 2] = "closeFriends";
  Screens[Screens["denyList"] = 3] = "denyList";
  return Screens;
}(Screens || {});
function StorySettings({
  isOpen,
  story,
  visibility,
  contactListIds,
  usersById,
  currentUserId,
  onClose
}) {
  const {
    editStoryPrivacy,
    toggleStoryInProfile
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [isOpenModal, openModal, closeModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])(false);
  const [privacy, setPrivacy] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(visibility);
  const [isPinned, setIsPinned] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(story?.isInProfile);
  const [activeKey, setActiveKey] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(Screens.privacy);
  const [editingBlockingCategory, setEditingBlockingCategory] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('everybody');
  const isBackButton = activeKey !== Screens.privacy;
  const closeFriendIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return (contactListIds || []).filter(userId => usersById[userId]?.isCloseFriend);
  }, [contactListIds, usersById]);
  const lockedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (activeKey === Screens.allowList && (!privacy?.allowUserIds?.length || privacy.allowUserIds[0] === currentUserId)) {
      return [currentUserId];
    }
    return undefined;
  }, [activeKey, currentUserId, privacy?.allowUserIds]);
  const selectedBlockedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (editingBlockingCategory !== privacy?.visibility) return [];
    return privacy?.blockUserIds || [];
  }, [editingBlockingCategory, privacy?.blockUserIds, privacy?.visibility]);
  const handleAllowUserIdsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(newIds => {
    setPrivacy({
      ...privacy,
      allowUserIds: newIds?.length ? newIds?.filter(id => id !== currentUserId) : [currentUserId]
    });
  });
  const handleDenyUserIdsChange = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(newIds => {
    setPrivacy({
      ...privacy,
      blockUserIds: newIds,
      visibility: editingBlockingCategory
    });
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isOpen) {
      setActiveKey(Screens.privacy);
      openModal();
    }
  }, [isOpen]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    setPrivacy(visibility);
  }, [visibility]);
  const handleCloseButtonClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    if (activeKey === Screens.privacy) {
      closeModal();
      return;
    }
    setActiveKey(Screens.privacy);
  });
  function handleVisibilityChange(newVisibility) {
    setPrivacy({
      ...privacy,
      visibility: newVisibility
    });
  }
  function handleActionClick(e, action) {
    (0,_util_stopEvent__WEBPACK_IMPORTED_MODULE_6__["default"])(e);
    switch (action) {
      case 'closeFriends':
        setActiveKey(Screens.closeFriends);
        break;
      case 'allowUserIds':
        setActiveKey(Screens.allowList);
        break;
      case 'blockUserIds':
        setActiveKey(Screens.denyList);
        setEditingBlockingCategory('everybody');
        break;
      case 'blockContactUserIds':
        setActiveKey(Screens.denyList);
        setEditingBlockingCategory('contacts');
        break;
    }
  }
  const handleIsPinnedToggle = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    setIsPinned(!isPinned);
  });

  // console.warn(privacy?.visibility, story?.visibility, OPTIONS);

  const handleSubmit = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    editStoryPrivacy({
      peerId: story.peerId,
      storyId: story.id,
      privacy: privacy
    });
    if (story.isInProfile !== isPinned) {
      toggleStoryInProfile({
        peerId: story.peerId,
        storyId: story.id,
        isInProfile: isPinned
      });
    }
    closeModal();
  });
  function renderActionName(action) {
    if (action === 'closeFriends') {
      if (closeFriendIds.length === 0) {
        return lang('StoryPrivacyOptionCloseFriendsDetail');
      }
      if (closeFriendIds.length === 1) {
        return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getPeerTitle)(lang, usersById[closeFriendIds[0]]);
      }
      return lang('StoryPrivacyOptionPeople', closeFriendIds.length, 'i');
    }
    if (action === 'blockUserIds' && privacy?.visibility === 'everybody' || action === 'blockContactUserIds' && privacy?.visibility === 'contacts') {
      if (!privacy?.blockUserIds?.length) {
        return lang('StoryPrivacyOptionContactsDetail');
      }
      if (privacy.blockUserIds.length === 1) {
        return lang('StoryPrivacyOptionExcludePerson', (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(usersById[privacy.blockUserIds[0]]));
      }
      return lang('StoryPrivacyOptionExcludePeople', privacy.blockUserIds.length, 'i');
    }
    if (!privacy?.allowUserIds || privacy.allowUserIds.length === 0) {
      return lang('StoryPrivacyOptionSelectedContactsDetail');
    }
    if (privacy.allowUserIds.length === 1) {
      return (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(usersById[privacy.allowUserIds[0]]);
    }
    return lang('StoryPrivacyOptionPeople', privacy.allowUserIds.length, 'i');
  }

  // eslint-disable-next-line consistent-return
  function renderHeaderContent() {
    switch (activeKey) {
      case Screens.privacy:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
          className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].headerTitle
        }, lang('StoryPrivacyAlertEditTitle'));
      case Screens.allowList:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
          className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].headerTitle
        }, lang('StoryPrivacyAlertSelectContactsTitle'));
      case Screens.closeFriends:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
          className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].headerTitle
        }, lang('CloseFriends'));
      case Screens.denyList:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
          className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].headerTitle
        }, lang('StoryPrivacyAlertExcludedContactsTitle'));
    }
  }

  // eslint-disable-next-line consistent-return
  function renderContent(isActive) {
    switch (activeKey) {
      case Screens.privacy:
        return renderPrivacyList();
      case Screens.closeFriends:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_privacy_CloseFriends__WEBPACK_IMPORTED_MODULE_17__["default"], {
          key: "close-friends",
          isActive: isActive,
          contactListIds: contactListIds,
          currentUserId: currentUserId,
          usersById: usersById,
          onClose: handleCloseButtonClick
        });
      case Screens.denyList:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_privacy_AllowDenyList__WEBPACK_IMPORTED_MODULE_16__["default"], {
          key: "deny-list",
          id: "deny-list",
          contactListIds: contactListIds,
          currentUserId: currentUserId,
          usersById: usersById,
          selectedIds: selectedBlockedIds,
          onSelect: handleDenyUserIdsChange
        });
      case Screens.allowList:
        return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_privacy_AllowDenyList__WEBPACK_IMPORTED_MODULE_16__["default"], {
          key: "allow-list",
          id: "allow-list",
          contactListIds: contactListIds,
          lockedIds: lockedIds,
          currentUserId: currentUserId,
          usersById: usersById,
          selectedIds: privacy?.allowUserIds,
          onSelect: handleAllowUserIdsChange
        });
    }
  }
  function renderPrivacyList() {
    const storyLifeTime = story ? (0,_util_dates_units__WEBPACK_IMPORTED_MODULE_5__.getHours)(story.expireDate - story.date) : 0;
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].section
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h3", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].title
    }, lang('StoryPrivacyAlertSubtitleProfile')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].list
    }, OPTIONS.map(option => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("label", {
      key: option.value,
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].option, option.value === privacy?.visibility && _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].checked)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
      type: "radio",
      name: "story_privacy",
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].input,
      value: option.value,
      checked: option.value === privacy?.visibility,
      onChange: () => handleVisibilityChange(option.value),
      teactExperimentControlled: true
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].icon,
      style: `--color-from: ${option.color[0]}; --color-to: ${option.color[1]}`
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__["default"], {
      name: option.icon
    })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].optionContent
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].option_name)
    }, lang(option.name)), option.actions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      tabIndex: 0,
      role: "button",
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].action,
      "aria-label": lang('Edit'),
      onClick: e => {
        handleActionClick(e, option.actions);
      }
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].actionInner
    }, renderActionName(option.actions)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_10__["default"], {
      name: "next"
    }))))))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].section
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
      ripple: true,
      onClick: handleIsPinnedToggle
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("span", null, lang('StoryKeep')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Switcher__WEBPACK_IMPORTED_MODULE_14__["default"], {
      id: "group-notifications",
      label: lang('StoryKeep'),
      checked: isPinned,
      inactive: true
    }))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].footer
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].info
    }, lang('StoryKeepInfo', storyLifeTime)), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].submit
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_11__["default"], {
      onClick: handleSubmit
    }, lang('StoryPrivacyButtonSave')))));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isOpen: isOpenModal,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].modal, 'component-theme-dark'),
    onClose: closeModal,
    noBackdrop: true,
    onCloseAnimationEnd: onClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].header
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_11__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].closeButton, 'close-button'),
    round: true,
    color: "translucent",
    size: "smaller",
    onClick: handleCloseButtonClick,
    ariaLabel: isBackButton ? lang('Common.Back') : lang('Common.Close')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('animated-close-icon', isBackButton && 'state-back')
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_15__["default"], {
    name: "slideFade",
    activeKey: activeKey
  }, renderHeaderContent())), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Transition__WEBPACK_IMPORTED_MODULE_15__["default"], {
    activeKey: activeKey,
    name: "slideFade",
    slideClassName: "ChatOrUserPicker_slide",
    className: _StorySettings_module_scss__WEBPACK_IMPORTED_MODULE_18__["default"].content
  }, renderContent));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    storyViewer: {
      storyId,
      peerId
    }
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global);
  const story = peerId && storyId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectPeerStory)(global, peerId, storyId) : undefined;
  return {
    story: story && 'content' in story ? story : undefined,
    visibility: story && 'visibility' in story ? story.visibility : undefined,
    contactListIds: global.contactList?.userIds,
    usersById: global.users.byId,
    currentUserId: global.currentUserId
  };
})(StorySettings)));

/***/ }),

/***/ "./src/components/story/StorySlides.tsx":
/*!**********************************************!*\
  !*** ./src/components/story/StorySlides.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_buildStyle__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../util/buildStyle */ "./src/util/buildStyle.ts");
/* harmony import */ var _util_captureEvents__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../util/captureEvents */ "./src/util/captureEvents.ts");
/* harmony import */ var _util_focusEditableElement__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../util/focusEditableElement */ "./src/util/focusEditableElement.ts");
/* harmony import */ var _util_math__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../util/math */ "./src/util/math.ts");
/* harmony import */ var _util_scrollLock__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../util/scrollLock */ "./src/util/scrollLock.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _helpers_dimensions__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./helpers/dimensions */ "./src/components/story/helpers/dimensions.ts");
/* harmony import */ var _hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../hooks/useAppLayout */ "./src/hooks/useAppLayout.ts");
/* harmony import */ var _hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../hooks/useCurrentOrPrev */ "./src/hooks/useCurrentOrPrev.ts");
/* harmony import */ var _hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../hooks/useHistoryBack */ "./src/hooks/useHistoryBack.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../hooks/window/useWindowSize */ "./src/hooks/window/useWindowSize.ts");
/* harmony import */ var _hooks_useSlideSizes__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./hooks/useSlideSizes */ "./src/components/story/hooks/useSlideSizes.ts");
/* harmony import */ var _Story__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./Story */ "./src/components/story/Story.tsx");
/* harmony import */ var _StoryPreview__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./StoryPreview */ "./src/components/story/StoryPreview.tsx");
/* harmony import */ var _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./StoryViewer.module.scss */ "./src/components/story/StoryViewer.module.scss");
























const ACTIVE_SLIDE_VERTICAL_CORRECTION_REM = 1.75;
const SWIPE_Y_THRESHOLD = 50;
const SCROLL_RELEASE_DELAY = 1500;
var SwipeDirection = /*#__PURE__*/function (SwipeDirection) {
  SwipeDirection[SwipeDirection["Horizontal"] = 0] = "Horizontal";
  SwipeDirection[SwipeDirection["Vertical"] = 1] = "Vertical";
  return SwipeDirection;
}(SwipeDirection || {});
function StorySlides({
  peerIds,
  currentPeerId,
  currentStoryId,
  isOpen,
  isSinglePeer,
  isSingleStory,
  isPrivate,
  isArchive,
  byPeerId,
  isDeleteModalOpen,
  onDelete,
  onClose,
  onReport
}) {
  const {
    stopActiveReaction
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  // eslint-disable-next-line no-null/no-null
  const containerRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const [renderingPeerId, setRenderingPeerId] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentPeerId);
  const [renderingStoryId, setRenderingStoryId] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(currentStoryId);
  const prevPeerId = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_18__["default"])(currentPeerId);
  const renderingIsArchive = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_15__["default"])(isArchive, true);
  const renderingIsPrivate = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_15__["default"])(isPrivate, true);
  const renderingIsSinglePeer = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_15__["default"])(isSinglePeer, true);
  const renderingIsSingleStory = (0,_hooks_useCurrentOrPrev__WEBPACK_IMPORTED_MODULE_15__["default"])(isSingleStory, true);
  const slideSizes = (0,_hooks_useSlideSizes__WEBPACK_IMPORTED_MODULE_20__["default"])();
  const {
    height: windowHeight,
    width: windowWidth
  } = (0,_hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_19__["default"])();
  const swipeDirectionRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(undefined);
  const isReleasedRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);
  const {
    isMobile
  } = (0,_hooks_useAppLayout__WEBPACK_IMPORTED_MODULE_14__["default"])();
  const rendersRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)({});
  const [getIsAnimating, setIsAnimating] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)(false);
  (0,_hooks_useHistoryBack__WEBPACK_IMPORTED_MODULE_16__["default"])({
    isActive: isOpen,
    onBack: onClose,
    shouldBeReplaced: true
  });
  function setRef(ref, peerId) {
    if (!ref) {
      return;
    }
    if (!rendersRef.current[peerId]) {
      rendersRef.current[peerId] = {
        current: ref
      };
    } else {
      rendersRef.current[peerId].current = ref;
    }
  }
  const renderingPeerIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (renderingPeerId && (renderingIsSinglePeer || renderingIsSingleStory)) {
      return [renderingPeerId];
    }
    const index = renderingPeerId ? peerIds.indexOf(renderingPeerId) : -1;
    if (!renderingPeerId || index === -1) {
      return [];
    }
    const start = Math.max(index - 4, 0);
    const end = Math.min(index + 5, peerIds.length);
    return peerIds.slice(start, end);
  }, [renderingIsSingleStory, renderingIsSinglePeer, renderingPeerId, peerIds]);
  const renderingPeerPosition = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!renderingPeerIds.length || !renderingPeerId) {
      return -1;
    }
    return renderingPeerIds.indexOf(renderingPeerId);
  }, [renderingPeerId, renderingPeerIds]);
  const currentPeerPosition = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!renderingPeerIds.length || !currentPeerId) {
      return -1;
    }
    return renderingPeerIds.indexOf(currentPeerId);
  }, [currentPeerId, renderingPeerIds]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isMobile) return;

    // If animation disabled, set rendering peer id to current peer
    setRenderingPeerId(currentPeerId);
  }, [currentPeerId, isMobile]);

  // Handling the flipping of stories from a current user
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (renderingPeerId === currentPeerId && currentStoryId !== renderingStoryId) {
      setRenderingStoryId(currentStoryId);
    }
  }, [currentPeerId, currentStoryId, renderingPeerId, renderingStoryId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isMobile) return undefined;
    if (prevPeerId && prevPeerId !== currentPeerId) {
      setIsAnimating(true);
    }
    return () => {
      setIsAnimating(false);
    };
  }, [prevPeerId, currentPeerId, setIsAnimating, isMobile]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    return () => {
      if (!currentStoryId || !currentPeerId) return;
      stopActiveReaction({
        containerId: (0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getStoryKey)(currentPeerId, currentStoryId)
      });
    };
  }, [currentStoryId, currentPeerId]);
  const slideAmount = currentPeerPosition - renderingPeerPosition;
  const isBackward = renderingPeerPosition > currentPeerPosition;
  const calculateTransformX = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(() => {
    return peerIds.reduce((transformX, peerId, index) => {
      if (peerId === renderingPeerId) {
        transformX[peerId] = (0,_helpers_dimensions__WEBPACK_IMPORTED_MODULE_13__.calculateOffsetX)({
          scale: slideSizes.scale,
          slideAmount,
          isBackward,
          isActiveSlideSize: isBackward
        });
      } else {
        let isMoveThroughActiveSlide = false;
        if (!isBackward && index > 0 && peerIds[index - 1] === renderingPeerId) {
          isMoveThroughActiveSlide = true;
        }
        if (isBackward && index < peerIds.length - 1 && peerIds[index + 1] === renderingPeerId) {
          isMoveThroughActiveSlide = true;
        }
        transformX[peerId] = (0,_helpers_dimensions__WEBPACK_IMPORTED_MODULE_13__.calculateOffsetX)({
          scale: slideSizes.scale,
          slideAmount,
          isBackward,
          isActiveSlideSize: currentPeerId === peerId && !isBackward,
          isMoveThroughActiveSlide
        });
      }
      return transformX;
    }, {});
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!containerRef.current || !isOpen) {
      return undefined;
    }
    let offsetY = 0;
    const getCurrentStoryRef = () => {
      return renderingPeerId ? rendersRef.current[renderingPeerId]?.current : undefined;
    };
    const onRelease = event => {
      // This allows to prevent onRelease triggered by debounced wheel event
      // after onRelease was triggered manually in onDrag
      if (isReleasedRef.current) {
        isReleasedRef.current = false;
        return;
      }
      const current = getCurrentStoryRef();
      if (!current) return;
      if (offsetY < -SWIPE_Y_THRESHOLD) {
        const composer = document.getElementById(_config__WEBPACK_IMPORTED_MODULE_2__.EDITABLE_STORY_INPUT_ID);
        if (composer) {
          (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
            (0,_util_focusEditableElement__WEBPACK_IMPORTED_MODULE_9__["default"])(composer);
          });
        }
        return;
      }
      if (offsetY > SWIPE_Y_THRESHOLD) {
        onClose();
        if (event.type === 'wheel') {
          (0,_util_scrollLock__WEBPACK_IMPORTED_MODULE_11__.disableScrolling)();
          setTimeout(_util_scrollLock__WEBPACK_IMPORTED_MODULE_11__.enableScrolling, SCROLL_RELEASE_DELAY);
        }
      } else {
        (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
          current.style.setProperty('--slide-translate-y', '0px');
        });
      }
    };
    return (0,_util_captureEvents__WEBPACK_IMPORTED_MODULE_8__.captureEvents)(containerRef.current, {
      isNotPassive: true,
      withNativeDrag: true,
      withWheelDrag: true,
      excludedClosestSelector: '.Composer',
      onDrag: (event, captureEvent, {
        dragOffsetX,
        dragOffsetY
      }) => {
        if (isReleasedRef.current) return;
        // Avoid conflicts with swipe-to-back gestures
        if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_12__.IS_IOS && captureEvent.type === 'touchstart') {
          const {
            pageX
          } = captureEvent.touches[0];
          if (pageX <= _util_captureEvents__WEBPACK_IMPORTED_MODULE_8__.IOS_SCREEN_EDGE_THRESHOLD || pageX >= windowWidth - _util_captureEvents__WEBPACK_IMPORTED_MODULE_8__.IOS_SCREEN_EDGE_THRESHOLD) {
            return;
          }
        }
        if (event.type === 'mousemove') return;
        const absOffsetX = Math.abs(dragOffsetX);
        const absOffsetY = Math.abs(dragOffsetY);
        const current = getCurrentStoryRef();
        if (!current) return;
        // If vertical shift is dominant we change only vertical position
        if (swipeDirectionRef.current === SwipeDirection.Vertical || Math.abs(absOffsetY) > _util_captureEvents__WEBPACK_IMPORTED_MODULE_8__.SWIPE_DIRECTION_THRESHOLD || absOffsetY / absOffsetX > _util_captureEvents__WEBPACK_IMPORTED_MODULE_8__.SWIPE_DIRECTION_TOLERANCE) {
          swipeDirectionRef.current = SwipeDirection.Vertical;
          const limit = windowHeight;
          offsetY = (0,_util_math__WEBPACK_IMPORTED_MODULE_10__.clamp)(dragOffsetY, -limit, limit);
          if (offsetY > 0) {
            (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
              current.style.setProperty('--slide-translate-y', `${offsetY * (isMobile ? 1 : -1)}px`);
            });
          }
          if (event.type === 'wheel' && Math.abs(offsetY) > SWIPE_Y_THRESHOLD * 2) {
            onRelease(event);
            isReleasedRef.current = true;
          }
        }
      },
      onRelease
    });
  }, [isOpen, onClose, windowWidth, windowHeight, isMobile, renderingPeerId]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    if (isMobile) return;
    const transformX = calculateTransformX();
    Object.entries(rendersRef.current).forEach(([peerId, {
      current
    }]) => {
      if (!current) return;
      if (!getIsAnimating()) {
        current.classList.remove(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].slideAnimation, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].slideAnimationToActive, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].slideAnimationFromActive);
        current.style.setProperty('--slide-translate-x', '0px');
        current.style.setProperty('--slide-translate-y', '0px');
        current.style.setProperty('--slide-translate-scale', '1');
        current.style.setProperty('--slide-content-scale', String(slideSizes.toActiveScale));
        return;
      }
      const getScale = () => {
        if (currentPeerId === peerId) {
          return String(slideSizes.toActiveScale);
        }
        if (peerId === renderingPeerId) {
          return String(slideSizes.fromActiveScale);
        }
        return '1';
      };
      let offsetY = 0;
      if (peerId === renderingPeerId) {
        offsetY = -ACTIVE_SLIDE_VERTICAL_CORRECTION_REM * slideSizes.fromActiveScale;
        current.classList.add(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].slideAnimationFromActive);
      }
      if (peerId === currentPeerId) {
        offsetY = ACTIVE_SLIDE_VERTICAL_CORRECTION_REM;
        current.classList.add(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].slideAnimationToActive);
      }
      current.classList.add(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].slideAnimation);
      current.style.setProperty('--slide-translate-x', `${transformX[peerId] || 0}px`);
      current.style.setProperty('--slide-translate-y', `${offsetY}rem`);
      current.style.setProperty('--slide-translate-scale', getScale());
    });
  }, [currentPeerId, getIsAnimating, renderingPeerId, slideSizes, isMobile]);
  const handleTransitionEnd = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_17__["default"])(event => {
    // It is `target` that is needed here, not `currentTarget`
    const target = event.target;
    if (!target || !target.classList.contains(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].activeSlide)) return;
    if (renderingPeerId !== currentPeerId) {
      setRenderingPeerId(currentPeerId);
      setRenderingStoryId(currentStoryId);
    } else if (currentStoryId !== renderingStoryId) {
      setRenderingStoryId(currentStoryId);
    }
    setIsAnimating(false);
  });
  if (isMobile) {
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].wrapper,
      ref: containerRef
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].mobileSlide,
      ref: ref => setRef(ref, renderingPeerId)
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Story__WEBPACK_IMPORTED_MODULE_21__["default"], {
      peerId: renderingPeerId,
      storyId: renderingStoryId,
      onDelete: onDelete,
      dimensions: slideSizes.activeSlide,
      isPrivateStories: renderingIsPrivate,
      isArchivedStories: renderingIsArchive,
      isDeleteModalOpen: isDeleteModalOpen,
      isSingleStory: isSingleStory,
      getIsAnimating: getIsAnimating,
      onClose: onClose,
      onReport: onReport
    })));
  }
  function renderStoryPreview(peerId, index, position) {
    const style = (0,_util_buildStyle__WEBPACK_IMPORTED_MODULE_7__["default"])(`width: ${slideSizes.slide.width}px`, `height: ${slideSizes.slide.height}px`);
    const className = (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].slide, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].slidePreview, `slide-${position}`);
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      key: peerId,
      ref: ref => setRef(ref, peerId),
      className: className,
      style: style
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StoryPreview__WEBPACK_IMPORTED_MODULE_22__["default"], {
      peer: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectPeer)((0,_global__WEBPACK_IMPORTED_MODULE_1__.getGlobal)(), peerId),
      peerStories: byPeerId?.[peerId]
    }));
  }
  function renderStory(peerId) {
    const style = isMobile ? undefined : (0,_util_buildStyle__WEBPACK_IMPORTED_MODULE_7__["default"])(`width: ${slideSizes.activeSlide.width}px`, `--slide-media-height: ${slideSizes.activeSlide.height}px`);
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
      key: peerId,
      ref: ref => setRef(ref, peerId),
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_6__["default"])(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].slide, _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].activeSlide),
      style: style
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Story__WEBPACK_IMPORTED_MODULE_21__["default"], {
      peerId: peerId,
      storyId: renderingStoryId,
      onDelete: onDelete,
      dimensions: slideSizes.activeSlide,
      isPrivateStories: renderingIsPrivate,
      isArchivedStories: renderingIsArchive,
      isDeleteModalOpen: isDeleteModalOpen,
      isSingleStory: isSingleStory,
      getIsAnimating: getIsAnimating,
      onClose: onClose,
      onReport: onReport
    }));
  }
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].wrapper,
    ref: containerRef,
    style: `--story-viewer-scale: ${slideSizes.scale}`,
    onTransitionEnd: handleTransitionEnd
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].fullSize,
    onClick: onClose
  }), renderingPeerIds.length > 1 && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_23__["default"].backdropNonInteractive,
    style: `height: ${slideSizes.slide.height}px`
  }), renderingPeerIds.map((peerId, index) => {
    if (peerId === renderingPeerId) {
      return renderStory(renderingPeerId);
    }
    return renderStoryPreview(peerId, index, index - renderingPeerPosition);
  }));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    storyViewer: {
      peerId: currentPeerId,
      storyId: currentStoryId,
      isSinglePeer,
      isSingleStory,
      isPrivate,
      isArchive,
      storyList
    }
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectTabState)(global);
  const {
    byPeerId,
    orderedPeerIds: {
      active
    }
  } = global.stories;
  return {
    byPeerId,
    peerIds: storyList?.peerIds ?? active,
    currentPeerId,
    currentStoryId,
    isSinglePeer,
    isSingleStory,
    isPrivate,
    isArchive
  };
}, global => (0,_global_selectors__WEBPACK_IMPORTED_MODULE_5__.selectIsStoryViewerOpen)(global))(StorySlides)));

/***/ }),

/***/ "./src/components/story/StoryView.tsx":
/*!********************************************!*\
  !*** ./src/components/story/StoryView.tsx ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/dates/dateFormat */ "./src/util/dates/dateFormat.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common/GroupChatInfo */ "./src/components/common/GroupChatInfo.tsx");
/* harmony import */ var _common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/PrivateChatInfo */ "./src/components/common/PrivateChatInfo.tsx");
/* harmony import */ var _common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common/reactions/ReactionStaticEmoji */ "./src/components/common/reactions/ReactionStaticEmoji.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./StoryViewModal.module.scss */ "./src/components/story/StoryViewModal.module.scss");














const CLOSE_ANIMATION_DURATION = 100;
const DEFAULT_REACTION_SIZE = 1.5 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_6__.REM;
const BULLET = '\u2022';
const StoryView = ({
  storyView,
  peer,
  availableReactions
}) => {
  const {
    openChat,
    closeStoryViewer,
    unblockUser,
    blockUser,
    deleteContact,
    updateStoryView,
    focusMessage,
    openStoryViewer,
    closeStoryViewModal
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const handleClick = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    const {
      type
    } = storyView;
    if (type === 'repost') {
      closeStoryViewModal();
      openStoryViewer({
        peerId: storyView.peerId,
        storyId: storyView.storyId
      });
      return;
    }
    closeStoryViewer();
    setTimeout(() => {
      if (type === 'user') {
        openChat({
          id: storyView.peerId
        });
      } else if (type === 'forward') {
        focusMessage({
          chatId: storyView.peerId,
          messageId: storyView.messageId
        });
      }
    }, CLOSE_ANIMATION_DURATION);
  });
  const contextActions = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!(0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(storyView.peerId)) return undefined;
    const {
      peerId,
      areStoriesBlocked,
      isUserBlocked
    } = storyView;
    const user = peer;
    const {
      isContact
    } = user || {};
    const fullName = (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.getUserFullName)(user);
    const actions = [];
    if (!isUserBlocked) {
      if (!areStoriesBlocked) {
        actions.push({
          handler: () => {
            blockUser({
              userId: peerId,
              isOnlyStories: true
            });
            updateStoryView({
              userId: peerId,
              areStoriesBlocked: true
            });
          },
          title: lang('StoryHideFrom', fullName),
          icon: 'hand-stop'
        });
      } else {
        actions.push({
          handler: () => {
            unblockUser({
              userId: peerId,
              isOnlyStories: true
            });
            updateStoryView({
              userId: peerId,
              areStoriesBlocked: false
            });
          },
          title: lang('StoryShowBackTo', fullName),
          icon: 'play-story'
        });
      }
    }
    if (isContact) {
      actions.push({
        handler: () => {
          deleteContact({
            userId: peerId
          });
        },
        title: lang('DeleteContact'),
        icon: 'delete-user',
        destructive: true
      });
    } else {
      actions.push({
        handler: () => {
          if (isUserBlocked) {
            unblockUser({
              userId: peerId
            });
            updateStoryView({
              userId: peerId,
              isUserBlocked: false
            });
          } else {
            blockUser({
              userId: peerId
            });
            updateStoryView({
              userId: peerId,
              isUserBlocked: true
            });
          }
        },
        title: lang(isUserBlocked ? 'Unblock' : 'BlockUser'),
        icon: isUserBlocked ? 'user' : 'delete-user',
        destructive: !isUserBlocked
      });
    }
    return actions;
  }, [lang, storyView, peer]);
  const statusIcon = storyView.type === 'user' ? 'message-read' : storyView.type === 'forward' ? 'forward' : 'loop';
  const shouldColorStatus = storyView.type === 'forward' || storyView.type === 'repost';
  const status = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const isModified = storyView.type === 'repost' && storyView.story.forwardInfo?.isModified;
    const parts = [(0,_util_dates_dateFormat__WEBPACK_IMPORTED_MODULE_5__.formatDateAtTime)(lang, storyView.date * 1000)];
    if (isModified) {
      parts.push(lang('lng_edited'));
    }
    return parts.join(` ${BULLET} `);
  }, [lang, storyView]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_12__["default"], {
    key: storyView.peerId,
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('chat-item-clickable small-icon', _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].opacityFadeIn, (storyView.isUserBlocked || storyView.areStoriesBlocked) && _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].blocked),
    onClick: handleClick,
    rightElement: storyView.type === 'user' && storyView.reaction ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_reactions_ReactionStaticEmoji__WEBPACK_IMPORTED_MODULE_11__["default"], {
      reaction: storyView.reaction,
      className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].viewReaction,
      size: DEFAULT_REACTION_SIZE,
      availableReactions: availableReactions,
      withIconHeart: true
    }) : undefined,
    contextActions: contextActions,
    withPortalForMenu: true,
    menuBubbleClassName: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].menuBubble
  }, (0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.isUserId)(storyView.peerId) ? /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_PrivateChatInfo__WEBPACK_IMPORTED_MODULE_10__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(shouldColorStatus && _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].withColoredStatus),
    userId: storyView.peerId,
    noStatusOrTyping: true,
    status: status,
    statusIcon: statusIcon,
    withStory: true,
    forceShowSelf: true
  }) : /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_GroupChatInfo__WEBPACK_IMPORTED_MODULE_9__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(shouldColorStatus && _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_13__["default"].withColoredStatus),
    chatId: storyView.peerId,
    status: status,
    statusIcon: statusIcon,
    withStory: true
  }));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)((global, {
  storyView
}) => {
  const peer = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectPeer)(global, storyView.peerId);
  return {
    peer,
    availableReactions: global.reactions.availableReactions
  };
})(StoryView)));

/***/ }),

/***/ "./src/components/story/StoryViewModal.tsx":
/*!*************************************************!*\
  !*** ./src/components/story/StoryViewModal.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_serverTime__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/serverTime */ "./src/util/serverTime.ts");
/* harmony import */ var _common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/helpers/renderText */ "./src/components/common/helpers/renderText.tsx");
/* harmony import */ var _hooks_useDebouncedCallback__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useDebouncedCallback */ "./src/hooks/useDebouncedCallback.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/useScrolledState */ "./src/hooks/useScrolledState.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/DropdownMenu */ "./src/components/ui/DropdownMenu.tsx");
/* harmony import */ var _ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/InfiniteScroll */ "./src/components/ui/InfiniteScroll.tsx");
/* harmony import */ var _ui_ListItem__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/ListItem */ "./src/components/ui/ListItem.tsx");
/* harmony import */ var _ui_MenuItem__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../ui/MenuItem */ "./src/components/ui/MenuItem.tsx");
/* harmony import */ var _ui_Modal__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../ui/Modal */ "./src/components/ui/Modal.tsx");
/* harmony import */ var _ui_placeholder_PlaceholderChatInfo__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../ui/placeholder/PlaceholderChatInfo */ "./src/components/ui/placeholder/PlaceholderChatInfo.tsx");
/* harmony import */ var _ui_SearchInput__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../ui/SearchInput */ "./src/components/ui/SearchInput.tsx");
/* harmony import */ var _StoryView__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./StoryView */ "./src/components/story/StoryView.tsx");
/* harmony import */ var _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./StoryViewModal.module.scss */ "./src/components/story/StoryViewModal.module.scss");























const REFETCH_DEBOUNCE = 250;
function StoryViewModal({
  story,
  viewersExpirePeriod,
  views,
  nextOffset,
  isLoading,
  isCurrentUserPremium
}) {
  const {
    loadStoryViewList,
    closeStoryViewModal,
    clearStoryViews
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const [areJustContacts, markJustContacts, unmarkJustContacts] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__["default"])(false);
  const [areReactionsFirst, markReactionsFirst, unmarkReactionsFirst] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_8__["default"])(true);
  const [query, setQuery] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_10__["default"])();
  const isOpen = Boolean(story);
  const isExpired = Boolean(story?.date) && story.date + viewersExpirePeriod < (0,_util_serverTime__WEBPACK_IMPORTED_MODULE_5__.getServerTime)();
  const {
    viewsCount = 0,
    reactionsCount = 0
  } = story?.views || {};
  const shouldShowJustContacts = story?.isPublic && viewsCount > _config__WEBPACK_IMPORTED_MODULE_2__.STORY_VIEWS_MIN_CONTACTS_FILTER;
  const shouldShowSortByReactions = reactionsCount > _config__WEBPACK_IMPORTED_MODULE_2__.STORY_MIN_REACTIONS_SORT;
  const shouldShowSearch = viewsCount > _config__WEBPACK_IMPORTED_MODULE_2__.STORY_VIEWS_MIN_SEARCH;
  const hasHeader = shouldShowJustContacts || shouldShowSortByReactions || shouldShowSearch;
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      setQuery('');
      unmarkJustContacts();
      markReactionsFirst();
    }
  }, [isOpen]);
  const refetchViews = (0,_hooks_useDebouncedCallback__WEBPACK_IMPORTED_MODULE_7__["default"])(() => {
    clearStoryViews({
      isLoading: true
    });
  }, [], REFETCH_DEBOUNCE, true);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    refetchViews();
  }, [areJustContacts, areReactionsFirst, query, refetchViews]);
  const sortedViews = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return views?.sort(prepareComparator(areReactionsFirst));
  }, [areReactionsFirst, views]);
  const placeholderCount = !sortedViews?.length ? Math.min(viewsCount, 8) : 1;
  const notAllAvailable = Boolean(sortedViews?.length) && sortedViews.length < viewsCount && isExpired;
  const handleLoadMore = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    if (!story?.id || nextOffset === undefined) return;
    loadStoryViewList({
      peerId: story.peerId,
      storyId: story.id,
      offset: nextOffset,
      areReactionsFirst: areReactionsFirst || undefined,
      areJustContacts: areJustContacts || undefined,
      query
    });
  });
  const {
    handleScroll,
    isAtBeginning
  } = (0,_hooks_useScrolledState__WEBPACK_IMPORTED_MODULE_11__["default"])();
  const handleClose = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
    closeStoryViewModal();
  });
  const MoreMenuButton = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return ({
      onTrigger,
      isOpen: isMenuOpen
    }) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
      fluid: true,
      size: "tiny",
      color: "translucent",
      className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(!isMenuOpen && 'active', _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].sortButton, _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].topButton),
      faded: isMenuOpen,
      onClick: onTrigger,
      ariaLabel: lang('SortBy')
    }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
      name: areReactionsFirst ? 'heart-outline' : 'recent',
      className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].iconSort
    }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
      name: "down",
      className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].iconDown
    }));
  }, [areReactionsFirst, lang]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Modal__WEBPACK_IMPORTED_MODULE_18__["default"], {
    isOpen: isOpen,
    onClose: handleClose,
    className: "component-theme-dark",
    contentClassName: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].viewsList,
    isSlim: true
  }, hasHeader && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].header
  }, shouldShowJustContacts && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].contactFilter
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(!areJustContacts && _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].selected, _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].topButton),
    size: "tiny",
    color: "translucent-white",
    fluid: true,
    onClick: unmarkJustContacts
  }, lang('AllViewers')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(areJustContacts && _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].selected, _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].topButton),
    size: "tiny",
    color: "translucent-white",
    fluid: true,
    onClick: markJustContacts
  }, lang('Contacts'))), shouldShowSortByReactions && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_DropdownMenu__WEBPACK_IMPORTED_MODULE_14__["default"], {
    className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].sort,
    trigger: MoreMenuButton,
    positionX: "right"
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
    icon: "heart-outline",
    onClick: markReactionsFirst
  }, lang('SortByReactions'), areReactionsFirst && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "check",
    className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].check
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_MenuItem__WEBPACK_IMPORTED_MODULE_17__["default"], {
    icon: "recent",
    onClick: unmarkReactionsFirst
  }, lang('SortByTime'), !areReactionsFirst && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
    name: "check",
    className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].check
  }))), shouldShowSearch && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_SearchInput__WEBPACK_IMPORTED_MODULE_20__["default"], {
    className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].search,
    value: query,
    onChange: setQuery
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].content, !isAtBeginning && _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].topScrolled, 'custom-scroll'),
    onScroll: handleScroll
  }, isExpired && !isLoading && !query && Boolean(!sortedViews?.length) && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].info, _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].centeredInfo)
  }, (0,_common_helpers_renderText__WEBPACK_IMPORTED_MODULE_6__["default"])(lang(isCurrentUserPremium ? 'ServerErrorViewers' : 'ExpiredViewsStub'), ['simple_markdown', 'emoji'])), !isLoading && Boolean(query.length) && !sortedViews?.length && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].info
  }, lang('Story.ViewList.EmptyTextSearch')), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_InfiniteScroll__WEBPACK_IMPORTED_MODULE_15__["default"], {
    items: sortedViews,
    onLoadMore: handleLoadMore
  }, sortedViews?.map(view => {
    const additionalKeyId = view.type === 'forward' ? view.messageId : view.type === 'repost' ? view.storyId : 'user';
    return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StoryView__WEBPACK_IMPORTED_MODULE_21__["default"], {
      key: `${view.peerId}-${view.date}-${additionalKeyId}`,
      storyView: view
    });
  }), isLoading && Array.from({
    length: placeholderCount
  }).map((_, i) => /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ListItem__WEBPACK_IMPORTED_MODULE_16__["default"]
  // eslint-disable-next-line react/no-array-index-key
  , {
    key: `placeholder-${i}`,
    className: "chat-item-clickable contact-list-item scroll-item small-icon",
    disabled: true
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_placeholder_PlaceholderChatInfo__WEBPACK_IMPORTED_MODULE_19__["default"], null))), notAllAvailable && /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    key: "not-all-available",
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].info, _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].bottomInfo)
  }, lang('Story.ViewList.NotFullyRecorded')))), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])(_StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].footer, 'dialog-buttons')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_13__["default"], {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_4__["default"])('confirm-dialog-button', _StoryViewModal_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].close),
    isText: true,
    onClick: handleClose
  }, lang('Close'))));
}
function prepareComparator(areReactionsFirst) {
  return (a, b) => {
    if (areReactionsFirst) {
      const reactionA = a.type === 'user' && a.reaction;
      const reactionB = b.type === 'user' && b.reaction;
      if (reactionA && !reactionB) {
        return -1;
      }
      if (!reactionA && reactionB) {
        return 1;
      }
    }
    return b.date - a.date;
  };
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    appConfig
  } = global;
  const {
    storyViewer: {
      viewModal
    }
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global);
  const {
    storyId,
    views,
    nextOffset,
    isLoading
  } = viewModal || {};
  const story = storyId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectPeerStory)(global, global.currentUserId, storyId) : undefined;
  return {
    storyId,
    views,
    viewersExpirePeriod: appConfig.storyExpirePeriod + appConfig.storyViewersExpirePeriod,
    story: story && 'content' in story ? story : undefined,
    nextOffset,
    isLoading,
    availableReactions: global.reactions.availableReactions,
    isCurrentUserPremium: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsCurrentUserPremium)(global)
  };
})(StoryViewModal)));

/***/ }),

/***/ "./src/components/story/StoryViewer.tsx":
/*!**********************************************!*\
  !*** ./src/components/story/StoryViewer.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global */ "./src/global/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../config */ "./src/config.ts");
/* harmony import */ var _global_selectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../global/selectors */ "./src/global/selectors/index.ts");
/* harmony import */ var _util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../util/captureEscKeyListener */ "./src/util/captureEscKeyListener.ts");
/* harmony import */ var _util_directInputManager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/directInputManager */ "./src/util/directInputManager.ts");
/* harmony import */ var _helpers_ghostAnimation__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./helpers/ghostAnimation */ "./src/components/story/helpers/ghostAnimation.ts");
/* harmony import */ var _hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../hooks/useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../hooks/usePreviousDeprecated */ "./src/hooks/usePreviousDeprecated.ts");
/* harmony import */ var _hooks_usePriorityPlaybackCheck__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../hooks/usePriorityPlaybackCheck */ "./src/hooks/usePriorityPlaybackCheck.ts");
/* harmony import */ var _hooks_useSlideSizes__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./hooks/useSlideSizes */ "./src/components/story/hooks/useSlideSizes.ts");
/* harmony import */ var _hooks_useStoryProps__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./hooks/useStoryProps */ "./src/components/story/hooks/useStoryProps.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _ui_Button__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/Button */ "./src/components/ui/Button.tsx");
/* harmony import */ var _ui_ShowTransition__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/ShowTransition */ "./src/components/ui/ShowTransition.tsx");
/* harmony import */ var _StealthModeModal__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./StealthModeModal */ "./src/components/story/StealthModeModal.tsx");
/* harmony import */ var _StoryDeleteConfirmModal__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./StoryDeleteConfirmModal */ "./src/components/story/StoryDeleteConfirmModal.tsx");
/* harmony import */ var _StorySettings__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./StorySettings */ "./src/components/story/StorySettings.tsx");
/* harmony import */ var _StorySlides__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./StorySlides */ "./src/components/story/StorySlides.tsx");
/* harmony import */ var _StoryViewModal__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./StoryViewModal */ "./src/components/story/StoryViewModal.tsx");
/* harmony import */ var _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./StoryViewer.module.scss */ "./src/components/story/StoryViewer.module.scss");























const ANIMATION_DURATION = 250;
function StoryViewer({
  isOpen,
  peerId,
  storyId,
  story,
  origin,
  shouldSkipHistoryAnimations,
  withAnimation,
  isPrivacyModalOpen
}) {
  const {
    closeStoryViewer,
    closeStoryPrivacyEditor,
    reportStory
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_9__["default"])();
  const [storyToDelete, setStoryToDelete] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [isDeleteModalOpen, openDeleteModal, closeDeleteModal] = (0,_hooks_useFlag__WEBPACK_IMPORTED_MODULE_7__["default"])(false);
  const {
    bestImageData,
    thumbnail
  } = (0,_hooks_useStoryProps__WEBPACK_IMPORTED_MODULE_13__["default"])(story);
  const slideSizes = (0,_hooks_useSlideSizes__WEBPACK_IMPORTED_MODULE_12__["default"])();
  const isPrevOpen = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(isOpen);
  const prevBestImageData = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(bestImageData);
  const prevPeerId = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(peerId);
  const prevOrigin = (0,_hooks_usePreviousDeprecated__WEBPACK_IMPORTED_MODULE_10__["default"])(origin);
  const isGhostAnimation = Boolean(withAnimation && !shouldSkipHistoryAnimations);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      setStoryToDelete(undefined);
      closeDeleteModal();
    }
  }, [isOpen]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isOpen) {
      return undefined;
    }
    (0,_util_directInputManager__WEBPACK_IMPORTED_MODULE_5__.disableDirectTextInput)();
    const stopPriorityPlayback = (0,_hooks_usePriorityPlaybackCheck__WEBPACK_IMPORTED_MODULE_11__.dispatchPriorityPlaybackEvent)();
    return () => {
      (0,_util_directInputManager__WEBPACK_IMPORTED_MODULE_5__.enableDirectTextInput)();
      stopPriorityPlayback();
    };
  }, [isOpen]);
  const handleClose = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    closeStoryViewer();
  }, [closeStoryViewer]);
  const handleOpenDeleteModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(s => {
    setStoryToDelete(s);
    openDeleteModal();
  });
  const handleCloseDeleteModal = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    closeDeleteModal();
    setStoryToDelete(undefined);
  });
  const openMessageReport = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_8__["default"])(() => {
    if (!storyId) return;
    reportStory({
      storyId,
      peerId
    });
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => isOpen ? (0,_util_captureEscKeyListener__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    handleClose();
  }) : undefined, [handleClose, isOpen]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isGhostAnimation && !isPrevOpen && isOpen && peerId && thumbnail && origin !== undefined) {
      (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.beginHeavyAnimation)(ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_END_DELAY);
      (0,_helpers_ghostAnimation__WEBPACK_IMPORTED_MODULE_6__.animateOpening)(peerId, origin, thumbnail, bestImageData, slideSizes.activeSlide);
    }
    if (isGhostAnimation && isPrevOpen && !isOpen && prevPeerId && prevBestImageData && prevOrigin !== undefined) {
      (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.beginHeavyAnimation)(ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_2__.ANIMATION_END_DELAY);
      (0,_helpers_ghostAnimation__WEBPACK_IMPORTED_MODULE_6__.animateClosing)(prevPeerId, prevOrigin, prevBestImageData);
    }
  }, [isGhostAnimation, bestImageData, prevBestImageData, isOpen, isPrevOpen, slideSizes.activeSlide, thumbnail, peerId, prevPeerId, origin, prevOrigin]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_ShowTransition__WEBPACK_IMPORTED_MODULE_16__["default"], {
    id: "StoryViewer",
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].root,
    isOpen: isOpen,
    shouldAnimateFirstRender: true,
    noCloseTransition: shouldSkipHistoryAnimations
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].backdrop,
    onClick: handleClose
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_15__["default"], {
    className: _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_22__["default"].close,
    round: true,
    size: "smaller",
    color: "translucent-white",
    ariaLabel: lang('Close'),
    onClick: handleClose
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
    name: "close"
  })), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StorySlides__WEBPACK_IMPORTED_MODULE_20__["default"], {
    isOpen: isOpen,
    isDeleteModalOpen: isDeleteModalOpen,
    onReport: openMessageReport,
    onClose: handleClose,
    onDelete: handleOpenDeleteModal
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StoryDeleteConfirmModal__WEBPACK_IMPORTED_MODULE_18__["default"], {
    isOpen: isDeleteModalOpen,
    story: storyToDelete,
    onClose: handleCloseDeleteModal
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StoryViewModal__WEBPACK_IMPORTED_MODULE_21__["default"], null), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StealthModeModal__WEBPACK_IMPORTED_MODULE_17__["default"], null), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_StorySettings__WEBPACK_IMPORTED_MODULE_19__["default"], {
    isOpen: isPrivacyModalOpen,
    onClose: closeStoryPrivacyEditor
  }));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)((0,_global__WEBPACK_IMPORTED_MODULE_1__.withGlobal)(global => {
  const {
    shouldSkipHistoryAnimations,
    storyViewer: {
      storyId,
      peerId,
      isPrivacyModalOpen,
      origin
    }
  } = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectTabState)(global);
  const story = peerId && storyId ? (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectPeerStory)(global, peerId, storyId) : undefined;
  const withAnimation = (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectPerformanceSettingsValue)(global, 'mediaViewerAnimations');
  return {
    isOpen: (0,_global_selectors__WEBPACK_IMPORTED_MODULE_3__.selectIsStoryViewerOpen)(global),
    shouldSkipHistoryAnimations,
    peerId: peerId,
    storyId,
    story,
    origin,
    withAnimation,
    isPrivacyModalOpen
  };
})(StoryViewer)));

/***/ }),

/***/ "./src/components/story/helpers/dimensions.ts":
/*!****************************************************!*\
  !*** ./src/components/story/helpers/dimensions.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BASE_STORY_HEIGHT: () => (/* binding */ BASE_STORY_HEIGHT),
/* harmony export */   BASE_STORY_WIDTH: () => (/* binding */ BASE_STORY_WIDTH),
/* harmony export */   calculateOffsetX: () => (/* binding */ calculateOffsetX),
/* harmony export */   calculateSlideSizes: () => (/* binding */ calculateSlideSizes)
/* harmony export */ });
/* harmony import */ var _util_math__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../util/math */ "./src/util/math.ts");

const BASE_STORY_WIDTH = 720;
const BASE_STORY_HEIGHT = 1280;
const BASE_SCREEN_WIDTH = 1200;
const BASE_SCREEN_HEIGHT = 800;
const BASE_ACTIVE_SLIDE_WIDTH = 405;
const BASE_ACTIVE_SLIDE_HEIGHT = 720;
const BASE_SLIDE_WIDTH = 135;
const BASE_SLIDE_HEIGHT = 240;
const BASE_GAP_WIDTH = 40;
function calculateSlideSizes(windowWidth, windowHeight) {
  const scale = calculateScale(BASE_SCREEN_WIDTH, BASE_SCREEN_HEIGHT, windowWidth, windowHeight);
  const activeSlideWidth = (0,_util_math__WEBPACK_IMPORTED_MODULE_0__.roundToNearestEven)(BASE_ACTIVE_SLIDE_WIDTH * scale);
  const slideWidth = (0,_util_math__WEBPACK_IMPORTED_MODULE_0__.roundToNearestEven)(BASE_SLIDE_WIDTH * scale);
  // Avoid fractional values to prevent blurry text
  return {
    activeSlide: {
      width: activeSlideWidth,
      height: (0,_util_math__WEBPACK_IMPORTED_MODULE_0__.roundToNearestEven)(BASE_ACTIVE_SLIDE_HEIGHT * scale)
    },
    slide: {
      width: slideWidth,
      height: (0,_util_math__WEBPACK_IMPORTED_MODULE_0__.roundToNearestEven)(BASE_SLIDE_HEIGHT * scale)
    },
    scale,
    toActiveScale: activeSlideWidth / slideWidth,
    fromActiveScale: slideWidth / activeSlideWidth
  };
}
function calculateOffsetX({
  scale,
  slideAmount,
  isActiveSlideSize,
  isMoveThroughActiveSlide,
  isBackward
}) {
  const mainOffset = BASE_GAP_WIDTH + (isActiveSlideSize ? BASE_ACTIVE_SLIDE_WIDTH : BASE_SLIDE_WIDTH);
  const additionalOffset = (Math.abs(slideAmount) - 1) * ((isMoveThroughActiveSlide ? BASE_ACTIVE_SLIDE_WIDTH : BASE_SLIDE_WIDTH) + BASE_GAP_WIDTH);
  const totalOffset = (0,_util_math__WEBPACK_IMPORTED_MODULE_0__.roundToNearestEven)((mainOffset + additionalOffset) * scale);
  return isBackward ? -totalOffset : totalOffset;
}
function calculateScale(baseWidth, baseHeight, newWidth, newHeight) {
  const widthScale = newWidth / baseWidth;
  const heightScale = newHeight / baseHeight;
  return Math.min(widthScale, heightScale);
}

/***/ }),

/***/ "./src/components/story/helpers/ghostAnimation.ts":
/*!********************************************************!*\
  !*** ./src/components/story/helpers/ghostAnimation.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   animateClosing: () => (/* binding */ animateClosing),
/* harmony export */   animateOpening: () => (/* binding */ animateOpening)
/* harmony export */ });
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../types */ "./src/types/index.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../config */ "./src/config.ts");
/* harmony import */ var _lib_fastBlur__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/fastBlur */ "./src/lib/fastBlur.js");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_animation__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../util/animation */ "./src/util/animation.ts");
/* harmony import */ var _util_stopEvent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../util/stopEvent */ "./src/util/stopEvent.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _util_windowSize__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../util/windowSize */ "./src/util/windowSize.ts");
/* harmony import */ var _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/helpers/mediaDimensions */ "./src/components/common/helpers/mediaDimensions.ts");
/* harmony import */ var _StoryRibbon_module_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../StoryRibbon.module.scss */ "./src/components/story/StoryRibbon.module.scss");
/* harmony import */ var _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../StoryViewer.module.scss */ "./src/components/story/StoryViewer.module.scss");












const ANIMATION_DURATION = 200;
const OFFSET_BOTTOM = 3.5 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_9__.REM;
const MOBILE_OFFSET = 0.5 * _common_helpers_mediaDimensions__WEBPACK_IMPORTED_MODULE_9__.REM;
const MOBILE_WIDTH = 600;
function animateOpening(userId, origin, thumb, bestImageData, dimensions) {
  const {
    mediaEl: fromImage
  } = getNodes(origin, userId);
  if (!fromImage) {
    return;
  }
  const {
    width: windowWidth,
    height: windowHeight
  } = _util_windowSize__WEBPACK_IMPORTED_MODULE_8__["default"].get();
  let {
    width: toWidth,
    height: toHeight
  } = dimensions;
  const isMobile = windowWidth <= MOBILE_WIDTH;
  if (isMobile) {
    toWidth = windowWidth - 2 * MOBILE_OFFSET;
    toHeight = windowHeight - OFFSET_BOTTOM - 2 * MOBILE_OFFSET;
    const safeAreaBottom = getComputedStyle(document.documentElement).getPropertyValue('--safe-area-bottom');
    if (safeAreaBottom) {
      toHeight -= parseFloat(safeAreaBottom);
    }
  }
  const toLeft = isMobile ? MOBILE_OFFSET : (windowWidth - toWidth) / 2;
  const toTop = isMobile ? MOBILE_OFFSET : (windowHeight - (toHeight + OFFSET_BOTTOM)) / 2;
  const {
    top: fromTop,
    left: fromLeft,
    width: fromWidth,
    height: fromHeight
  } = fromImage.getBoundingClientRect();
  const fromTranslateX = fromLeft + fromWidth / 2 - (toLeft + toWidth / 2);
  const fromTranslateY = fromTop + fromHeight / 2 - (toTop + toHeight / 2);
  const fromScaleX = fromWidth / toWidth;
  const fromScaleY = fromHeight / toHeight;
  (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
    const ghost = createGhost(bestImageData || thumb, !bestImageData);
    (0,_util_animation__WEBPACK_IMPORTED_MODULE_5__.applyStyles)(ghost, {
      top: `${toTop}px`,
      left: `${toLeft}px`,
      width: `${toWidth}px`,
      height: `${toHeight}px`,
      transform: `translate3d(${fromTranslateX}px, ${fromTranslateY}px, 0) scale(${fromScaleX}, ${fromScaleY})`
    });
    const container = document.getElementById('StoryViewer');
    container.appendChild(ghost);
    document.body.classList.add('ghost-animating');
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
      (0,_util_animation__WEBPACK_IMPORTED_MODULE_5__.applyStyles)(ghost, {
        transform: ''
      });
      setTimeout(() => {
        (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
          if (container.contains(ghost)) {
            container.removeChild(ghost);
          }
          document.body.classList.remove('ghost-animating');
        });
      }, ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_1__.ANIMATION_END_DELAY);
    });
  });
}
function animateClosing(userId, origin, bestImageData) {
  const {
    mediaEl: toImage
  } = getNodes(origin, userId);
  const fromImage = document.getElementById('StoryViewer').querySelector(`.${_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].mobileSlide} .${_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].media}, .${_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].activeSlide} .${_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].media}`);
  if (!fromImage || !toImage) {
    return;
  }
  const {
    top: fromTop,
    left: fromLeft,
    width: fromWidth,
    height: fromHeight
  } = fromImage.getBoundingClientRect();
  const {
    top: toTop,
    left: toLeft,
    width: toWidth,
    height: toHeight
  } = toImage.getBoundingClientRect();
  const toTranslateX = toLeft + toWidth / 2 - (fromLeft + fromWidth / 2);
  const toTranslateY = toTop + toHeight / 2 - (fromTop + fromHeight / 2);
  const toScaleX = toWidth / fromWidth;
  const toScaleY = toHeight / fromHeight;
  (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
    const ghost = createGhost(bestImageData);
    (0,_util_animation__WEBPACK_IMPORTED_MODULE_5__.applyStyles)(ghost, {
      top: `${fromTop}px`,
      left: `${fromLeft}px`,
      width: `${fromWidth}px`,
      height: `${fromHeight}px`
    });
    const ghost2 = createGhost(toImage.src, undefined, true);
    const ghost2Top = fromTop + fromHeight / 2 - fromWidth / 2;
    (0,_util_animation__WEBPACK_IMPORTED_MODULE_5__.applyStyles)(ghost2, {
      top: `${ghost2Top}px`,
      left: `${fromLeft}px`,
      width: `${fromWidth}px`,
      height: `${fromWidth}px`
    });
    const container = document.getElementById('StoryViewer');
    container.appendChild(ghost);
    document.body.appendChild(ghost2);
    document.body.classList.add('ghost-animating');
    (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
      (0,_util_animation__WEBPACK_IMPORTED_MODULE_5__.applyStyles)(ghost, {
        transform: `translate3d(${toTranslateX}px, ${toTranslateY}px, 0) scale(${toScaleX}, ${toScaleY})`
      });
      (0,_util_animation__WEBPACK_IMPORTED_MODULE_5__.applyStyles)(ghost2, {
        transform: `translate3d(${toTranslateX}px, ${toTranslateY}px, 0) scale(${toScaleX})`,
        opacity: '1'
      });
      setTimeout(() => {
        (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
          if (container.contains(ghost)) {
            container.removeChild(ghost);
          }
          if (document.body.contains(ghost2)) {
            document.body.removeChild(ghost2);
          }
          document.body.classList.remove('ghost-animating');
        });
      }, ANIMATION_DURATION + _config__WEBPACK_IMPORTED_MODULE_1__.ANIMATION_END_DELAY);
    });
  });
}
const RADIUS = 2;
const ITERATIONS = 2;
function createGhost(source, hasBlur = false, isGhost2 = false) {
  const ghost = document.createElement('div');
  ghost.classList.add(!isGhost2 ? _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].ghost : _StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].ghost2);
  const img = new Image();
  img.draggable = false;
  img.oncontextmenu = _util_stopEvent__WEBPACK_IMPORTED_MODULE_6__["default"];
  img.classList.add(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].ghostImage);
  if (hasBlur) {
    const canvas = document.createElement('canvas');
    canvas.classList.add(_StoryViewer_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].thumbnail);
    img.onload = () => {
      const ctx = canvas.getContext('2d', {
        alpha: false
      });
      const {
        width,
        height
      } = img;
      (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_3__.requestMutation)(() => {
        canvas.width = width;
        canvas.height = height;
        if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_7__.IS_CANVAS_FILTER_SUPPORTED) {
          ctx.filter = `blur(${RADIUS}px)`;
        }
        ctx.drawImage(img, -RADIUS * 2, -RADIUS * 2, width + RADIUS * 4, height + RADIUS * 4);
        if (!_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_7__.IS_CANVAS_FILTER_SUPPORTED) {
          (0,_lib_fastBlur__WEBPACK_IMPORTED_MODULE_2__["default"])(ctx, 0, 0, width, height, RADIUS, ITERATIONS);
        }
      });
    };
    img.src = source;
    ghost.appendChild(canvas);
  } else {
    img.src = source;
    ghost.appendChild(img);
  }
  return ghost;
}
function getNodes(origin, userId) {
  let containerSelector;
  const mediaSelector = `#${(0,_global_helpers__WEBPACK_IMPORTED_MODULE_4__.getPeerStoryHtmlId)(userId)}`;
  switch (origin) {
    case _types__WEBPACK_IMPORTED_MODULE_0__.StoryViewerOrigin.StoryRibbon:
      containerSelector = `#LeftColumn .${_StoryRibbon_module_scss__WEBPACK_IMPORTED_MODULE_10__["default"].root}`;
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.StoryViewerOrigin.MiddleHeaderAvatar:
      containerSelector = '.MiddleHeader .Transition_slide-active .ChatInfo';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.StoryViewerOrigin.ChatList:
      containerSelector = '#LeftColumn .chat-list';
      break;
    case _types__WEBPACK_IMPORTED_MODULE_0__.StoryViewerOrigin.SearchResult:
      containerSelector = '#LeftColumn .LeftSearch--container';
      break;
  }
  const container = document.querySelector(containerSelector);
  const mediaEls = container && container.querySelectorAll(`${mediaSelector} img`);
  return {
    container,
    mediaEl: mediaEls?.[0]
  };
}

/***/ }),

/***/ "./src/components/story/hooks/useSlideSizes.ts":
/*!*****************************************************!*\
  !*** ./src/components/story/hooks/useSlideSizes.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useSlideSizes)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _helpers_dimensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/dimensions */ "./src/components/story/helpers/dimensions.ts");
/* harmony import */ var _hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/window/useWindowSize */ "./src/hooks/window/useWindowSize.ts");



function useSlideSizes() {
  const {
    width: windowWidth,
    height: windowHeight
  } = (0,_hooks_window_useWindowSize__WEBPACK_IMPORTED_MODULE_2__["default"])();
  return (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (0,_helpers_dimensions__WEBPACK_IMPORTED_MODULE_1__.calculateSlideSizes)(windowWidth, windowHeight), [windowWidth, windowHeight]);
}

/***/ }),

/***/ "./src/components/story/hooks/useStoryProps.ts":
/*!*****************************************************!*\
  !*** ./src/components/story/hooks/useStoryProps.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useStoryProps)
/* harmony export */ });
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _hooks_useMedia__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../hooks/useMedia */ "./src/hooks/useMedia.ts");



function useStoryProps(story, isCurrentUserPremium = false, isDropdownMenuOpen = false) {
  const isLoadedStory = story && 'content' in story;
  const isDeletedStory = story && 'isDeleted' in story;
  const hasText = isLoadedStory ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.hasMessageText)(story) : false;
  const hasForwardInfo = isLoadedStory && Boolean(story.forwardInfo);
  let thumbnail;
  if (isLoadedStory) {
    if (story.content.photo?.thumbnail) {
      thumbnail = story.content.photo.thumbnail.dataUri;
    }
    if (story.content.video?.thumbnail?.dataUri) {
      thumbnail = story.content.video.thumbnail.dataUri;
    }
  }
  const previewHash = isLoadedStory ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getStoryMediaHash)(story) : undefined;
  const previewBlobUrl = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_2__["default"])(previewHash);
  const isVideo = Boolean(isLoadedStory && story.content.video);
  const noSound = isLoadedStory && story.content.video?.noSound;
  const fullMediaHash = isLoadedStory ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getStoryMediaHash)(story, 'full') : undefined;
  const fullMediaData = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_2__["default"])(fullMediaHash, !story, isVideo ? _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMediaFormat.Progressive : _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMediaFormat.BlobUrl);
  const altMediaHash = isVideo && isLoadedStory ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getStoryMediaHash)(story, 'full', true) : undefined;
  const altMediaData = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_2__["default"])(altMediaHash, !story, _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMediaFormat.Progressive);
  const hasFullData = Boolean(fullMediaData || altMediaData);
  const bestImageData = isVideo ? previewBlobUrl : fullMediaData || previewBlobUrl;
  const hasThumb = !previewBlobUrl && !hasFullData;
  const canDownload = isCurrentUserPremium && isLoadedStory && !story.noForwards;
  const downloadHash = isLoadedStory ? (0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.getStoryMediaHash)(story, 'download') : undefined;
  const downloadMediaData = (0,_hooks_useMedia__WEBPACK_IMPORTED_MODULE_2__["default"])(downloadHash, !canDownload && !isDropdownMenuOpen);
  return {
    isLoadedStory,
    isDeletedStory,
    hasText,
    hasForwardInfo,
    thumbnail,
    previewHash,
    previewBlobUrl,
    isVideo,
    noSound,
    fullMediaHash,
    fullMediaData,
    altMediaHash,
    altMediaData,
    hasFullData,
    bestImageData,
    hasThumb,
    canDownload,
    downloadMediaData
  };
}

/***/ }),

/***/ "./src/components/story/privacy/AllowDenyList.tsx":
/*!********************************************************!*\
  !*** ./src/components/story/privacy/AllowDenyList.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _util_memo__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/memo */ "./src/util/memo.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");






function AllowDenyList({
  id,
  contactListIds,
  currentUserId,
  usersById,
  selectedIds,
  lockedIds,
  onSelect
}) {
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_4__["default"])();
  const [searchQuery, setSearchQuery] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const displayedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const contactIds = (contactListIds || []).filter(userId => userId !== currentUserId);
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_2__.unique)((0,_global_helpers__WEBPACK_IMPORTED_MODULE_1__.filterUsersByName)([...(selectedIds || []), ...contactIds], usersById, searchQuery));
  }, [contactListIds, currentUserId, searchQuery, selectedIds, usersById]);
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_5__["default"], {
    key: id,
    itemIds: displayedIds,
    selectedIds: selectedIds ?? _util_memo__WEBPACK_IMPORTED_MODULE_3__.MEMO_EMPTY_ARRAY,
    lockedSelectedIds: lockedIds,
    filterValue: searchQuery,
    filterPlaceholder: lang('Search'),
    searchInputId: `${id}-picker-search`,
    isSearchable: true,
    withDefaultPadding: true,
    forceShowSelf: true,
    onSelectedIdsChange: onSelect,
    onFilterChange: setSearchQuery,
    allowMultiple: true,
    withStatus: true,
    itemInputType: "checkbox"
  });
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(AllowDenyList));

/***/ }),

/***/ "./src/components/story/privacy/CloseFriends.tsx":
/*!*******************************************************!*\
  !*** ./src/components/story/privacy/CloseFriends.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../global */ "./src/global/index.ts");
/* harmony import */ var _global_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../global/helpers */ "./src/global/helpers/index.ts");
/* harmony import */ var _util_buildClassName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../util/buildClassName */ "./src/util/buildClassName.ts");
/* harmony import */ var _util_iteratees__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../util/iteratees */ "./src/util/iteratees.ts");
/* harmony import */ var _hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../hooks/useEffectWithPrevDeps */ "./src/hooks/useEffectWithPrevDeps.ts");
/* harmony import */ var _hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../hooks/useLastCallback */ "./src/hooks/useLastCallback.ts");
/* harmony import */ var _hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../hooks/useOldLang */ "./src/hooks/useOldLang.ts");
/* harmony import */ var _common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/icons/Icon */ "./src/components/common/icons/Icon.tsx");
/* harmony import */ var _common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/pickers/PeerPicker */ "./src/components/common/pickers/PeerPicker.tsx");
/* harmony import */ var _ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../ui/FloatingActionButton */ "./src/components/ui/FloatingActionButton.tsx");
/* harmony import */ var _CloseFriends_module_scss__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./CloseFriends.module.scss */ "./src/components/story/privacy/CloseFriends.module.scss");












function CloseFriends({
  isActive,
  contactListIds,
  usersById,
  currentUserId,
  onClose
}) {
  const {
    saveCloseFriends
  } = (0,_global__WEBPACK_IMPORTED_MODULE_1__.getActions)();
  const lang = (0,_hooks_useOldLang__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [searchQuery, setSearchQuery] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)('');
  const [isSubmitShown, setIsSubmitShown] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [newSelectedContactIds, setNewSelectedContactIds] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)([]);
  const closeFriendIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    return (contactListIds || []).filter(userId => usersById[userId]?.isCloseFriend);
  }, [contactListIds, usersById]);
  const displayedIds = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    const contactIds = (contactListIds || []).filter(id => id !== currentUserId);
    return (0,_util_iteratees__WEBPACK_IMPORTED_MODULE_4__.unique)((0,_global_helpers__WEBPACK_IMPORTED_MODULE_2__.filterUsersByName)([...closeFriendIds, ...contactIds], usersById, searchQuery));
  }, [closeFriendIds, contactListIds, currentUserId, searchQuery, usersById]);
  (0,_hooks_useEffectWithPrevDeps__WEBPACK_IMPORTED_MODULE_5__["default"])(([prevIsActive]) => {
    if (!prevIsActive && isActive) {
      setIsSubmitShown(false);
      setNewSelectedContactIds(closeFriendIds);
    }
  }, [isActive, closeFriendIds]);
  const handleSelectedContactIdsChange = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value => {
    setNewSelectedContactIds(value);
    setIsSubmitShown(true);
  }, []);
  const handleSubmit = (0,_hooks_useLastCallback__WEBPACK_IMPORTED_MODULE_6__["default"])(() => {
    saveCloseFriends({
      userIds: newSelectedContactIds
    });
    onClose();
  });
  return /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].Fragment, null, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_pickers_PeerPicker__WEBPACK_IMPORTED_MODULE_9__["default"], {
    itemIds: displayedIds || [],
    selectedIds: newSelectedContactIds,
    filterValue: searchQuery,
    filterPlaceholder: lang('Search'),
    searchInputId: "close-friends-picker-search",
    isSearchable: true,
    withDefaultPadding: true,
    onSelectedIdsChange: handleSelectedContactIdsChange,
    onFilterChange: setSearchQuery,
    allowMultiple: true,
    withStatus: true,
    itemInputType: "checkbox"
  }), /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", {
    className: (0,_util_buildClassName__WEBPACK_IMPORTED_MODULE_3__["default"])(_CloseFriends_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].buttonHolder, isSubmitShown && _CloseFriends_module_scss__WEBPACK_IMPORTED_MODULE_11__["default"].active)
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_ui_FloatingActionButton__WEBPACK_IMPORTED_MODULE_10__["default"], {
    isShown: isSubmitShown,
    onClick: handleSubmit,
    ariaLabel: lang('Save')
  }, /*#__PURE__*/_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_common_icons_Icon__WEBPACK_IMPORTED_MODULE_8__["default"], {
    name: "check"
  }))));
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.memo)(CloseFriends));

/***/ }),

/***/ "./src/hooks/events/useOutsideClick.ts":
/*!*********************************************!*\
  !*** ./src/hooks/events/useOutsideClick.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   useClickOutside: () => (/* binding */ useClickOutside)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _useLastCallback__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../useLastCallback */ "./src/hooks/useLastCallback.ts");


function useClickOutside(refs, callback) {
  const handleClickOutside = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_1__["default"])(event => {
    const clickedOutside = refs.every(ref => {
      return ref.current && !ref.current.contains(event.target);
    });
    if (clickedOutside) callback(event);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    document.addEventListener('click', handleClickOutside);
    return () => {
      document.removeEventListener('click', handleClickOutside);
    };
  }, [handleClickOutside]);
}

/***/ }),

/***/ "./src/hooks/reducers/usePaymentReducer.ts":
/*!*************************************************!*\
  !*** ./src/hooks/reducers/usePaymentReducer.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _useReducer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../useReducer */ "./src/hooks/useReducer.ts");

const INITIAL_STATE = {
  streetLine1: '',
  streetLine2: '',
  city: '',
  state: '',
  countryIso2: '',
  postCode: '',
  fullName: '',
  email: '',
  phone: '',
  shipping: '',
  cardNumber: '',
  cardholder: '',
  expiry: '',
  cvv: '',
  billingCountry: '',
  billingZip: '',
  saveInfo: true,
  saveCredentials: false,
  formErrors: {},
  tipAmount: 0,
  savedCredentialId: ''
};
const reducer = (state, action) => {
  switch (action.type) {
    case 'changeAddress1':
      return {
        ...state,
        streetLine1: action.payload,
        formErrors: {
          ...state.formErrors,
          streetLine1: undefined
        }
      };
    case 'changeAddress2':
      return {
        ...state,
        streetLine2: action.payload,
        formErrors: {
          ...state.formErrors,
          streetLine2: undefined
        }
      };
    case 'changeCity':
      return {
        ...state,
        city: action.payload,
        formErrors: {
          ...state.formErrors,
          city: undefined
        }
      };
    case 'changeState':
      return {
        ...state,
        state: action.payload,
        formErrors: {
          ...state.formErrors,
          state: undefined
        }
      };
    case 'changeCountry':
      return {
        ...state,
        countryIso2: action.payload.iso2,
        billingCountry: action.payload.defaultName,
        formErrors: {
          ...state.formErrors,
          countryIso2: undefined
        }
      };
    case 'changePostCode':
      return {
        ...state,
        postCode: action.payload,
        formErrors: {
          ...state.formErrors,
          postCode: undefined
        }
      };
    case 'changeFullName':
      return {
        ...state,
        fullName: action.payload,
        formErrors: {
          ...state.formErrors,
          fullName: undefined
        }
      };
    case 'changeEmail':
      return {
        ...state,
        email: action.payload,
        formErrors: {
          ...state.formErrors,
          email: undefined
        }
      };
    case 'changePhone':
      return {
        ...state,
        phone: action.payload,
        formErrors: {
          ...state.formErrors,
          phone: undefined
        }
      };
    case 'changeShipping':
      return {
        ...state,
        shipping: action.payload
      };
    case 'changeCardNumber':
      return {
        ...state,
        cardNumber: action.payload,
        formErrors: {
          ...state.formErrors,
          cardNumber: undefined
        }
      };
    case 'changeCardholder':
      return {
        ...state,
        cardholder: action.payload,
        formErrors: {
          ...state.formErrors,
          cardholder: undefined
        }
      };
    case 'changeExpiryDate':
      return {
        ...state,
        expiry: action.payload,
        formErrors: {
          ...state.formErrors,
          expiry: undefined
        }
      };
    case 'changeCvvCode':
      return {
        ...state,
        cvv: action.payload,
        formErrors: {
          ...state.formErrors,
          cvv: undefined
        }
      };
    case 'changeBillingCountry':
      return {
        ...state,
        billingCountry: action.payload,
        formErrors: {
          ...state.formErrors,
          billingCountry: undefined
        }
      };
    case 'changeBillingZip':
      return {
        ...state,
        billingZip: action.payload,
        formErrors: {
          ...state.formErrors,
          billingZip: undefined
        }
      };
    case 'changeSaveInfo':
      return {
        ...state,
        saveInfo: action.payload
      };
    case 'changeSaveCredentials':
      return {
        ...state,
        saveCredentials: action.payload
      };
    case 'updateUserInfo':
      if (action.payload.country) {
        return {
          ...state,
          ...action.payload,
          billingCountry: action.payload.country
        };
      }
      return {
        ...state,
        ...action.payload
      };
    case 'setFormErrors':
      return {
        ...state,
        formErrors: {
          ...state.formErrors,
          ...action.payload
        }
      };
    case 'setTipAmount':
      return {
        ...state,
        tipAmount: action.payload
      };
    case 'changeSavedCredentialId':
      return {
        ...state,
        savedCredentialId: action.payload
      };
    case 'resetState':
      return {
        ...INITIAL_STATE
      };
    default:
      return state;
  }
};
const usePaymentReducer = () => {
  return (0,_useReducer__WEBPACK_IMPORTED_MODULE_0__["default"])(reducer, INITIAL_STATE);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (usePaymentReducer);

/***/ }),

/***/ "./src/hooks/reducers/useTwoFaReducer.ts":
/*!***********************************************!*\
  !*** ./src/hooks/reducers/useTwoFaReducer.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _useReducer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../useReducer */ "./src/hooks/useReducer.ts");

const INITIAL_STATE = {
  currentPassword: '',
  password: '',
  hint: '',
  email: ''
};
const twoFaReducer = (state, action) => {
  switch (action.type) {
    case 'setCurrentPassword':
      return {
        ...state,
        currentPassword: action.payload
      };
    case 'setPassword':
      return {
        ...state,
        password: action.payload
      };
    case 'setHint':
      return {
        ...state,
        hint: action.payload
      };
    case 'setEmail':
      return {
        ...state,
        email: action.payload
      };
    case 'reset':
      return INITIAL_STATE;
    default:
      return state;
  }
};
const useTwoFaReducer = () => {
  return (0,_useReducer__WEBPACK_IMPORTED_MODULE_0__["default"])(twoFaReducer, INITIAL_STATE);
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (useTwoFaReducer);

/***/ }),

/***/ "./src/hooks/useBlur.ts":
/*!******************************!*\
  !*** ./src/hooks/useBlur.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useBlur)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _lib_fastBlur__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/fastBlur */ "./src/lib/fastBlur.js");
/* harmony import */ var _util_files__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/files */ "./src/util/files.ts");
/* harmony import */ var _useForceUpdate__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./useForceUpdate */ "./src/hooks/useForceUpdate.ts");




const RADIUS = 2;
const ITERATIONS = 2;
const MAX_CACHE_SIZE = 1000;
const cache = new Map();
function useBlur(dataUri, isDisabled = false, delay) {
  const blurredRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(dataUri ? cache.get(dataUri) : undefined);
  const timeoutRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const forceUpdate = (0,_useForceUpdate__WEBPACK_IMPORTED_MODULE_3__["default"])();
  if (timeoutRef.current && isDisabled) {
    clearTimeout(timeoutRef.current);
    timeoutRef.current = undefined;
  }
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!dataUri || blurredRef.current || isDisabled) {
      return;
    }
    const img = new Image();
    img.onload = () => {
      const canvas = (0,_util_files__WEBPACK_IMPORTED_MODULE_2__.imgToCanvas)(img);
      (0,_lib_fastBlur__WEBPACK_IMPORTED_MODULE_1__["default"])(canvas.getContext('2d'), 0, 0, canvas.width, canvas.height, RADIUS, ITERATIONS);
      const blurredDataUri = canvas.toDataURL();
      blurredRef.current = blurredDataUri;
      forceUpdate();
      if (cache.size >= MAX_CACHE_SIZE) {
        cache.clear();
      }
      cache.set(dataUri, blurredDataUri);
    };
    if (delay) {
      timeoutRef.current = window.setTimeout(() => {
        img.src = dataUri;
      }, delay);
    } else {
      img.src = dataUri;
    }
  }, [dataUri, delay, forceUpdate, isDisabled]);
  return blurredRef.current;
}

/***/ }),

/***/ "./src/hooks/useBlurSync.ts":
/*!**********************************!*\
  !*** ./src/hooks/useBlurSync.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useBlurSync)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _lib_fastBlur__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/fastBlur */ "./src/lib/fastBlur.js");
/* harmony import */ var _util_files__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/files */ "./src/util/files.ts");
/* harmony import */ var _useBlur__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./useBlur */ "./src/hooks/useBlur.ts");
/* harmony import */ var _useSyncEffect__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./useSyncEffect */ "./src/hooks/useSyncEffect.ts");





const RADIUS = 2;
const ITERATIONS = 2;
function useBlurSync(dataUri) {
  const blurredRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  let isChanged = false;
  (0,_useSyncEffect__WEBPACK_IMPORTED_MODULE_4__["default"])(() => {
    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps
    isChanged = true;
    blurredRef.current = undefined;
    if (!dataUri) {
      return;
    }
    const img = new Image();
    img.src = dataUri;
    if (!img.width) {
      return;
    }
    const canvas = (0,_util_files__WEBPACK_IMPORTED_MODULE_2__.imgToCanvas)(img);
    (0,_lib_fastBlur__WEBPACK_IMPORTED_MODULE_1__["default"])(canvas.getContext('2d'), 0, 0, canvas.width, canvas.height, RADIUS, ITERATIONS);
    blurredRef.current = canvas.toDataURL();
  }, [dataUri]);

  // Sometimes `Image` do not manage to load synchronously,
  // so we fall back the non-blurred variant and prepare the async one at least for the next time
  const blurredAsync = (0,_useBlur__WEBPACK_IMPORTED_MODULE_3__["default"])(dataUri || undefined, Boolean(blurredRef.current));
  return blurredRef.current || !isChanged && blurredAsync || dataUri || undefined;
}

/***/ }),

/***/ "./src/hooks/useCurrentTimeSignal.ts":
/*!*******************************************!*\
  !*** ./src/hooks/useCurrentTimeSignal.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useCurrentTimeSignal),
/* harmony export */   getCurrentTime: () => (/* binding */ getCurrentTime),
/* harmony export */   setCurrentTime: () => (/* binding */ setCurrentTime)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _util_signals__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/signals */ "./src/util/signals.ts");


const [getCurrentTime, setCurrentTime] = (0,_util_signals__WEBPACK_IMPORTED_MODULE_1__.createSignal)(0);
function useCurrentTimeSignal() {
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useUnmountCleanup)(() => {
    setCurrentTime(0);
  });
  return [getCurrentTime, setCurrentTime];
}

/***/ }),

/***/ "./src/hooks/useDraggable.ts":
/*!***********************************!*\
  !*** ./src/hooks/useDraggable.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ResizeHandleType: () => (/* binding */ ResizeHandleType),
/* harmony export */   "default": () => (/* binding */ useDraggable)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../config */ "./src/config.ts");
/* harmony import */ var _util_buildStyle__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/buildStyle */ "./src/util/buildStyle.ts");
/* harmony import */ var _util_captureEvents__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/captureEvents */ "./src/util/captureEvents.ts");
/* harmony import */ var _useFlag__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./useFlag */ "./src/hooks/useFlag.ts");
/* harmony import */ var _useLastCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./useLastCallback */ "./src/hooks/useLastCallback.ts");






let ResizeHandleType = /*#__PURE__*/function (ResizeHandleType) {
  ResizeHandleType[ResizeHandleType["Top"] = 0] = "Top";
  ResizeHandleType[ResizeHandleType["Bottom"] = 1] = "Bottom";
  ResizeHandleType[ResizeHandleType["Left"] = 2] = "Left";
  ResizeHandleType[ResizeHandleType["Right"] = 3] = "Right";
  ResizeHandleType[ResizeHandleType["TopLeft"] = 4] = "TopLeft";
  ResizeHandleType[ResizeHandleType["TopRight"] = 5] = "TopRight";
  ResizeHandleType[ResizeHandleType["BottomLeft"] = 6] = "BottomLeft";
  ResizeHandleType[ResizeHandleType["BottomRight"] = 7] = "BottomRight";
  return ResizeHandleType;
}({});
const resizeHandleSelectorsMap = {
  top: ResizeHandleType.Top,
  bottom: ResizeHandleType.Bottom,
  left: ResizeHandleType.Left,
  right: ResizeHandleType.Right,
  topLeft: ResizeHandleType.TopLeft,
  topRight: ResizeHandleType.TopRight,
  bottomLeft: ResizeHandleType.BottomLeft,
  bottomRight: ResizeHandleType.BottomRight
};
const resizeHandleSelectors = Object.keys(resizeHandleSelectorsMap);
let resizeTimeout;
const FULLSCREEN_POSITION = {
  x: 0,
  y: 0
};
function useDraggable(ref, dragHandleElementRef, isDragEnabled = true, originalSize, isFullscreen = false, minimumSize = {
  width: 0,
  height: 0
}, cachedPosition) {
  const [elementCurrentPosition, setElementCurrentPosition] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(cachedPosition);
  const [elementCurrentSize, setElementCurrentSize] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  const [getElementPositionOnStartTransform, setElementPositionOnStartTransform] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)({
    x: 0,
    y: 0
  });
  const [getElementSizeOnStartTransform, setElementSizeOnStartTransform] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)({
    width: 0,
    height: 0
  });
  const [getTransformStartPoint, setTransformStartPoint] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useSignal)({
    x: 0,
    y: 0
  });
  const elementPositionOnStartTransform = getElementPositionOnStartTransform();
  const transformStartPoint = getTransformStartPoint();
  const element = ref.current;
  const dragHandleElement = dragHandleElementRef.current;
  const [isInitiated, setIsInitiated] = (0,_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])(false);
  const [wasElementShown, setWasElementShown] = (0,_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])(false);
  const [isDragging, startDragging, stopDragging] = (0,_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])(false);
  const [isResizing, startResizing, stopResizing] = (0,_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])(false);
  const [isWindowsResizing, startWindowResizing, stopWindowResizing] = (0,_useFlag__WEBPACK_IMPORTED_MODULE_4__["default"])(false);
  const [hitResizeHandle, setHitResizeHandle] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  function getVisibleArea() {
    return {
      width: window.innerWidth,
      height: window.innerHeight
    };
  }
  const updateCurrentPosition = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(position => {
    if (!isFullscreen) setElementCurrentPosition({
      x: position.x,
      y: position.y
    });
  });
  const getActualPosition = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    return isFullscreen ? FULLSCREEN_POSITION : elementCurrentPosition;
  });
  const getCenteredPosition = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    if (!elementCurrentSize) return undefined;
    const {
      width,
      height
    } = elementCurrentSize;
    const visibleArea = getVisibleArea();
    const viewportWidth = visibleArea.width;
    const viewportHeight = visibleArea.height;
    const centeredX = (viewportWidth - width) / 2;
    const centeredY = (viewportHeight - height) / 2;
    return {
      x: centeredX,
      y: centeredY
    };
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (element) setWasElementShown();
  }, [element]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isInitiated && elementCurrentSize) {
      const centeredPosition = getCenteredPosition();
      if (!centeredPosition) return;
      updateCurrentPosition(centeredPosition);
      setIsInitiated();
    }
  }, [elementCurrentSize, isInitiated, element]);
  const handleStartDrag = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(event => {
    if (event instanceof MouseEvent && event.button !== 0) {
      return;
    }
    const targetElement = event.target;
    if (targetElement.closest('.no-drag') || !element) {
      return;
    }
    const {
      pageX,
      pageY
    } = 'touches' in event ? event.touches[0] : event;
    const {
      left,
      top
    } = element.getBoundingClientRect();
    setElementPositionOnStartTransform({
      x: left,
      y: top
    });
    setTransformStartPoint({
      x: pageX,
      y: pageY
    });
    startDragging();
  });
  function getResizeHandleFromTarget(targetElement) {
    const closest = selector => targetElement.closest(selector);
    if (!closest(_config__WEBPACK_IMPORTED_MODULE_1__.RESIZE_HANDLE_SELECTOR)) return undefined;
    for (const selector of resizeHandleSelectors) {
      if (closest(`.${selector}`)) {
        return resizeHandleSelectorsMap[selector];
      }
    }
    return undefined;
  }
  const handleStartResize = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(event => {
    if (event instanceof MouseEvent && event.button !== 0) {
      return;
    }
    const targetElement = event.target;
    if (!element || !targetElement) {
      return;
    }
    const resizeHandle = getResizeHandleFromTarget(targetElement);
    if (resizeHandle === undefined) return;
    setHitResizeHandle(resizeHandle);
    const {
      pageX,
      pageY
    } = 'touches' in event ? event.touches[0] : event;
    const {
      left,
      right,
      top,
      bottom
    } = element.getBoundingClientRect();
    setElementPositionOnStartTransform({
      x: left,
      y: top
    });
    setElementSizeOnStartTransform({
      width: right - left,
      height: bottom - top
    });
    setTransformStartPoint({
      x: pageX,
      y: pageY
    });
    startResizing();
  });
  const handleDragRelease = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    stopDragging();
  });
  const handleResizeRelease = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    stopResizing();
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (!isDragEnabled) {
      stopDragging();
    }
  }, [isDragEnabled]);
  const ensurePositionInVisibleArea = (x, y) => {
    const visibleArea = getVisibleArea();
    const visibleAreaWidth = visibleArea.width;
    const visibleAreaHeight = visibleArea.height;
    const componentWidth = elementCurrentSize.width;
    const componentHeight = elementCurrentSize.height;
    let newX = x;
    let newY = y;
    if (newX < 0) newX = 0;
    if (newY < 0) newY = 0;
    if (newX + componentWidth > visibleAreaWidth) newX = visibleAreaWidth - componentWidth;
    if (newY + componentHeight > visibleAreaHeight) newY = visibleAreaHeight - componentHeight;
    return {
      x: newX,
      y: newY
    };
  };
  const adjustPositionWithinBounds = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    if (isFullscreen) return;
    const position = !wasElementShown && !cachedPosition ? getCenteredPosition() : elementCurrentPosition;
    if (!elementCurrentSize || !position) return;
    const newPosition = ensurePositionInVisibleArea(position.x, position.y);
    updateCurrentPosition(newPosition);
  });
  const ensureSizeInVisibleArea = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(sizeForCheck => {
    const newSize = sizeForCheck;
    const visibleArea = getVisibleArea();
    const originalWidth = originalSize.width;
    const originalHeight = originalSize.height;
    newSize.width = Math.min(visibleArea.width, Math.max(originalWidth, newSize.width));
    newSize.height = Math.min(visibleArea.height, Math.max(originalHeight, newSize.height));
    return newSize;
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isResizing) return;
    const newSize = ensureSizeInVisibleArea({
      width: originalSize.width,
      height: originalSize.height
    });
    if (newSize) setElementCurrentSize(newSize);
  }, [originalSize, isResizing]);
  const adjustSizeWithinBounds = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(() => {
    if (!elementCurrentSize || isResizing) return;
    const newSize = ensureSizeInVisibleArea(elementCurrentSize);
    if (newSize) setElementCurrentSize(newSize);
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (isResizing) return;
    adjustPositionWithinBounds();
  }, [elementCurrentSize, isResizing]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const handleWindowResize = () => {
      startWindowResizing();
      adjustSizeWithinBounds();
      adjustPositionWithinBounds();
      if (resizeTimeout) {
        clearTimeout(resizeTimeout);
        resizeTimeout = undefined;
      }
      resizeTimeout = window.setTimeout(() => {
        resizeTimeout = undefined;
        stopWindowResizing();
      }, 250);
    };
    window.addEventListener('resize', handleWindowResize);
    return () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = undefined;
      window.removeEventListener('resize', handleWindowResize);
    };
  }, [adjustPositionWithinBounds]);
  const handleDrag = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(event => {
    if (!isDragging || !element) return;
    const {
      pageX,
      pageY
    } = 'touches' in event ? event.touches[0] : event;
    const offsetX = pageX - transformStartPoint.x;
    const offsetY = pageY - transformStartPoint.y;
    const newX = elementPositionOnStartTransform.x + offsetX;
    const newY = elementPositionOnStartTransform.y + offsetY;
    if (elementCurrentSize) setElementCurrentPosition(ensurePositionInVisibleArea(newX, newY));
  });
  const handleResize = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_5__["default"])(event => {
    if (!isResizing || !element || hitResizeHandle === undefined) return;
    const {
      pageX,
      pageY
    } = 'touches' in event ? event.touches[0] : event;
    const sizeOnStartTransform = getElementSizeOnStartTransform();
    const pageVisibleX = Math.min(Math.max(0, pageX), getVisibleArea().width);
    const pageVisibleY = Math.min(Math.max(0, pageY), getVisibleArea().height);
    const offsetX = pageVisibleX - transformStartPoint.x;
    const offsetY = pageVisibleY - transformStartPoint.y;
    const maxX = elementPositionOnStartTransform.x + sizeOnStartTransform.width - minimumSize.width;
    const maxY = elementPositionOnStartTransform.y + sizeOnStartTransform.height - minimumSize.height;
    const originalBounds = {
      x: elementPositionOnStartTransform.x,
      y: elementPositionOnStartTransform.y,
      width: sizeOnStartTransform.width,
      height: sizeOnStartTransform.height
    };
    const newBounds = {
      ...originalBounds
    };
    if (hitResizeHandle === ResizeHandleType.Left || hitResizeHandle === ResizeHandleType.TopLeft || hitResizeHandle === ResizeHandleType.BottomLeft) {
      newBounds.width = Math.max(sizeOnStartTransform.width - offsetX, minimumSize.width);
      newBounds.x = Math.min(newBounds.x + offsetX, maxX);
    }
    if (hitResizeHandle === ResizeHandleType.Right || hitResizeHandle === ResizeHandleType.TopRight || hitResizeHandle === ResizeHandleType.BottomRight) {
      newBounds.width = Math.max(sizeOnStartTransform.width + offsetX, minimumSize.width);
    }
    if (hitResizeHandle === ResizeHandleType.Top || hitResizeHandle === ResizeHandleType.TopLeft || hitResizeHandle === ResizeHandleType.TopRight) {
      newBounds.height = Math.max(sizeOnStartTransform.height - offsetY, minimumSize.height);
      newBounds.y = Math.min(newBounds.y + offsetY, maxY);
    }
    if (hitResizeHandle === ResizeHandleType.Bottom || hitResizeHandle === ResizeHandleType.BottomLeft || hitResizeHandle === ResizeHandleType.BottomRight) {
      newBounds.height = Math.max(sizeOnStartTransform.height + offsetY, minimumSize.height);
    }
    setElementCurrentSize({
      width: newBounds.width,
      height: newBounds.height
    });
    setElementCurrentPosition({
      x: newBounds.x,
      y: newBounds.y
    });
  });
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    let cleanup;
    if (dragHandleElement && isDragEnabled) {
      cleanup = (0,_util_captureEvents__WEBPACK_IMPORTED_MODULE_3__.captureEvents)(dragHandleElement, {
        onCapture: handleStartDrag,
        onDrag: handleDrag,
        onRelease: handleDragRelease,
        onClick: handleDragRelease,
        onDoubleClick: handleDragRelease
      });
    }
    return cleanup;
  }, [isDragEnabled, dragHandleElement]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const cleanups = [];
    if (element && isDragEnabled) {
      for (const selector of resizeHandleSelectors) {
        const resizeHandler = element.querySelector(`.resizeHandle.${selector}`);
        if (resizeHandler) {
          const cleanup = (0,_util_captureEvents__WEBPACK_IMPORTED_MODULE_3__.captureEvents)(resizeHandler, {
            onCapture: handleStartResize,
            onDrag: handleResize,
            onRelease: handleResizeRelease,
            onClick: handleResizeRelease,
            onDoubleClick: handleResizeRelease
          });
          if (cleanup) {
            cleanups.push(cleanup);
          }
        }
      }
    }
    return () => {
      cleanups.forEach(cleanup => cleanup());
    };
  }, [isDragEnabled, element]);
  const cursorStyle = isDragging ? 'cursor: grabbing !important; ' : '';
  const actualPosition = getActualPosition();
  if (!isInitiated || !elementCurrentSize || !actualPosition) {
    return {
      isDragging: false,
      style: cursorStyle
    };
  }
  const style = (0,_util_buildStyle__WEBPACK_IMPORTED_MODULE_2__["default"])(`left: ${actualPosition.x}px;`, `top: ${actualPosition.y}px;`, !isFullscreen && `max-width: ${elementCurrentSize.width}px;`, !isFullscreen && `max-height: ${elementCurrentSize.height}px;`, 'position: fixed;', (isDragging || isResizing || isWindowsResizing) && 'transition: none !important;', cursorStyle);
  return {
    position: elementCurrentPosition,
    size: elementCurrentSize,
    isDragging,
    isResizing,
    style
  };
}

/***/ }),

/***/ "./src/hooks/useFocusAfterAnimation.ts":
/*!*********************************************!*\
  !*** ./src/hooks/useFocusAfterAnimation.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useFocusAfterAnimation)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/windowEnvironment */ "./src/util/windowEnvironment.ts");



const DEFAULT_DURATION = 300;
function useFocusAfterAnimation(ref, animationDuration = DEFAULT_DURATION) {
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_TOUCH_ENV) {
      return;
    }
    setTimeout(() => {
      (0,_lib_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_1__.requestMeasure)(() => {
        ref.current?.focus();
      });
    }, animationDuration);
  }, [ref, animationDuration]);
}

/***/ }),

/***/ "./src/hooks/useMultiClick.ts":
/*!************************************!*\
  !*** ./src/hooks/useMultiClick.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useMultiClick)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");

const CLICK_TIMEOUT = 300;
function useMultiClick(amount, callback) {
  const currentAmountRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(0);
  const timeoutRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  const handleClick = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    currentAmountRef.current++;
    if (currentAmountRef.current === amount) {
      currentAmountRef.current = 0;
      callback();
      return;
    }
    if (timeoutRef.current) {
      clearTimeout(timeoutRef.current);
    }
    timeoutRef.current = setTimeout(() => {
      currentAmountRef.current = 0;
    }, CLICK_TIMEOUT);
  }, [amount, callback]);
  return handleClick;
}

/***/ }),

/***/ "./src/hooks/usePictureInPicture.ts":
/*!******************************************!*\
  !*** ./src/hooks/usePictureInPicture.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ usePictureInPicture),
/* harmony export */   exitPictureInPictureIfNeeded: () => (/* binding */ exitPictureInPictureIfNeeded),
/* harmony export */   usePictureInPictureSignal: () => (/* binding */ usePictureInPictureSignal)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../config */ "./src/config.ts");
/* harmony import */ var _util_safePlay__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/safePlay */ "./src/util/safePlay.ts");
/* harmony import */ var _util_signals__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/signals */ "./src/util/signals.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/windowEnvironment */ "./src/util/windowEnvironment.ts");





const signal = (0,_util_signals__WEBPACK_IMPORTED_MODULE_3__.createSignal)(false);
const setIsPictureInPicture = signal[1];
function usePictureInPictureSignal() {
  return signal;
}
function usePictureInPicture(elRef, onEnter, onLeave) {
  const [isSupported, setIsSupported] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [isActive, setIsActive] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {
    // PIP is not supported in PWA on iOS, despite being detected
    if (_util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_IOS && _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_4__.IS_PWA || !elRef.current) return undefined;
    const video = elRef.current;
    const setMode = getSetPresentationMode(video);
    const isEnabled = document.pictureInPictureEnabled && !elRef.current?.disablePictureInPicture || setMode !== undefined;
    if (!isEnabled) return undefined;
    // @ts-ignore
    video.autoPictureInPicture = true;
    setIsSupported(true);
    const onEnterInternal = () => {
      onEnter();
      setIsActive(true);
      setIsPictureInPicture(true);
    };
    const onLeaveInternal = () => {
      setIsPictureInPicture(false);
      setIsActive(false);
      onLeave();
    };
    video.addEventListener('enterpictureinpicture', onEnterInternal);
    video.addEventListener('leavepictureinpicture', onLeaveInternal);
    return () => {
      video.removeEventListener('enterpictureinpicture', onEnterInternal);
      video.removeEventListener('leavepictureinpicture', onLeaveInternal);
    };
  }, [elRef, onEnter, onLeave]);
  const exitPictureInPicture = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!elRef.current) return;
    const video = elRef.current;
    const setMode = getSetPresentationMode(video);
    if (setMode) {
      setMode('inline');
    } else {
      exitPictureInPictureIfNeeded();
    }
  }, [elRef]);
  const enterPictureInPicture = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {
    if (!elRef.current) return;
    exitPictureInPicture();
    const video = elRef.current;
    const isPlaying = (0,_util_safePlay__WEBPACK_IMPORTED_MODULE_2__.getIsVideoPlaying)(video);
    const setMode = getSetPresentationMode(video);
    if (setMode) {
      setMode('picture-in-picture');
    } else {
      requestPictureInPicture(video);
    }
    // Muted video stops in PiP mode, so we need to play it again
    if (isPlaying) {
      (0,_util_safePlay__WEBPACK_IMPORTED_MODULE_2__["default"])(video);
    }
  }, [elRef, exitPictureInPicture]);
  if (!isSupported) {
    return [false];
  }
  return [isSupported, enterPictureInPicture, isActive];
}
function getSetPresentationMode(video) {
  // @ts-ignore
  if (video.webkitSupportsPresentationMode && typeof video.webkitSetPresentationMode === 'function') {
    // @ts-ignore
    return video.webkitSetPresentationMode.bind(video);
  }
  return undefined;
}
function requestPictureInPicture(video) {
  if (video.requestPictureInPicture) {
    try {
      video.requestPictureInPicture();
    } catch (err) {
      if (_config__WEBPACK_IMPORTED_MODULE_1__.DEBUG) {
        // eslint-disable-next-line no-console
        console.log('[MV] PictureInPicture Error', err);
      }
    }
  }
}
function exitPictureInPictureIfNeeded() {
  if (document.pictureInPictureElement) {
    try {
      document.exitPictureInPicture();
    } catch (err) {
      if (_config__WEBPACK_IMPORTED_MODULE_1__.DEBUG) {
        // eslint-disable-next-line no-console
        console.log('[MV] PictureInPicture Error', err);
      }
    }
  }
}

/***/ }),

/***/ "./src/hooks/useScrolledState.ts":
/*!***************************************!*\
  !*** ./src/hooks/useScrolledState.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useScrolledState)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _useLastCallback__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./useLastCallback */ "./src/hooks/useLastCallback.ts");


const THRESHOLD = 5;
function useScrolledState(threshold = THRESHOLD) {
  const [isAtBeginning, setIsAtBeginning] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const [isAtEnd, setIsAtEnd] = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
  const handleScroll = (0,_useLastCallback__WEBPACK_IMPORTED_MODULE_1__["default"])(e => {
    const {
      scrollHeight,
      scrollTop,
      clientHeight
    } = e.target;
    setIsAtBeginning(scrollTop < threshold);
    setIsAtEnd(scrollHeight - scrollTop - clientHeight < threshold);
  });
  return {
    isAtBeginning,
    isAtEnd,
    handleScroll
  };
}

/***/ }),

/***/ "./src/hooks/useSelectWithEnter.ts":
/*!*****************************************!*\
  !*** ./src/hooks/useSelectWithEnter.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");

const useSendWithEnter = onSelect => {
  // eslint-disable-next-line no-null/no-null
  const buttonRef = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  const handleKeyDown = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useCallback)(e => {
    if (e.key !== 'Enter') return;
    const isFocused = buttonRef.current === document.activeElement;
    if (isFocused) {
      onSelect();
    }
  }, [onSelect]);
  (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    window.addEventListener('keydown', handleKeyDown, false);
    return () => window.removeEventListener('keydown', handleKeyDown, false);
  }, [handleKeyDown]);
  return buttonRef;
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (useSendWithEnter);

/***/ }),

/***/ "./src/hooks/useSignalRef.ts":
/*!***********************************!*\
  !*** ./src/hooks/useSignalRef.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   useSignalRef: () => (/* binding */ useSignalRef)
/* harmony export */ });
/* harmony import */ var _lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/teact/teact */ "./src/lib/teact/teact.ts");
/* harmony import */ var _useEffectOnce__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./useEffectOnce */ "./src/hooks/useEffectOnce.ts");



// Allows to use signal value as "silent" dependency in hooks (not causing updates)
function useSignalRef(getValue) {
  const ref = (0,_lib_teact_teact__WEBPACK_IMPORTED_MODULE_0__.useRef)(getValue());
  (0,_useEffectOnce__WEBPACK_IMPORTED_MODULE_1__["default"])(() => {
    return getValue.subscribe(() => {
      ref.current = getValue();
    });
  });
  return ref;
}

/***/ }),

/***/ "./src/lib/video-preview/VideoPreview.ts":
/*!***********************************************!*\
  !*** ./src/lib/video-preview/VideoPreview.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   VideoPreview: () => (/* binding */ VideoPreview),
/* harmony export */   createVideoPreviews: () => (/* binding */ createVideoPreviews),
/* harmony export */   getPreviewDimensions: () => (/* binding */ getPreviewDimensions),
/* harmony export */   renderVideoPreview: () => (/* binding */ renderVideoPreview)
/* harmony export */ });
/* harmony import */ var _api_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../api/types */ "./src/api/types/index.ts");
/* harmony import */ var _util_launchMediaWorkers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/launchMediaWorkers */ "./src/util/launchMediaWorkers.ts");
/* harmony import */ var _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/windowEnvironment */ "./src/util/windowEnvironment.ts");
/* harmony import */ var _api_gramjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../api/gramjs */ "./src/api/gramjs/index.ts");
/* harmony import */ var _fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../fasterdom/fasterdom */ "./src/lib/fasterdom/fasterdom.ts");
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }





const IS_MOBILE = _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_ANDROID || _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_IOS;
const PREVIEW_SIZE_RATIO = _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_ANDROID || _util_windowEnvironment__WEBPACK_IMPORTED_MODULE_2__.IS_IOS ? 0.3 : 0.25;
const MAX_FRAMES = IS_MOBILE ? 40 : 80;
const PREVIEW_MAX_SIDE = 200;
const connections = (0,_util_launchMediaWorkers__WEBPACK_IMPORTED_MODULE_1__["default"])();
let videoPreview;
class VideoPreview {
  constructor(url, canvas) {
    _defineProperty(this, "frames", new Map());
    _defineProperty(this, "currentTime", 0);
    _defineProperty(this, "canvas", void 0);
    this.canvas = canvas;
    connections.forEach(({
      connector
    }, index) => {
      void connector.request({
        name: 'video-preview:init',
        args: [url, MAX_FRAMES, index, _util_launchMediaWorkers__WEBPACK_IMPORTED_MODULE_1__.MAX_WORKERS, this.onFrame.bind(this)]
      });
    });
  }
  onFrame(time, frame) {
    this.frames.set(time, frame);
    if (time === this.currentTime) {
      this.render(time);
    }
  }
  clearCache() {
    this.frames.forEach(frame => {
      frame.close();
    });
    this.frames.clear();
  }
  render(time) {
    this.currentTime = time;
    const frame = this.frames.get(time);
    if (!frame) return false;
    (0,_fasterdom_fasterdom__WEBPACK_IMPORTED_MODULE_4__.requestMutation)(() => {
      this.canvas.width = frame.width;
      this.canvas.height = frame.height;
      const ctx = this.canvas.getContext('2d');
      ctx.drawImage(frame, 0, 0, this.canvas.width, this.canvas.height);
    });
    return true;
  }
  destroy() {
    this.clearCache();
    connections.forEach(({
      connector
    }) => {
      void connector.request({
        name: 'video-preview:destroy',
        args: []
      });
    });
  }
}
function getPreviewDimensions(width, height) {
  width = Math.round(width * PREVIEW_SIZE_RATIO);
  height = Math.round(height * PREVIEW_SIZE_RATIO);
  const ratio = width / height;
  if (width > PREVIEW_MAX_SIDE) {
    width = PREVIEW_MAX_SIDE;
    height = Math.round(width / ratio);
  }
  if (height > PREVIEW_MAX_SIDE) {
    height = PREVIEW_MAX_SIDE;
    width = Math.round(height * ratio);
  }
  return {
    width,
    height
  };
}
connections.forEach(({
  worker
}) => {
  worker.addEventListener('message', async e => {
    const {
      type,
      messageId,
      params
    } = e.data;
    if (type !== 'requestPart') {
      return;
    }
    const result = await (0,_api_gramjs__WEBPACK_IMPORTED_MODULE_3__.callApi)('downloadMedia', {
      mediaFormat: _api_types__WEBPACK_IMPORTED_MODULE_0__.ApiMediaFormat.Progressive,
      ...params
    });
    if (!result) {
      return;
    }
    const {
      arrayBuffer
    } = result;
    worker.postMessage({
      type: 'partResponse',
      messageId,
      result: arrayBuffer
    }, [arrayBuffer]);
  });
});
function createVideoPreviews(url, canvas) {
  if (videoPreview) {
    videoPreview.destroy();
  }
  videoPreview = new VideoPreview(url, canvas);
  return () => {
    videoPreview?.destroy();
    videoPreview = undefined;
  };
}
function renderVideoPreview(time) {
  if (!videoPreview) return false;
  return videoPreview.render(time);
}

/***/ }),

/***/ "./src/util/findInViewport.ts":
/*!************************************!*\
  !*** ./src/util/findInViewport.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ findInViewport)
/* harmony export */ });
function findInViewport(container, selectorOrElements, margin = 0, isDense = false, shouldContainBottom = false, isHorizontal = false) {
  const viewportY1 = container[isHorizontal ? 'scrollLeft' : 'scrollTop'];
  const viewportY2 = viewportY1 + container[isHorizontal ? 'offsetWidth' : 'offsetHeight'];
  const allElements = typeof selectorOrElements === 'string' ? container.querySelectorAll(selectorOrElements) : selectorOrElements;
  const {
    length
  } = allElements;
  const visibleIndexes = [];
  let isFound = false;
  for (let i = 0; i < length; i++) {
    const element = allElements[i];
    const y1 = element[isHorizontal ? 'offsetLeft' : 'offsetTop'];
    const y2 = y1 + element[isHorizontal ? 'offsetWidth' : 'offsetHeight'];
    const isVisible = shouldContainBottom ? y2 >= viewportY1 - margin && y2 <= viewportY2 + margin : y1 <= viewportY2 + margin && y2 >= viewportY1 - margin;
    if (isVisible) {
      visibleIndexes.push(i);
      isFound = true;
    } else if (isFound && !isDense) {
      break;
    }
  }
  return {
    allElements,
    visibleIndexes
  };
}

/***/ }),

/***/ "./src/util/getKeyFromEvent.ts":
/*!*************************************!*\
  !*** ./src/util/getKeyFromEvent.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ getKeyFromEvent)
/* harmony export */ });
function getKeyFromEvent(e) {
  const key = e.key || e.code;
  return key.startsWith('Key') ? key.slice(3).toLowerCase() : key;
}

/***/ }),

/***/ "./src/util/scrollLock.ts":
/*!********************************!*\
  !*** ./src/util/scrollLock.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   disableScrolling: () => (/* binding */ disableScrolling),
/* harmony export */   enableScrolling: () => (/* binding */ enableScrolling),
/* harmony export */   getTouchY: () => (/* binding */ getTouchY)
/* harmony export */ });
let scrollLockEl;
let excludedClosestSelector;
const IGNORED_KEYS = {
  Down: true,
  ArrowDown: true,
  Up: true,
  ArrowUp: true,
  Left: true,
  ArrowLeft: true,
  Right: true,
  ArrowRight: true,
  ' ': true,
  PageUp: true,
  PageDown: true,
  End: true,
  Home: true,
  Tab: true
};
function isTextBox(target) {
  if (!target || !(target instanceof HTMLElement)) return false;
  const element = target;
  const tagName = element.tagName.toLowerCase();
  if (tagName === 'textarea') return true;
  if (tagName !== 'input') return false;
  const type = element.getAttribute('type');
  if (!type) return false;
  const inputTypes = ['text', 'password', 'number', 'email', 'tel', 'url', 'search', 'date', 'datetime', 'datetime-local', 'time', 'month', 'week'];
  return inputTypes.indexOf(type.toLowerCase()) > -1;
}
const getTouchY = e => {
  return 'changedTouches' in e ? e.changedTouches[0].clientY : 0;
};
const preventDefault = e => {
  const deltaY = 'deltaY' in e ? e.deltaY : getTouchY(e);
  if (!scrollLockEl
  // Allow overlay scrolling
  || !scrollLockEl.contains(e.target)
  // Prevent top overscroll
  || scrollLockEl.scrollTop <= 0 && deltaY <= 0
  // Prevent bottom overscroll
  || scrollLockEl.scrollTop >= scrollLockEl.scrollHeight - scrollLockEl.offsetHeight && deltaY >= 0) {
    if (excludedClosestSelector && e.target.closest(excludedClosestSelector)) return;
    e.preventDefault();
  }
};
function preventDefaultForScrollKeys(e) {
  if (IGNORED_KEYS[e.key] && !isTextBox(e.target)) {
    e.preventDefault();
  }
}
function disableScrolling(el, _excludedClosestSelector) {
  scrollLockEl = el;
  excludedClosestSelector = _excludedClosestSelector;
  // Disable scrolling in Chrome
  document.addEventListener('wheel', preventDefault, {
    passive: false
  });
  document.addEventListener('touchmove', preventDefault, {
    passive: false
  });
  document.onkeydown = preventDefaultForScrollKeys;
  return enableScrolling;
}
function enableScrolling() {
  scrollLockEl = undefined;
  excludedClosestSelector = undefined;
  document.removeEventListener('wheel', preventDefault); // Enable scrolling in Chrome
  document.removeEventListener('touchmove', preventDefault);
  // eslint-disable-next-line no-null/no-null
  document.onkeydown = null;
}

/***/ }),

/***/ "./src/util/setTooltipItemVisible.ts":
/*!*******************************************!*\
  !*** ./src/util/setTooltipItemVisible.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ setTooltipItemVisible)
/* harmony export */ });
/* harmony import */ var _visibility_isFullyVisible__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./visibility/isFullyVisible */ "./src/util/visibility/isFullyVisible.ts");
/* harmony import */ var _animateScroll__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./animateScroll */ "./src/util/animateScroll.ts");
/* harmony import */ var _findInViewport__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./findInViewport */ "./src/util/findInViewport.ts");



const VIEWPORT_MARGIN = 8;
const SCROLL_MARGIN = 10;
function setTooltipItemVisible(selector, index, containerRef) {
  const container = containerRef.current;
  if (!container || index < 0) {
    return;
  }
  const {
    visibleIndexes,
    allElements
  } = (0,_findInViewport__WEBPACK_IMPORTED_MODULE_2__["default"])(container, selector, VIEWPORT_MARGIN, true, true);
  if (!allElements.length || !allElements[index]) {
    return;
  }
  const first = visibleIndexes[0];
  if (!visibleIndexes.includes(index) || index === first && !(0,_visibility_isFullyVisible__WEBPACK_IMPORTED_MODULE_0__["default"])(container, allElements[first])) {
    const position = index > visibleIndexes[visibleIndexes.length - 1] ? 'start' : 'end';
    (0,_animateScroll__WEBPACK_IMPORTED_MODULE_1__["default"])({
      container,
      element: allElements[index],
      position,
      margin: SCROLL_MARGIN
    });
  }
}

/***/ }),

/***/ "./src/util/visibility/isFullyVisible.ts":
/*!***********************************************!*\
  !*** ./src/util/visibility/isFullyVisible.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ isFullyVisible)
/* harmony export */ });
function isFullyVisible(container, element, isHorizontal = false) {
  const viewportY1 = container[isHorizontal ? 'scrollLeft' : 'scrollTop'];
  const viewportY2 = viewportY1 + container[isHorizontal ? 'offsetWidth' : 'offsetHeight'];
  const y1 = element[isHorizontal ? 'offsetLeft' : 'offsetTop'];
  const y2 = y1 + element[isHorizontal ? 'offsetWidth' : 'offsetHeight'];
  return y1 > viewportY1 && y2 < viewportY2;
}

/***/ }),

/***/ "./src/components/common/AboutMonetizationModal.module.scss":
/*!******************************************************************!*\
  !*** ./src/components/common/AboutMonetizationModal.module.scss ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"title":"AboutMonetizationModal-module__title","description":"AboutMonetizationModal-module__description","toncoin":"AboutMonetizationModal-module__toncoin"});

/***/ }),

/***/ "./src/components/common/CalendarModal.scss":
/*!**************************************************!*\
  !*** ./src/components/common/CalendarModal.scss ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/common/CountryPickerModal.module.scss":
/*!**************************************************************!*\
  !*** ./src/components/common/CountryPickerModal.module.scss ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"CountryPickerModal-module__root","pickerSelector":"CountryPickerModal-module__pickerSelector","pickerTitle":"CountryPickerModal-module__pickerTitle","picker":"CountryPickerModal-module__picker","footer":"CountryPickerModal-module__footer"});

/***/ }),

/***/ "./src/components/common/CustomEmojiPicker.module.scss":
/*!*************************************************************!*\
  !*** ./src/components/common/CustomEmojiPicker.module.scss ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"CustomEmojiPicker-module__root","activated":"CustomEmojiPicker-module__activated"});

/***/ }),

/***/ "./src/components/common/CustomEmojiSetsModal.module.scss":
/*!****************************************************************!*\
  !*** ./src/components/common/CustomEmojiSetsModal.module.scss ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"CustomEmojiSetsModal-module__root","sets":"CustomEmojiSetsModal-module__sets"});

/***/ }),

/***/ "./src/components/common/DeleteMessageModal.module.scss":
/*!**************************************************************!*\
  !*** ./src/components/common/DeleteMessageModal.module.scss ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"mainContainer":"DeleteMessageModal-module__mainContainer","container":"DeleteMessageModal-module__container","title":"DeleteMessageModal-module__title","singleTitle":"DeleteMessageModal-module__singleTitle","actionTitle":"DeleteMessageModal-module__actionTitle","restrictionTitle":"DeleteMessageModal-module__restrictionTitle","listItemButton":"DeleteMessageModal-module__listItemButton","button":"DeleteMessageModal-module__button","dropdownList":"DeleteMessageModal-module__dropdownList","dialogButtons":"DeleteMessageModal-module__dialogButtons","restrictionContainer":"DeleteMessageModal-module__restrictionContainer","restrictionContainerOpen":"DeleteMessageModal-module__restrictionContainerOpen","dropdownListOpen":"DeleteMessageModal-module__dropdownListOpen"});

/***/ }),

/***/ "./src/components/common/GifButton.scss":
/*!**********************************************!*\
  !*** ./src/components/common/GifButton.scss ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/common/ManageUsernames.module.scss":
/*!***********************************************************!*\
  !*** ./src/components/common/ManageUsernames.module.scss ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"container":"ManageUsernames-module__container","header":"ManageUsernames-module__header","description":"ManageUsernames-module__description","sortableContainer":"ManageUsernames-module__sortableContainer","item":"ManageUsernames-module__item"});

/***/ }),

/***/ "./src/components/common/PasswordMonkey.scss":
/*!***************************************************!*\
  !*** ./src/components/common/PasswordMonkey.scss ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/common/PrivacySettingsNoticeModal.module.scss":
/*!**********************************************************************!*\
  !*** ./src/components/common/PrivacySettingsNoticeModal.module.scss ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"container":"PrivacySettingsNoticeModal-module__container","icon":"PrivacySettingsNoticeModal-module__icon","header":"PrivacySettingsNoticeModal-module__header","desc":"PrivacySettingsNoticeModal-module__desc","separator":"PrivacySettingsNoticeModal-module__separator","button":"PrivacySettingsNoticeModal-module__button","closeButton":"PrivacySettingsNoticeModal-module__closeButton"});

/***/ }),

/***/ "./src/components/common/SeenByModal.module.scss":
/*!*******************************************************!*\
  !*** ./src/components/common/SeenByModal.module.scss ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"modal":"SeenByModal-module__modal"});

/***/ }),

/***/ "./src/components/common/SliderDots.module.scss":
/*!******************************************************!*\
  !*** ./src/components/common/SliderDots.module.scss ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"SliderDots-module__root","arrow":"SliderDots-module__arrow","right":"SliderDots-module__right","arrow-hidden":"SliderDots-module__arrow-hidden","arrowHidden":"SliderDots-module__arrow-hidden","dot":"SliderDots-module__dot","medium":"SliderDots-module__medium","small":"SliderDots-module__small","invisible":"SliderDots-module__invisible","active":"SliderDots-module__active"});

/***/ }),

/***/ "./src/components/common/StickerButton.scss":
/*!**************************************************!*\
  !*** ./src/components/common/StickerButton.scss ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/common/StickerSetCard.scss":
/*!***************************************************!*\
  !*** ./src/components/common/StickerSetCard.scss ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/common/StickerSetModal.scss":
/*!****************************************************!*\
  !*** ./src/components/common/StickerSetModal.scss ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/common/VerificationMonetizationModal.module.scss":
/*!*************************************************************************!*\
  !*** ./src/components/common/VerificationMonetizationModal.module.scss ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"VerificationMonetizationModal-module__root","content":"VerificationMonetizationModal-module__content"});

/***/ }),

/***/ "./src/components/common/pickers/ChatOrUserPicker.scss":
/*!*************************************************************!*\
  !*** ./src/components/common/pickers/ChatOrUserPicker.scss ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/common/reactions/ReactionEmoji.module.scss":
/*!*******************************************************************!*\
  !*** ./src/components/common/reactions/ReactionEmoji.module.scss ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"ReactionEmoji-module__root","selected":"ReactionEmoji-module__selected"});

/***/ }),

/***/ "./src/components/left/ArchivedChats.scss":
/*!************************************************!*\
  !*** ./src/components/left/ArchivedChats.scss ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/ChatFolderModal.module.scss":
/*!*********************************************************!*\
  !*** ./src/components/left/ChatFolderModal.module.scss ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"modalContent":"ChatFolderModal-module__modalContent","root":"ChatFolderModal-module__root","main":"ChatFolderModal-module__main","footer":"ChatFolderModal-module__footer"});

/***/ }),

/***/ "./src/components/left/main/StatusPickerMenu.module.scss":
/*!***************************************************************!*\
  !*** ./src/components/left/main/StatusPickerMenu.module.scss ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"menuContent":"StatusPickerMenu-module__menuContent"});

/***/ }),

/***/ "./src/components/left/newChat/NewChat.scss":
/*!**************************************************!*\
  !*** ./src/components/left/newChat/NewChat.scss ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/search/ChatMessage.scss":
/*!*****************************************************!*\
  !*** ./src/components/left/search/ChatMessage.scss ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/search/ChatResults.scss":
/*!*****************************************************!*\
  !*** ./src/components/left/search/ChatResults.scss ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/search/DateSuggest.scss":
/*!*****************************************************!*\
  !*** ./src/components/left/search/DateSuggest.scss ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/search/LeftSearch.scss":
/*!****************************************************!*\
  !*** ./src/components/left/search/LeftSearch.scss ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/search/RecentContacts.scss":
/*!********************************************************!*\
  !*** ./src/components/left/search/RecentContacts.scss ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/settings/PrivacyLockedOption.module.scss":
/*!**********************************************************************!*\
  !*** ./src/components/left/settings/PrivacyLockedOption.module.scss ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"contacts_and_premium_option-title":"PrivacyLockedOption-module__contacts_and_premium_option-title","contactsAndPremiumOptionTitle":"PrivacyLockedOption-module__contacts_and_premium_option-title","lock-icon":"PrivacyLockedOption-module__lock-icon","lockIcon":"PrivacyLockedOption-module__lock-icon"});

/***/ }),

/***/ "./src/components/left/settings/Settings.scss":
/*!****************************************************!*\
  !*** ./src/components/left/settings/Settings.scss ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/settings/SettingsActiveSession.module.scss":
/*!************************************************************************!*\
  !*** ./src/components/left/settings/SettingsActiveSession.module.scss ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"SettingsActiveSession":"SettingsActiveSession-module__SettingsActiveSession","settingsActiveSession":"SettingsActiveSession-module__SettingsActiveSession","iconDevice":"SettingsActiveSession-module__iconDevice","iconDevice__android":"SettingsActiveSession-module__iconDevice__android","iconDeviceAndroid":"SettingsActiveSession-module__iconDevice__android","iconDevice__apple":"SettingsActiveSession-module__iconDevice__apple","iconDeviceApple":"SettingsActiveSession-module__iconDevice__apple","iconDevice__brave":"SettingsActiveSession-module__iconDevice__brave","iconDeviceBrave":"SettingsActiveSession-module__iconDevice__brave","iconDevice__chrome":"SettingsActiveSession-module__iconDevice__chrome","iconDeviceChrome":"SettingsActiveSession-module__iconDevice__chrome","iconDevice__edge":"SettingsActiveSession-module__iconDevice__edge","iconDeviceEdge":"SettingsActiveSession-module__iconDevice__edge","iconDevice__firefox":"SettingsActiveSession-module__iconDevice__firefox","iconDeviceFirefox":"SettingsActiveSession-module__iconDevice__firefox","iconDevice__linux":"SettingsActiveSession-module__iconDevice__linux","iconDeviceLinux":"SettingsActiveSession-module__iconDevice__linux","iconDevice__opera":"SettingsActiveSession-module__iconDevice__opera","iconDeviceOpera":"SettingsActiveSession-module__iconDevice__opera","iconDevice__safari":"SettingsActiveSession-module__iconDevice__safari","iconDeviceSafari":"SettingsActiveSession-module__iconDevice__safari","iconDevice__samsung":"SettingsActiveSession-module__iconDevice__samsung","iconDeviceSamsung":"SettingsActiveSession-module__iconDevice__samsung","iconDevice__ubuntu":"SettingsActiveSession-module__iconDevice__ubuntu","iconDeviceUbuntu":"SettingsActiveSession-module__iconDevice__ubuntu","iconDevice__unknown":"SettingsActiveSession-module__iconDevice__unknown","iconDeviceUnknown":"SettingsActiveSession-module__iconDevice__unknown","iconDevice__vivaldi":"SettingsActiveSession-module__iconDevice__vivaldi","iconDeviceVivaldi":"SettingsActiveSession-module__iconDevice__vivaldi","iconDevice__windows":"SettingsActiveSession-module__iconDevice__windows","iconDeviceWindows":"SettingsActiveSession-module__iconDevice__windows","iconDevice__xbox":"SettingsActiveSession-module__iconDevice__xbox","iconDeviceXbox":"SettingsActiveSession-module__iconDevice__xbox","title":"SettingsActiveSession-module__title","note":"SettingsActiveSession-module__note","date":"SettingsActiveSession-module__date","box":"SettingsActiveSession-module__box","actionHeader":"SettingsActiveSession-module__actionHeader","actionName":"SettingsActiveSession-module__actionName","headerButton":"SettingsActiveSession-module__headerButton"});

/***/ }),

/***/ "./src/components/left/settings/SettingsActiveSessions.scss":
/*!******************************************************************!*\
  !*** ./src/components/left/settings/SettingsActiveSessions.scss ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/settings/SettingsActiveWebsite.module.scss":
/*!************************************************************************!*\
  !*** ./src/components/left/settings/SettingsActiveWebsite.module.scss ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"SettingsActiveWebsite-module__root","avatar":"SettingsActiveWebsite-module__avatar","title":"SettingsActiveWebsite-module__title","note":"SettingsActiveWebsite-module__note","box":"SettingsActiveWebsite-module__box","action-header":"SettingsActiveWebsite-module__action-header","actionHeader":"SettingsActiveWebsite-module__action-header","action-name":"SettingsActiveWebsite-module__action-name","actionName":"SettingsActiveWebsite-module__action-name","header-button":"SettingsActiveWebsite-module__header-button","headerButton":"SettingsActiveWebsite-module__header-button"});

/***/ }),

/***/ "./src/components/left/settings/SettingsActiveWebsites.module.scss":
/*!*************************************************************************!*\
  !*** ./src/components/left/settings/SettingsActiveWebsites.module.scss ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"avatar":"SettingsActiveWebsites-module__avatar","clear-help":"SettingsActiveWebsites-module__clear-help","clearHelp":"SettingsActiveWebsites-module__clear-help","subtitle":"SettingsActiveWebsites-module__subtitle"});

/***/ }),

/***/ "./src/components/left/settings/SettingsDoNotTranslate.module.scss":
/*!*************************************************************************!*\
  !*** ./src/components/left/settings/SettingsDoNotTranslate.module.scss ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"SettingsDoNotTranslate-module__root","item":"SettingsDoNotTranslate-module__item"});

/***/ }),

/***/ "./src/components/left/settings/SettingsGeneralBackground.scss":
/*!*********************************************************************!*\
  !*** ./src/components/left/settings/SettingsGeneralBackground.scss ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/settings/SettingsGeneralBackgroundColor.scss":
/*!**************************************************************************!*\
  !*** ./src/components/left/settings/SettingsGeneralBackgroundColor.scss ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/settings/SettingsPrivacyPublicPhoto.module.scss":
/*!*****************************************************************************!*\
  !*** ./src/components/left/settings/SettingsPrivacyPublicPhoto.module.scss ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"fallback-photo":"SettingsPrivacyPublicPhoto-module__fallback-photo","fallbackPhoto":"SettingsPrivacyPublicPhoto-module__fallback-photo"});

/***/ }),

/***/ "./src/components/left/settings/WallpaperTile.scss":
/*!*********************************************************!*\
  !*** ./src/components/left/settings/WallpaperTile.scss ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/settings/folders/FolderTitleInput.scss":
/*!********************************************************************!*\
  !*** ./src/components/left/settings/folders/FolderTitleInput.scss ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/left/settings/folders/SettingsFolders.scss":
/*!*******************************************************************!*\
  !*** ./src/components/left/settings/folders/SettingsFolders.scss ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/main/NewContactModal.scss":
/*!**************************************************!*\
  !*** ./src/components/main/NewContactModal.scss ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/main/premium/GiveawayModal.module.scss":
/*!***************************************************************!*\
  !*** ./src/components/main/premium/GiveawayModal.module.scss ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"GiveawayModal-module__root","button":"GiveawayModal-module__button","main":"GiveawayModal-module__main","logo":"GiveawayModal-module__logo","header-text":"GiveawayModal-module__header-text","headerText":"GiveawayModal-module__header-text","description":"GiveawayModal-module__description","header":"GiveawayModal-module__header","hidden-header":"GiveawayModal-module__hidden-header","hiddenHeader":"GiveawayModal-module__hidden-header","close-button":"GiveawayModal-module__close-button","closeButton":"GiveawayModal-module__close-button","premium-header-text":"GiveawayModal-module__premium-header-text","premiumHeaderText":"GiveawayModal-module__premium-header-text","primary-footer-text":"GiveawayModal-module__primary-footer-text","primaryFooterText":"GiveawayModal-module__primary-footer-text","section":"GiveawayModal-module__section","types":"GiveawayModal-module__types","footer":"GiveawayModal-module__footer","options":"GiveawayModal-module__options","giveawayTitle":"GiveawayModal-module__giveawayTitle","subscription":"GiveawayModal-module__subscription","starSubscription":"GiveawayModal-module__starSubscription","subscriptionOption":"GiveawayModal-module__subscriptionOption","status":"GiveawayModal-module__status","info":"GiveawayModal-module__info","titleInfo":"GiveawayModal-module__titleInfo","month":"GiveawayModal-module__month","quantity":"GiveawayModal-module__quantity","floatingBadge":"GiveawayModal-module__floatingBadge","floatingBadgeColor":"GiveawayModal-module__floatingBadgeColor","floatingBadgeButtonColor":"GiveawayModal-module__floatingBadgeButtonColor","floatingBadgeIcon":"GiveawayModal-module__floatingBadgeIcon","floatingBadgeValue":"GiveawayModal-module__floatingBadgeValue","subscriptionFooter":"GiveawayModal-module__subscriptionFooter","premiumFeatures":"GiveawayModal-module__premiumFeatures","dateButton":"GiveawayModal-module__dateButton","title":"GiveawayModal-module__title","checkboxSection":"GiveawayModal-module__checkboxSection","prizesSection":"GiveawayModal-module__prizesSection","prizesInput":"GiveawayModal-module__prizesInput","subLabelClassName":"GiveawayModal-module__subLabelClassName","prepaidImg":"GiveawayModal-module__prepaidImg","addButton":"GiveawayModal-module__addButton","addChannel":"GiveawayModal-module__addChannel","removeChannel":"GiveawayModal-module__removeChannel","starOptions":"GiveawayModal-module__starOptions","transition":"GiveawayModal-module__transition"});

/***/ }),

/***/ "./src/components/main/premium/GiveawayTypeOption.module.scss":
/*!********************************************************************!*\
  !*** ./src/components/main/premium/GiveawayTypeOption.module.scss ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"wrapper":"GiveawayTypeOption-module__wrapper","input":"GiveawayTypeOption-module__input","content":"GiveawayTypeOption-module__content","notChecked":"GiveawayTypeOption-module__notChecked","giveaway":"GiveawayTypeOption-module__giveaway","title":"GiveawayTypeOption-module__title","link":"GiveawayTypeOption-module__link","optionImg":"GiveawayTypeOption-module__optionImg","contentText":"GiveawayTypeOption-module__contentText"});

/***/ }),

/***/ "./src/components/main/premium/PremiumFeatureItem.module.scss":
/*!********************************************************************!*\
  !*** ./src/components/main/premium/PremiumFeatureItem.module.scss ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"PremiumFeatureItem-module__root","text":"PremiumFeatureItem-module__text","header":"PremiumFeatureItem-module__header","description":"PremiumFeatureItem-module__description","icon":"PremiumFeatureItem-module__icon","font-icon":"PremiumFeatureItem-module__font-icon","fontIcon":"PremiumFeatureItem-module__font-icon"});

/***/ }),

/***/ "./src/components/main/premium/PremiumFeatureModal.module.scss":
/*!*********************************************************************!*\
  !*** ./src/components/main/premium/PremiumFeatureModal.module.scss ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"PremiumFeatureModal-module__root","button":"PremiumFeatureModal-module__button","button-content":"PremiumFeatureModal-module__button-content","buttonContent":"PremiumFeatureModal-module__button-content","back-button":"PremiumFeatureModal-module__back-button","backButton":"PremiumFeatureModal-module__back-button","white-back-button":"PremiumFeatureModal-module__white-back-button","whiteBackButton":"PremiumFeatureModal-module__white-back-button","content":"PremiumFeatureModal-module__content","frame":"PremiumFeatureModal-module__frame","slide":"PremiumFeatureModal-module__slide","limits":"PremiumFeatureModal-module__limits","stories":"PremiumFeatureModal-module__stories","limits-content":"PremiumFeatureModal-module__limits-content","limitsContent":"PremiumFeatureModal-module__limits-content","header":"PremiumFeatureModal-module__header","no-header-border":"PremiumFeatureModal-module__no-header-border","noHeaderBorder":"PremiumFeatureModal-module__no-header-border","preview":"PremiumFeatureModal-module__preview","title":"PremiumFeatureModal-module__title","description":"PremiumFeatureModal-module__description","footer":"PremiumFeatureModal-module__footer","no-footer-border":"PremiumFeatureModal-module__no-footer-border","noFooterBorder":"PremiumFeatureModal-module__no-footer-border"});

/***/ }),

/***/ "./src/components/main/premium/PremiumMainModal.module.scss":
/*!******************************************************************!*\
  !*** ./src/components/main/premium/PremiumMainModal.module.scss ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"PremiumMainModal-module__root","transition":"PremiumMainModal-module__transition","button":"PremiumMainModal-module__button","main":"PremiumMainModal-module__main","logo":"PremiumMainModal-module__logo","status-emoji":"PremiumMainModal-module__status-emoji","statusEmoji":"PremiumMainModal-module__status-emoji","header-text":"PremiumMainModal-module__header-text","headerText":"PremiumMainModal-module__header-text","description":"PremiumMainModal-module__description","list":"PremiumMainModal-module__list","no-button":"PremiumMainModal-module__no-button","noButton":"PremiumMainModal-module__no-button","header":"PremiumMainModal-module__header","hidden-header":"PremiumMainModal-module__hidden-header","hiddenHeader":"PremiumMainModal-module__hidden-header","close-button":"PremiumMainModal-module__close-button","closeButton":"PremiumMainModal-module__close-button","premium-header-text":"PremiumMainModal-module__premium-header-text","premiumHeaderText":"PremiumMainModal-module__premium-header-text","footer-text":"PremiumMainModal-module__footer-text","footerText":"PremiumMainModal-module__footer-text","primary-footer-text":"PremiumMainModal-module__primary-footer-text","primaryFooterText":"PremiumMainModal-module__primary-footer-text","footer":"PremiumMainModal-module__footer","stickerSetText":"PremiumMainModal-module__stickerSetText","stickerSetLink":"PremiumMainModal-module__stickerSetLink","stickerSetLinkIcon":"PremiumMainModal-module__stickerSetLinkIcon","subscriptionOptions":"PremiumMainModal-module__subscriptionOptions","subscriptionOption":"PremiumMainModal-module__subscriptionOption"});

/***/ }),

/***/ "./src/components/main/premium/PremiumSubscriptionOption.module.scss":
/*!***************************************************************************!*\
  !*** ./src/components/main/premium/PremiumSubscriptionOption.module.scss ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"wrapper":"PremiumSubscriptionOption-module__wrapper","giveawayWrapper":"PremiumSubscriptionOption-module__giveawayWrapper","active":"PremiumSubscriptionOption-module__active","input":"PremiumSubscriptionOption-module__input","content":"PremiumSubscriptionOption-module__content","month":"PremiumSubscriptionOption-module__month","perMonth":"PremiumSubscriptionOption-module__perMonth","amount":"PremiumSubscriptionOption-module__amount","discount":"PremiumSubscriptionOption-module__discount","giveawayDiscount":"PremiumSubscriptionOption-module__giveawayDiscount"});

/***/ }),

/***/ "./src/components/main/premium/common/PremiumLimitPreview.module.scss":
/*!****************************************************************************!*\
  !*** ./src/components/main/premium/common/PremiumLimitPreview.module.scss ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"PremiumLimitPreview-module__root","title":"PremiumLimitPreview-module__title","description":"PremiumLimitPreview-module__description"});

/***/ }),

/***/ "./src/components/main/premium/common/PremiumLimitReachedModal.module.scss":
/*!*********************************************************************************!*\
  !*** ./src/components/main/premium/common/PremiumLimitReachedModal.module.scss ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"PremiumLimitReachedModal-module__root","limit-compare":"PremiumLimitReachedModal-module__limit-compare","limitCompare":"PremiumLimitReachedModal-module__limit-compare","limit-badge":"PremiumLimitReachedModal-module__limit-badge","limitBadge":"PremiumLimitReachedModal-module__limit-badge","limit-value":"PremiumLimitReachedModal-module__limit-value","limitValue":"PremiumLimitReachedModal-module__limit-value","limit-icon":"PremiumLimitReachedModal-module__limit-icon","limitIcon":"PremiumLimitReachedModal-module__limit-icon","dialog-buttons":"PremiumLimitReachedModal-module__dialog-buttons","dialogButtons":"PremiumLimitReachedModal-module__dialog-buttons","x2":"PremiumLimitReachedModal-module__x2","button-icon":"PremiumLimitReachedModal-module__button-icon","buttonIcon":"PremiumLimitReachedModal-module__button-icon"});

/***/ }),

/***/ "./src/components/main/premium/common/PremiumLimitsCompare.module.scss":
/*!*****************************************************************************!*\
  !*** ./src/components/main/premium/common/PremiumLimitsCompare.module.scss ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"PremiumLimitsCompare-module__root","floating-badge":"PremiumLimitsCompare-module__floating-badge","floatingBadge":"PremiumLimitsCompare-module__floating-badge","floating-badge-triangle":"PremiumLimitsCompare-module__floating-badge-triangle","floatingBadgeTriangle":"PremiumLimitsCompare-module__floating-badge-triangle","floating-badge-icon":"PremiumLimitsCompare-module__floating-badge-icon","floatingBadgeIcon":"PremiumLimitsCompare-module__floating-badge-icon","text":"PremiumLimitsCompare-module__text","floating-badge-value":"PremiumLimitsCompare-module__floating-badge-value","floatingBadgeValue":"PremiumLimitsCompare-module__floating-badge-value","left-text":"PremiumLimitsCompare-module__left-text PremiumLimitsCompare-module__text PremiumLimitsCompare-module__text","leftText":"PremiumLimitsCompare-module__left-text PremiumLimitsCompare-module__text PremiumLimitsCompare-module__text","right-text":"PremiumLimitsCompare-module__right-text PremiumLimitsCompare-module__text PremiumLimitsCompare-module__text","rightText":"PremiumLimitsCompare-module__right-text PremiumLimitsCompare-module__text PremiumLimitsCompare-module__text","right-value":"PremiumLimitsCompare-module__right-value PremiumLimitsCompare-module__text PremiumLimitsCompare-module__text","rightValue":"PremiumLimitsCompare-module__right-value PremiumLimitsCompare-module__text PremiumLimitsCompare-module__text","left-value":"PremiumLimitsCompare-module__left-value PremiumLimitsCompare-module__text","leftValue":"PremiumLimitsCompare-module__left-value PremiumLimitsCompare-module__text","line":"PremiumLimitsCompare-module__line","left":"PremiumLimitsCompare-module__left","right":"PremiumLimitsCompare-module__right"});

/***/ }),

/***/ "./src/components/main/premium/previews/PremiumFeaturePreviewStickers.module.scss":
/*!****************************************************************************************!*\
  !*** ./src/components/main/premium/previews/PremiumFeaturePreviewStickers.module.scss ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"PremiumFeaturePreviewStickers-module__root","sticker":"PremiumFeaturePreviewStickers-module__sticker","effect-sticker":"PremiumFeaturePreviewStickers-module__effect-sticker PremiumFeaturePreviewStickers-module__sticker","effectSticker":"PremiumFeaturePreviewStickers-module__effect-sticker PremiumFeaturePreviewStickers-module__sticker"});

/***/ }),

/***/ "./src/components/main/premium/previews/PremiumFeaturePreviewStories.module.scss":
/*!***************************************************************************************!*\
  !*** ./src/components/main/premium/previews/PremiumFeaturePreviewStories.module.scss ***!
  \***************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"PremiumFeaturePreviewStories-module__root","header":"PremiumFeaturePreviewStories-module__header","circle":"PremiumFeaturePreviewStories-module__circle","title":"PremiumFeaturePreviewStories-module__title","features":"PremiumFeaturePreviewStories-module__features","mobile":"PremiumFeaturePreviewStories-module__mobile","scrolled":"PremiumFeaturePreviewStories-module__scrolled"});

/***/ }),

/***/ "./src/components/main/premium/previews/PremiumFeaturePreviewVideo.module.scss":
/*!*************************************************************************************!*\
  !*** ./src/components/main/premium/previews/PremiumFeaturePreviewVideo.module.scss ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"PremiumFeaturePreviewVideo-module__root","wrapper":"PremiumFeaturePreviewVideo-module__wrapper","down":"PremiumFeaturePreviewVideo-module__down","frame":"PremiumFeaturePreviewVideo-module__frame","video":"PremiumFeaturePreviewVideo-module__video"});

/***/ }),

/***/ "./src/components/mediaViewer/MediaViewer.scss":
/*!*****************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewer.scss ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/mediaViewer/MediaViewerActions.scss":
/*!************************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewerActions.scss ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/mediaViewer/MediaViewerContent.scss":
/*!************************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewerContent.scss ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/mediaViewer/MediaViewerFooter.scss":
/*!***********************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewerFooter.scss ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/mediaViewer/MediaViewerSlides.scss":
/*!***********************************************************!*\
  !*** ./src/components/mediaViewer/MediaViewerSlides.scss ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/mediaViewer/SeekLine.module.scss":
/*!*********************************************************!*\
  !*** ./src/components/mediaViewer/SeekLine.module.scss ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"container":"SeekLine-module__container","preview":"SeekLine-module__preview","previewCanvas":"SeekLine-module__previewCanvas","previewTime":"SeekLine-module__previewTime","previewTimeText":"SeekLine-module__previewTimeText","track":"SeekLine-module__track","buffered":"SeekLine-module__buffered","played":"SeekLine-module__played","seeking":"SeekLine-module__seeking"});

/***/ }),

/***/ "./src/components/mediaViewer/SenderInfo.scss":
/*!****************************************************!*\
  !*** ./src/components/mediaViewer/SenderInfo.scss ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/mediaViewer/VideoPlayer.scss":
/*!*****************************************************!*\
  !*** ./src/components/mediaViewer/VideoPlayer.scss ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/mediaViewer/VideoPlayerControls.scss":
/*!*************************************************************!*\
  !*** ./src/components/mediaViewer/VideoPlayerControls.scss ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/ChatLanguageModal.module.scss":
/*!*************************************************************!*\
  !*** ./src/components/middle/ChatLanguageModal.module.scss ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"ChatLanguageModal-module__root","list-item":"ChatLanguageModal-module__list-item","listItem":"ChatLanguageModal-module__list-item","title":"ChatLanguageModal-module__title","subtitle":"ChatLanguageModal-module__subtitle","languages":"ChatLanguageModal-module__languages"});

/***/ }),

/***/ "./src/components/middle/DeleteSelectedMessageModal.module.scss":
/*!**********************************************************************!*\
  !*** ./src/components/middle/DeleteSelectedMessageModal.module.scss ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"main":"DeleteSelectedMessageModal-module__main","container":"DeleteSelectedMessageModal-module__container","title":"DeleteSelectedMessageModal-module__title","singleTitle":"DeleteSelectedMessageModal-module__singleTitle","actionTitle":"DeleteSelectedMessageModal-module__actionTitle","restrictionTitle":"DeleteSelectedMessageModal-module__restrictionTitle","listItemButton":"DeleteSelectedMessageModal-module__listItemButton","button":"DeleteSelectedMessageModal-module__button","dropdownList":"DeleteSelectedMessageModal-module__dropdownList","dialogButtons":"DeleteSelectedMessageModal-module__dialogButtons","restrictionContainer":"DeleteSelectedMessageModal-module__restrictionContainer","restrictionContainerOpen":"DeleteSelectedMessageModal-module__restrictionContainerOpen","dropdownListOpen":"DeleteSelectedMessageModal-module__dropdownListOpen"});

/***/ }),

/***/ "./src/components/middle/EmojiInteractionAnimation.scss":
/*!**************************************************************!*\
  !*** ./src/components/middle/EmojiInteractionAnimation.scss ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/HeaderMenuContainer.scss":
/*!********************************************************!*\
  !*** ./src/components/middle/HeaderMenuContainer.scss ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/MessageSelectToolbar.scss":
/*!*********************************************************!*\
  !*** ./src/components/middle/MessageSelectToolbar.scss ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/ReactorListModal.scss":
/*!*****************************************************!*\
  !*** ./src/components/middle/ReactorListModal.scss ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/AttachmentModal.module.scss":
/*!********************************************************************!*\
  !*** ./src/components/middle/composer/AttachmentModal.module.scss ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"AttachmentModal-module__root","mobile":"AttachmentModal-module__mobile","symbolMenuOpen":"AttachmentModal-module__symbolMenuOpen","header-border":"AttachmentModal-module__header-border","headerBorder":"AttachmentModal-module__header-border","attachments":"AttachmentModal-module__attachments","attachments-bottom-padding":"AttachmentModal-module__attachments-bottom-padding","attachmentsBottomPadding":"AttachmentModal-module__attachments-bottom-padding","caption-wrapper":"AttachmentModal-module__caption-wrapper","captionWrapper":"AttachmentModal-module__caption-wrapper","caption-top-border":"AttachmentModal-module__caption-top-border","captionTopBorder":"AttachmentModal-module__caption-top-border","caption":"AttachmentModal-module__caption","dropTarget":"AttachmentModal-module__dropTarget","dropOutlineContainer":"AttachmentModal-module__dropOutlineContainer","dropOutline":"AttachmentModal-module__dropOutline","outline":"AttachmentModal-module__outline","hovered":"AttachmentModal-module__hovered","send-wrapper":"AttachmentModal-module__send-wrapper","sendWrapper":"AttachmentModal-module__send-wrapper","send":"AttachmentModal-module__send","is-pointer-env":"AttachmentModal-module__is-pointer-env","isPointerEnv":"AttachmentModal-module__is-pointer-env"});

/***/ }),

/***/ "./src/components/middle/composer/AttachmentModalItem.module.scss":
/*!************************************************************************!*\
  !*** ./src/components/middle/composer/AttachmentModalItem.module.scss ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"AttachmentModalItem-module__root","preview":"AttachmentModalItem-module__preview","duration":"AttachmentModalItem-module__duration","single":"AttachmentModalItem-module__single","no-grouping":"AttachmentModalItem-module__no-grouping","noGrouping":"AttachmentModalItem-module__no-grouping","file":"AttachmentModalItem-module__file","overlay":"AttachmentModalItem-module__overlay","action-item":"AttachmentModalItem-module__action-item","actionItem":"AttachmentModalItem-module__action-item","delete-file":"AttachmentModalItem-module__delete-file","deleteFile":"AttachmentModalItem-module__delete-file"});

/***/ }),

/***/ "./src/components/middle/composer/BotCommandMenu.scss":
/*!************************************************************!*\
  !*** ./src/components/middle/composer/BotCommandMenu.scss ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/ChatCommand.scss":
/*!*********************************************************!*\
  !*** ./src/components/middle/composer/ChatCommand.scss ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/ChatCommandTooltip.module.scss":
/*!***********************************************************************!*\
  !*** ./src/components/middle/composer/ChatCommandTooltip.module.scss ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"ChatCommandTooltip-module__root"});

/***/ }),

/***/ "./src/components/middle/composer/CustomEmojiTooltip.module.scss":
/*!***********************************************************************!*\
  !*** ./src/components/middle/composer/CustomEmojiTooltip.module.scss ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"CustomEmojiTooltip-module__root","emojiButton":"CustomEmojiTooltip-module__emojiButton"});

/***/ }),

/***/ "./src/components/middle/composer/CustomSendMenu.scss":
/*!************************************************************!*\
  !*** ./src/components/middle/composer/CustomSendMenu.scss ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/EmojiButton.scss":
/*!*********************************************************!*\
  !*** ./src/components/middle/composer/EmojiButton.scss ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/EmojiPicker.scss":
/*!*********************************************************!*\
  !*** ./src/components/middle/composer/EmojiPicker.scss ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/EmojiTooltip.scss":
/*!**********************************************************!*\
  !*** ./src/components/middle/composer/EmojiTooltip.scss ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/GifPicker.scss":
/*!*******************************************************!*\
  !*** ./src/components/middle/composer/GifPicker.scss ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/InlineBotTooltip.scss":
/*!**************************************************************!*\
  !*** ./src/components/middle/composer/InlineBotTooltip.scss ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/MentionTooltip.scss":
/*!************************************************************!*\
  !*** ./src/components/middle/composer/MentionTooltip.scss ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/PollModal.scss":
/*!*******************************************************!*\
  !*** ./src/components/middle/composer/PollModal.scss ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/SendAsMenu.scss":
/*!********************************************************!*\
  !*** ./src/components/middle/composer/SendAsMenu.scss ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/StickerPicker.module.scss":
/*!******************************************************************!*\
  !*** ./src/components/middle/composer/StickerPicker.module.scss ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"StickerPicker-module__root","main":"StickerPicker-module__main","hasHeader":"StickerPicker-module__hasHeader","main_customEmoji":"StickerPicker-module__main_customEmoji","mainCustomEmoji":"StickerPicker-module__main_customEmoji","header":"StickerPicker-module__header","headerWithBorder":"StickerPicker-module__headerWithBorder","stickerCover":"StickerPicker-module__stickerCover","activated":"StickerPicker-module__activated","pickerDisabled":"StickerPicker-module__pickerDisabled"});

/***/ }),

/***/ "./src/components/middle/composer/StickerSetCover.module.scss":
/*!********************************************************************!*\
  !*** ./src/components/middle/composer/StickerSetCover.module.scss ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"StickerSetCover-module__root","video":"StickerSetCover-module__video","image":"StickerSetCover-module__image"});

/***/ }),

/***/ "./src/components/middle/composer/StickerTooltip.scss":
/*!************************************************************!*\
  !*** ./src/components/middle/composer/StickerTooltip.scss ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/SymbolMenu.scss":
/*!********************************************************!*\
  !*** ./src/components/middle/composer/SymbolMenu.scss ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/TextFormatter.scss":
/*!***********************************************************!*\
  !*** ./src/components/middle/composer/TextFormatter.scss ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/inlineResults/BaseResult.scss":
/*!**********************************************************************!*\
  !*** ./src/components/middle/composer/inlineResults/BaseResult.scss ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/composer/inlineResults/MediaResult.scss":
/*!***********************************************************************!*\
  !*** ./src/components/middle/composer/inlineResults/MediaResult.scss ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/middle/message/TimeMenuItem.module.scss":
/*!****************************************************************!*\
  !*** ./src/components/middle/message/TimeMenuItem.module.scss ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"item":"TimeMenuItem-module__item","get":"TimeMenuItem-module__get","skeleton":"TimeMenuItem-module__skeleton","transition":"TimeMenuItem-module__transition"});

/***/ }),

/***/ "./src/components/middle/message/reactions/ReactionPicker.module.scss":
/*!****************************************************************************!*\
  !*** ./src/components/middle/message/reactions/ReactionPicker.module.scss ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"menu":"ReactionPicker-module__menu","menuContent":"ReactionPicker-module__menuContent","storyMenu":"ReactionPicker-module__storyMenu","onlyReactions":"ReactionPicker-module__onlyReactions","hidden":"ReactionPicker-module__hidden"});

/***/ }),

/***/ "./src/components/middle/message/reactions/ReactionPickerLimited.module.scss":
/*!***********************************************************************************!*\
  !*** ./src/components/middle/message/reactions/ReactionPickerLimited.module.scss ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"ReactionPickerLimited-module__root","wrapper":"ReactionPickerLimited-module__wrapper"});

/***/ }),

/***/ "./src/components/middle/search/MiddleSearch.module.scss":
/*!***************************************************************!*\
  !*** ./src/components/middle/search/MiddleSearch.module.scss ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"MiddleSearch-module__root","header":"MiddleSearch-module__header","active":"MiddleSearch-module__active","avatar":"MiddleSearch-module__avatar","input":"MiddleSearch-module__input","mobile":"MiddleSearch-module__mobile","focused":"MiddleSearch-module__focused","withDropdown":"MiddleSearch-module__withDropdown","adaptSearchBorders":"MiddleSearch-module__adaptSearchBorders","dropdown":"MiddleSearch-module__dropdown","dropdownHidden":"MiddleSearch-module__dropdownHidden","results":"MiddleSearch-module__results","placeholder":"MiddleSearch-module__placeholder","separator":"MiddleSearch-module__separator","savedTags":"MiddleSearch-module__savedTags","wrap":"MiddleSearch-module__wrap","searchTags":"MiddleSearch-module__searchTags","savedSearchTag":"MiddleSearch-module__savedSearchTag","hash":"MiddleSearch-module__hash","searchTypes":"MiddleSearch-module__searchTypes","searchType":"MiddleSearch-module__searchType","selectedType":"MiddleSearch-module__selectedType","footer":"MiddleSearch-module__footer","keyboard-visible":"MiddleSearch-module__keyboard-visible","keyboardVisible":"MiddleSearch-module__keyboard-visible","counter":"MiddleSearch-module__counter","mobileNavigation":"MiddleSearch-module__mobileNavigation","navigationButton":"MiddleSearch-module__navigationButton","navigationDisabled":"MiddleSearch-module__navigationDisabled","jumpIn":"MiddleSearch-module__jumpIn"});

/***/ }),

/***/ "./src/components/middle/search/MiddleSearchResult.module.scss":
/*!*********************************************************************!*\
  !*** ./src/components/middle/search/MiddleSearchResult.module.scss ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"MiddleSearchResult-module__root","active":"MiddleSearchResult-module__active","info":"MiddleSearchResult-module__info","topRow":"MiddleSearchResult-module__topRow","meta":"MiddleSearchResult-module__meta","subtitle":"MiddleSearchResult-module__subtitle"});

/***/ }),

/***/ "./src/components/modals/aboutAds/AboutAdsModal.module.scss":
/*!******************************************************************!*\
  !*** ./src/components/modals/aboutAds/AboutAdsModal.module.scss ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"AboutAdsModal-module__root","title":"AboutAdsModal-module__title","description":"AboutAdsModal-module__description","moreButton":"AboutAdsModal-module__moreButton","secondary":"AboutAdsModal-module__secondary","content":"AboutAdsModal-module__content"});

/***/ }),

/***/ "./src/components/modals/boost/BoostModal.module.scss":
/*!************************************************************!*\
  !*** ./src/components/modals/boost/BoostModal.module.scss ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"content":"BoostModal-module__content","modal":"BoostModal-module__modal","loading":"BoostModal-module__loading","description":"BoostModal-module__description","bold":"BoostModal-module__bold","chip":"BoostModal-module__chip","replaceModal":"BoostModal-module__replaceModal","replaceModalContent":"BoostModal-module__replaceModalContent","avatarContainer":"BoostModal-module__avatarContainer","arrow":"BoostModal-module__arrow","boostedWrapper":"BoostModal-module__boostedWrapper","boostedMark":"BoostModal-module__boostedMark"});

/***/ }),

/***/ "./src/components/modals/chatInvite/ChatInviteModal.module.scss":
/*!**********************************************************************!*\
  !*** ./src/components/modals/chatInvite/ChatInviteModal.module.scss ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"content":"ChatInviteModal-module__content","title":"ChatInviteModal-module__title","participantCount":"ChatInviteModal-module__participantCount","participants":"ChatInviteModal-module__participants","participant":"ChatInviteModal-module__participant","buttons":"ChatInviteModal-module__buttons"});

/***/ }),

/***/ "./src/components/modals/chatlist/ChatlistModal.module.scss":
/*!******************************************************************!*\
  !*** ./src/components/modals/chatlist/ChatlistModal.module.scss ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"description":"ChatlistModal-module__description","picker-wrapper":"ChatlistModal-module__picker-wrapper","pickerWrapper":"ChatlistModal-module__picker-wrapper","picker-header":"ChatlistModal-module__picker-header","pickerHeader":"ChatlistModal-module__picker-header","picker-header-info":"ChatlistModal-module__picker-header-info","pickerHeaderInfo":"ChatlistModal-module__picker-header-info","selection-toggle":"ChatlistModal-module__selection-toggle","selectionToggle":"ChatlistModal-module__selection-toggle","foldersWrapper":"ChatlistModal-module__foldersWrapper","folders":"ChatlistModal-module__folders","folder":"ChatlistModal-module__folder","button-text":"ChatlistModal-module__button-text","buttonText":"ChatlistModal-module__button-text","button-badge":"ChatlistModal-module__button-badge","buttonBadge":"ChatlistModal-module__button-badge"});

/***/ }),

/***/ "./src/components/modals/collectible/CollectibleInfoModal.module.scss":
/*!****************************************************************************!*\
  !*** ./src/components/modals/collectible/CollectibleInfoModal.module.scss ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"content":"CollectibleInfoModal-module__content","closeButton":"CollectibleInfoModal-module__closeButton","icon":"CollectibleInfoModal-module__icon","title":"CollectibleInfoModal-module__title","description":"CollectibleInfoModal-module__description"});

/***/ }),

/***/ "./src/components/modals/emojiStatusAccess/EmojiStatusAccessModal.module.scss":
/*!************************************************************************************!*\
  !*** ./src/components/modals/emojiStatusAccess/EmojiStatusAccessModal.module.scss ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"content":"EmojiStatusAccessModal-module__content","chatItem":"EmojiStatusAccessModal-module__chatItem"});

/***/ }),

/***/ "./src/components/modals/giftcode/GiftCodeModal.module.scss":
/*!******************************************************************!*\
  !*** ./src/components/modals/giftcode/GiftCodeModal.module.scss ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"clickable":"GiftCodeModal-module__clickable","centered":"GiftCodeModal-module__centered","logo":"GiftCodeModal-module__logo"});

/***/ }),

/***/ "./src/components/modals/inviteViaLink/InviteViaLinkModal.module.scss":
/*!****************************************************************************!*\
  !*** ./src/components/modals/inviteViaLink/InviteViaLinkModal.module.scss ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"content":"InviteViaLinkModal-module__content","closeButton":"InviteViaLinkModal-module__closeButton","contentText":"InviteViaLinkModal-module__contentText","title":"InviteViaLinkModal-module__title","separator":"InviteViaLinkModal-module__separator","userPicker":"InviteViaLinkModal-module__userPicker","sendInvites":"InviteViaLinkModal-module__sendInvites","avatarList":"InviteViaLinkModal-module__avatarList"});

/***/ }),

/***/ "./src/components/modals/locationAccess/LocationAccessModal.module.scss":
/*!******************************************************************************!*\
  !*** ./src/components/modals/locationAccess/LocationAccessModal.module.scss ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"avatars":"LocationAccessModal-module__avatars","arrow":"LocationAccessModal-module__arrow"});

/***/ }),

/***/ "./src/components/modals/map/MapModal.module.scss":
/*!********************************************************!*\
  !*** ./src/components/modals/map/MapModal.module.scss ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"MapModal-module__root","buttons":"MapModal-module__buttons"});

/***/ }),

/***/ "./src/components/modals/oneTimeMedia/OneTimeMediaModal.module.scss":
/*!**************************************************************************!*\
  !*** ./src/components/modals/oneTimeMedia/OneTimeMediaModal.module.scss ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"OneTimeMediaModal-module__root","fade-in-opacity":"OneTimeMediaModal-module__fade-in-opacity","fadeInOpacity":"OneTimeMediaModal-module__fade-in-opacity","closing":"OneTimeMediaModal-module__closing","voice":"OneTimeMediaModal-module__voice","video":"OneTimeMediaModal-module__video","footer":"OneTimeMediaModal-module__footer","closeBtn":"OneTimeMediaModal-module__closeBtn"});

/***/ }),

/***/ "./src/components/modals/reportAd/ReportAdModal.module.scss":
/*!******************************************************************!*\
  !*** ./src/components/modals/reportAd/ReportAdModal.module.scss ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"slide":"ReportAdModal-module__slide","root":"ReportAdModal-module__root","modalTitle":"ReportAdModal-module__modalTitle","optionText":"ReportAdModal-module__optionText","option":"ReportAdModal-module__option","optionButton":"ReportAdModal-module__optionButton","sectionTitle":"ReportAdModal-module__sectionTitle","description":"ReportAdModal-module__description","title":"ReportAdModal-module__title","titleMultiline":"ReportAdModal-module__titleMultiline","subtitle":"ReportAdModal-module__subtitle","transition":"ReportAdModal-module__transition"});

/***/ }),

/***/ "./src/components/modals/reportModal/ReportModal.module.scss":
/*!*******************************************************************!*\
  !*** ./src/components/modals/reportModal/ReportModal.module.scss ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"slide":"ReportModal-module__slide","root":"ReportModal-module__root","content":"ReportModal-module__content","modalTitle":"ReportModal-module__modalTitle","header":"ReportModal-module__header","optionText":"ReportModal-module__optionText","option":"ReportModal-module__option","optionButton":"ReportModal-module__optionButton","sectionTitle":"ReportModal-module__sectionTitle","description":"ReportModal-module__description","title":"ReportModal-module__title","hasDepth":"ReportModal-module__hasDepth","titleMultiline":"ReportModal-module__titleMultiline","subtitle":"ReportModal-module__subtitle","transition":"ReportModal-module__transition","block":"ReportModal-module__block","optionInfo":"ReportModal-module__optionInfo","reportIcon":"ReportModal-module__reportIcon"});

/***/ }),

/***/ "./src/components/modals/suggestedStatus/SuggestedStatusModal.module.scss":
/*!********************************************************************************!*\
  !*** ./src/components/modals/suggestedStatus/SuggestedStatusModal.module.scss ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"content":"SuggestedStatusModal-module__content","topEmoji":"SuggestedStatusModal-module__topEmoji","description":"SuggestedStatusModal-module__description","title":"SuggestedStatusModal-module__title"});

/***/ }),

/***/ "./src/components/modals/urlAuth/UrlAuthModal.module.scss":
/*!****************************************************************!*\
  !*** ./src/components/modals/urlAuth/UrlAuthModal.module.scss ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"checkbox":"UrlAuthModal-module__checkbox"});

/***/ }),

/***/ "./src/components/modals/webApp/MinimizedWebAppModal.module.scss":
/*!***********************************************************************!*\
  !*** ./src/components/modals/webApp/MinimizedWebAppModal.module.scss ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"MinimizedWebAppModal-module__root","window-state-button":"MinimizedWebAppModal-module__window-state-button","windowStateButton":"MinimizedWebAppModal-module__window-state-button","button":"MinimizedWebAppModal-module__button","avatars":"MinimizedWebAppModal-module__avatars","state-icon":"MinimizedWebAppModal-module__state-icon","stateIcon":"MinimizedWebAppModal-module__state-icon","icon":"MinimizedWebAppModal-module__icon","title":"MinimizedWebAppModal-module__title"});

/***/ }),

/***/ "./src/components/modals/webApp/MoreAppsTabContent.module.scss":
/*!*********************************************************************!*\
  !*** ./src/components/modals/webApp/MoreAppsTabContent.module.scss ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"MoreAppsTabContent-module__root","search":"MoreAppsTabContent-module__search","section-title":"MoreAppsTabContent-module__section-title","sectionTitle":"MoreAppsTabContent-module__section-title","section-content":"MoreAppsTabContent-module__section-content","sectionContent":"MoreAppsTabContent-module__section-content","showMoreLink":"MoreAppsTabContent-module__showMoreLink"});

/***/ }),

/***/ "./src/components/modals/webApp/WebAppGridItem.module.scss":
/*!*****************************************************************!*\
  !*** ./src/components/modals/webApp/WebAppGridItem.module.scss ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"container":"WebAppGridItem-module__container","user-count-badge":"WebAppGridItem-module__user-count-badge","userCountBadge":"WebAppGridItem-module__user-count-badge","user-badge-icon":"WebAppGridItem-module__user-badge-icon","userBadgeIcon":"WebAppGridItem-module__user-badge-icon","name":"WebAppGridItem-module__name"});

/***/ }),

/***/ "./src/components/modals/webApp/WebAppModal.module.scss":
/*!**************************************************************!*\
  !*** ./src/components/modals/webApp/WebAppModal.module.scss ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"WebAppModal-module__root","multi-tab":"WebAppModal-module__multi-tab","multiTab":"WebAppModal-module__multi-tab","close-icon":"WebAppModal-module__close-icon","closeIcon":"WebAppModal-module__close-icon","minimized":"WebAppModal-module__minimized","fullScreen":"WebAppModal-module__fullScreen","tabs":"WebAppModal-module__tabs","tool-bar":"WebAppModal-module__tool-bar","toolBar":"WebAppModal-module__tool-bar","tab-button-wrapper":"WebAppModal-module__tab-button-wrapper","tabButtonWrapper":"WebAppModal-module__tab-button-wrapper","tab-button":"WebAppModal-module__tab-button","tabButton":"WebAppModal-module__tab-button","tab-right-mask":"WebAppModal-module__tab-right-mask","tabRightMask":"WebAppModal-module__tab-right-mask","tab-close-button":"WebAppModal-module__tab-close-button","tabCloseButton":"WebAppModal-module__tab-close-button","tab-button-curve-path":"WebAppModal-module__tab-button-curve-path","tabButtonCurvePath":"WebAppModal-module__tab-button-curve-path","tab-button-left-curve":"WebAppModal-module__tab-button-left-curve","tabButtonLeftCurve":"WebAppModal-module__tab-button-left-curve","tab-button-right-curve":"WebAppModal-module__tab-button-right-curve","tabButtonRightCurve":"WebAppModal-module__tab-button-right-curve","more-apps-tab-icon":"WebAppModal-module__more-apps-tab-icon","moreAppsTabIcon":"WebAppModal-module__more-apps-tab-icon","avatar-container":"WebAppModal-module__avatar-container","avatarContainer":"WebAppModal-module__avatar-container","web-app-tab-more-menu":"WebAppModal-module__web-app-tab-more-menu","webAppTabMoreMenu":"WebAppModal-module__web-app-tab-more-menu","more-button":"WebAppModal-module__more-button","moreButton":"WebAppModal-module__more-button","tab-more-button":"WebAppModal-module__tab-more-button","tabMoreButton":"WebAppModal-module__tab-more-button","more-apps-button":"WebAppModal-module__more-apps-button","moreAppsButton":"WebAppModal-module__more-apps-button","window-state-button":"WebAppModal-module__window-state-button","windowStateButton":"WebAppModal-module__window-state-button","header-button":"WebAppModal-module__header-button","headerButton":"WebAppModal-module__header-button","fullscreenButton":"WebAppModal-module__fullscreenButton","tab-close-icon":"WebAppModal-module__tab-close-icon","tabCloseIcon":"WebAppModal-module__tab-close-icon","state-icon":"WebAppModal-module__state-icon","stateIcon":"WebAppModal-module__state-icon","icon":"WebAppModal-module__icon","tab-avatar":"WebAppModal-module__tab-avatar","tabAvatar":"WebAppModal-module__tab-avatar","state-back":"WebAppModal-module__state-back","stateBack":"WebAppModal-module__state-back","loading-spinner":"WebAppModal-module__loading-spinner","loadingSpinner":"WebAppModal-module__loading-spinner","hide":"WebAppModal-module__hide","frame":"WebAppModal-module__frame","with-button":"WebAppModal-module__with-button","withButton":"WebAppModal-module__with-button","main-button":"WebAppModal-module__main-button","mainButton":"WebAppModal-module__main-button","visible":"WebAppModal-module__visible","hidden":"WebAppModal-module__hidden","main-button-spinner":"WebAppModal-module__main-button-spinner","mainButtonSpinner":"WebAppModal-module__main-button-spinner","web-app-popup":"WebAppModal-module__web-app-popup","webAppPopup":"WebAppModal-module__web-app-popup","without-title":"WebAppModal-module__without-title","withoutTitle":"WebAppModal-module__without-title"});

/***/ }),

/***/ "./src/components/modals/webApp/WebAppModalTabContent.module.scss":
/*!************************************************************************!*\
  !*** ./src/components/modals/webApp/WebAppModalTabContent.module.scss ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"WebAppModalTabContent-module__root","multi-tab":"WebAppModalTabContent-module__multi-tab","multiTab":"WebAppModalTabContent-module__multi-tab","loadingPlaceholder":"WebAppModalTabContent-module__loadingPlaceholder","placeholderPath":"WebAppModalTabContent-module__placeholderPath","fadeOpacityBreath":"WebAppModalTabContent-module__fadeOpacityBreath","defaultPlaceholderGrid":"WebAppModalTabContent-module__defaultPlaceholderGrid","placeholderSquare":"WebAppModalTabContent-module__placeholderSquare","hide":"WebAppModalTabContent-module__hide","frame":"WebAppModalTabContent-module__frame","with-button":"WebAppModalTabContent-module__with-button","withButton":"WebAppModalTabContent-module__with-button","hidden":"WebAppModalTabContent-module__hidden","secondary-button":"WebAppModalTabContent-module__secondary-button","secondaryButton":"WebAppModalTabContent-module__secondary-button","main-button":"WebAppModalTabContent-module__main-button","mainButton":"WebAppModalTabContent-module__main-button","visible":"WebAppModalTabContent-module__visible","buttons-container":"WebAppModalTabContent-module__buttons-container","buttonsContainer":"WebAppModalTabContent-module__buttons-container","one-row":"WebAppModalTabContent-module__one-row","oneRow":"WebAppModalTabContent-module__one-row","two-rows":"WebAppModalTabContent-module__two-rows","twoRows":"WebAppModalTabContent-module__two-rows","left-to-right":"WebAppModalTabContent-module__left-to-right","leftToRight":"WebAppModalTabContent-module__left-to-right","right-to-left":"WebAppModalTabContent-module__right-to-left","rightToLeft":"WebAppModalTabContent-module__right-to-left","top-to-bottom":"WebAppModalTabContent-module__top-to-bottom","topToBottom":"WebAppModalTabContent-module__top-to-bottom","bottom-to-top":"WebAppModalTabContent-module__bottom-to-top","bottomToTop":"WebAppModalTabContent-module__bottom-to-top","hide-horizontal":"WebAppModalTabContent-module__hide-horizontal","hideHorizontal":"WebAppModalTabContent-module__hide-horizontal","secondary-button-spinner":"WebAppModalTabContent-module__secondary-button-spinner","secondaryButtonSpinner":"WebAppModalTabContent-module__secondary-button-spinner","main-button-spinner":"WebAppModalTabContent-module__main-button-spinner","mainButtonSpinner":"WebAppModalTabContent-module__main-button-spinner","web-app-popup":"WebAppModalTabContent-module__web-app-popup","webAppPopup":"WebAppModalTabContent-module__web-app-popup","without-title":"WebAppModalTabContent-module__without-title","withoutTitle":"WebAppModalTabContent-module__without-title","closeIcon":"WebAppModalTabContent-module__closeIcon","state-back":"WebAppModalTabContent-module__state-back","stateBack":"WebAppModalTabContent-module__state-back","backIconContainer":"WebAppModalTabContent-module__backIconContainer","moreIcon":"WebAppModalTabContent-module__moreIcon","headerPanel":"WebAppModalTabContent-module__headerPanel","icon":"WebAppModalTabContent-module__icon","headerSplitButton":"WebAppModalTabContent-module__headerSplitButton","headerButton":"WebAppModalTabContent-module__headerButton","left":"WebAppModalTabContent-module__left","right":"WebAppModalTabContent-module__right","buttonCaptionContainer":"WebAppModalTabContent-module__buttonCaptionContainer","backButtonCaption":"WebAppModalTabContent-module__backButtonCaption"});

/***/ }),

/***/ "./src/components/payment/CardInput.scss":
/*!***********************************************!*\
  !*** ./src/components/payment/CardInput.scss ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/payment/Checkout.module.scss":
/*!*****************************************************!*\
  !*** ./src/components/payment/Checkout.module.scss ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"Checkout-module__root","description":"Checkout-module__description","checkout-picture":"Checkout-module__checkout-picture","checkoutPicture":"Checkout-module__checkout-picture","text":"Checkout-module__text","checkout-title":"Checkout-module__checkout-title","checkoutTitle":"Checkout-module__checkout-title","checkout-description":"Checkout-module__checkout-description","checkoutDescription":"Checkout-module__checkout-description","price-info":"Checkout-module__price-info","priceInfo":"Checkout-module__price-info","price-info-item":"Checkout-module__price-info-item","priceInfoItem":"Checkout-module__price-info-item","price-info-item-main":"Checkout-module__price-info-item-main","priceInfoItemMain":"Checkout-module__price-info-item-main","price-info-item-title":"Checkout-module__price-info-item-title","priceInfoItemTitle":"Checkout-module__price-info-item-title","tipsList":"Checkout-module__tipsList","tipsItem":"Checkout-module__tipsItem","tipsItem_active":"Checkout-module__tipsItem_active","tipsItemActive":"Checkout-module__tipsItem_active","invoice-info":"Checkout-module__invoice-info","invoiceInfo":"Checkout-module__invoice-info","provider":"Checkout-module__provider","stripe":"Checkout-module__stripe","smartglocal":"Checkout-module__smartglocal","checkout-info-item-info-title":"Checkout-module__checkout-info-item-info-title","checkoutInfoItemInfoTitle":"Checkout-module__checkout-info-item-info-title","checkout-info-item-info-data":"Checkout-module__checkout-info-item-info-data","checkoutInfoItemInfoData":"Checkout-module__checkout-info-item-info-data","tos-checkbox":"Checkout-module__tos-checkbox","tosCheckbox":"Checkout-module__tos-checkbox","list":"Checkout-module__list"});

/***/ }),

/***/ "./src/components/payment/ConfirmPayment.scss":
/*!****************************************************!*\
  !*** ./src/components/payment/ConfirmPayment.scss ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/payment/PaymentInfo.scss":
/*!*************************************************!*\
  !*** ./src/components/payment/PaymentInfo.scss ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/payment/PaymentModal.scss":
/*!**************************************************!*\
  !*** ./src/components/payment/PaymentModal.scss ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/payment/Shipping.scss":
/*!**********************************************!*\
  !*** ./src/components/payment/Shipping.scss ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/payment/ShippingInfo.scss":
/*!**************************************************!*\
  !*** ./src/components/payment/ShippingInfo.scss ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/right/GifSearch.scss":
/*!*********************************************!*\
  !*** ./src/components/right/GifSearch.scss ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/right/ManageTopic.module.scss":
/*!******************************************************!*\
  !*** ./src/components/right/ManageTopic.module.scss ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"ManageTopic-module__root","content":"ManageTopic-module__content","section":"ManageTopic-module__section","general":"ManageTopic-module__general","top":"ManageTopic-module__top","bottom":"ManageTopic-module__bottom","iconWrapper":"ManageTopic-module__iconWrapper","icon":"ManageTopic-module__icon","clickable":"ManageTopic-module__clickable","heading":"ManageTopic-module__heading","icon-picker":"ManageTopic-module__icon-picker","iconPicker":"ManageTopic-module__icon-picker"});

/***/ }),

/***/ "./src/components/right/PollAnswerResults.scss":
/*!*****************************************************!*\
  !*** ./src/components/right/PollAnswerResults.scss ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/right/PollResults.scss":
/*!***********************************************!*\
  !*** ./src/components/right/PollResults.scss ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/right/StickerSearch.scss":
/*!*************************************************!*\
  !*** ./src/components/right/StickerSearch.scss ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/right/management/JoinRequest.scss":
/*!**********************************************************!*\
  !*** ./src/components/right/management/JoinRequest.scss ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/right/management/Management.scss":
/*!*********************************************************!*\
  !*** ./src/components/right/management/Management.scss ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/components/right/statistics/Statistics.module.scss":
/*!****************************************************************!*\
  !*** ./src/components/right/statistics/Statistics.module.scss ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"Statistics-module__root","pie-slim-in":"Statistics-module__pie-slim-in","pieSlimIn":"Statistics-module__pie-slim-in","pie-slim-out":"Statistics-module__pie-slim-out","pieSlimOut":"Statistics-module__pie-slim-out","messages":"Statistics-module__messages","publicForwards":"Statistics-module__publicForwards","messages-title":"Statistics-module__messages-title","messagesTitle":"Statistics-module__messages-title","publicForwards-title":"Statistics-module__publicForwards-title","publicForwardsTitle":"Statistics-module__publicForwards-title","ready":"Statistics-module__ready","graph":"Statistics-module__graph","hidden":"Statistics-module__hidden"});

/***/ }),

/***/ "./src/components/right/statistics/StatisticsPublicForward.module.scss":
/*!*****************************************************************************!*\
  !*** ./src/components/right/statistics/StatisticsPublicForward.module.scss ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"StatisticsPublicForward-module__root","title":"StatisticsPublicForward-module__title","views":"StatisticsPublicForward-module__views"});

/***/ }),

/***/ "./src/components/right/statistics/StatisticsRecentPost.module.scss":
/*!**************************************************************************!*\
  !*** ./src/components/right/statistics/StatisticsRecentPost.module.scss ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"StatisticsRecentPost-module__root","withImage":"StatisticsRecentPost-module__withImage","imageContainer":"StatisticsRecentPost-module__imageContainer","image":"StatisticsRecentPost-module__image","round":"StatisticsRecentPost-module__round","circle":"StatisticsRecentPost-module__circle","withStoryCircle":"StatisticsRecentPost-module__withStoryCircle","summary":"StatisticsRecentPost-module__summary","title":"StatisticsRecentPost-module__title","info":"StatisticsRecentPost-module__info","meta":"StatisticsRecentPost-module__meta","metaWithIcon":"StatisticsRecentPost-module__metaWithIcon","metaIcon":"StatisticsRecentPost-module__metaIcon","date":"StatisticsRecentPost-module__date"});

/***/ }),

/***/ "./src/components/story/StealthModeModal.module.scss":
/*!***********************************************************!*\
  !*** ./src/components/story/StealthModeModal.module.scss ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"StealthModeModal-module__root","closeButton":"StealthModeModal-module__closeButton","stealthIcon":"StealthModeModal-module__stealthIcon","title":"StealthModeModal-module__title","description":"StealthModeModal-module__description","listItem":"StealthModeModal-module__listItem","icon":"StealthModeModal-module__icon","button":"StealthModeModal-module__button","subtitle":"StealthModeModal-module__subtitle"});

/***/ }),

/***/ "./src/components/story/StoryFooter.module.scss":
/*!******************************************************!*\
  !*** ./src/components/story/StoryFooter.module.scss ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"StoryFooter-module__root","viewInfo":"StoryFooter-module__viewInfo","interactive":"StoryFooter-module__interactive","avatars":"StoryFooter-module__avatars","spacer":"StoryFooter-module__spacer","reactionCount":"StoryFooter-module__reactionCount","reactionCountHeart":"StoryFooter-module__reactionCountHeart","footerItem":"StoryFooter-module__footerItem","views":"StoryFooter-module__views","viewIcon":"StoryFooter-module__viewIcon","reactionButton":"StoryFooter-module__reactionButton","reactionHeart":"StoryFooter-module__reactionHeart"});

/***/ }),

/***/ "./src/components/story/StoryProgress.module.scss":
/*!********************************************************!*\
  !*** ./src/components/story/StoryProgress.module.scss ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"StoryProgress-module__root","viewed":"StoryProgress-module__viewed","active":"StoryProgress-module__active","inner":"StoryProgress-module__inner","progress":"StoryProgress-module__progress","paused":"StoryProgress-module__paused"});

/***/ }),

/***/ "./src/components/story/StorySettings.module.scss":
/*!********************************************************!*\
  !*** ./src/components/story/StorySettings.module.scss ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"modal":"StorySettings-module__modal","header":"StorySettings-module__header","closeButton":"StorySettings-module__closeButton","headerTitle":"StorySettings-module__headerTitle","content":"StorySettings-module__content","section":"StorySettings-module__section","title":"StorySettings-module__title","list":"StorySettings-module__list","option":"StorySettings-module__option","checked":"StorySettings-module__checked","input":"StorySettings-module__input","icon":"StorySettings-module__icon","action":"StorySettings-module__action","optionContent":"StorySettings-module__optionContent","footer":"StorySettings-module__footer","info":"StorySettings-module__info","submit":"StorySettings-module__submit"});

/***/ }),

/***/ "./src/components/story/StoryViewModal.module.scss":
/*!*********************************************************!*\
  !*** ./src/components/story/StoryViewModal.module.scss ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"views-list":"StoryViewModal-module__views-list","viewsList":"StoryViewModal-module__views-list","views-list-loading":"StoryViewModal-module__views-list-loading","viewsListLoading":"StoryViewModal-module__views-list-loading","info":"StoryViewModal-module__info","centeredInfo":"StoryViewModal-module__centeredInfo","view-reaction":"StoryViewModal-module__view-reaction","viewReaction":"StoryViewModal-module__view-reaction","header":"StoryViewModal-module__header","content":"StoryViewModal-module__content","top-button":"StoryViewModal-module__top-button","topButton":"StoryViewModal-module__top-button","contact-filter":"StoryViewModal-module__contact-filter","contactFilter":"StoryViewModal-module__contact-filter","selected":"StoryViewModal-module__selected","sort":"StoryViewModal-module__sort","sort-button":"StoryViewModal-module__sort-button","sortButton":"StoryViewModal-module__sort-button","icon-sort":"StoryViewModal-module__icon-sort","iconSort":"StoryViewModal-module__icon-sort","icon-down":"StoryViewModal-module__icon-down","iconDown":"StoryViewModal-module__icon-down","search":"StoryViewModal-module__search","bottom-info":"StoryViewModal-module__bottom-info","bottomInfo":"StoryViewModal-module__bottom-info","scrolled":"StoryViewModal-module__scrolled","footer":"StoryViewModal-module__footer","closeButton":"StoryViewModal-module__closeButton","opacity-fade-in":"StoryViewModal-module__opacity-fade-in","opacityFadeIn":"StoryViewModal-module__opacity-fade-in","fadeIn":"StoryViewModal-module__fadeIn","blocked":"StoryViewModal-module__blocked","check":"StoryViewModal-module__check","menuBubble":"StoryViewModal-module__menuBubble","with-colored-status":"StoryViewModal-module__with-colored-status","withColoredStatus":"StoryViewModal-module__with-colored-status"});

/***/ }),

/***/ "./src/components/story/StoryViewer.module.scss":
/*!******************************************************!*\
  !*** ./src/components/story/StoryViewer.module.scss ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"root":"StoryViewer-module__root","fullSize":"StoryViewer-module__fullSize","backdrop":"StoryViewer-module__backdrop","captionBackdrop":"StoryViewer-module__captionBackdrop","backdropNonInteractive":"StoryViewer-module__backdropNonInteractive","close":"StoryViewer-module__close","wrapper":"StoryViewer-module__wrapper","slideAnimation":"StoryViewer-module__slideAnimation","slideAnimationToActive":"StoryViewer-module__slideAnimationToActive","content":"StoryViewer-module__content","slideAnimationFromActive":"StoryViewer-module__slideAnimationFromActive","storyHeader":"StoryViewer-module__storyHeader","composer":"StoryViewer-module__composer","caption":"StoryViewer-module__caption","captionGradient":"StoryViewer-module__captionGradient","media":"StoryViewer-module__media","mediaPreview":"StoryViewer-module__mediaPreview","contentInner":"StoryViewer-module__contentInner","name":"StoryViewer-module__name","slide":"StoryViewer-module__slide","mobileSlide":"StoryViewer-module__mobileSlide","slidePreview":"StoryViewer-module__slidePreview","activeSlide":"StoryViewer-module__activeSlide","slideInner":"StoryViewer-module__slideInner","mediaWrapper":"StoryViewer-module__mediaWrapper","forward":"StoryViewer-module__forward","storyIndicators":"StoryViewer-module__storyIndicators","sender":"StoryViewer-module__sender","senderInfoTransition":"StoryViewer-module__senderInfoTransition","senderInfo":"StoryViewer-module__senderInfo","senderMeta":"StoryViewer-module__senderMeta","senderName":"StoryViewer-module__senderName","storyMetaRow":"StoryViewer-module__storyMetaRow","storyMeta":"StoryViewer-module__storyMeta","closeButton":"StoryViewer-module__closeButton","actions":"StoryViewer-module__actions","active":"StoryViewer-module__active","visibilityButton":"StoryViewer-module__visibilityButton","visibilityButtonSelf":"StoryViewer-module__visibilityButtonSelf","button":"StoryViewer-module__button","buttonMenu":"StoryViewer-module__buttonMenu","captionInner":"StoryViewer-module__captionInner","captionContent":"StoryViewer-module__captionContent","captionText":"StoryViewer-module__captionText","hasOverflow":"StoryViewer-module__hasOverflow","expanded":"StoryViewer-module__expanded","animate":"StoryViewer-module__animate","withShowMore":"StoryViewer-module__withShowMore","captionShowMore":"StoryViewer-module__captionShowMore","navigate":"StoryViewer-module__navigate","prev":"StoryViewer-module__prev","next":"StoryViewer-module__next","modal":"StoryViewer-module__modal","thumbnail":"StoryViewer-module__thumbnail","ghost":"StoryViewer-module__ghost","ghost2":"StoryViewer-module__ghost2","ghostImage":"StoryViewer-module__ghostImage","forwardHeader":"StoryViewer-module__forwardHeader","clickable":"StoryViewer-module__clickable","headerTitle":"StoryViewer-module__headerTitle","forwardInfo":"StoryViewer-module__forwardInfo","fromPeer":"StoryViewer-module__fromPeer"});

/***/ }),

/***/ "./src/components/story/privacy/CloseFriends.module.scss":
/*!***************************************************************!*\
  !*** ./src/components/story/privacy/CloseFriends.module.scss ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// extracted by mini-css-extract-plugin
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({"buttonHolder":"CloseFriends-module__buttonHolder","active":"CloseFriends-module__active"});

/***/ }),

/***/ "./src/assets/mastercard.svg":
/*!***********************************!*\
  !*** ./src/assets/mastercard.svg ***!
  \***********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "mastercard.790db81f7978635f77d8.svg";

/***/ }),

/***/ "./src/assets/mir.svg":
/*!****************************!*\
  !*** ./src/assets/mir.svg ***!
  \****************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "mir.e3a390b90e2e3e292621.svg";

/***/ }),

/***/ "./src/assets/premium/DeviceFrame.svg":
/*!********************************************!*\
  !*** ./src/assets/premium/DeviceFrame.svg ***!
  \********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "DeviceFrame.79271ee0fa60a7b6a1aa.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumAds.svg":
/*!*******************************************!*\
  !*** ./src/assets/premium/PremiumAds.svg ***!
  \*******************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumAds.a758f19ece91fe91318e.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumBadge.svg":
/*!*********************************************!*\
  !*** ./src/assets/premium/PremiumBadge.svg ***!
  \*********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumBadge.1c630afcfd1112ad16d0.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumChats.svg":
/*!*********************************************!*\
  !*** ./src/assets/premium/PremiumChats.svg ***!
  \*********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumChats.89d9d315638e283ca895.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumEffects.svg":
/*!***********************************************!*\
  !*** ./src/assets/premium/PremiumEffects.svg ***!
  \***********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumEffects.4eab9caad8e9c276842d.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumEmoji.svg":
/*!*********************************************!*\
  !*** ./src/assets/premium/PremiumEmoji.svg ***!
  \*********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumEmoji.26515017c8f6dc4f3f67.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumFile.svg":
/*!********************************************!*\
  !*** ./src/assets/premium/PremiumFile.svg ***!
  \********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumFile.884dd3865acfe594fc61.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumLastSeen.svg":
/*!************************************************!*\
  !*** ./src/assets/premium/PremiumLastSeen.svg ***!
  \************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumLastSeen.9575a548770d23785846.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumLimits.svg":
/*!**********************************************!*\
  !*** ./src/assets/premium/PremiumLimits.svg ***!
  \**********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumLimits.08701cb6df3cf756c5f7.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumLogo.svg":
/*!********************************************!*\
  !*** ./src/assets/premium/PremiumLogo.svg ***!
  \********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumLogo.a5c0e88cd478f4d76d82.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumMessagePrivacy.svg":
/*!******************************************************!*\
  !*** ./src/assets/premium/PremiumMessagePrivacy.svg ***!
  \******************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumMessagePrivacy.950cab3e87c60c5733a6.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumReactions.svg":
/*!*************************************************!*\
  !*** ./src/assets/premium/PremiumReactions.svg ***!
  \*************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumReactions.7fee56ab6b58c82fd15e.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumSpeed.svg":
/*!*********************************************!*\
  !*** ./src/assets/premium/PremiumSpeed.svg ***!
  \*********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumSpeed.d0a43b6780c411c2f84a.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumStatus.svg":
/*!**********************************************!*\
  !*** ./src/assets/premium/PremiumStatus.svg ***!
  \**********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumStatus.c42f9c4b68f9c2c4537a.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumStickers.svg":
/*!************************************************!*\
  !*** ./src/assets/premium/PremiumStickers.svg ***!
  \************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumStickers.7b5a8531a41b43d0da12.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumTags.svg":
/*!********************************************!*\
  !*** ./src/assets/premium/PremiumTags.svg ***!
  \********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumTags.3b187054cc90f8e16cb7.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumTranslate.svg":
/*!*************************************************!*\
  !*** ./src/assets/premium/PremiumTranslate.svg ***!
  \*************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumTranslate.cb2dcbb898d96cb35469.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumVideo.svg":
/*!*********************************************!*\
  !*** ./src/assets/premium/PremiumVideo.svg ***!
  \*********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumVideo.288cb61931e33d913f0a.svg";

/***/ }),

/***/ "./src/assets/premium/PremiumVoice.svg":
/*!*********************************************!*\
  !*** ./src/assets/premium/PremiumVoice.svg ***!
  \*********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "PremiumVoice.b3a2893dbe481108ab94.svg";

/***/ }),

/***/ "./src/assets/visa.svg":
/*!*****************************!*\
  !*** ./src/assets/visa.svg ***!
  \*****************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__.p + "visa.fb39984c9532c0336be9.svg";

/***/ })

}]);
//# sourceMappingURL=BundleExtra.584c84cb32dc2dac8087.js.map